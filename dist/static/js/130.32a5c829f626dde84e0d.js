webpackJsonp([130],{"7U8C":function(t,e,a){(t.exports=a("UTlt")(!1)).push([t.i,"\n.nodata,\n.nodata-box {\n  width: 100%;\n  height: 100%;\n  background: url(/static/imgs/nodata.png) center center no-repeat;\n}\n.fullcharts.nodata-box {\n  position: absolute;\n  top: 40px;\n  height: calc(100vh - 40px - 48px - 80px);\n  background: #fff;\n}\n.el-input__inner::-webkit-input-placeholder {\n  color: #A9ADB7;\n}\n.el-input__inner::-moz-placeholder {\n  /* Mozilla Firefox 19+ */\n  color: #A9ADB7;\n}\n.el-input__inner:-moz-placeholder {\n  /* Mozilla Firefox 4 to 18 */\n  color: #A9ADB7;\n}\n.el-input__inner:-ms-input-placeholder {\n  /* Internet Explorer 10-11 */\n  color: #A9ADB7;\n}\n.el-checkbox__label {\n  padding-left: 6px;\n  font-size: 12px;\n}\n.el-checkbox {\n  font-size: 12px;\n  color: #545B6D;\n}\n.el-input {\n  font-size: 12px;\n}\ninput.el-input__inner {\n  border-color: #DFE5F1;\n}\nbutton.border-color {\n  border-color: #DFE5F1;\n}\n.el-checkbox__inner {\n  width: 12px;\n  height: 12px;\n  border-color: #DFE5F1;\n}\n.el-checkbox__inner::after {\n  top: 0;\n}\n.el-select-dropdown__item {\n  font-size: 12px;\n}\n/*主色为蓝色系*/\n/* @PrimaryBackgroundColor: hsl(hue(@PrimaryColor), 100%, 96%); */\n/*字体颜色*/\n/* 通用头部head部分样式 */\n/* @BorderColor: hsl(hue(@PrimaryColor), 20%, 80%); */\n/* table */\n/* @ThBackgroundColor: hsl(hue(@PrimaryColor)+12, 33%, 96%); */\n/* detail列表详情下的table */\n/* detail列表详情下的slide-section */\n/* detail列表详情下的slide-section 时光轴样式 */\n.shengwuzhipin-analy .totals {\n  height: 86px;\n  background-color: #fff;\n  -webkit-box-shadow: 0px 0px 5px rgba(196, 211, 248, 0.9);\n          box-shadow: 0px 0px 5px rgba(196, 211, 248, 0.9);\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  border-radius: 0 0 4px 4px;\n  overflow: hidden;\n}\n.shengwuzhipin-analy .totals .total-item {\n  display: inline-block;\n  width: 20%;\n  min-width: 127px;\n  text-align: center;\n  vertical-align: text-bottom;\n  border-bottom: 3px solid #fff;\n}\n.shengwuzhipin-analy .totals .total-item:hover {\n  color: #4877e8;\n  background-color: #eff2fa;\n  border-bottom: 3px solid #4877e8;\n}\n.shengwuzhipin-analy .totals .total-item .li1 {\n  padding-top: 19px;\n  font-size: 13px;\n  font-weight: 600;\n}\n.shengwuzhipin-analy .totals .total-item .li2 {\n  font-size: 14px;\n}\n.shengwuzhipin-analy .totals .total-item .li2 span {\n  font-size: 24px;\n  color: #4877e8;\n}\n.shengwuzhipin-analy .chart-boxes {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n}\n.shengwuzhipin-analy .echarts {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  display: inline-block;\n  margin: 50px 10px 20px 10px;\n  width: calc(100% - 20px);\n  height: 400px;\n}\n.shengwuzhipin-analy .hide {\n  display: none;\n}\n.shengwuzhipin-analy .dialog {\n  position: fixed;\n  z-index: 99999;\n  top: 48px;\n  left: 0px;\n  width: 100%;\n  height: calc(100% - 48px);\n  background-color: #eff2fa;\n}\n.shengwuzhipin-analy .dialog .menu {\n  position: fixed;\n  left: 0px;\n  top: 48px;\n}\n.shengwuzhipin-analy .dialog .menu .nav {\n  width: 220px;\n  padding-left: 20px;\n  line-height: 40px;\n  border-left: 4px solid #eff2fa;\n  border-bottom: 1px dashed #dfe5f1;\n  cursor: pointer;\n}\n.shengwuzhipin-analy .dialog .menu .nav.active,\n.shengwuzhipin-analy .dialog .menu .nav:hover {\n  border-left: 4px solid #4877e8;\n  border-bottom: 0px;\n  background-color: #fff;\n  -webkit-box-shadow: 0px 0px 5px rgba(196, 211, 248, 0.9);\n          box-shadow: 0px 0px 5px rgba(196, 211, 248, 0.9);\n  color: #4877e8;\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap {\n  width: calc(100% - 250px) !important;\n  height: 100% !important;\n  position: absolute;\n  overflow-x: hidden;\n  top: 0px;\n  left: 250px;\n  background-color: #fff;\n  -webkit-box-shadow: 0px 0px 5px rgba(196, 211, 248, 0.9);\n          box-shadow: 0px 0px 5px rgba(196, 211, 248, 0.9);\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap .echarts-items-title {\n  position: relative;\n  padding-right: 40px;\n  background-color: #eff2fa;\n  line-height: 40px;\n  text-align: right;\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap .echarts-items-title .echart-title {\n  position: absolute;\n  left: 18px;\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap .echarts-items-title .esc-btn {\n  display: inline-block;\n  height: 100%;\n  font-size: 13px;\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap .echarts-items-title .esc-btn img {\n  display: inline-block;\n  margin-top: 10px;\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap .echarts-items {\n  width: 100%;\n  height: 700px;\n  overflow: hidden;\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap .echarts-items .echarts-item {\n  display: inline-block;\n  margin: 0px 50px;\n  height: 900px;\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap .echarts-items .open-charts {\n  height: 700px;\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap .ctr-actions {\n  padding: 100px 0px 20px;\n  text-align: center;\n}\n.shengwuzhipin-analy .dialog .echarts-items-wap .ctr-actions .action {\n  cursor: pointer;\n  padding: 5px;\n}\n.shengwuzhipin-analy .chart_top {\n  background-color: #eff2fa;\n  -webkit-box-shadow: 0px 2px 8px 0px #D8E2FA;\n          box-shadow: 0px 2px 8px 0px #D8E2FA;\n  position: relative;\n  border-radius: 0 0 4px 4px;\n}\n.shengwuzhipin-analy .chart_bottom {\n  background-color: #eff2fa;\n}\n.shengwuzhipin-analy .chart_bottom .go-list {\n  line-height: 30px;\n  text-align: right;\n  padding-right: 40px;\n  font-size: 14px;\n  padding: 6px 0 1px;\n}\n.shengwuzhipin-analy .chart_bottom .go-list a {\n  width: 86px;\n  height: 24px;\n  line-height: 24px;\n  background: #f4a622;\n  border-radius: 4px;\n  display: block;\n  text-align: center;\n  color: #fff;\n}\n.shengwuzhipin-analy .chart_bottom .go-list a:hover {\n  color: #fff;\n}\n/deep/ .optioned {\n  display: -webkit-inline-box;\n  display: -ms-inline-flexbox;\n  display: inline-flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  height: 40px;\n}\n.la-optioned .optioned.main {\n  display: -webkit-inline-box !important;\n  display: -ms-inline-flexbox !important;\n  display: inline-flex !important;\n  -webkit-box-align: center !important;\n      -ms-flex-align: center !important;\n          align-items: center !important;\n  height: 40px !important;\n}\n.wrap-add-del {\n  margin: 0 !important;\n}\n.la-main .la-right .sec2 {\n  -webkit-box-shadow: none;\n          box-shadow: none;\n}\n",""])},YvoV:function(t,e,a){var n=a("7U8C");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("FIqI")("3216f51f",n,!0,{})},lw0F:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("3cXf"),i=a.n(n),s=a("IHPB"),o=a.n(s),r=a("lC5x"),l=a.n(r),h=a("J0Oq"),c=a.n(h),p=a("4YfN"),u=a.n(p),d=a("ZJ3O"),m=a("00Zy"),f=a("A50N"),y=a("bSIt"),g={components:{LoadingGif:d.a,DbEcharts:m.a,MEcharts:f.a},data:function(){return{specType:0,tempTitle:[],titles:["药品销售量排行","品牌销售量排行","企业销售量排行"],n:0,kshResTotal:{},totalList:[{name:"生产企业",key:"guifanqiye",unit:"个"},{name:"活性成分",key:"zwylbm",unit:"种"},{name:"品种数",key:"guifanname",unit:"个"},{name:"剂型",key:"jixing2",unit:"个"},{name:"规格",key:"guifanguige",unit:"个"},{name:"总销售量",key:"sale",unit:"万"},{name:"销售量同比",key:"tb",unit:"%"}],echartsList:[{title:"药品销售量排行",api:"ypph",ykey:"field",skey:"sale",option:{}},{title:"品牌销售量排行",api:"ppph",ykey:"field",skey:"sale",option:{}},{title:"企业销售量排行",api:"qyph",ykey:"field",skey:"sale",option:{}},{title:"年度销售量",api:"ndph",xkey:"field",lineKey:"sale",barKey:"sale",option:{}},{title:"医疗机构销售量",api:"djfb_xszb",ykey:"field",skey:"sale",option:{}},{title:"ATC分类销售量",api:"atc",ykey:"field",skey:"sale",option:{}}],echartsListOpen:[],echartsOpenWidth:700,promise:null,dialogVisible:!1,openIndex:0,atcsSel:!1,id:"",analyLoading:!0,tempType:[],tempTotalData:null,tempData:[],searchState:{putong:{},gaoji:{},shaixuan:{},fourth:{}}}},watch:{dialogVisible:{handler:function(t,e){this.id=t?"open-echarts":"echarts"},immediate:!0,deep:!0},kshRes:function(t){if("/yyxs/analy_amount"===this.$route.path){if(this.kshResTotal=t.aggs,this.tempTotalData=t.view,document.getElementById("echarts4")){var e=Echarts.getInstanceByDom(document.getElementById("echarts4"));e&&e.clear()}t.view.djfb_xse.forEach(function(t){return t.sale=t.sale/1e4}),this.update(t.view)}},$route:function(t,e){if(t.query.type!=e.query.type&&this.loadData(),"/yyxs/analy_amount"!==this.$route.path||this.kshRes.aggs||this.loadData(),"/yyxs/analy_amount"===this.$route.path?window.addEventListener("resize",this.echartsResizeHandler):(window.removeEventListener("resize",this.echartsResizeHandler),this.echartsClear("echarts")),"/yyxs/list"===this.$route.path){var a=this.activeTabName;Store.commit("Yyxs/tabname",""),Store.commit("Yyxs/tabname",a),this.noData&&Store.dispatch("Yyxs/nomalSearch",{queryToPutong:!1,tabs:!0})}}},computed:u()({},Object(y.b)({nopms:function(t){return t.Yyxs.nopms},kshRes:function(t){return t.Yyxs.kshRes},conditions:function(t){return t.Yyxs.conditions},allBase:function(t){return t.Yyxs.allBase},activeTabName:function(t){return t.Yyxs.tabname},res1:function(t){return t.Yyxs.res1},res2:function(t){return t.Yyxs.res2},res3:function(t){return t.Yyxs.res3},res4:function(t){return t.Yyxs.res4},putong:function(t){return t.Yyxs.putong},gaoji:function(t){return t.Yyxs.gaoji},shaixuan:function(t){return t.Yyxs.shaixuan},fourth:function(t){return t.Yyxs.fourth}}),{amount_type:function(){return 2},noData:function(){return!(this.res1.res||this.res2.res||this.res3.res||this.res4.res)},title:function(){var t=[];return _.forEach(this.echartsList,function(e){t.push(e.title)}),t}}),methods:{exportHandler:function(t,e){var a=this;return c()(l.a.mark(function n(){var i,s,o,r,h;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a.analyLoading=!0,i="",s="万片/粒/袋/支",o=a.echartsList[t].api,r="",n.t0=o,n.next="atc"===n.t0?5:"ndph"===n.t0?8:"ppph"===n.t0?11:"qyph"===n.t0?14:"ypph"===n.t0?17:20;break;case 5:return r="分类名称",i="ATC分类销售量",n.abrupt("break",20);case 8:return r="年份",i="年度销售量",n.abrupt("break",20);case 11:return r="品牌名称",i="品牌销售量排行",n.abrupt("break",20);case 14:return r="企业名称",i="企业销售量排行",n.abrupt("break",20);case 17:return r="药品名称",i="药品销售量排行",n.abrupt("break",20);case 20:return h="field="+r+",amount=销售量（"+s+"）",4===t&&(i="医疗机构销售量",0===e?(o="djfb_xszb",h="field=医院等级,amount=销售数据占比"):1===e&&(o="djfb_xse",h="field=医院等级,amount=销售量（万片/粒/袋/支）")),n.next=24,Store.dispatch("Yyxs/exportAsExcel",{moduleName:i,outdata_column:h,outdata_action:o,amount_type:2});case 24:n.sent,setTimeout(function(){a.analyLoading=!1},1e3);case 26:case"end":return n.stop()}},n,a)}))()},getImgName:function(t){return"药智数据企业版-"+document.title+"-智能分析-"+this.echartsList[t].title},unitChange:function(t,e){return e=e||"sale",this.isBillion(t,e)&&_.forEach(t,function(t){t[e]=t[e]/1e4}),t},isBillion:function(t,e){e=e||"sale";var a=!1;return _.forEach(t,function(t){parseFloat(t[e])>=1e4&&(a=!0)}),a},initLayout:function(){var t=window.innerWidth;this.echartsOpenWidth=t-310},loadData:_.debounce(function(){var t=this;this.analyLoading=!0,this.echartsListOpen=_.cloneDeep(this.echartsList),this.promise=Store.dispatch("Yyxs/getKshRes",2).then(function(e){return t.update(e),e}),setTimeout(function(){t.analyLoading=!1},2e3)},10),handleCloseIndex:function(){var t=this,e=this.openIndex,a="echarts"+e.toString(),n=Echarts.getInstanceByDom(document.getElementById(a)),i=this.tempType[e],s={},o=this.tempData[e];if(n?n.clear():n=Echarts.init(document.getElementById(a)),"atc"==this.echartsList[e].api&&(i="pie"),"pie"==i){var r=o.pie_data,l=o.yAxis_data,h=o.series_data;(s=this.drawPieEcharts(e,r,l,h)).toolbox.feature.myMagnify.show=!0,s.tooltip.formatter=function(e){return(_.isArray(e)?e[0].name:e.name)+"<br/>销售量（亿）: "+t.echartsTooltipMoney(_.isArray(e)?e[0].value:e.value)},s.series[0].label.formatter=function(e){return t.echartsTooltipMoney(e.value)}}else if("doughnut"==i){var c=o.pie_data,p=o.yAxis_data,u=o.series_data;s=this.drawDoughnutEcharts(e,c,p,u)}else if("bar"==i){var d=o.yAxis_data,m=o.series_data;d=d.reverse(),m=m.reverse(),(s=this.drawBarEchartsY(e,d,m)).toolbox.feature.myMagnify.show=!0,s.tooltip.formatter=function(e){return(_.isArray(e)?e[0].name:e.name)+"<br/>销售量（亿）: "+t.echartsTooltipMoney(_.isArray(e)?e[0].value:e.value)},s.series[0].label.formatter=function(e){return t.echartsTooltipMoney(e.value)}}else if("barLine"==i){var f=o.xAxis_data,y=(o.series_data,this.echartsList[e].api),g={type:"bar",name:"销售量（万）: ",data:[],label:{show:!0,position:"top",color:"#333",formatter:function(e){return t.echartsTooltipMoney(e.value)}}},x=[],b=this.echartsList[e].xkey,v=this.echartsList[e].barKey,w={type:"line",name:"同比（%）",yAxisIndex:1,data:[],label:{show:!0,position:"right",color:"#333",formatter:function(t){return t.value+"%"}}},k=(this.isBillion(k,this.echartsList[e].skey),[]);if(3!==e&&(k=this.unitChange(this.tempTotalData[y],this.echartsList[e].skey)),"ndph"===y&&this.tempTotalData[y].forEach(function(t){f.push(t[b]),g.data.push(t[v]),x.push(t[v])}),"ndph"===y){g.data.reverse();var T=x.reverse();w.data=this.rateFn(T),f=f.reverse(),[g,w]}(s=this.drawBarLineEcharts(e,f.reverse(),[g,w])).toolbox.feature.myMagnify.show=!0,s.tooltip.formatter=function(a){var n=t.echartsList[e].isBillion?"亿":"万";return(_.isArray(a)?a[0].name:a.name)+"<br/>销售量（"+n+"）: "+t.echartsTooltipMoney(_.isArray(a)?a[0].value:a.value)},s.series[0].label.formatter=function(e){return t.echartsTooltipMoney(e.value)}}n.setOption(s),this.dialogVisible=!1},handleOpenIndex:function(t,e){var a=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t>0&&t<this.echartsList.length?this.openIndex=t:this.openIndex=0,1==n&&(e=this.tempData[t]);var i="open-echarts"+t.toString(),s=Echarts.getInstanceByDom(document.getElementById(i)),o=this.tempType[t],r={};if(s?s.clear():s=Echarts.init(document.getElementById(i)),"atc"==this.echartsList[t].api&&(o="pie"),"pie"==o){var l=e,h=l.pie_data,c=l.yAxis_data,p=l.series_data;(r=this.drawPieEcharts(t,h,c,p)).toolbox.feature.myMagnify.show=!1,r.tooltip.formatter=function(t){return(_.isArray(t)?t[0].name:t.name)+"<br/>销售量（亿）: "+a.echartsTooltipMoney(_.isArray(t)?t[0].value:t.value)},r.series[0].label.formatter=function(t){return a.echartsTooltipMoney(t.value)}}else if("bar"==o){var u=e,d=u.yAxis_data,m=u.series_data;d=d.reverse(),m=m.reverse(),(r=this.drawBarEchartsY(t,d,m)).toolbox.feature.myMagnify.show=!1,r.tooltip.formatter=function(t){return(_.isArray(t)?t[0].name:t.name)+"<br/>销售量（亿）: "+a.echartsTooltipMoney(_.isArray(t)?t[0].value:t.value)},r.series[0].label.formatter=function(t){return a.echartsTooltipMoney(t.value)}}else if("doughnut"==o){var f=e,y=f.pie_data,g=f.yAxis_data,x=f.series_data;r=this.drawDoughnutEcharts(t,y,g,x)}else if("barLine"==o){var b=e,v=b.xAxis_data,w=(b.series_data,this.echartsList[t].api),k={type:"bar",name:"销售量（万）: ",data:[],label:{show:!0,position:"top",color:"#333",formatter:function(t){return a.echartsTooltipMoney(t.value)}}},T=[],L=this.echartsList[t].xkey,E=this.echartsList[t].barKey,D={type:"line",name:"同比（%）",yAxisIndex:1,data:[],label:{show:!0,position:"right",color:"#333",formatter:function(t){return t.value+"%"}}},A=(this.isBillion(A,this.echartsList[t].skey),[]);if(3!==t&&(A=this.unitChange(this.tempTotalData[w],this.echartsList[t].skey)),"ndph"===w&&this.tempTotalData[w].forEach(function(t){v.push(t[L]),k.data.push(t[E]),T.push(t[E])}),"ndph"===w){k.data.reverse();var I=T.reverse();D.data=this.rateFn(I),v=v.reverse(),[k,D]}(r=this.drawBarLineEcharts(t,v.reverse(),[k,D])).toolbox.feature.myMagnify.show=!1,r.tooltip.formatter=function(e){var n=a.echartsList[t].isBillion?"亿":"万";return(_.isArray(e)?e[0].name:e.name)+"<br/>销售量（"+n+"）: "+a.echartsTooltipMoney(_.isArray(e)?e[0].value:e.value)},r.series[0].label.formatter=function(t){return a.echartsTooltipMoney(t.value)}}s.setOption(r)},update:function(t){var e=this;_.forEach(t,function(t,a){_.forEach(e.echartsList,function(t,n){a===t.api&&e.echartsData(a,n)})})},initOpendKsh:function(t,e){this.dialogVisible=!0,this.handleOpenIndex(t,e)},echartsData:function(t,e){var a=this,n=this.kshRes.view[t];this.tempTotalData[this.echartsList[e].api]=n,"djfb_xse"===t&&(this.tempTotalData[t]=this.kshRes.view[t],this.echartsList[e].isBillion=isBillion);var i=this.echartsList[e],s=i.api,o=[],r=[],l=[],h=[],c=0,p=i.ykey,u=i.skey,d=i.xkey,m=i.barKey,f=(i.lineKey,[]),y={type:"bar",name:"销售量（万）: ",data:[],label:{show:!0,position:"top",color:"#333",formatter:function(t){return a.echartsTooltipMoney(t.value)}}},g={type:"line",name:"同比（%）",yAxisIndex:1,data:[],label:{show:!0,position:"right",color:"#333",formatter:function(t){return t.value+"%"}}};if(void 0!==n){var x=this.isBillion(n,i.skey);n=this.unitChange(n,i.skey),i.isBillion=x,c=n.length;for(var b=0;b<c;b++){var v=n[b];"ndph"===s?(l.push(v[d]),y.data.push(v[m]),f.push(v[m])):(o.push(v[p]),r.push(Number(v[u])),h.push({value:Number(v[u]),name:v[p]}))}var w=void 0;if("ndph"===s){y.data.reverse();var k=f.reverse();g.data=this.rateFn(k),w=this.drawBarLineEcharts(e,l.reverse(),[y,g])}else"atc"===s?w=this.drawPieEcharts(e,h,o,r):"djfb_xszb"===s?(this.tempType[e]="doughnut",this.specType=0,w=this.drawDoughnutEcharts(e,h,o,r)):w=this.drawBarEchartsY(e,o,r);this.echartsList[e].option=_.cloneDeep(w),this.echartsListOpen[e].option=_.cloneDeep(w),this.echartsListOpen[e].option.toolbox.feature.myMagnify.show=!1,this.echartsListOpen[e].option.tooltip.formatter=function(t){var n=a.echartsList[e].isBillion?"亿":"万";return(_.isArray(t)?t[0].name:t.name)+"<br/>销售量（"+n+"）: "+a.echartsTooltipMoney(_.isArray(t)?t[0].value:t.value)},this.echartsListOpen[e].option.series[0].label.formatter=function(t){return a.echartsTooltipMoney(t.value)}}this.getAtc()},getAtc:function(){var t=this;this.atcsSel=!1,_.forEach(this.conditions,function(e){"atc"===e.name&&e.atcs_sel&&(t.atcsSel=!0)})},rateFn:function(t){var e=[];return _.forEach(t,function(a,n){if(0!==n){var i=Number((a-t[n-1])/t[n-1]*100).toFixed(2);e.push(i)}else e.push(null)}),e},drawBarEchartsY:function(t,e,a){var n=this,i=[],s=this;4!==t?(e.length>0&&e.forEach(function(t,e){i.push({name:t,value:a[e]})}),e=[],a=[],this.tempTotalData[this.echartsList[t].api].forEach(function(t){return e.push(t.number+"-"+t.field)}),this.tempTotalData[this.echartsList[t].api].forEach(function(t){return a.push(t.sale)}),e=e.reverse(),a=a.reverse()):(a=a.reverse(),e=e.reverse());var o=e&&e.findIndex(function(t,e){return t.includes("-其他")});o>-1&&(e.splice(o,1),a.splice(o,1)),this.tempTitle[t]=this.titles[t]+"(TOP100)",this.tempData[t]={yAxis_data:e,series_data:a},this.tempType[t]="bar";var r=this.echartsList[t].isBillion?"亿":"万",l=a.length-10,h=a.length-1;a.length<10&&(l=0,h=a.length-1);var c={tooltip:{position:function(t,e,a,i,s){return n.echartsTooltipPositionX(t,e,a,i,s)},trigger:"axis",formatter:function(t){return t[0].name+"<br/>销售量（"+r+"）:"+n.echartsTooltipMoney(t[0].value)}},dataZoom:[{show:a.length>10,startValue:l,endValue:h,width:"35",showDetail:!1,yAxisIndex:0,left:20}],toolbox:{feature:{saveAsImage:{show:!1},myExport:{title:"导出",icon:"image:///static/imgs/echarts/download.png",onclick:function(){4!==t?s.exportHandler(t):s.exportHandler(4,s.specType)}},myMagnify:{show:!0,title:"全屏",icon:"image:///static/imgs/echarts/screen.png",onclick:function(){var e=0==s.specType?"djfb_xszb":"djfb_xse",a=s.tempTotalData[e].map(function(t){return t.field}).reverse(),n=s.tempTotalData[e].map(function(t){return t.sale}).reverse();s.initOpendKsh(t,{yAxis_data:a,series_data:n})}}}},grid:{containLabel:!0,left:e.length>10?-40:-30,right:"100px"},yAxis:{type:"category",axisLabel:{margin:110,textStyle:{align:"left"},formatter:function(t){return t.length>9?t.substring(0,9)+"...":t}},data:e},xAxis:{type:"value",name:"销售量（"+r+"）",axisLabel:{formatter:function(t){return n.echartsUnitTransform(t)}}},series:[{data:a,type:"bar",label:{show:!0,position:"right",color:"#333",formatter:function(t){return n.echartsTooltipMoney(t.value)}}}]};if(t<this.echartsList.length-1)if(4===t){var p={show:!0,title:"占比统计",icon:"image:///static/imgs/echarts/doughnut.png",onclick:function(){s.specType=0,s.tempType[t]="doughnut";var e=s.id+t.toString(),a=Echarts.getInstanceByDom(document.getElementById(e));a.clear(),a=Echarts.init(document.getElementById(e));var n=s.tempTotalData.djfb_xszb.map(function(t){return Number(t.sale)}),i=s.tempTotalData.djfb_xszb.map(function(t){return t.field}),o=[];s.tempTotalData.djfb_xszb.forEach(function(t){o.push({value:Number(t.sale),name:t.field})});var r=s.drawDoughnutEcharts(t,o,i,n);r.toolbox.feature.myTogglePie=!1,r.series[0].data=o,s.dialogVisible?(s.echartsListOpen[t].option=_.cloneDeep(r),s.echartsListOpen[t].option.toolbox.feature.myMagnify.show=!1,s.echartsListOpen[t].option.tooltip.formatter=function(t){return t.name+"："+t.value+"%"},s.echartsListOpen[t].option.series[0].label.formatter=function(t){return s.echartsTooltipMoney(t.value)}):(s.echartsList[t].option=_.cloneDeep(r),s.echartsListOpen[t].option.toolbox.feature.myTogglePie&&(s.echartsListOpen[t].option.toolbox.feature.myTogglePie.show=!1),s.echartsList[t].option.tooltip.formatter=function(t){return t.name+"："+t.value+"%"})}},u=c.toolbox.feature,d=u.saveAsImage,m=u.myExport,f=u.myMagnify;c.toolbox.feature={saveAsImage:d,myToggleDoughnut:p,myExport:m,myMagnify:f}}else{var y={show:!0,title:"饼形图",icon:"image:///static/imgs/echarts/pie.png",onclick:function(){s.tempType[t]="pie";var o=s.id+t.toString(),r=Echarts.getInstanceByDom(document.getElementById(o));r?r.clear():r=Echarts.init(document.getElementById(o));var l=n.echartsList[t].ykey,h=n.echartsList[t].skey;e=[],a=[],i=[],n.tempTotalData[n.echartsList[t].api].forEach(function(t){e.push(t[l]),a.push(t[h]),i.push({value:t[h],name:t[l]})});var c=s.drawPieEcharts(t,i,e,a);s.dialogVisible?(s.echartsListOpen[t].option=_.cloneDeep(c),s.echartsListOpen[t].option.toolbox.feature.myMagnify.show=!1,s.echartsListOpen[t].option.tooltip.formatter=function(t){return(_.isArray(t)?t[0].name:t.name)+"<br/>销售量（亿）: "+s.echartsTooltipMoney(_.isArray(t)?t[0].value:t.value)},s.echartsListOpen[t].option.series[0].label.formatter=function(t){return s.echartsTooltipMoney(t.value)}):(s.echartsList[t].option=_.cloneDeep(c),s.echartsListOpen[t].option.toolbox.feature.myToggleLine&&(s.echartsListOpen[t].option.toolbox.feature.myToggleLine.show=!1))}},g=c.toolbox.feature,x=g.saveAsImage,b=g.myExport,v=g.myMagnify;c.toolbox.feature={saveAsImage:x,myTogglePie:y,myExport:b,myMagnify:v}}return c},drawBarLineEcharts:function(t,e,a){var n=this,i=this,s=this.echartsList[t].isBillion?"亿":"万",o=this.echartsList[t].api,r={type:"bar",name:"销售量（"+s+"）",data:[],label:{show:!0,position:"top",color:"#333",formatter:function(t){return n.echartsTooltipMoney(t.value)}}},l=[],h=this.echartsList[t].xkey,c=this.echartsList[t].barKey,p={type:"line",name:"同比（%）",yAxisIndex:1,data:[],label:{show:!0,position:"right",color:"#333",formatter:function(t){return t.value+"%"}}},u=(this.isBillion(d,this.echartsList[t].skey),"销售量（"+s+"）"),d=[];if(3!==t&&(d=this.unitChange(this.tempTotalData[o],this.echartsList[t].skey)),e=[],r.data=[],"ndph"===o&&this.tempTotalData[o].forEach(function(t){e.push(t[h]),r.data.push(t[c]),l.push(t[c])}),"ndph"===o){r.data.reverse();var m=l.reverse();p.data=this.rateFn(m),e=e.reverse(),a=[r,p]}return this.tempData[t]={xAxis_data:e,series_data:a},this.tempType[t]="barLine",{tooltip:{trigger:"axis",formatter:function(t){var e=t[0].name+"<br>";return _.map(t,function(t){"bar"==t.seriesType?e+='<span style="display: inline-block;height: 6px;width: 6px;border-radius: 50%;margin-right:5px; background-color:'+t.color+'"></span>销售量（'+s+"）:"+n.echartsTooltipMoney(t.value)+"<br>":"line"==t.seriesType&&t.value&&(e+='<span style="display: inline-block;height: 6px;width: 6px;border-radius: 50%;margin-right:5px; background-color:'+t.color+'"></span>同比（%）: '+t.value+"<br>")}),e}},grid:{containLabel:!0},toolbox:{feature:{saveAsImage:{show:!1},myExport:{show:!0,title:"导出",icon:"image:///static/imgs/echarts/download.png",onclick:function(){i.exportHandler(t)}},myMagnify:{show:!0,title:"全屏",icon:"image:///static/imgs/echarts/screen.png",onclick:function(){i.initOpendKsh(t,{xAxis_data:e,series_data:a})}}}},legend:{data:[{name:"销售量（"+s+"）",icon:"circle"},{name:"同比（%）"}],bottom:20},xAxis:[{type:"category",data:e,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:u,axisLabel:{formatter:function(t){return n.echartsUnitTransform(t)}}},{type:"value",name:"同比（%）",axisLabel:{formatter:function(t){return t+"%"}}}],series:a}},drawDoughnutEcharts:function(t,e,a,n){var i=[],s=this.echartsList[t].api,o=this.echartsList[t].ykey,r=this.echartsList[t].skey,l=this;return a=[],n=[],i=[],this.tempTotalData[s].forEach(function(t){a.push(t[o]),n.push(t[r]),i.push({value:Number(t[r]),name:t[o]})}),this.tempTitle[t]=this.titles[t]+"(TOP10)",this.tempData[t]={pie_data:i,yAxis_data:a,series_data:n},this.tempType[t]="doughnut",{toolbox:{feature:{saveAsImage:{show:!1},myToggleBar:{show:!0,title:"数据统计",icon:"image:///static/imgs/echarts/bar-horizontal.png",onclick:function(){l.tempType[t]="bar",l.specType=1;var e=l.id+t.toString(),a=Echarts.getInstanceByDom(document.getElementById(e));a.clear(),a=Echarts.init(document.getElementById(e));var n=l.tempTotalData.djfb_xse.map(function(t){return t.sale}),i=l.tempTotalData.djfb_xse.map(function(t){return t.field}),s=l.drawBarEchartsY(t,i,n);s.xAxis.name="销售量（亿）",s.toolbox.feature.myTogglePie=!1,s.series[0].data=n,l.dialogVisible?(l.echartsListOpen[t].option=_.cloneDeep(s),l.echartsListOpen[t].option.toolbox.feature.myMagnify.show=!1,l.echartsListOpen[t].option.tooltip.formatter=function(t){var e=Number(_.isArray(t)?t[0].value:t.value);return(_.isArray(t)?t[0].name:t.name)+"<br/>销售量（亿）: "+l.echartsTooltipMoney(e)},l.echartsListOpen[t].option.series[0].label.formatter=function(t){return l.echartsTooltipMoney(t.value)}):(l.echartsList[t].option=_.cloneDeep(s),l.echartsListOpen[t].option.toolbox.feature.myTogglePie&&(l.echartsListOpen[t].option.toolbox.feature.myTogglePie.show=!1),l.echartsList[t].option.tooltip.formatter=function(t){var e=Number(_.isArray(t)?t[0].value:t.value);return(_.isArray(t)?t[0].name:t.name)+"<br/>销售量（亿）: "+l.echartsTooltipMoney(e)})}},myExport:{title:"导出",icon:"image:///static/imgs/echarts/download.png",onclick:function(){4!==t?l.exportHandler(t):l.exportHandler(4,l.specType)}},myMagnify:{show:!0,title:"全屏",icon:"image:///static/imgs/echarts/screen.png",onclick:function(){l.initOpendKsh(t,{pie_data:i,yAxis_data:a,series_data:n})}}}},legend:{type:"scroll",bottom:0,data:e},tooltip:{trigger:"item",formatter:function(t){return t.name+"："+t.value+"%"}},series:[{type:"pie",radius:["40%","75%"],data:e,label:{normal:{show:!0,position:"outside",formatter:function(t){return t.name.length>9?t.name.substring(0,9)+"..."+t.percent+"%":t.name+t.percent+"%"},color:"#606266"}},itemStyle:{}}]}},drawPieEcharts:function(t,e,a,n){var i=this,s=this.echartsList[t].isBillion?"亿":"万",r=[],l=this.echartsList[t].api,h=this.echartsList[t].ykey,c=this.echartsList[t].skey,p=this;a=[],n=[],r=[],this.tempTotalData[l].forEach(function(t){a.push(t[h]),n.push(t[c]),r.push({value:t[c],name:t[h]})}),this.tempTitle[t]=this.titles[t]+"(TOP10)",this.tempData[t]={pie_data:r,yAxis_data:a,series_data:n},this.tempType[t]="pie";var u=e;e.length>10&&(u=[].concat(o()(e.slice(0,10)),[e[e.length-1]]));var d={toolbox:{feature:{saveAsImage:{show:!1},myExport:{title:"导出",icon:"image:///static/imgs/echarts/download.png",onclick:function(){p.exportHandler(t)}},myMagnify:{show:!0,title:"全屏",icon:"image:///static/imgs/echarts/screen.png",onclick:function(){p.initOpendKsh(t,{pie_data:r,yAxis_data:a,series_data:n})}}}},legend:{type:"scroll",bottom:0,data:"atc"==l?e:e.slice(0,10).map(function(t){return t.name})},tooltip:{trigger:"item",formatter:function(t){return t.name+"<br/>销售量（"+s+"）: "+i.echartsTooltipMoney(t.value)}},series:[{type:"pie",radius:"60%",center:["50%","50%"],data:"atc"==l?e:u,label:{normal:{show:!0,position:"outside",formatter:function(t){return t.name.length>9?t.name.substring(0,9)+"..."+t.percent+"%":t.name+t.percent+"%"},color:"#606266"}},itemStyle:{}}]};if(t<this.echartsList.length-1){var m={show:!0,title:"柱状图",icon:"image:///static/imgs/echarts/bar.png",onclick:function(){p.tempType[t]="bar";var e=p.id+t.toString(),i=Echarts.getInstanceByDom(document.getElementById(e));i?i.clear():i=Echarts.init(document.getElementById(e));var s=p.drawBarEchartsY(t,a,n);p.dialogVisible?(p.echartsListOpen[t].option=_.cloneDeep(s),p.echartsListOpen[t].option.toolbox.feature.myMagnify.show=!1,p.echartsListOpen[t].option.tooltip.formatter=function(t){return(_.isArray(t)?t[0].name:t.name)+"<br/>销售量（亿）: "+p.echartsTooltipMoney(_.isArray(t)?t[0].value:t.value)},p.echartsListOpen[t].option.series[0].label.formatter=function(t){return p.echartsTooltipMoney(t.value)}):(p.echartsList[t].option=_.cloneDeep(s),p.echartsListOpen[t].option.toolbox.feature.myTogglePie&&(p.echartsListOpen[t].option.toolbox.feature.myTogglePie.show=!1))}},f=d.toolbox.feature,y=f.saveAsImage,g=f.myExport,x=f.myMagnify;d.toolbox.feature={saveAsImage:y,myToggleLine:m,myExport:g,myMagnify:x}}return d},echartsResizeHandler:function(){var t=this;this.dialogVisible&&this.initLayout(),this.$nextTick(function(){t.echartsResize("echart")})},diffSearchData:function(){var t={putong:this.putong,gaoji:this.gaoji,shaixuan:this.shaixuan,fourth:this.fourth};return i()(t)!=i()(this.searchState)&&(this.searchState=t,!0)}},created:function(){var t=this;this.$nextTick(function(){t.initLayout(),t.loadData(),t.titles.forEach(function(e,a){t.tempTitle[a]=t.titles[a]+"(TOP100)"})}),setTimeout(function(){var e=sessionStorage.getItem("hashLocation");window._paq.push(["setCustomUrl","https://"+e]),window._paq.push(["trackPageView",t.allBase.dbname]),window._paq.push(["setDocumentTitle",t.allBase.dbname])},1e3)},mounted:function(){window.addEventListener("resize",this.echartsResizeHandler)},activated:function(){this.vueRouteToNoPms(this.nopms.ksh),this.diffSearchData()&&this.loadData()},updated:function(){this.vueRouteToNoPms(this.nopms.ksh)}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"analy-wrapeer"},[t.analyLoading?a("LoadingGif",{attrs:{className:"db-index-loading",loadFlag:t.analyLoading}}):t._e(),t._v(" "),a("div",{staticClass:"shengwuzhipin-analy"},[a("div",{staticClass:"chart_top"},[a("div",{staticClass:"totals"},t._l(t.totalList,function(e,n){return a("ul",{key:n,staticClass:"total-item"},["[object Object]"===Object.prototype.toString.call(t.kshResTotal[e.key])&&"tb"===e.key?[a("li",{staticClass:"li1"},[t._v("\n              "+t._s(e.name)+"（"+t._s(t.kshResTotal[e.key].year)+"）\n            ")]),t._v(" "),a("li",{staticClass:"li2"},[t._v("\n              总计\n              "),a("span",[t._v(t._s(t.kshResTotal[e.key].value?t.kshResTotal[e.key].value:"-"))]),t._v(t._s(e.unit)+"\n            ")])]:[a("li",{staticClass:"li1"},[t._v("\n              "+t._s(e.name)+"\n            ")]),t._v(" "),t.kshResTotal[e.key]>=1e8&&"sale"===e.key?a("li",{staticClass:"li2"},[t._v("\n              总计\n              "),a("span",[t._v(t._s(t.kshResTotal[e.key]?(t.kshResTotal[e.key]/1e8).toFixed(2):"-"))]),t._v(t._s("亿")+"\n            ")]):a("li",{staticClass:"li2"},["sale"===e.key?a("div",[t._v("\n                总计\n                "),a("span",[t._v(t._s(t.kshResTotal[e.key]?(t.kshResTotal[e.key]/1e4).toFixed(2):"-"))]),t._v(t._s(e.unit)+"\n              ")]):a("div",[t._v("\n                总计\n                "),a("span",[t._v(t._s(t.kshResTotal[e.key]?t.kshResTotal[e.key]:"-"))]),t._v(t._s(e.unit)+"\n              ")])])]],2)}),0)]),t._v(" "),a("div",{staticClass:"chart_bottom"},[a("div",{staticClass:"go-list"},[a("router-link",{attrs:{tag:"a",to:{path:"/yyxs/list"}}},[t._v("返回列表")])],1),t._v(" "),a("div",{staticClass:"chart-boxes"},[t._l(t.echartsList,function(e,n){return["djfb_xszb"!=e.api?a("DbEcharts",{key:n,attrs:{title:n<3?t.tempTitle[n]:e.title}},[a("MEcharts",{ref:"echarts"+n,refInFor:!0,staticClass:"echarts",attrs:{option:e.option,id:"echarts"+n,conditions:t.conditions,name:e.api,atcsSel:t.atcsSel}})],1):t._e()]})],2)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogVisible,expression:"dialogVisible"}],staticClass:"dialog"},[a("div",{staticClass:"menu"},t._l(t.title,function(e,n){return a("div",{key:n,class:[n==t.openIndex?"active":"","nav"],on:{click:function(e){return t.handleOpenIndex(n,[],!0)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),0),t._v(" "),a("div",{staticClass:"echarts-items-wap"},[a("div",{staticClass:"echarts-items-title"},[t.openIndex<3?a("span",{staticClass:"echart-title"},[t._v(t._s(t.tempTitle[t.openIndex]))]):a("span",{staticClass:"echart-title"},[t._v(t._s(t.title[t.openIndex]))]),t._v(" "),a("a",{staticClass:"esc-btn",attrs:{href:"javascript:;"},on:{click:function(e){return t.handleCloseIndex()}}},[a("i"),t._v(" "),a("img",{attrs:{src:"/static/imgs/echarts/esc-fullscreen.png",alt:"退出全屏"}})])]),t._v(" "),a("div",{staticClass:"echarts-items"},t._l(t.echartsListOpen,function(e,n){return a("div",{directives:[{name:"show",rawName:"v-show",value:n===t.openIndex,expression:"i === openIndex"}],key:n,staticClass:"echarts-item"},[a("MEcharts",{ref:"open-echarts"+n,refInFor:!0,staticClass:"open-charts",attrs:{option:e.option,id:"open-echarts"+n,width:t.echartsOpenWidth,conditions:t.conditions,height:700,name:e.api,atcsSel:t.atcsSel}})],1)}),0),t._v(" "),a("div",{staticClass:"ctr-actions"},[a("el-button",{staticClass:"pre action",on:{click:function(e){return t.handleOpenIndex(t.openIndex-1,[],!0)}}},[a("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),a("el-button",{staticClass:"next action",on:{click:function(e){return t.handleOpenIndex(t.openIndex+1,[],!0)}}},[a("i",{staticClass:"el-icon-arrow-right"})])],1),t._v(" "),t._m(0)])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"nodata-box fullcharts hide"},[e("div",{staticClass:"nodata"})])}]};var b=a("C7Lr")(g,x,!1,function(t){a("YvoV")},null,null);e.default=b.exports}});