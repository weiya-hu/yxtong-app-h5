!function(t){filesType="";if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ketcher=t()}}(function(){var L;return function(){function c(i,a,s){function u(e,t){if(!a[e]){if(!i[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(l)return l(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var o=a[e]={exports:{}};i[e][0].call(o.exports,function(t){return u(i[e][1][t]||t)},o,o.exports,c,i,a,s)}return a[e].exports}for(var l="function"==typeof require&&require,t=0;t<s.length;t++)u(s[t]);return u}return c}()({1:[function(t,c,e){(function(e,t){function r(){for(;o.next;){o=o.next;var t=o.task;o.task=void 0;var e=o.domain;e&&(o.domain=void 0,e.enter());try{t()}catch(t){if(u)throw e&&e.exit(),setTimeout(r,0),e&&e.enter(),t;setTimeout(function(){throw t},0)}e&&e.exit()}a=!1}function n(t){i=i.next={task:t,domain:u&&e.domain,next:null},a||(a=!0,s())}var o={task:void 0,next:null},i=o,a=!1,s=void 0,u=!1;if(void 0!==e&&e.nextTick)u=!0,s=function(){e.nextTick(r)};else if("function"==typeof t)s="undefined"!=typeof window?t.bind(window,r):function(){t(r)};else if("undefined"!=typeof MessageChannel){var l=new MessageChannel;l.port1.onmessage=r,s=function(){l.port2.postMessage(0)}}else s=function(){setTimeout(r,0)};c.exports=n}).call(this,t("_process"),t("timers").setImmediate)},{_process:486,timers:513}],2:[function(t,e,r){!function(){"use strict";function i(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var n=typeof r;if("string"===n||"number"===n)t.push(r);else if(Array.isArray(r))t.push(i.apply(null,r));else if("object"===n)for(var o in r)a.call(r,o)&&r[o]&&t.push(o)}}return t.join(" ")}var a={}.hasOwnProperty;void 0!==e&&e.exports?e.exports=i:"function"==typeof L&&"object"==typeof L.amd&&L.amd?L("classnames",[],function(){return i}):window.classNames=i}()},{}],3:[function(t,e,r){e.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},{}],4:[function(t,e,r){var n=t("./_wks")("unscopables"),o=Array.prototype;void 0==o[n]&&t("./_hide")(o,n,{}),e.exports=function(t){o[n][t]=!0}},{"./_hide":35,"./_wks":106}],5:[function(t,e,r){e.exports=function(t,e,r,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(r+": incorrect invocation!");return t}},{}],6:[function(t,e,r){var n=t("./_is-object");e.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},{"./_is-object":44}],7:[function(t,e,r){"use strict";var l=t("./_to-object"),c=t("./_to-absolute-index"),f=t("./_to-length");e.exports=[].copyWithin||function(t,e){var r=l(this),n=f(r.length),o=c(t,n),i=c(e,n),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?n:c(a,n))-i,n-o),u=1;for(i<o&&o<i+s&&(u=-1,i+=s-1,o+=s-1);s-- >0;)i in r?r[o]=r[i]:delete r[o],o+=u,i+=u;return r}},{"./_to-absolute-index":91,"./_to-length":95,"./_to-object":96}],8:[function(t,e,r){"use strict";var s=t("./_to-object"),u=t("./_to-absolute-index"),l=t("./_to-length");e.exports=function(t){for(var e=s(this),r=l(e.length),n=arguments.length,o=u(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:u(i,r);a>o;)e[o++]=t;return e}},{"./_to-absolute-index":91,"./_to-length":95,"./_to-object":96}],9:[function(t,e,r){var u=t("./_to-iobject"),l=t("./_to-length"),c=t("./_to-absolute-index");e.exports=function(s){return function(t,e,r){var n,o=u(t),i=l(o.length),a=c(r,i);if(s&&e!=e){for(;i>a;)if((n=o[a++])!=n)return!0}else for(;i>a;a++)if((s||a in o)&&o[a]===e)return s||a||0;return!s&&-1}}},{"./_to-absolute-index":91,"./_to-iobject":94,"./_to-length":95}],10:[function(t,e,r){var b=t("./_ctx"),_=t("./_iobject"),x=t("./_to-object"),w=t("./_to-length"),n=t("./_array-species-create");e.exports=function(f,t){var d=1==f,p=2==f,h=3==f,m=4==f,g=6==f,v=5==f||g,y=t||n;return function(t,e,r){for(var n,o,i=x(t),a=_(i),s=b(e,r,3),u=w(a.length),l=0,c=d?y(t,u):p?y(t,0):void 0;u>l;l++)if((v||l in a)&&(n=a[l],o=s(n,l,i),f))if(d)c[l]=o;else if(o)switch(f){case 3:return!0;case 5:return n;case 6:return l;case 2:c.push(n)}else if(m)return!1;return g?-1:h||m?m:c}}},{"./_array-species-create":12,"./_ctx":21,"./_iobject":40,"./_to-length":95,"./_to-object":96}],11:[function(t,e,r){var n=t("./_is-object"),o=t("./_is-array"),i=t("./_wks")("species");e.exports=function(t){var e;return o(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!o(e.prototype)||(e=void 0),n(e)&&null===(e=e[i])&&(e=void 0)),void 0===e?Array:e}},{"./_is-array":42,"./_is-object":44,"./_wks":106}],12:[function(t,e,r){var n=t("./_array-species-constructor");e.exports=function(t,e){return new(n(t))(e)}},{"./_array-species-constructor":11}],13:[function(t,e,r){"use strict";var i=t("./_a-function"),a=t("./_is-object"),s=t("./_invoke"),u=[].slice,l={},c=function(t,e,r){if(!(e in l)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";l[e]=Function("F,a","return new F("+n.join(",")+")")}return l[e](t,r)};e.exports=Function.bind||function(e){var r=i(this),n=u.call(arguments,1),o=function(){var t=n.concat(u.call(arguments));return this instanceof o?c(r,t.length,t):s(r,t,e)};return a(r.prototype)&&(o.prototype=r.prototype),o}},{"./_a-function":3,"./_invoke":39,"./_is-object":44}],14:[function(t,e,r){var o=t("./_cof"),i=t("./_wks")("toStringTag"),a="Arguments"==o(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};e.exports=function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=s(e=Object(t),i))?r:a?o(e):"Object"==(n=o(e))&&"function"==typeof e.callee?"Arguments":n}},{"./_cof":15,"./_wks":106}],15:[function(t,e,r){var n={}.toString;e.exports=function(t){return n.call(t).slice(8,-1)}},{}],16:[function(t,e,r){"use strict";var a=t("./_object-dp").f,s=t("./_object-create"),u=t("./_redefine-all"),l=t("./_ctx"),c=t("./_an-instance"),f=t("./_for-of"),n=t("./_iter-define"),o=t("./_iter-step"),i=t("./_set-species"),d=t("./_descriptors"),p=t("./_meta").fastKey,h=t("./_validate-collection"),m=d?"_s":"size",g=function(t,e){var r,n=p(e);if("F"!==n)return t._i[n];for(r=t._f;r;r=r.n)if(r.k==e)return r};e.exports={getConstructor:function(t,i,r,n){var o=t(function(t,e){c(t,o,i,"_i"),t._t=i,t._i=s(null),t._f=void 0,t._l=void 0,t[m]=0,void 0!=e&&f(e,r,t[n],t)});return u(o.prototype,{clear:function(){for(var t=h(this,i),e=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete e[r.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var e=h(this,i),r=g(e,t);if(r){var n=r.n,o=r.p;delete e._i[r.i],r.r=!0,o&&(o.n=n),n&&(n.p=o),e._f==r&&(e._f=n),e._l==r&&(e._l=o),e[m]--}return!!r},forEach:function(t){h(this,i);for(var e,r=l(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.n:this._f;)for(r(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!g(h(this,i),t)}}),d&&a(o.prototype,"size",{get:function(){return h(this,i)[m]}}),o},def:function(t,e,r){var n,o,i=g(t,e);return i?i.v=r:(t._l=i={i:o=p(e,!0),k:e,v:r,p:n=t._l,n:void 0,r:!1},t._f||(t._f=i),n&&(n.n=i),t[m]++,"F"!==o&&(t._i[o]=i)),t},getEntry:g,setStrong:function(t,r,e){n(t,r,function(t,e){this._t=h(t,r),this._k=e,this._l=void 0},function(){for(var t=this,e=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==e?o(0,r.k):"values"==e?o(0,r.v):o(0,[r.k,r.v]):(t._t=void 0,o(1))},e?"entries":"values",!e,!0),i(r)}}},{"./_an-instance":5,"./_ctx":21,"./_descriptors":23,"./_for-of":32,"./_iter-define":48,"./_iter-step":50,"./_meta":57,"./_object-create":61,"./_object-dp":62,"./_redefine-all":77,"./_set-species":81,"./_validate-collection":103}],17:[function(t,e,r){"use strict";var a=t("./_redefine-all"),s=t("./_meta").getWeak,o=t("./_an-object"),u=t("./_is-object"),l=t("./_an-instance"),c=t("./_for-of"),n=t("./_array-methods"),f=t("./_has"),d=t("./_validate-collection"),i=n(5),p=n(6),h=0,m=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},v=function(t,e){return i(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=v(this,t);if(e)return e[1]},has:function(t){return!!v(this,t)},set:function(t,e){var r=v(this,t);r?r[1]=e:this.a.push([t,e])},delete:function(e){var t=p(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(t,r,n,o){var i=t(function(t,e){l(t,i,r,"_i"),t._t=r,t._i=h++,t._l=void 0,void 0!=e&&c(e,n,t[o],t)});return a(i.prototype,{delete:function(t){if(!u(t))return!1;var e=s(t);return!0===e?m(d(this,r)).delete(t):e&&f(e,this._i)&&delete e[this._i]},has:function(t){if(!u(t))return!1;var e=s(t);return!0===e?m(d(this,r)).has(t):e&&f(e,this._i)}}),i},def:function(t,e,r){var n=s(o(e),!0);return!0===n?m(t).set(e,r):n[t._i]=r,t},ufstore:m}},{"./_an-instance":5,"./_an-object":6,"./_array-methods":10,"./_for-of":32,"./_has":34,"./_is-object":44,"./_meta":57,"./_redefine-all":77,"./_validate-collection":103}],18:[function(t,e,r){"use strict";var v=t("./_global"),y=t("./_export"),b=t("./_redefine"),_=t("./_redefine-all"),x=t("./_meta"),w=t("./_for-of"),S=t("./_an-instance"),O=t("./_is-object"),A=t("./_fails"),E=t("./_iter-detect"),j=t("./_set-to-string-tag"),P=t("./_inherit-if-required");e.exports=function(n,t,e,r,o,i){var a=v[n],s=a,u=o?"set":"add",l=s&&s.prototype,c={},f=function(t){var r=l[t];b(l,t,"delete"==t?function(t){return!(i&&!O(t))&&r.call(this,0===t?0:t)}:"has"==t?function(t){return!(i&&!O(t))&&r.call(this,0===t?0:t)}:"get"==t?function(t){return i&&!O(t)?void 0:r.call(this,0===t?0:t)}:"add"==t?function(t){return r.call(this,0===t?0:t),this}:function(t,e){return r.call(this,0===t?0:t,e),this})};if("function"==typeof s&&(i||l.forEach&&!A(function(){(new s).entries().next()}))){var d=new s,p=d[u](i?{}:-0,1)!=d,h=A(function(){d.has(1)}),m=E(function(t){new s(t)}),g=!i&&A(function(){for(var t=new s,e=5;e--;)t[u](e,e);return!t.has(-0)});m||(s=t(function(t,e){S(t,s,n);var r=P(new a,t,s);return void 0!=e&&w(e,o,r[u],r),r}),s.prototype=l,l.constructor=s),(h||g)&&(f("delete"),f("has"),o&&f("get")),(g||p)&&f(u),i&&l.clear&&delete l.clear}else s=r.getConstructor(t,n,o,u),_(s.prototype,e),x.NEED=!0;return j(s,n),c[n]=s,y(y.G+y.W+y.F*(s!=a),c),i||r.setStrong(s,n,o),s}},{"./_an-instance":5,"./_export":27,"./_fails":29,"./_for-of":32,"./_global":33,"./_inherit-if-required":38,"./_is-object":44,"./_iter-detect":49,"./_meta":57,"./_redefine":78,"./_redefine-all":77,"./_set-to-string-tag":82}],19:[function(t,e,r){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},{}],20:[function(t,e,r){"use strict";var n=t("./_object-dp"),o=t("./_property-desc");e.exports=function(t,e,r){e in t?n.f(t,e,o(0,r)):t[e]=r}},{"./_object-dp":62,"./_property-desc":76}],21:[function(t,e,r){var i=t("./_a-function");e.exports=function(n,o,t){if(i(n),void 0===o)return n;switch(t){case 1:return function(t){return n.call(o,t)};case 2:return function(t,e){return n.call(o,t,e)};case 3:return function(t,e,r){return n.call(o,t,e,r)}}return function(){return n.apply(o,arguments)}}},{"./_a-function":3}],22:[function(t,e,r){e.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},{}],23:[function(t,e,r){e.exports=!t("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":29}],24:[function(t,e,r){var n=t("./_is-object"),o=t("./_global").document,i=n(o)&&n(o.createElement);e.exports=function(t){return i?o.createElement(t):{}}},{"./_global":33,"./_is-object":44}],25:[function(t,e,r){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],26:[function(t,e,r){var s=t("./_object-keys"),u=t("./_object-gops"),l=t("./_object-pie");e.exports=function(t){var e=s(t),r=u.f;if(r)for(var n,o=r(t),i=l.f,a=0;o.length>a;)i.call(t,n=o[a++])&&e.push(n);return e}},{"./_object-gops":67,"./_object-keys":70,"./_object-pie":71}],27:[function(t,e,r){var m=t("./_global"),g=t("./_core"),v=t("./_hide"),y=t("./_redefine"),b=t("./_ctx"),_=function(t,e,r){var n,o,i,a,s=t&_.F,u=t&_.G,l=t&_.S,c=t&_.P,f=t&_.B,d=u?m:l?m[e]||(m[e]={}):(m[e]||{}).prototype,p=u?g:g[e]||(g[e]={}),h=p.prototype||(p.prototype={});u&&(r=e);for(n in r)o=!s&&d&&void 0!==d[n],i=(o?d:r)[n],a=f&&o?b(i,m):c&&"function"==typeof i?b(Function.call,i):i,d&&y(d,n,i,t&_.U),p[n]!=i&&v(p,n,a),c&&h[n]!=i&&(h[n]=i)};m.core=g,_.F=1,_.G=2,_.S=4,_.P=8,_.B=16,_.W=32,_.U=64,_.R=128,e.exports=_},{"./_core":19,"./_ctx":21,"./_global":33,"./_hide":35,"./_redefine":78}],28:[function(t,e,r){var n=t("./_wks")("match");e.exports=function(e){var r=/./;try{"/./"[e](r)}catch(t){try{return r[n]=!1,!"/./"[e](r)}catch(e){}}return!0}},{"./_wks":106}],29:[function(t,e,r){e.exports=function(t){try{return!!t()}catch(t){return!0}}},{}],30:[function(t,e,r){"use strict";var s=t("./_hide"),u=t("./_redefine"),l=t("./_fails"),c=t("./_defined"),f=t("./_wks");e.exports=function(e,t,r){var n=f(e),o=r(c,n,""[e]),i=o[0],a=o[1];l(function(){var t={};return t[n]=function(){return 7},7!=""[e](t)})&&(u(String.prototype,e,i),s(RegExp.prototype,n,2==t?function(t,e){return a.call(t,this,e)}:function(t){return a.call(t,this)}))}},{"./_defined":22,"./_fails":29,"./_hide":35,"./_redefine":78,"./_wks":106}],31:[function(t,e,r){"use strict";var n=t("./_an-object");e.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},{"./_an-object":6}],32:[function(t,e,r){var d=t("./_ctx"),p=t("./_iter-call"),h=t("./_is-array-iter"),m=t("./_an-object"),g=t("./_to-length"),v=t("./core.get-iterator-method"),y={},b={},r=e.exports=function(t,e,r,n,o){var i,a,s,u,l=o?function(){return t}:v(t),c=d(r,n,e?2:1),f=0;if("function"!=typeof l)throw TypeError(t+" is not iterable!");if(h(l)){for(i=g(t.length);i>f;f++)if((u=e?c(m(a=t[f])[0],a[1]):c(t[f]))===y||u===b)return u}else for(s=l.call(t);!(a=s.next()).done;)if((u=p(s,c,a.value,e))===y||u===b)return u};r.BREAK=y,r.RETURN=b},{"./_an-object":6,"./_ctx":21,"./_is-array-iter":41,"./_iter-call":46,"./_to-length":95,"./core.get-iterator-method":107}],33:[function(t,e,r){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],34:[function(t,e,r){var n={}.hasOwnProperty;e.exports=function(t,e){return n.call(t,e)}},{}],35:[function(t,e,r){var n=t("./_object-dp"),o=t("./_property-desc");e.exports=t("./_descriptors")?function(t,e,r){return n.f(t,e,o(1,r))}:function(t,e,r){return t[e]=r,t}},{"./_descriptors":23,"./_object-dp":62,"./_property-desc":76}],36:[function(t,e,r){var n=t("./_global").document;e.exports=n&&n.documentElement},{"./_global":33}],37:[function(t,e,r){e.exports=!t("./_descriptors")&&!t("./_fails")(function(){return 7!=Object.defineProperty(t("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":23,"./_dom-create":24,"./_fails":29}],38:[function(t,e,r){var i=t("./_is-object"),a=t("./_set-proto").set;e.exports=function(t,e,r){var n,o=e.constructor;return o!==r&&"function"==typeof o&&(n=o.prototype)!==r.prototype&&i(n)&&a&&a(t,n),t}},{"./_is-object":44,"./_set-proto":80}],39:[function(t,e,r){e.exports=function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},{}],40:[function(t,e,r){var n=t("./_cof");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},{"./_cof":15}],41:[function(t,e,r){var n=t("./_iterators"),o=t("./_wks")("iterator"),i=Array.prototype;e.exports=function(t){return void 0!==t&&(n.Array===t||i[o]===t)}},{"./_iterators":51,"./_wks":106}],42:[function(t,e,r){var n=t("./_cof");e.exports=Array.isArray||function(t){return"Array"==n(t)}},{"./_cof":15}],43:[function(t,e,r){var n=t("./_is-object"),o=Math.floor;e.exports=function(t){return!n(t)&&isFinite(t)&&o(t)===t}},{"./_is-object":44}],44:[function(t,e,r){e.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},{}],45:[function(t,e,r){var n=t("./_is-object"),o=t("./_cof"),i=t("./_wks")("match");e.exports=function(t){var e;return n(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==o(t))}},{"./_cof":15,"./_is-object":44,"./_wks":106}],46:[function(t,e,r){var i=t("./_an-object");e.exports=function(t,e,r,n){try{return n?e(i(r)[0],r[1]):e(r)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},{"./_an-object":6}],47:[function(t,e,r){"use strict";var n=t("./_object-create"),o=t("./_property-desc"),i=t("./_set-to-string-tag"),a={};t("./_hide")(a,t("./_wks")("iterator"),function(){return this}),e.exports=function(t,e,r){t.prototype=n(a,{next:o(1,r)}),i(t,e+" Iterator")}},{"./_hide":35,"./_object-create":61,"./_property-desc":76,"./_set-to-string-tag":82,"./_wks":106}],48:[function(t,e,r){"use strict";var b=t("./_library"),_=t("./_export"),x=t("./_redefine"),w=t("./_hide"),S=t("./_iterators"),O=t("./_iter-create"),A=t("./_set-to-string-tag"),E=t("./_object-gpo"),j=t("./_wks")("iterator"),P=!([].keys&&"next"in[].keys()),T=function(){return this};e.exports=function(t,e,r,n,o,i,a){O(r,e,n);var s,u,l,c=function(t){if(!P&&t in h)return h[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},f=e+" Iterator",d="values"==o,p=!1,h=t.prototype,m=h[j]||h["@@iterator"]||o&&h[o],g=m||c(o),v=o?d?c("entries"):g:void 0,y="Array"==e?h.entries||m:m;if(y&&(l=E(y.call(new t)))!==Object.prototype&&l.next&&(A(l,f,!0),b||"function"==typeof l[j]||w(l,j,T)),d&&m&&"values"!==m.name&&(p=!0,g=function(){return m.call(this)}),b&&!a||!P&&!p&&h[j]||w(h,j,g),S[e]=g,S[f]=T,o)if(s={values:d?g:c("values"),keys:i?g:c("keys"),entries:v},a)for(u in s)u in h||x(h,u,s[u]);else _(_.P+_.F*(P||p),e,s);return s}},{"./_export":27,"./_hide":35,"./_iter-create":47,"./_iterators":51,"./_library":52,"./_object-gpo":68,"./_redefine":78,"./_set-to-string-tag":82,"./_wks":106}],49:[function(t,e,r){var i=t("./_wks")("iterator"),a=!1;try{var n=[7][i]();n.return=function(){a=!0},Array.from(n,function(){throw 2})}catch(t){}e.exports=function(t,e){if(!e&&!a)return!1;var r=!1;try{var n=[7],o=n[i]();o.next=function(){return{done:r=!0}},n[i]=function(){return o},t(n)}catch(t){}return r}},{"./_wks":106}],50:[function(t,e,r){e.exports=function(t,e){return{value:e,done:!!t}}},{}],51:[function(t,e,r){e.exports={}},{}],52:[function(t,e,r){e.exports=!1},{}],53:[function(t,e,r){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},{}],54:[function(t,e,r){var i=t("./_math-sign"),n=Math.pow,a=n(2,-52),s=n(2,-23),u=n(2,127)*(2-s),l=n(2,-126),c=function(t){return t+1/a-1/a};e.exports=Math.fround||function(t){var e,r,n=Math.abs(t),o=i(t);return n<l?o*c(n/l/s)*l*s:(e=(1+s/a)*n,r=e-(e-n),r>u||r!=r?o*(1/0):o*r)}},{"./_math-sign":56}],55:[function(t,e,r){e.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},{}],56:[function(t,e,r){e.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},{}],57:[function(t,e,r){var n=t("./_uid")("meta"),o=t("./_is-object"),i=t("./_has"),a=t("./_object-dp").f,s=0,u=Object.isExtensible||function(){return!0},l=!t("./_fails")(function(){return u(Object.preventExtensions({}))}),c=function(t){a(t,n,{value:{i:"O"+ ++s,w:{}}})},f=function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,n)){if(!u(t))return"F";if(!e)return"E";c(t)}return t[n].i},d=function(t,e){if(!i(t,n)){if(!u(t))return!0;if(!e)return!1;c(t)}return t[n].w},p=function(t){return l&&h.NEED&&u(t)&&!i(t,n)&&c(t),t},h=e.exports={KEY:n,NEED:!1,fastKey:f,getWeak:d,onFreeze:p}},{"./_fails":29,"./_has":34,"./_is-object":44,"./_object-dp":62,"./_uid":101}],58:[function(t,e,r){var s=t("./_global"),u=t("./_task").set,l=s.MutationObserver||s.WebKitMutationObserver,c=s.process,f=s.Promise,d="process"==t("./_cof")(c);e.exports=function(){var r,n,o,t=function(){var t,e;for(d&&(t=c.domain)&&t.exit();r;){e=r.fn,r=r.next;try{e()}catch(t){throw r?o():n=void 0,t}}n=void 0,t&&t.enter()};if(d)o=function(){c.nextTick(t)};else if(!l||s.navigator&&s.navigator.standalone)if(f&&f.resolve){var e=f.resolve(void 0);o=function(){e.then(t)}}else o=function(){u.call(s,t)};else{var i=!0,a=document.createTextNode("");new l(t).observe(a,{characterData:!0}),o=function(){a.data=i=!i}}return function(t){var e={fn:t,next:void 0};n&&(n.next=e),r||(r=e,o()),n=e}}},{"./_cof":15,"./_global":33,"./_task":90}],59:[function(t,e,r){"use strict";function n(t){var r,n;this.promise=new t(function(t,e){if(void 0!==r||void 0!==n)throw TypeError("Bad Promise constructor");r=t,n=e}),this.resolve=o(r),this.reject=o(n)}var o=t("./_a-function");e.exports.f=function(t){return new n(t)}},{"./_a-function":3}],60:[function(t,e,r){"use strict";var d=t("./_object-keys"),p=t("./_object-gops"),h=t("./_object-pie"),m=t("./_to-object"),g=t("./_iobject"),o=Object.assign;e.exports=!o||t("./_fails")(function(){var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(t){e[t]=t}),7!=o({},t)[r]||Object.keys(o({},e)).join("")!=n})?function(t,e){for(var r=m(t),n=arguments.length,o=1,i=p.f,a=h.f;n>o;)for(var s,u=g(arguments[o++]),l=i?d(u).concat(i(u)):d(u),c=l.length,f=0;c>f;)a.call(u,s=l[f++])&&(r[s]=u[s]);return r}:o},{"./_fails":29,"./_iobject":40,"./_object-gops":67,"./_object-keys":70,"./_object-pie":71,"./_to-object":96}],61:[function(n,t,e){var o=n("./_an-object"),i=n("./_object-dps"),a=n("./_enum-bug-keys"),s=n("./_shared-key")("IE_PROTO"),u=function(){},l=function(){var t,e=n("./_dom-create")("iframe"),r=a.length;for(e.style.display="none",n("./_html").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;r--;)delete l.prototype[a[r]];return l()};t.exports=Object.create||function(t,e){var r;return null!==t?(u.prototype=o(t),r=new u,u.prototype=null,r[s]=t):r=l(),void 0===e?r:i(r,e)}},{"./_an-object":6,"./_dom-create":24,"./_enum-bug-keys":25,"./_html":36,"./_object-dps":63,"./_shared-key":83}],62:[function(t,e,r){var n=t("./_an-object"),o=t("./_ie8-dom-define"),i=t("./_to-primitive"),a=Object.defineProperty;r.f=t("./_descriptors")?Object.defineProperty:function(t,e,r){if(n(t),e=i(e,!0),n(r),o)try{return a(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},{"./_an-object":6,"./_descriptors":23,"./_ie8-dom-define":37,"./_to-primitive":97}],63:[function(t,e,r){var a=t("./_object-dp"),s=t("./_an-object"),u=t("./_object-keys");e.exports=t("./_descriptors")?Object.defineProperties:function(t,e){s(t);for(var r,n=u(e),o=n.length,i=0;o>i;)a.f(t,r=n[i++],e[r]);return t}},{"./_an-object":6,"./_descriptors":23,"./_object-dp":62,"./_object-keys":70}],64:[function(t,e,r){var n=t("./_object-pie"),o=t("./_property-desc"),i=t("./_to-iobject"),a=t("./_to-primitive"),s=t("./_has"),u=t("./_ie8-dom-define"),l=Object.getOwnPropertyDescriptor;r.f=t("./_descriptors")?l:function(t,e){if(t=i(t),e=a(e,!0),u)try{return l(t,e)}catch(t){}if(s(t,e))return o(!n.f.call(t,e),t[e])}},{"./_descriptors":23,"./_has":34,"./_ie8-dom-define":37,"./_object-pie":71,"./_property-desc":76,"./_to-iobject":94,"./_to-primitive":97}],65:[function(t,e,r){var n=t("./_to-iobject"),o=t("./_object-gopn").f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return o(t)}catch(t){return a.slice()}};e.exports.f=function(t){return a&&"[object Window]"==i.call(t)?s(t):o(n(t))}},{"./_object-gopn":66,"./_to-iobject":94}],66:[function(t,e,r){var n=t("./_object-keys-internal"),o=t("./_enum-bug-keys").concat("length","prototype");r.f=Object.getOwnPropertyNames||function(t){return n(t,o)}},{"./_enum-bug-keys":25,"./_object-keys-internal":69}],67:[function(t,e,r){r.f=Object.getOwnPropertySymbols},{}],68:[function(t,e,r){var n=t("./_has"),o=t("./_to-object"),i=t("./_shared-key")("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(t){return t=o(t),n(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},{"./_has":34,"./_shared-key":83,"./_to-object":96}],69:[function(t,e,r){var a=t("./_has"),s=t("./_to-iobject"),u=t("./_array-includes")(!1),l=t("./_shared-key")("IE_PROTO");e.exports=function(t,e){var r,n=s(t),o=0,i=[];for(r in n)r!=l&&a(n,r)&&i.push(r);for(;e.length>o;)a(n,r=e[o++])&&(~u(i,r)||i.push(r));return i}},{"./_array-includes":9,"./_has":34,"./_shared-key":83,"./_to-iobject":94}],70:[function(t,e,r){var n=t("./_object-keys-internal"),o=t("./_enum-bug-keys");e.exports=Object.keys||function(t){return n(t,o)}},{"./_enum-bug-keys":25,"./_object-keys-internal":69}],71:[function(t,e,r){r.f={}.propertyIsEnumerable},{}],72:[function(t,e,r){var u=t("./_object-keys"),l=t("./_to-iobject"),c=t("./_object-pie").f;e.exports=function(s){return function(t){for(var e,r=l(t),n=u(r),o=n.length,i=0,a=[];o>i;)c.call(r,e=n[i++])&&a.push(s?[e,r[e]]:r[e]);return a}}},{"./_object-keys":70,"./_object-pie":71,"./_to-iobject":94}],73:[function(t,e,r){var n=t("./_object-gopn"),o=t("./_object-gops"),i=t("./_an-object"),a=t("./_global").Reflect;e.exports=a&&a.ownKeys||function(t){var e=n.f(i(t)),r=o.f;return r?e.concat(r(t)):e}},{"./_an-object":6,"./_global":33,"./_object-gopn":66,"./_object-gops":67}],74:[function(t,e,r){e.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},{}],75:[function(t,e,r){var n=t("./_an-object"),o=t("./_is-object"),i=t("./_new-promise-capability");e.exports=function(t,e){if(n(t),o(e)&&e.constructor===t)return e;var r=i.f(t);return(0,r.resolve)(e),r.promise}},{"./_an-object":6,"./_is-object":44,"./_new-promise-capability":59}],76:[function(t,e,r){e.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},{}],77:[function(t,e,r){var o=t("./_redefine");e.exports=function(t,e,r){for(var n in e)o(t,n,e[n],r);return t}},{"./_redefine":78}],78:[function(t,e,r){var i=t("./_global"),a=t("./_hide"),s=t("./_has"),u=t("./_uid")("src"),n=Function.toString,l=(""+n).split("toString");t("./_core").inspectSource=function(t){return n.call(t)},(e.exports=function(t,e,r,n){var o="function"==typeof r;o&&(s(r,"name")||a(r,"name",e)),t[e]!==r&&(o&&(s(r,u)||a(r,u,t[e]?""+t[e]:l.join(String(e)))),t===i?t[e]=r:n?t[e]?t[e]=r:a(t,e,r):(delete t[e],a(t,e,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[u]||n.call(this)})},{"./_core":19,"./_global":33,"./_has":34,"./_hide":35,"./_uid":101}],79:[function(t,e,r){e.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},{}],80:[function(e,t,r){var n=e("./_is-object"),o=e("./_an-object"),i=function(t,e){if(o(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,n){try{n=e("./_ctx")(Function.call,e("./_object-gopd").f(Object.prototype,"__proto__").set,2),n(t,[]),r=!(t instanceof Array)}catch(t){r=!0}return function(t,e){return i(t,e),r?t.__proto__=e:n(t,e),t}}({},!1):void 0),check:i}},{"./_an-object":6,"./_ctx":21,"./_is-object":44,"./_object-gopd":64}],81:[function(t,e,r){"use strict";var n=t("./_global"),o=t("./_object-dp"),i=t("./_descriptors"),a=t("./_wks")("species");e.exports=function(t){var e=n[t];i&&e&&!e[a]&&o.f(e,a,{configurable:!0,get:function(){return this}})}},{"./_descriptors":23,"./_global":33,"./_object-dp":62,"./_wks":106}],82:[function(t,e,r){var n=t("./_object-dp").f,o=t("./_has"),i=t("./_wks")("toStringTag");e.exports=function(t,e,r){t&&!o(t=r?t:t.prototype,i)&&n(t,i,{configurable:!0,value:e})}},{"./_has":34,"./_object-dp":62,"./_wks":106}],83:[function(t,e,r){var n=t("./_shared")("keys"),o=t("./_uid");e.exports=function(t){return n[t]||(n[t]=o(t))}},{"./_shared":84,"./_uid":101}],84:[function(t,e,r){var n=t("./_core"),o=t("./_global"),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:t("./_library")?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},{"./_core":19,"./_global":33,"./_library":52}],85:[function(t,e,r){var o=t("./_an-object"),i=t("./_a-function"),a=t("./_wks")("species");e.exports=function(t,e){var r,n=o(t).constructor;return void 0===n||void 0==(r=o(n)[a])?e:i(r)}},{"./_a-function":3,"./_an-object":6,"./_wks":106}],86:[function(t,e,r){var u=t("./_to-integer"),l=t("./_defined");e.exports=function(s){return function(t,e){var r,n,o=String(l(t)),i=u(e),a=o.length;return i<0||i>=a?s?"":void 0:(r=o.charCodeAt(i),r<55296||r>56319||i+1===a||(n=o.charCodeAt(i+1))<56320||n>57343?s?o.charAt(i):r:s?o.slice(i,i+2):n-56320+(r-55296<<10)+65536)}}},{"./_defined":22,"./_to-integer":93}],87:[function(t,e,r){var n=t("./_is-regexp"),o=t("./_defined");e.exports=function(t,e,r){if(n(e))throw TypeError("String#"+r+" doesn't accept regex!");return String(o(t))}},{"./_defined":22,"./_is-regexp":45}],88:[function(t,e,r){var c=t("./_to-length"),f=t("./_string-repeat"),d=t("./_defined");e.exports=function(t,e,r,n){var o=String(d(t)),i=o.length,a=void 0===r?" ":String(r),s=c(e);if(s<=i||""==a)return o;var u=s-i,l=f.call(a,Math.ceil(u/a.length));return l.length>u&&(l=l.slice(0,u)),n?l+o:o+l}},{"./_defined":22,"./_string-repeat":89,"./_to-length":95}],89:[function(t,e,r){"use strict";var o=t("./_to-integer"),i=t("./_defined");e.exports=function(t){var e=String(i(this)),r="",n=o(t);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r}},{"./_defined":22,"./_to-integer":93}],90:[function(t,e,r){var n,o,i,a=t("./_ctx"),s=t("./_invoke"),u=t("./_html"),l=t("./_dom-create"),c=t("./_global"),f=c.process,d=c.setImmediate,p=c.clearImmediate,h=c.MessageChannel,m=c.Dispatch,g=0,v={},y=function(){var t=+this;if(v.hasOwnProperty(t)){var e=v[t];delete v[t],e()}},b=function(t){y.call(t.data)};d&&p||(d=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return v[++g]=function(){s("function"==typeof t?t:Function(t),e)},n(g),g},p=function(t){delete v[t]},"process"==t("./_cof")(f)?n=function(t){f.nextTick(a(y,t,1))}:m&&m.now?n=function(t){m.now(a(y,t,1))}:h?(o=new h,i=o.port2,o.port1.onmessage=b,n=a(i.postMessage,i,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(t){c.postMessage(t+"","*")},c.addEventListener("message",b,!1)):n="onreadystatechange"in l("script")?function(t){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),y.call(t)}}:function(t){setTimeout(a(y,t,1),0)}),e.exports={set:d,clear:p}},{"./_cof":15,"./_ctx":21,"./_dom-create":24,"./_global":33,"./_html":36,"./_invoke":39}],91:[function(t,e,r){var n=t("./_to-integer"),o=Math.max,i=Math.min;e.exports=function(t,e){return t=n(t),t<0?o(t+e,0):i(t,e)}},{"./_to-integer":93}],92:[function(t,e,r){var n=t("./_to-integer"),o=t("./_to-length");e.exports=function(t){if(void 0===t)return 0;var e=n(t),r=o(e);if(e!==r)throw RangeError("Wrong length!");return r}},{"./_to-integer":93,"./_to-length":95}],93:[function(t,e,r){var n=Math.ceil,o=Math.floor;e.exports=function(t){return isNaN(t=+t)?0:(t>0?o:n)(t)}},{}],94:[function(t,e,r){var n=t("./_iobject"),o=t("./_defined");e.exports=function(t){return n(o(t))}},{"./_defined":22,"./_iobject":40}],95:[function(t,e,r){var n=t("./_to-integer"),o=Math.min;e.exports=function(t){return t>0?o(n(t),9007199254740991):0}},{"./_to-integer":93}],96:[function(t,e,r){var n=t("./_defined");e.exports=function(t){return Object(n(t))}},{"./_defined":22}],97:[function(t,e,r){var o=t("./_is-object");e.exports=function(t,e){if(!o(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!o(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!o(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!o(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":44}],98:[function(t,e,r){"use strict";if(t("./_descriptors")){var b=t("./_library"),_=t("./_global"),x=t("./_fails"),w=t("./_export"),S=t("./_typed"),n=t("./_typed-buffer"),d=t("./_ctx"),O=t("./_an-instance"),o=t("./_property-desc"),A=t("./_hide"),i=t("./_redefine-all"),a=t("./_to-integer"),E=t("./_to-length"),j=t("./_to-index"),s=t("./_to-absolute-index"),u=t("./_to-primitive"),l=t("./_has"),P=t("./_classof"),T=t("./_is-object"),p=t("./_to-object"),h=t("./_is-array-iter"),C=t("./_object-create"),k=t("./_object-gpo"),M=t("./_object-gopn").f,m=t("./core.get-iterator-method"),c=t("./_uid"),f=t("./_wks"),g=t("./_array-methods"),v=t("./_array-includes"),y=t("./_species-constructor"),R=t("./es6.array.iterator"),N=t("./_iterators"),B=t("./_iter-detect"),I=t("./_set-species"),L=t("./_array-fill"),D=t("./_array-copy-within"),F=t("./_object-dp"),G=t("./_object-gopd"),z=F.f,H=G.f,W=_.RangeError,U=_.TypeError,V=_.Uint8Array,q=Array.prototype,Y=n.ArrayBuffer,K=n.DataView,$=g(0),X=g(2),Z=g(3),Q=g(4),J=g(5),tt=g(6),et=v(!0),rt=v(!1),nt=R.values,ot=R.keys,it=R.entries,at=q.lastIndexOf,st=q.reduce,ut=q.reduceRight,lt=q.join,ct=q.sort,ft=q.slice,dt=q.toString,pt=q.toLocaleString,ht=f("iterator"),mt=f("toStringTag"),gt=c("typed_constructor"),vt=c("def_constructor"),yt=S.CONSTR,bt=S.TYPED,_t=S.VIEW,xt=g(1,function(t,e){return Et(y(t,t[vt]),e)}),wt=x(function(){return 1===new V(new Uint16Array([1]).buffer)[0]}),St=!!V&&!!V.prototype.set&&x(function(){new V(1).set({})}),Ot=function(t,e){var r=a(t);if(r<0||r%e)throw W("Wrong offset!");return r},At=function(t){if(T(t)&&bt in t)return t;throw U(t+" is not a typed array!")},Et=function(t,e){if(!(T(t)&&gt in t))throw U("It is not a typed array constructor!");return new t(e)},jt=function(t,e){return Pt(y(t,t[vt]),e)},Pt=function(t,e){for(var r=0,n=e.length,o=Et(t,n);n>r;)o[r]=e[r++];return o},Tt=function(t,e,r){z(t,e,{get:function(){return this._d[r]}})},Ct=function(t){var e,r,n,o,i,a,s=p(t),u=arguments.length,l=u>1?arguments[1]:void 0,c=void 0!==l,f=m(s);if(void 0!=f&&!h(f)){for(a=f.call(s),n=[],e=0;!(i=a.next()).done;e++)n.push(i.value);s=n}for(c&&u>2&&(l=d(l,arguments[2],2)),e=0,r=E(s.length),o=Et(this,r);r>e;e++)o[e]=c?l(s[e],e):s[e];return o},kt=function(){for(var t=0,e=arguments.length,r=Et(this,e);e>t;)r[t]=arguments[t++];return r},Mt=!!V&&x(function(){pt.call(new V(1))}),Rt=function(){return pt.apply(Mt?ft.call(At(this)):At(this),arguments)},Nt={copyWithin:function(t,e){return D.call(At(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return Q(At(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return L.apply(At(this),arguments)},filter:function(t){return jt(this,X(At(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return J(At(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(At(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){$(At(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return rt(At(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(At(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return lt.apply(At(this),arguments)},lastIndexOf:function(t){return at.apply(At(this),arguments)},map:function(t){return xt(At(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(At(this),arguments)},reduceRight:function(t){return ut.apply(At(this),arguments)},reverse:function(){for(var t,e=this,r=At(e).length,n=Math.floor(r/2),o=0;o<n;)t=e[o],e[o++]=e[--r],e[r]=t;return e},some:function(t){return Z(At(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ct.call(At(this),t)},subarray:function(t,e){var r=At(this),n=r.length,o=s(t,n);return new(y(r,r[vt]))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,E((void 0===e?n:s(e,n))-o))}},Bt=function(t,e){return jt(this,ft.call(At(this),t,e))},It=function(t){At(this);var e=Ot(arguments[1],1),r=this.length,n=p(t),o=E(n.length),i=0;if(o+e>r)throw W("Wrong length!");for(;i<o;)this[e+i]=n[i++]},Lt={entries:function(){return it.call(At(this))},keys:function(){return ot.call(At(this))},values:function(){return nt.call(At(this))}},Dt=function(t,e){return T(t)&&t[bt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Ft=function(t,e){return Dt(t,e=u(e,!0))?o(2,t[e]):H(t,e)},Gt=function(t,e,r){return!(Dt(t,e=u(e,!0))&&T(r)&&l(r,"value"))||l(r,"get")||l(r,"set")||r.configurable||l(r,"writable")&&!r.writable||l(r,"enumerable")&&!r.enumerable?z(t,e,r):(t[e]=r.value,t)};yt||(G.f=Ft,F.f=Gt),w(w.S+w.F*!yt,"Object",{getOwnPropertyDescriptor:Ft,defineProperty:Gt}),x(function(){dt.call({})})&&(dt=pt=function(){return lt.call(this)});var zt=i({},Nt);i(zt,Lt),A(zt,ht,Lt.values),i(zt,{slice:Bt,set:It,constructor:function(){},toString:dt,toLocaleString:Rt}),Tt(zt,"buffer","b"),Tt(zt,"byteOffset","o"),Tt(zt,"byteLength","l"),Tt(zt,"length","e"),z(zt,mt,{get:function(){return this[bt]}}),e.exports=function(t,f,e,o){o=!!o;var d=t+(o?"Clamped":"")+"Array",n="get"+t,i="set"+t,p=_[d],a=p||{},r=p&&k(p),s=!p||!S.ABV,u={},l=p&&p.prototype,c=function(t,e){var r=t._d;return r.v[n](e*f+r.o,wt)},h=function(t,e,r){var n=t._d;o&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),n.v[i](e*f+n.o,r,wt)},m=function(t,e){z(t,e,{get:function(){return c(this,e)},set:function(t){return h(this,e,t)},enumerable:!0})};s?(p=e(function(t,e,r,n){O(t,p,d,"_d");var o,i,a,s,u=0,l=0;if(T(e)){if(!(e instanceof Y||"ArrayBuffer"==(s=P(e))||"SharedArrayBuffer"==s))return bt in e?Pt(p,e):Ct.call(p,e);o=e,l=Ot(r,f);var c=e.byteLength;if(void 0===n){if(c%f)throw W("Wrong length!");if((i=c-l)<0)throw W("Wrong length!")}else if((i=E(n)*f)+l>c)throw W("Wrong length!");a=i/f}else a=j(e),i=a*f,o=new Y(i);for(A(t,"_d",{b:o,o:l,l:i,e:a,v:new K(o)});u<a;)m(t,u++)}),l=p.prototype=C(zt),A(l,"constructor",p)):x(function(){p(1)})&&x(function(){new p(-1)})&&B(function(t){new p,new p(null),new p(1.5),new p(t)},!0)||(p=e(function(t,e,r,n){O(t,p,d);var o;return T(e)?e instanceof Y||"ArrayBuffer"==(o=P(e))||"SharedArrayBuffer"==o?void 0!==n?new a(e,Ot(r,f),n):void 0!==r?new a(e,Ot(r,f)):new a(e):bt in e?Pt(p,e):Ct.call(p,e):new a(j(e))}),$(r!==Function.prototype?M(a).concat(M(r)):M(a),function(t){t in p||A(p,t,a[t])}),p.prototype=l,b||(l.constructor=p));var g=l[ht],v=!!g&&("values"==g.name||void 0==g.name),y=Lt.values;A(p,gt,!0),A(l,bt,d),A(l,_t,!0),A(l,vt,p),(o?new p(1)[mt]==d:mt in l)||z(l,mt,{get:function(){return d}}),u[d]=p,w(w.G+w.W+w.F*(p!=a),u),w(w.S,d,{BYTES_PER_ELEMENT:f}),w(w.S+w.F*x(function(){a.of.call(p,1)}),d,{from:Ct,of:kt}),"BYTES_PER_ELEMENT"in l||A(l,"BYTES_PER_ELEMENT",f),w(w.P,d,Nt),I(d),w(w.P+w.F*St,d,{set:It}),w(w.P+w.F*!v,d,Lt),b||l.toString==dt||(l.toString=dt),w(w.P+w.F*x(function(){new p(1).slice()}),d,{slice:Bt}),w(w.P+w.F*(x(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!x(function(){l.toLocaleString.call([1,2])})),d,{toLocaleString:Rt}),N[d]=v?g:y,b||v||A(l,ht,y)}}else e.exports=function(){}},{"./_an-instance":5,"./_array-copy-within":7,"./_array-fill":8,"./_array-includes":9,"./_array-methods":10,"./_classof":14,"./_ctx":21,"./_descriptors":23,"./_export":27,"./_fails":29,"./_global":33,"./_has":34,"./_hide":35,"./_is-array-iter":41,"./_is-object":44,"./_iter-detect":49,"./_iterators":51,"./_library":52,"./_object-create":61,"./_object-dp":62,"./_object-gopd":64,"./_object-gopn":66,"./_object-gpo":68,"./_property-desc":76,"./_redefine-all":77,"./_set-species":81,"./_species-constructor":85,"./_to-absolute-index":91,"./_to-index":92,"./_to-integer":93,"./_to-length":95,"./_to-object":96,"./_to-primitive":97,"./_typed":100,"./_typed-buffer":99,"./_uid":101,"./_wks":106,"./core.get-iterator-method":107,"./es6.array.iterator":113}],99:[function(t,e,r){"use strict";function n(t,e,r){var n,o,i,a=new Array(r),s=8*r-e-1,u=(1<<s)-1,l=u>>1,c=23===e?D(2,-24)-D(2,-77):0,f=0,d=t<0||0===t&&1/t<0?1:0;for(t=L(t),t!=t||t===B?(o=t!=t?1:0,n=u):(n=F(G(t)/z),t*(i=D(2,-n))<1&&(n--,i*=2),t+=n+l>=1?c/i:c*D(2,1-l),t*i>=2&&(n++,i/=2),n+l>=u?(o=0,n=u):n+l>=1?(o=(t*i-1)*D(2,e),n+=l):(o=t*D(2,l-1)*D(2,e),n=0));e>=8;a[f++]=255&o,o/=256,e-=8);for(n=n<<e|o,s+=e;s>0;a[f++]=255&n,n/=256,s-=8);return a[--f]|=128*d,a}function o(t,e,r){var n,o=8*r-e-1,i=(1<<o)-1,a=i>>1,s=o-7,u=r-1,l=t[u--],c=127&l;for(l>>=7;s>0;c=256*c+t[u],u--,s-=8);for(n=c&(1<<-s)-1,c>>=-s,s+=e;s>0;n=256*n+t[u],u--,s-=8);if(0===c)c=1-a;else{if(c===i)return n?NaN:l?-B:B;n+=D(2,e),c-=a}return(l?-1:1)*n*D(2,c-e)}function i(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function a(t){return[255&t]}function s(t){return[255&t,t>>8&255]}function u(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function l(t){return n(t,52,8)}function c(t){return n(t,23,4)}function f(t,e,r){E(t[T],e,{get:function(){return this[r]}})}function d(t,e,r,n){var o=+r,i=O(o);if(i+e>t[W])throw N(C);var a=t[H]._b,s=i+t[U],u=a.slice(s,s+e);return n?u:u.reverse()}function p(t,e,r,n,o,i){var a=+r,s=O(a);if(s+e>t[W])throw N(C);for(var u=t[H]._b,l=s+t[U],c=n(+o),f=0;f<e;f++)u[l+f]=c[i?f:e-f-1]}var h=t("./_global"),m=t("./_descriptors"),g=t("./_library"),v=t("./_typed"),y=t("./_hide"),b=t("./_redefine-all"),_=t("./_fails"),x=t("./_an-instance"),w=t("./_to-integer"),S=t("./_to-length"),O=t("./_to-index"),A=t("./_object-gopn").f,E=t("./_object-dp").f,j=t("./_array-fill"),P=t("./_set-to-string-tag"),T="prototype",C="Wrong index!",k=h.ArrayBuffer,M=h.DataView,R=h.Math,N=h.RangeError,B=h.Infinity,I=k,L=R.abs,D=R.pow,F=R.floor,G=R.log,z=R.LN2,H=m?"_b":"buffer",W=m?"_l":"byteLength",U=m?"_o":"byteOffset";if(v.ABV){if(!_(function(){k(1)})||!_(function(){new k(-1)})||_(function(){return new k,new k(1.5),new k(NaN),"ArrayBuffer"!=k.name})){k=function(t){return x(this,k),new I(O(t))};for(var V,q=k[T]=I[T],Y=A(I),K=0;Y.length>K;)(V=Y[K++])in k||y(k,V,I[V]);g||(q.constructor=k)}var $=new M(new k(2)),X=M[T].setInt8;$.setInt8(0,2147483648),$.setInt8(1,2147483649),!$.getInt8(0)&&$.getInt8(1)||b(M[T],{setInt8:function(t,e){X.call(this,t,e<<24>>24)},setUint8:function(t,e){X.call(this,t,e<<24>>24)}},!0)}else k=function(t){x(this,k,"ArrayBuffer");var e=O(t);this._b=j.call(new Array(e),0),this[W]=e},M=function(t,e,r){x(this,M,"DataView"),x(t,k,"DataView");var n=t[W],o=w(e);if(o<0||o>n)throw N("Wrong offset!");if(r=void 0===r?n-o:S(r),o+r>n)throw N("Wrong length!");this[H]=t,this[U]=o,this[W]=r},m&&(f(k,"byteLength","_l"),f(M,"buffer","_b"),f(M,"byteLength","_l"),f(M,"byteOffset","_o")),b(M[T],{getInt8:function(t){return d(this,1,t)[0]<<24>>24},getUint8:function(t){return d(this,1,t)[0]},getInt16:function(t){var e=d(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=d(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return i(d(this,4,t,arguments[1]))},getUint32:function(t){return i(d(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return o(d(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return o(d(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){p(this,1,t,a,e)},setUint8:function(t,e){p(this,1,t,a,e)},setInt16:function(t,e){p(this,2,t,s,e,arguments[2])},setUint16:function(t,e){p(this,2,t,s,e,arguments[2])},setInt32:function(t,e){p(this,4,t,u,e,arguments[2])},setUint32:function(t,e){p(this,4,t,u,e,arguments[2])},setFloat32:function(t,e){p(this,4,t,c,e,arguments[2])},setFloat64:function(t,e){p(this,8,t,l,e,arguments[2])}});P(k,"ArrayBuffer"),P(M,"DataView"),y(M[T],v.VIEW,!0),r.ArrayBuffer=k,r.DataView=M},{"./_an-instance":5,"./_array-fill":8,"./_descriptors":23,"./_fails":29,"./_global":33,"./_hide":35,"./_library":52,"./_object-dp":62,"./_object-gopn":66,"./_redefine-all":77,"./_set-to-string-tag":82,"./_to-index":92,"./_to-integer":93,"./_to-length":95,"./_typed":100}],100:[function(t,e,r){for(var n,o=t("./_global"),i=t("./_hide"),a=t("./_uid"),s=a("typed_array"),u=a("view"),l=!(!o.ArrayBuffer||!o.DataView),c=l,f=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(n=o[d[f++]])?(i(n.prototype,s,!0),i(n.prototype,u,!0)):c=!1;e.exports={ABV:l,CONSTR:c,TYPED:s,VIEW:u}},{"./_global":33,"./_hide":35,"./_uid":101}],101:[function(t,e,r){var n=0,o=Math.random();e.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+o).toString(36))}},{}],102:[function(t,e,r){var n=t("./_global"),o=n.navigator;e.exports=o&&o.userAgent||""},{"./_global":33}],103:[function(t,e,r){var n=t("./_is-object");e.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},{"./_is-object":44}],104:[function(t,e,r){var n=t("./_global"),o=t("./_core"),i=t("./_library"),a=t("./_wks-ext"),s=t("./_object-dp").f;e.exports=function(t){var e=o.Symbol||(o.Symbol=i?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},{"./_core":19,"./_global":33,"./_library":52,"./_object-dp":62,"./_wks-ext":105}],105:[function(t,e,r){r.f=t("./_wks")},{"./_wks":106}],106:[function(t,e,r){var n=t("./_shared")("wks"),o=t("./_uid"),i=t("./_global").Symbol,a="function"==typeof i;(e.exports=function(t){return n[t]||(n[t]=a&&i[t]||(a?i:o)("Symbol."+t))}).store=n},{"./_global":33,"./_shared":84,"./_uid":101}],107:[function(t,e,r){var n=t("./_classof"),o=t("./_wks")("iterator"),i=t("./_iterators");e.exports=t("./_core").getIteratorMethod=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||i[n(t)]}},{"./_classof":14,"./_core":19,"./_iterators":51,"./_wks":106}],108:[function(t,e,r){var n=t("./_export");n(n.P,"Array",{copyWithin:t("./_array-copy-within")}),t("./_add-to-unscopables")("copyWithin")},{"./_add-to-unscopables":4,"./_array-copy-within":7,"./_export":27}],109:[function(t,e,r){var n=t("./_export");n(n.P,"Array",{fill:t("./_array-fill")}),t("./_add-to-unscopables")("fill")},{"./_add-to-unscopables":4,"./_array-fill":8,"./_export":27}],110:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_array-methods")(6),i="findIndex",a=!0;i in[]&&Array(1)[i](function(){a=!1}),n(n.P+n.F*a,"Array",{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),t("./_add-to-unscopables")(i)},{"./_add-to-unscopables":4,"./_array-methods":10,"./_export":27}],111:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_array-methods")(5),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),n(n.P+n.F*i,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),t("./_add-to-unscopables")("find")},{"./_add-to-unscopables":4,"./_array-methods":10,"./_export":27}],112:[function(t,e,r){"use strict";var d=t("./_ctx"),n=t("./_export"),p=t("./_to-object"),h=t("./_iter-call"),m=t("./_is-array-iter"),g=t("./_to-length"),v=t("./_create-property"),y=t("./core.get-iterator-method");n(n.S+n.F*!t("./_iter-detect")(function(t){Array.from(t)}),"Array",{from:function(t){var e,r,n,o,i=p(t),a="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,l=void 0!==u,c=0,f=y(i);if(l&&(u=d(u,s>2?arguments[2]:void 0,2)),void 0==f||a==Array&&m(f))for(e=g(i.length),r=new a(e);e>c;c++)v(r,c,l?u(i[c],c):i[c]);else for(o=f.call(i),r=new a;!(n=o.next()).done;c++)v(r,c,l?h(o,u,[n.value,c],!0):n.value);return r.length=c,r}})},{"./_create-property":20,"./_ctx":21,"./_export":27,"./_is-array-iter":41,"./_iter-call":46,"./_iter-detect":49,"./_to-length":95,"./_to-object":96,"./core.get-iterator-method":107}],113:[function(t,e,r){"use strict";var n=t("./_add-to-unscopables"),o=t("./_iter-step"),i=t("./_iterators"),a=t("./_to-iobject");e.exports=t("./_iter-define")(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,o(1)):"keys"==e?o(0,r):"values"==e?o(0,t[r]):o(0,[r,t[r]])},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},{"./_add-to-unscopables":4,"./_iter-define":48,"./_iter-step":50,"./_iterators":51,"./_to-iobject":94}],114:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_create-property");n(n.S+n.F*t("./_fails")(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,r=new("function"==typeof this?this:Array)(e);e>t;)o(r,t,arguments[t++]);return r.length=e,r}})},{"./_create-property":20,"./_export":27,"./_fails":29}],115:[function(t,e,r){var n=t("./_object-dp").f,o=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in o||t("./_descriptors")&&n(o,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},{"./_descriptors":23,"./_object-dp":62}],116:[function(t,e,r){"use strict";var n=t("./_collection-strong"),o=t("./_validate-collection");e.exports=t("./_collection")("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(o(this,"Map"),t);return e&&e.v},set:function(t,e){return n.def(o(this,"Map"),0===t?0:t,e)}},n,!0)},{"./_collection":18,"./_collection-strong":16,"./_validate-collection":103}],117:[function(t,e,r){var n=t("./_export"),o=t("./_math-log1p"),i=Math.sqrt,a=Math.acosh;n(n.S+n.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:o(t-1+i(t-1)*i(t+1))}})},{"./_export":27,"./_math-log1p":55}],118:[function(t,e,r){function n(t){return isFinite(t=+t)&&0!=t?t<0?-n(-t):Math.log(t+Math.sqrt(t*t+1)):t}var o=t("./_export"),i=Math.asinh;o(o.S+o.F*!(i&&1/i(0)>0),"Math",{asinh:n})},{"./_export":27}],119:[function(t,e,r){var n=t("./_export"),o=Math.atanh;n(n.S+n.F*!(o&&1/o(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},{"./_export":27}],120:[function(t,e,r){var n=t("./_export"),o=t("./_math-sign");n(n.S,"Math",{cbrt:function(t){return o(t=+t)*Math.pow(Math.abs(t),1/3)}})},{"./_export":27,"./_math-sign":56}],121:[function(t,e,r){var n=t("./_export");n(n.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},{"./_export":27}],122:[function(t,e,r){var n=t("./_export"),o=Math.exp;n(n.S,"Math",{cosh:function(t){return(o(t=+t)+o(-t))/2}})},{"./_export":27}],123:[function(t,e,r){var n=t("./_export"),o=t("./_math-expm1");n(n.S+n.F*(o!=Math.expm1),"Math",{expm1:o})},{"./_export":27,"./_math-expm1":53}],124:[function(t,e,r){var n=t("./_export");n(n.S,"Math",{fround:t("./_math-fround")})},{"./_export":27,"./_math-fround":54}],125:[function(t,e,r){var n=t("./_export"),u=Math.abs;n(n.S,"Math",{hypot:function(t,e){for(var r,n,o=0,i=0,a=arguments.length,s=0;i<a;)r=u(arguments[i++]),s<r?(n=s/r,o=o*n*n+1,s=r):r>0?(n=r/s,o+=n*n):o+=r;return s===1/0?1/0:s*Math.sqrt(o)}})},{"./_export":27}],126:[function(t,e,r){var n=t("./_export"),o=Math.imul;n(n.S+n.F*t("./_fails")(function(){return-5!=o(4294967295,5)||2!=o.length}),"Math",{imul:function(t,e){var r=+t,n=+e,o=65535&r,i=65535&n;return 0|o*i+((65535&r>>>16)*i+o*(65535&n>>>16)<<16>>>0)}})},{"./_export":27,"./_fails":29}],127:[function(t,e,r){var n=t("./_export");n(n.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},{"./_export":27}],128:[function(t,e,r){var n=t("./_export");n(n.S,"Math",{log1p:t("./_math-log1p")})},{"./_export":27,"./_math-log1p":55}],129:[function(t,e,r){var n=t("./_export");n(n.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},{"./_export":27}],130:[function(t,e,r){var n=t("./_export");n(n.S,"Math",{sign:t("./_math-sign")})},{"./_export":27,"./_math-sign":56}],131:[function(t,e,r){var n=t("./_export"),o=t("./_math-expm1"),i=Math.exp;n(n.S+n.F*t("./_fails")(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(o(t)-o(-t))/2:(i(t-1)-i(-t-1))*(Math.E/2)}})},{"./_export":27,"./_fails":29,"./_math-expm1":53}],132:[function(t,e,r){var n=t("./_export"),o=t("./_math-expm1"),i=Math.exp;n(n.S,"Math",{tanh:function(t){var e=o(t=+t),r=o(-t);return e==1/0?1:r==1/0?-1:(e-r)/(i(t)+i(-t))}})},{"./_export":27,"./_math-expm1":53}],133:[function(t,e,r){var n=t("./_export");n(n.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},{"./_export":27}],134:[function(t,e,r){var n=t("./_export");n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},{"./_export":27}],135:[function(t,e,r){var n=t("./_export"),o=t("./_global").isFinite;n(n.S,"Number",{isFinite:function(t){return"number"==typeof t&&o(t)}})},{"./_export":27,"./_global":33}],136:[function(t,e,r){var n=t("./_export");n(n.S,"Number",{isInteger:t("./_is-integer")})},{"./_export":27,"./_is-integer":43}],137:[function(t,e,r){var n=t("./_export");n(n.S,"Number",{isNaN:function(t){return t!=t}})},{"./_export":27}],138:[function(t,e,r){var n=t("./_export"),o=t("./_is-integer"),i=Math.abs;n(n.S,"Number",{isSafeInteger:function(t){return o(t)&&i(t)<=9007199254740991}})},{"./_export":27,"./_is-integer":43}],139:[function(t,e,r){var n=t("./_export");n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{"./_export":27}],140:[function(t,e,r){var n=t("./_export");n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{"./_export":27}],141:[function(t,e,r){var n=t("./_export");n(n.S+n.F,"Object",{assign:t("./_object-assign")})},{"./_export":27,"./_object-assign":60}],142:[function(t,e,r){var n=t("./_export");n(n.S,"Object",{is:t("./_same-value")})},{"./_export":27,"./_same-value":79}],143:[function(t,e,r){var n=t("./_export");n(n.S,"Object",{setPrototypeOf:t("./_set-proto").set})},{"./_export":27,"./_set-proto":80}],144:[function(r,t,e){"use strict";var n,o,i,a,s=r("./_library"),u=r("./_global"),l=r("./_ctx"),c=r("./_classof"),f=r("./_export"),d=r("./_is-object"),p=r("./_a-function"),h=r("./_an-instance"),m=r("./_for-of"),g=r("./_species-constructor"),v=r("./_task").set,y=r("./_microtask")(),b=r("./_new-promise-capability"),_=r("./_perform"),x=r("./_user-agent"),w=r("./_promise-resolve"),S=u.TypeError,O=u.process,A=O&&O.versions,E=A&&A.v8||"",j=u.Promise,P="process"==c(O),T=function(){},C=o=b.f,k=!!function(){try{var t=j.resolve(1),e=(t.constructor={})[r("./_wks")("species")]=function(t){t(T,T)};return(P||"function"==typeof PromiseRejectionEvent)&&t.then(T)instanceof e&&0!==E.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(t){}}(),M=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},R=function(c,e){if(!c._n){c._n=!0;var r=c._c;y(function(){for(var u=c._v,l=1==c._s,t=0;r.length>t;)!function(t){var e,r,n,o=l?t.ok:t.fail,i=t.resolve,a=t.reject,s=t.domain;try{o?(l||(2==c._h&&I(c),c._h=1),!0===o?e=u:(s&&s.enter(),e=o(u),s&&(s.exit(),n=!0)),e===t.promise?a(S("Promise-chain cycle")):(r=M(e))?r.call(e,i,a):i(e)):a(u)}catch(t){s&&!n&&s.exit(),a(t)}}(r[t++]);c._c=[],c._n=!1,e&&!c._h&&N(c)})}},N=function(i){v.call(u,function(){var t,e,r,n=i._v,o=B(i);if(o&&(t=_(function(){P?O.emit("unhandledRejection",n,i):(e=u.onunhandledrejection)?e({promise:i,reason:n}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",n)}),i._h=P||B(i)?2:1),i._a=void 0,o&&t.e)throw t.v})},B=function(t){return 1!==t._h&&0===(t._a||t._c).length},I=function(e){v.call(u,function(){var t;P?O.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},L=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),R(e,!0))},D=function(t){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw S("Promise can't be resolved itself");(r=M(t))?y(function(){var e={_w:n,_d:!1};try{r.call(t,l(D,e,1),l(L,e,1))}catch(t){L.call(e,t)}}):(n._v=t,n._s=1,R(n,!1))}catch(t){L.call({_w:n,_d:!1},t)}}};k||(j=function(t){h(this,j,"Promise","_h"),p(t),n.call(this);try{t(l(D,this,1),l(L,this,1))}catch(t){L.call(this,t)}},n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=r("./_redefine-all")(j.prototype,{then:function(t,e){var r=C(g(this,j));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=P?O.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&R(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new n;this.promise=t,this.resolve=l(D,t,1),this.reject=l(L,t,1)},b.f=C=function(t){return t===j||t===a?new i(t):o(t)}),f(f.G+f.W+f.F*!k,{Promise:j}),r("./_set-to-string-tag")(j,"Promise"),r("./_set-species")("Promise"),a=r("./_core").Promise,f(f.S+f.F*!k,"Promise",{reject:function(t){var e=C(this);return(0,e.reject)(t),e.promise}}),f(f.S+f.F*(s||!k),"Promise",{resolve:function(t){return w(s&&this===a?j:this,t)}}),f(f.S+f.F*!(k&&r("./_iter-detect")(function(t){j.all(t).catch(T)})),"Promise",{all:function(t){var a=this,e=C(a),s=e.resolve,u=e.reject,r=_(function(){var n=[],o=0,i=1;m(t,!1,function(t){var e=o++,r=!1;n.push(void 0),i++,a.resolve(t).then(function(t){r||(r=!0,n[e]=t,--i||s(n))},u)}),--i||s(n)});return r.e&&u(r.v),e.promise},race:function(t){var e=this,r=C(e),n=r.reject,o=_(function(){m(t,!1,function(t){e.resolve(t).then(r.resolve,n)})});return o.e&&n(o.v),r.promise}})},{"./_a-function":3,"./_an-instance":5,"./_classof":14,"./_core":19,"./_ctx":21,"./_export":27,"./_for-of":32,"./_global":33,"./_is-object":44,"./_iter-detect":49,"./_library":52,"./_microtask":58,"./_new-promise-capability":59,"./_perform":74,"./_promise-resolve":75,"./_redefine-all":77,"./_set-species":81,"./_set-to-string-tag":82,"./_species-constructor":85,"./_task":90,"./_user-agent":102,"./_wks":106}],145:[function(t,e,r){var n=t("./_export"),i=t("./_a-function"),a=t("./_an-object"),s=(t("./_global").Reflect||{}).apply,u=Function.apply;n(n.S+n.F*!t("./_fails")(function(){s(function(){})}),"Reflect",{apply:function(t,e,r){var n=i(t),o=a(r);return s?s(n,e,o):u.call(n,e,o)}})},{"./_a-function":3,"./_an-object":6,"./_export":27,"./_fails":29,"./_global":33}],146:[function(t,e,r){var n=t("./_export"),s=t("./_object-create"),u=t("./_a-function"),l=t("./_an-object"),c=t("./_is-object"),o=t("./_fails"),f=t("./_bind"),d=(t("./_global").Reflect||{}).construct,p=o(function(){function t(){}return!(d(function(){},[],t)instanceof t)}),h=!o(function(){d(function(){})});n(n.S+n.F*(p||h),"Reflect",{construct:function(t,e){u(t),l(e);var r=arguments.length<3?t:u(arguments[2]);if(h&&!p)return d(t,e,r);if(t==r){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(f.apply(t,n))}var o=r.prototype,i=s(c(o)?o:Object.prototype),a=Function.apply.call(t,i,e);return c(a)?a:i}})},{"./_a-function":3,"./_an-object":6,"./_bind":13,"./_export":27,"./_fails":29,"./_global":33,"./_is-object":44,"./_object-create":61}],147:[function(t,e,r){var n=t("./_object-dp"),o=t("./_export"),i=t("./_an-object"),a=t("./_to-primitive");o(o.S+o.F*t("./_fails")(function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,r){i(t),e=a(e,!0),i(r);try{return n.f(t,e,r),!0}catch(t){return!1}}})},{"./_an-object":6,"./_export":27,"./_fails":29,"./_object-dp":62,"./_to-primitive":97}],148:[function(t,e,r){var n=t("./_export"),o=t("./_object-gopd").f,i=t("./_an-object");n(n.S,"Reflect",{deleteProperty:function(t,e){var r=o(i(t),e);return!(r&&!r.configurable)&&delete t[e]}})},{"./_an-object":6,"./_export":27,"./_object-gopd":64}],149:[function(t,e,r){var n=t("./_object-gopd"),o=t("./_export"),i=t("./_an-object");o(o.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return n.f(i(t),e)}})},{"./_an-object":6,"./_export":27,"./_object-gopd":64}],150:[function(t,e,r){var n=t("./_export"),o=t("./_object-gpo"),i=t("./_an-object");n(n.S,"Reflect",{getPrototypeOf:function(t){return o(i(t))}})},{"./_an-object":6,"./_export":27,"./_object-gpo":68}],151:[function(t,e,r){function i(t,e){var r,n,o=arguments.length<3?t:arguments[2];return c(t)===o?t[e]:(r=a.f(t,e))?u(r,"value")?r.value:void 0!==r.get?r.get.call(o):void 0:l(n=s(t))?i(n,e,o):void 0}var a=t("./_object-gopd"),s=t("./_object-gpo"),u=t("./_has"),n=t("./_export"),l=t("./_is-object"),c=t("./_an-object");n(n.S,"Reflect",{get:i})},{"./_an-object":6,"./_export":27,"./_has":34,"./_is-object":44,"./_object-gopd":64,"./_object-gpo":68}],152:[function(t,e,r){var n=t("./_export");n(n.S,"Reflect",{has:function(t,e){return e in t}})},{"./_export":27}],153:[function(t,e,r){var n=t("./_export"),o=t("./_an-object"),i=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(t){return o(t),!i||i(t)}})},{"./_an-object":6,"./_export":27}],154:[function(t,e,r){var n=t("./_export");n(n.S,"Reflect",{ownKeys:t("./_own-keys")})},{"./_export":27,"./_own-keys":73}],155:[function(t,e,r){var n=t("./_export"),o=t("./_an-object"),i=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(t){o(t);try{return i&&i(t),!0}catch(t){return!1}}})},{"./_an-object":6,"./_export":27}],156:[function(t,e,r){var n=t("./_export"),o=t("./_set-proto");o&&n(n.S,"Reflect",{setPrototypeOf:function(t,e){o.check(t,e);try{return o.set(t,e),!0}catch(t){return!1}}})},{"./_export":27,"./_set-proto":80}],157:[function(t,e,r){function s(t,e,r){var n,o,i=arguments.length<4?t:arguments[3],a=l.f(p(t),e);if(!a){if(h(o=c(t)))return s(o,e,r,i);a=d(0)}if(f(a,"value")){if(!1===a.writable||!h(i))return!1;if(n=l.f(i,e)){if(n.get||n.set||!1===n.writable)return!1;n.value=r,u.f(i,e,n)}else u.f(i,e,d(0,r));return!0}return void 0!==a.set&&(a.set.call(i,r),!0)}var u=t("./_object-dp"),l=t("./_object-gopd"),c=t("./_object-gpo"),f=t("./_has"),n=t("./_export"),d=t("./_property-desc"),p=t("./_an-object"),h=t("./_is-object");n(n.S,"Reflect",{set:s})},{"./_an-object":6,"./_export":27,"./_has":34,"./_is-object":44,"./_object-dp":62,"./_object-gopd":64,"./_object-gpo":68,"./_property-desc":76}],158:[function(t,e,r){t("./_descriptors")&&"g"!=/./g.flags&&t("./_object-dp").f(RegExp.prototype,"flags",{configurable:!0,get:t("./_flags")})},{"./_descriptors":23,"./_flags":31,"./_object-dp":62}],159:[function(t,e,r){t("./_fix-re-wks")("match",1,function(n,o,t){return[function(t){"use strict";var e=n(this),r=void 0==t?void 0:t[o];return void 0!==r?r.call(t,e):new RegExp(t)[o](String(e))},t]})},{"./_fix-re-wks":30}],160:[function(t,e,r){t("./_fix-re-wks")("replace",2,function(o,i,a){return[function(t,e){"use strict";var r=o(this),n=void 0==t?void 0:t[i];return void 0!==n?n.call(t,r,e):a.call(String(r),t,e)},a]})},{"./_fix-re-wks":30}],161:[function(t,e,r){t("./_fix-re-wks")("search",1,function(n,o,t){return[function(t){"use strict";var e=n(this),r=void 0==t?void 0:t[o];return void 0!==r?r.call(t,e):new RegExp(t)[o](String(e))},t]})},{"./_fix-re-wks":30}],162:[function(t,e,r){t("./_fix-re-wks")("split",2,function(o,i,a){"use strict";var p=t("./_is-regexp"),h=a,m=[].push,g="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[g]||2!="ab".split(/(?:ab)*/)[g]||4!=".".split(/(.?)(.?)/)[g]||".".split(/()()/)[g]>1||"".split(/.?/)[g]){var v=void 0===/()??/.exec("")[1];a=function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!p(t))return h.call(r,t,e);var n,o,i,a,s,u=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),c=0,f=void 0===e?4294967295:e>>>0,d=new RegExp(t.source,l+"g");for(v||(n=new RegExp("^"+d.source+"$(?!\\s)",l));(o=d.exec(r))&&!((i=o.index+o[0][g])>c&&(u.push(r.slice(c,o.index)),!v&&o[g]>1&&o[0].replace(n,function(){for(s=1;s<arguments[g]-2;s++)void 0===arguments[s]&&(o[s]=void 0)}),o[g]>1&&o.index<r[g]&&m.apply(u,o.slice(1)),a=o[0][g],c=i,u[g]>=f));)d.lastIndex===o.index&&d.lastIndex++;return c===r[g]?!a&&d.test("")||u.push(""):u.push(r.slice(c)),u[g]>f?u.slice(0,f):u}}else"0".split(void 0,0)[g]&&(a=function(t,e){return void 0===t&&0===e?[]:h.call(this,t,e)});return[function(t,e){var r=o(this),n=void 0==t?void 0:t[i];return void 0!==n?n.call(t,r,e):a.call(String(r),t,e)},a]})},{"./_fix-re-wks":30,"./_is-regexp":45}],163:[function(t,e,r){"use strict";var n=t("./_collection-strong"),o=t("./_validate-collection");e.exports=t("./_collection")("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(o(this,"Set"),t=0===t?0:t,t)}},n)},{"./_collection":18,"./_collection-strong":16,"./_validate-collection":103}],164:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_string-at")(!1);n(n.P,"String",{codePointAt:function(t){return o(this,t)}})},{"./_export":27,"./_string-at":86}],165:[function(t,e,r){"use strict";var n=t("./_export"),a=t("./_to-length"),s=t("./_string-context"),u="".endsWith;n(n.P+n.F*t("./_fails-is-regexp")("endsWith"),"String",{endsWith:function(t){var e=s(this,t,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=a(e.length),o=void 0===r?n:Math.min(a(r),n),i=String(t);return u?u.call(e,i,o):e.slice(o-i.length,o)===i}})},{"./_export":27,"./_fails-is-regexp":28,"./_string-context":87,"./_to-length":95}],166:[function(t,e,r){var n=t("./_export"),i=t("./_to-absolute-index"),a=String.fromCharCode,o=String.fromCodePoint;n(n.S+n.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(t){for(var e,r=[],n=arguments.length,o=0;n>o;){if(e=+arguments[o++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");r.push(e<65536?a(e):a(55296+((e-=65536)>>10),e%1024+56320))}return r.join("")}})},{"./_export":27,"./_to-absolute-index":91}],167:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_string-context");n(n.P+n.F*t("./_fails-is-regexp")("includes"),"String",{includes:function(t){return!!~o(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},{"./_export":27,"./_fails-is-regexp":28,"./_string-context":87}],168:[function(t,e,r){var n=t("./_export"),a=t("./_to-iobject"),s=t("./_to-length");n(n.S,"String",{raw:function(t){for(var e=a(t.raw),r=s(e.length),n=arguments.length,o=[],i=0;r>i;)o.push(String(e[i++])),i<n&&o.push(String(arguments[i]));return o.join("")}})},{"./_export":27,"./_to-iobject":94,"./_to-length":95}],169:[function(t,e,r){var n=t("./_export");n(n.P,"String",{repeat:t("./_string-repeat")})},{"./_export":27,"./_string-repeat":89}],170:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_to-length"),i=t("./_string-context"),a="".startsWith;n(n.P+n.F*t("./_fails-is-regexp")("startsWith"),"String",{startsWith:function(t){var e=i(this,t,"startsWith"),r=o(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return a?a.call(e,n,r):e.slice(r,r+n.length)===n}})},{"./_export":27,"./_fails-is-regexp":28,"./_string-context":87,"./_to-length":95}],171:[function(t,e,r){"use strict";var n=t("./_global"),a=t("./_has"),o=t("./_descriptors"),i=t("./_export"),s=t("./_redefine"),u=t("./_meta").KEY,l=t("./_fails"),c=t("./_shared"),f=t("./_set-to-string-tag"),d=t("./_uid"),p=t("./_wks"),h=t("./_wks-ext"),m=t("./_wks-define"),g=t("./_enum-keys"),v=t("./_is-array"),y=t("./_an-object"),b=t("./_is-object"),_=t("./_to-iobject"),x=t("./_to-primitive"),w=t("./_property-desc"),S=t("./_object-create"),O=t("./_object-gopn-ext"),A=t("./_object-gopd"),E=t("./_object-dp"),j=t("./_object-keys"),P=A.f,T=E.f,C=O.f,k=n.Symbol,M=n.JSON,R=M&&M.stringify,N=p("_hidden"),B=p("toPrimitive"),I={}.propertyIsEnumerable,L=c("symbol-registry"),D=c("symbols"),F=c("op-symbols"),G=Object.prototype,z="function"==typeof k,H=n.QObject,W=!H||!H.prototype||!H.prototype.findChild,U=o&&l(function(){return 7!=S(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=P(G,e);n&&delete G[e],T(t,e,r),n&&t!==G&&T(G,e,n)}:T,V=function(t){var e=D[t]=S(k.prototype);return e._k=t,e},q=z&&"symbol"==typeof k.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof k},Y=function(t,e,r){return t===G&&Y(F,e,r),y(t),e=x(e,!0),y(r),a(D,e)?(r.enumerable?(a(t,N)&&t[N][e]&&(t[N][e]=!1),r=S(r,{enumerable:w(0,!1)})):(a(t,N)||T(t,N,w(1,{})),t[N][e]=!0),U(t,e,r)):T(t,e,r)},K=function(t,e){y(t);for(var r,n=g(e=_(e)),o=0,i=n.length;i>o;)Y(t,r=n[o++],e[r]);return t},$=function(t,e){return void 0===e?S(t):K(S(t),e)},X=function(t){var e=I.call(this,t=x(t,!0));return!(this===G&&a(D,t)&&!a(F,t))&&(!(e||!a(this,t)||!a(D,t)||a(this,N)&&this[N][t])||e)},Z=function(t,e){if(t=_(t),e=x(e,!0),t!==G||!a(D,e)||a(F,e)){var r=P(t,e);return!r||!a(D,e)||a(t,N)&&t[N][e]||(r.enumerable=!0),r}},Q=function(t){for(var e,r=C(_(t)),n=[],o=0;r.length>o;)a(D,e=r[o++])||e==N||e==u||n.push(e);return n},J=function(t){for(var e,r=t===G,n=C(r?F:_(t)),o=[],i=0;n.length>i;)!a(D,e=n[i++])||r&&!a(G,e)||o.push(D[e]);return o};z||(k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),r=function(t){this===G&&r.call(F,t),a(this,N)&&a(this[N],e)&&(this[N][e]=!1),U(this,e,w(1,t))};return o&&W&&U(G,e,{configurable:!0,set:r}),V(e)},s(k.prototype,"toString",function(){return this._k}),A.f=Z,E.f=Y,t("./_object-gopn").f=O.f=Q,t("./_object-pie").f=X,t("./_object-gops").f=J,o&&!t("./_library")&&s(G,"propertyIsEnumerable",X,!0),h.f=function(t){return V(p(t))}),i(i.G+i.W+i.F*!z,{Symbol:k});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)p(tt[et++]);for(var rt=j(p.store),nt=0;rt.length>nt;)m(rt[nt++]);i(i.S+i.F*!z,"Symbol",{for:function(t){return a(L,t+="")?L[t]:L[t]=k(t)},keyFor:function(t){if(!q(t))throw TypeError(t+" is not a symbol!");for(var e in L)if(L[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),i(i.S+i.F*!z,"Object",{create:$,defineProperty:Y,defineProperties:K,getOwnPropertyDescriptor:Z,getOwnPropertyNames:Q,getOwnPropertySymbols:J}),M&&i(i.S+i.F*(!z||l(function(){var t=k();return"[null]"!=R([t])||"{}"!=R({a:t})||"{}"!=R(Object(t))})),"JSON",{stringify:function(t){for(var e,r,n=[t],o=1;arguments.length>o;)n.push(arguments[o++]);if(r=e=n[1],(b(e)||void 0!==t)&&!q(t))return v(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!q(e))return e}),n[1]=e,R.apply(M,n)}}),k.prototype[B]||t("./_hide")(k.prototype,B,k.prototype.valueOf),f(k,"Symbol"),f(Math,"Math",!0),f(n.JSON,"JSON",!0)},{"./_an-object":6,"./_descriptors":23,"./_enum-keys":26,"./_export":27,"./_fails":29,"./_global":33,"./_has":34,"./_hide":35,"./_is-array":42,"./_is-object":44,"./_library":52,"./_meta":57,"./_object-create":61,"./_object-dp":62,"./_object-gopd":64,"./_object-gopn":66,"./_object-gopn-ext":65,"./_object-gops":67,"./_object-keys":70,"./_object-pie":71,"./_property-desc":76,"./_redefine":78,"./_set-to-string-tag":82,"./_shared":84,"./_to-iobject":94,"./_to-primitive":97,"./_uid":101,"./_wks":106,"./_wks-define":104,"./_wks-ext":105}],172:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_typed"),i=t("./_typed-buffer"),l=t("./_an-object"),c=t("./_to-absolute-index"),f=t("./_to-length"),a=t("./_is-object"),s=t("./_global").ArrayBuffer,d=t("./_species-constructor"),p=i.ArrayBuffer,h=i.DataView,u=o.ABV&&s.isView,m=p.prototype.slice,g=o.VIEW;n(n.G+n.W+n.F*(s!==p),{ArrayBuffer:p}),n(n.S+n.F*!o.CONSTR,"ArrayBuffer",{isView:function(t){return u&&u(t)||a(t)&&g in t}}),n(n.P+n.U+n.F*t("./_fails")(function(){return!new p(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==m&&void 0===e)return m.call(l(this),t);for(var r=l(this).byteLength,n=c(t,r),o=c(void 0===e?r:e,r),i=new(d(this,p))(f(o-n)),a=new h(this),s=new h(i),u=0;n<o;)s.setUint8(u++,a.getUint8(n++));return i}}),t("./_set-species")("ArrayBuffer")},{"./_an-object":6,"./_export":27,"./_fails":29,"./_global":33,"./_is-object":44,"./_set-species":81,"./_species-constructor":85,"./_to-absolute-index":91,"./_to-length":95,"./_typed":100,"./_typed-buffer":99}],173:[function(t,e,r){t("./_typed-array")("Float32",4,function(n){return function(t,e,r){return n(this,t,e,r)}})},{"./_typed-array":98}],174:[function(t,e,r){t("./_typed-array")("Float64",8,function(n){return function(t,e,r){return n(this,t,e,r)}})},{"./_typed-array":98}],175:[function(t,e,r){t("./_typed-array")("Int16",2,function(n){return function(t,e,r){return n(this,t,e,r)}})},{"./_typed-array":98}],176:[function(t,e,r){t("./_typed-array")("Int32",4,function(n){return function(t,e,r){return n(this,t,e,r)}})},{"./_typed-array":98}],177:[function(t,e,r){t("./_typed-array")("Int8",1,function(n){return function(t,e,r){return n(this,t,e,r)}})},{"./_typed-array":98}],178:[function(t,e,r){t("./_typed-array")("Uint16",2,function(n){return function(t,e,r){return n(this,t,e,r)}})},{"./_typed-array":98}],179:[function(t,e,r){t("./_typed-array")("Uint32",4,function(n){return function(t,e,r){return n(this,t,e,r)}})},{"./_typed-array":98}],180:[function(t,e,r){t("./_typed-array")("Uint8",1,function(n){return function(t,e,r){return n(this,t,e,r)}})},{"./_typed-array":98}],181:[function(t,e,r){t("./_typed-array")("Uint8",1,function(n){return function(t,e,r){return n(this,t,e,r)}},!0)},{"./_typed-array":98}],182:[function(t,e,r){"use strict";var i,n=t("./_array-methods")(0),a=t("./_redefine"),o=t("./_meta"),s=t("./_object-assign"),u=t("./_collection-weak"),l=t("./_is-object"),c=t("./_fails"),f=t("./_validate-collection"),d=o.getWeak,p=Object.isExtensible,h=u.ufstore,m={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(t){if(l(t)){var e=d(t);return!0===e?h(f(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(f(this,"WeakMap"),t,e)}},y=e.exports=t("./_collection")("WeakMap",g,v,u,!0,!0);c(function(){return 7!=(new y).set((Object.freeze||Object)(m),7).get(m)})&&(i=u.getConstructor(g,"WeakMap"),s(i.prototype,v),o.NEED=!0,n(["delete","has","get","set"],function(n){var t=y.prototype,o=t[n];a(t,n,function(t,e){if(l(t)&&!p(t)){this._f||(this._f=new i);var r=this._f[n](t,e);return"set"==n?this:r}return o.call(this,t,e)})}))},{"./_array-methods":10,"./_collection":18,"./_collection-weak":17,"./_fails":29,"./_is-object":44,"./_meta":57,"./_object-assign":60,"./_redefine":78,"./_validate-collection":103}],183:[function(t,e,r){"use strict";var n=t("./_collection-weak"),o=t("./_validate-collection");t("./_collection")("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(o(this,"WeakSet"),t,!0)}},n,!1,!0)},{"./_collection":18,"./_collection-weak":17,"./_validate-collection":103}],184:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_array-includes")(!0);n(n.P,"Array",{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),t("./_add-to-unscopables")("includes")},{"./_add-to-unscopables":4,"./_array-includes":9,"./_export":27}],185:[function(t,e,r){var n=t("./_export"),o=t("./_object-to-array")(!0);n(n.S,"Object",{entries:function(t){return o(t)}})},{"./_export":27,"./_object-to-array":72}],186:[function(t,e,r){var n=t("./_export"),u=t("./_own-keys"),l=t("./_to-iobject"),c=t("./_object-gopd"),f=t("./_create-property");n(n.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,r,n=l(t),o=c.f,i=u(n),a={},s=0;i.length>s;)void 0!==(r=o(n,e=i[s++]))&&f(a,e,r);return a}})},{"./_create-property":20,"./_export":27,"./_object-gopd":64,"./_own-keys":73,"./_to-iobject":94}],187:[function(t,e,r){var n=t("./_export"),o=t("./_object-to-array")(!1);n(n.S,"Object",{values:function(t){return o(t)}})},{"./_export":27,"./_object-to-array":72}],188:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_string-pad"),i=t("./_user-agent");n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(i),"String",{padEnd:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},{"./_export":27,"./_string-pad":88,"./_user-agent":102}],189:[function(t,e,r){"use strict";var n=t("./_export"),o=t("./_string-pad"),i=t("./_user-agent");n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(i),"String",{padStart:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},{"./_export":27,"./_string-pad":88,"./_user-agent":102}],190:[function(t,e,r){for(var n=t("./es6.array.iterator"),o=t("./_object-keys"),i=t("./_redefine"),a=t("./_global"),s=t("./_hide"),u=t("./_iterators"),l=t("./_wks"),c=l("iterator"),f=l("toStringTag"),d=u.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=o(p),m=0;m<h.length;m++){var g,v=h[m],y=p[v],b=a[v],_=b&&b.prototype;if(_&&(_[c]||s(_,c,d),_[f]||s(_,f,v),u[v]=d,y))for(g in n)_[g]||i(_,g,n[g],!0)}},{"./_global":33,"./_hide":35,"./_iterators":51,"./_object-keys":70,"./_redefine":78,"./_wks":106,"./es6.array.iterator":113}],191:[function(t,e,r){var n=t("./_export"),o=t("./_task");n(n.G+n.B,{setImmediate:o.set,clearImmediate:o.clear})},{"./_export":27,"./_task":90}],192:[function(t,e,r){var n=t("./_global"),o=t("./_export"),i=t("./_user-agent"),a=[].slice,s=/MSIE .\./.test(i),u=function(o){return function(t,e){var r=arguments.length>2,n=!!r&&a.call(arguments,2);return o(r?function(){("function"==typeof t?t:Function(t)).apply(this,n)}:t,e)}};o(o.G+o.B+o.F*s,{setTimeout:u(n.setTimeout),setInterval:u(n.setInterval)})},{"./_export":27,"./_global":33,"./_user-agent":102}],193:[function(t,e,r){var n=n||function(p){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=p.document,h=function(){return p.URL||p.webkitURL||p},m=t.createElementNS("http://www.w3.org/1999/xhtml","a"),g="download"in m,v=function(t){var e=new MouseEvent("click");t.dispatchEvent(e)},y=p.webkitRequestFileSystem,b=p.requestFileSystem||y||p.mozRequestFileSystem,i=function(t){(p.setImmediate||p.setTimeout)(function(){throw t},0)},_=0,x=function(t){var e=function(){"string"==typeof t?h().revokeObjectURL(t):t.remove()};p.chrome?e():setTimeout(e,500)},w=function(t,e,r){e=[].concat(e);for(var n=e.length;n--;){var o=t["on"+e[n]];if("function"==typeof o)try{o.call(t,r||t)}catch(t){i(t)}}},S=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t},n=function(n,r,t){t||(n=S(n));var e,o,i,a=this,s=n.type,u=!1,l=function(){w(a,"writestart progress write writeend".split(" "))},c=function(){if(!u&&e||(e=h().createObjectURL(n)),o)o.location.href=e;else{void 0==p.open(e,"_blank")&&"undefined"!=typeof safari&&(p.location.href=e)}a.readyState=a.DONE,l(),x(e)},f=function(t){return function(){if(a.readyState!==a.DONE)return t.apply(this,arguments)}},d={create:!0,exclusive:!1};return a.readyState=a.INIT,r||(r="download"),g?(e=h().createObjectURL(n),m.href=e,m.download=r,void setTimeout(function(){v(m),l(),x(e),a.readyState=a.DONE})):(p.chrome&&s&&"application/octet-stream"!==s&&(i=n.slice||n.webkitSlice,n=i.call(n,0,n.size,"application/octet-stream"),u=!0),y&&"download"!==r&&(r+=".download"),("application/octet-stream"===s||y)&&(o=p),b?(_+=n.size,void b(p.TEMPORARY,_,f(function(t){t.root.getDirectory("saved",d,f(function(t){var e=function(){t.getFile(r,d,f(function(r){r.createWriter(f(function(e){e.onwriteend=function(t){o.location.href=r.toURL(),a.readyState=a.DONE,w(a,"writeend",t),x(r)},e.onerror=function(){var t=e.error;t.code!==t.ABORT_ERR&&c()},"writestart progress write abort".split(" ").forEach(function(t){e["on"+t]=a["on"+t]}),e.write(n),a.abort=function(){e.abort(),a.readyState=a.DONE},a.readyState=a.WRITING}),c)}),c)};t.getFile(r,{create:!1},f(function(t){t.remove(),e()}),f(function(t){t.code===t.NOT_FOUND_ERR?e():c()}))}),c)}),c)):void c())},e=n.prototype,r=function(t,e,r){return new n(t,e,r)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,r){return r||(t=S(t)),navigator.msSaveOrOpenBlob(t,e||"download")}:(e.abort=function(){var t=this;t.readyState=t.DONE,w(t,"abort")},e.readyState=e.INIT=0,e.WRITING=1,e.DONE=2,e.error=e.onwritestart=e.onprogress=e.onwrite=e.onabort=e.onerror=e.onwriteend=null,r)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==e&&e.exports?e.exports.saveAs=n:void 0!==L&&null!==L&&null!=L.amd&&L([],function(){return n})},{}],194:[function(t,e,r){var n={};e.exports=n,n.createElement=function(t){return document.createElement(t)},n.createText=function(t){return document.createTextNode(t)},n.style=function(t,e){t.style.cssText=e},n.append=function(t,e){t.appendChild(e)},n.remove=function(t,e){t.removeChild(e)}},{}],195:[function(t,e,r){var n=t("promise"),v=t("./dom"),y=t("./ruler"),b=function(t,e){e=e||{weight:"normal"},this.family=t,this.style=e.style||"normal",this.variant=e.variant||"normal",this.weight=e.weight||"normal",this.stretch=e.stretch||"stretch",this.featureSettings=e.featureSettings||"normal"};e.exports=b,b.HAS_WEBKIT_FALLBACK_BUG=null,b.DEFAULT_TIMEOUT=3e3,b.getUserAgent=function(){return window.navigator.userAgent},b.hasWebKitFallbackBug=function(){if(null===b.HAS_WEBKIT_FALLBACK_BUG){var t=/AppleWeb[kK]it\/([0-9]+)(?:\.([0-9]+))/.exec(b.getUserAgent());b.HAS_WEBKIT_FALLBACK_BUG=!!t&&(parseInt(t[1],10)<536||536===parseInt(t[1],10)&&parseInt(t[2],10)<=11)}return b.HAS_WEBKIT_FALLBACK_BUG},b.prototype.getStyle=function(){return"font-style:"+this.style+";font-variant:"+this.variant+";font-weight:"+this.weight+";font-stretch:"+this.stretch+";font-feature-settings:"+this.featureSettings+";-moz-font-feature-settings:"+this.featureSettings+";-webkit-font-feature-settings:"+this.featureSettings+";"},b.prototype.check=function(t,e){var r=t||"BESbswy",o=e||b.DEFAULT_TIMEOUT,i=this.getStyle(),a=v.createElement("div"),s=new y(r),u=new y(r),l=new y(r),c=-1,f=-1,d=-1,p=-1,h=-1,m=-1,g=this;return s.setFont('"Times New Roman", sans-serif',i),u.setFont("serif",i),l.setFont("monospace",i),v.append(a,s.getElement()),v.append(a,u.getElement()),v.append(a,l.getElement()),v.append(document.body,a),p=s.getWidth(),h=u.getWidth(),m=l.getWidth(),new n(function(t,e){function r(){null!==a.parentNode&&v.remove(document.body,a)}function n(){-1!==c&&-1!==f&&-1!==d&&c===f&&f===d&&(b.hasWebKitFallbackBug()?c===p&&f===p&&d===p||c===h&&f===h&&d===h||c===m&&f===m&&d===m||(r(),t(g)):(r(),t(g)))}setTimeout(function(){r(),e(g)},o),s.onResize(function(t){c=t,n()}),s.setFont(g.family+",sans-serif",i),u.onResize(function(t){f=t,n()}),u.setFont(g.family+",serif",i),l.onResize(function(t){d=t,n()}),l.setFont(g.family+",monospace",i)})}},{"./dom":194,"./ruler":196,promise:487}],196:[function(t,e,r){var n=t("./dom"),o=function(t){var e="display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;";this.element=n.createElement("div"),this.element.setAttribute("aria-hidden","true"),n.append(this.element,n.createText(t)),this.collapsible=n.createElement("span"),this.expandable=n.createElement("span"),this.collapsibleInner=n.createElement("span"),this.expandableInner=n.createElement("span"),this.lastOffsetWidth=-1,n.style(this.collapsible,e),n.style(this.expandable,e),n.style(this.expandableInner,e),n.style(this.collapsibleInner,"display:inline-block;width:200%;height:200%;"),n.append(this.collapsible,this.collapsibleInner),n.append(this.expandable,this.expandableInner),n.append(this.element,this.collapsible),n.append(this.element,this.expandable)};e.exports=o,o.prototype.getElement=function(){return this.element},o.prototype.setFont=function(t,e){n.style(this.element,"min-width:20px;min-height:20px;display:inline-block;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font-size:100px;font-family:"+t+";"+e)},o.prototype.getWidth=function(){return this.element.offsetWidth},o.prototype.setWidth=function(t){this.element.style.width=t+"px"},o.prototype.reset=function(){var t=this.getWidth(),e=t+100;return this.expandableInner.style.width=e+"px",this.expandable.scrollLeft=e,this.collapsible.scrollLeft=this.collapsible.scrollWidth+100,this.lastOffsetWidth!==t&&(this.lastOffsetWidth=t,!0)},o.prototype.onScroll=function(t){this.reset()&&null!==this.element.parentNode&&t(this.lastOffsetWidth)},o.prototype.onResize=function(t){var e=this;this.collapsible.addEventListener("scroll",function(){e.onScroll(t)},!1),this.expandable.addEventListener("scroll",function(){e.onScroll(t)},!1),this.reset()}},{"./dom":194}],197:[function(t,e,r){"use strict";function u(t,e,r,n,o){var i=this.validateSchema(t,o,e,r);return!i.valid&&n instanceof Function&&n(i),i.valid}function c(t,e,r,n,o,i){if(!e.properties||void 0===e.properties[o])if(!1===e.additionalProperties)i.addError({name:"additionalProperties",argument:o,message:"additionalProperty "+JSON.stringify(o)+" exists in instance when not allowed"});else{var a=e.additionalProperties||{},s=this.validateSchema(t[o],a,r,n.makeChild(a,o));s.instance!==i.instance[o]&&(i.instance[o]=s.instance),i.importErrors(s)}}function i(t,e,r){var n,o=r.length;for(n=e+1,o;n<o;n++)if(a.deepCompareStrict(t,r[n]))return!1;return!0}var a=t("./helpers"),f=a.ValidatorResult,l=a.SchemaError,n={};n.ignoreProperties={id:!0,default:!0,description:!0,title:!0,exclusiveMinimum:!0,exclusiveMaximum:!0,additionalItems:!0,$schema:!0,$ref:!0,extends:!0};var o=n.validators={};o.type=function(t,e,r,n){if(void 0===t)return null;var o=new f(t,e,r,n),i=Array.isArray(e.type)?e.type:[e.type];if(!i.some(this.testType.bind(this,t,e,r,n))){var a=i.map(function(t){return t.id&&"<"+t.id+">"||t+""});o.addError({name:"type",argument:a,message:"is not of a type(s) "+a})}return o},o.anyOf=function(t,e,r,n){if(void 0===t)return null;var o=new f(t,e,r,n),i=new f(t,e,r,n);if(!Array.isArray(e.anyOf))throw new l("anyOf must be an array");if(!e.anyOf.some(u.bind(this,t,r,n,function(t){i.importErrors(t)}))){var a=e.anyOf.map(function(t,e){return t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+e+"]"});r.nestedErrors&&o.importErrors(i),o.addError({name:"anyOf",argument:a,message:"is not any of "+a.join(",")})}return o},o.allOf=function(o,t,i,a){if(void 0===o)return null;if(!Array.isArray(t.allOf))throw new l("allOf must be an array");var s=new f(o,t,i,a),u=this;return t.allOf.forEach(function(t,e){var r=u.validateSchema(o,t,i,a);if(!r.valid){var n=t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+e+"]";s.addError({name:"allOf",argument:{id:n,length:r.errors.length,valid:r},message:"does not match allOf schema "+n+" with "+r.errors.length+" error[s]:"}),s.importErrors(r)}}),s},o.oneOf=function(t,e,r,n){if(void 0===t)return null;if(!Array.isArray(e.oneOf))throw new l("oneOf must be an array");var o=new f(t,e,r,n),i=new f(t,e,r,n),a=e.oneOf.filter(u.bind(this,t,r,n,function(t){i.importErrors(t)})).length,s=e.oneOf.map(function(t,e){return t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+e+"]"});return 1!==a&&(r.nestedErrors&&o.importErrors(i),o.addError({name:"oneOf",argument:s,message:"is not exactly one from "+s.join(",")})),o},o.properties=function(t,e,r,n){if(void 0!==t&&t instanceof Object){var o=new f(t,e,r,n),i=e.properties||{};for(var a in i){var s=(t||void 0)&&t[a],u=this.validateSchema(s,i[a],r,n.makeChild(i[a],a));u.instance!==o.instance[a]&&(o.instance[a]=u.instance),o.importErrors(u)}return o}},o.patternProperties=function(t,e,r,n){if(void 0!==t&&this.types.object(t)){var o=new f(t,e,r,n),i=e.patternProperties||{};for(var a in t){var s=!0;for(var u in i){if(new RegExp(u).test(a)){s=!1;var l=this.validateSchema(t[a],i[u],r,n.makeChild(i[u],a));l.instance!==o.instance[a]&&(o.instance[a]=l.instance),o.importErrors(l)}}s&&c.call(this,t,e,r,n,a,o)}return o}},o.additionalProperties=function(t,e,r,n){if(void 0!==t&&this.types.object(t)){if(e.patternProperties)return null;var o=new f(t,e,r,n);for(var i in t)c.call(this,t,e,r,n,i,o);return o}},o.minProperties=function(t,e,r,n){if(!t||"object"!=typeof t)return null;var o=new f(t,e,r,n);return Object.keys(t).length>=e.minProperties||o.addError({name:"minProperties",argument:e.minProperties,message:"does not meet minimum property length of "+e.minProperties}),o},o.maxProperties=function(t,e,r,n){if(!t||"object"!=typeof t)return null;var o=new f(t,e,r,n);return Object.keys(t).length<=e.maxProperties||o.addError({name:"maxProperties",argument:e.maxProperties,message:"does not meet maximum property length of "+e.maxProperties}),o},o.items=function(t,o,i,a){if(!Array.isArray(t))return null;var s=this,u=new f(t,o,i,a);return void 0!==t&&o.items?(t.every(function(t,e){var r=Array.isArray(o.items)?o.items[e]||o.additionalItems:o.items;if(void 0===r)return!0;if(!1===r)return u.addError({name:"items",message:"additionalItems not permitted"}),!1;var n=s.validateSchema(t,r,i,a.makeChild(r,e));return n.instance!==u.instance[e]&&(u.instance[e]=n.instance),u.importErrors(n),!0}),u):u},o.minimum=function(t,e,r,n){if("number"!=typeof t)return null;var o=new f(t,e,r,n),i=!0;return i=e.exclusiveMinimum&&!0===e.exclusiveMinimum?t>e.minimum:t>=e.minimum,i||o.addError({name:"minimum",argument:e.minimum,message:"must have a minimum value of "+e.minimum}),o},o.maximum=function(t,e,r,n){if("number"!=typeof t)return null;var o,i=new f(t,e,r,n);return o=e.exclusiveMaximum&&!0===e.exclusiveMaximum?t<e.maximum:t<=e.maximum,o||i.addError({name:"maximum",argument:e.maximum,message:"must have a maximum value of "+e.maximum}),i},o.divisibleBy=function(t,e,r,n){if("number"!=typeof t)return null;if(0==e.divisibleBy)throw new l("divisibleBy cannot be zero");var o=new f(t,e,r,n);return t/e.divisibleBy%1&&o.addError({name:"divisibleBy",argument:e.divisibleBy,message:"is not divisible by (multiple of) "+JSON.stringify(e.divisibleBy)}),o},o.multipleOf=function(t,e,r,n){if("number"!=typeof t)return null;if(0==e.multipleOf)throw new l("multipleOf cannot be zero");var o=new f(t,e,r,n);return t/e.multipleOf%1&&o.addError({name:"multipleOf",argument:e.multipleOf,message:"is not a multiple of (divisible by) "+JSON.stringify(e.multipleOf)}),o},o.required=function(e,t,r,n){var o=new f(e,t,r,n);return void 0===e&&!0===t.required?o.addError({name:"required",message:"is required"}):e&&"object"==typeof e&&Array.isArray(t.required)&&t.required.forEach(function(t){void 0===e[t]&&o.addError({name:"required",argument:t,message:"requires property "+JSON.stringify(t)})}),o},o.pattern=function(t,e,r,n){if("string"!=typeof t)return null;var o=new f(t,e,r,n);return t.match(e.pattern)||o.addError({name:"pattern",argument:e.pattern,message:"does not match pattern "+JSON.stringify(e.pattern)}),o},o.format=function(t,e,r,n){var o=new f(t,e,r,n);return o.disableFormat||a.isFormat(t,e.format,this)||o.addError({name:"format",argument:e.format,message:"does not conform to the "+JSON.stringify(e.format)+" format"}),o},o.minLength=function(t,e,r,n){if("string"!=typeof t)return null;var o=new f(t,e,r,n);return t.length>=e.minLength||o.addError({name:"minLength",argument:e.minLength,message:"does not meet minimum length of "+e.minLength}),o},o.maxLength=function(t,e,r,n){if("string"!=typeof t)return null;var o=new f(t,e,r,n);return t.length<=e.maxLength||o.addError({name:"maxLength",argument:e.maxLength,message:"does not meet maximum length of "+e.maxLength}),o},o.minItems=function(t,e,r,n){if(!Array.isArray(t))return null;var o=new f(t,e,r,n);return t.length>=e.minItems||o.addError({name:"minItems",argument:e.minItems,message:"does not meet minimum length of "+e.minItems}),o},o.maxItems=function(t,e,r,n){if(!Array.isArray(t))return null;var o=new f(t,e,r,n);return t.length<=e.maxItems||o.addError({name:"maxItems",argument:e.maxItems,message:"does not meet maximum length of "+e.maxItems}),o},o.uniqueItems=function(t,e,r,n){function o(t,e,r){for(var n=e+1;n<r.length;n++)if(a.deepCompareStrict(t,r[n]))return!1;return!0}var i=new f(t,e,r,n);return Array.isArray(t)?(t.every(o)||i.addError({name:"uniqueItems",message:"contains duplicate item"}),i):i},o.uniqueItems=function(t,e,r,n){if(!Array.isArray(t))return null;var o=new f(t,e,r,n);return t.every(i)||o.addError({name:"uniqueItems",message:"contains duplicate item"}),o},o.dependencies=function(e,t,r,n){if(!e||"object"!=typeof e)return null;var o=new f(e,t,r,n);for(var i in t.dependencies)if(void 0!==e[i]){var a=t.dependencies[i],s=n.makeChild(a,i);if("string"==typeof a&&(a=[a]),Array.isArray(a))a.forEach(function(t){void 0===e[t]&&o.addError({name:"dependencies",argument:s.propertyPath,message:"property "+t+" not found, required by "+s.propertyPath})});else{var u=this.validateSchema(e,a,r,s);o.instance!==u.instance&&(o.instance=u.instance),u&&u.errors.length&&(o.addError({name:"dependencies",argument:s.propertyPath,message:"does not meet dependency required by "+s.propertyPath}),o.importErrors(u))}}return o},o.enum=function(t,e,r,n){if(!Array.isArray(e.enum))throw new l("enum expects an array",e);if(void 0===t)return null;var o=new f(t,e,r,n);return e.enum.some(a.deepCompareStrict.bind(null,t))||o.addError({name:"enum",argument:e.enum,message:"is not one of enum values: "+e.enum.join(",")}),o},o.not=o.disallow=function(r,n,o,i){var a=this;if(void 0===r)return null;var s=new f(r,n,o,i),t=n.not||n.disallow;return t?(Array.isArray(t)||(t=[t]),t.forEach(function(t){if(a.testType(r,n,o,i,t)){var e=t&&t.id&&"<"+t.id+">"||t;s.addError({name:"not",argument:e,message:"is of prohibited type "+e})}}),s):null},e.exports=n},{"./helpers":198}],198:[function(t,e,r){"use strict";function n(t,e){return e+": "+t.toString()+"\n"}function o(t,e,r,n){"object"==typeof r?e[n]=s(t[n],r):-1===t.indexOf(r)&&e.push(r)}function i(t,e,r){e[r]=t[r]}function a(t,e,r,n){"object"==typeof e[n]&&e[n]&&t[n]?r[n]=s(t[n],e[n]):r[n]=e[n]}function s(t,e){var r=Array.isArray(e),n=r&&[]||{};return r?(t=t||[],n=n.concat(t),e.forEach(o.bind(null,t,n))):(t&&"object"==typeof t&&Object.keys(t).forEach(i.bind(null,t,n)),Object.keys(e).forEach(a.bind(null,t,e,n))),n}function u(t){return"/"+encodeURIComponent(t).replace(/~/g,"%7E")}var l=t("url"),c=r.ValidationError=function(t,e,r,n,o,i){n&&(this.property=n),t&&(this.message=t),r&&(r.id?this.schema=r.id:this.schema=r),e&&(this.instance=e),this.name=o,this.argument=i,this.stack=this.toString()};c.prototype.toString=function(){return this.property+" "+this.message};var f=r.ValidatorResult=function(t,e,r,n){this.instance=t,this.schema=e,this.propertyPath=n.propertyPath,this.errors=[],this.throwError=r&&r.throwError,this.disableFormat=r&&!0===r.disableFormat};f.prototype.addError=function(t){var e;if("string"==typeof t)e=new c(t,this.instance,this.schema,this.propertyPath);else{if(!t)throw new Error("Missing error detail");if(!t.message)throw new Error("Missing error message");if(!t.name)throw new Error("Missing validator type");e=new c(t.message,this.instance,this.schema,this.propertyPath,t.name,t.argument)}if(this.throwError)throw e;return this.errors.push(e),e},f.prototype.importErrors=function(t){"string"==typeof t||t&&t.validatorType?this.addError(t):t&&t.errors&&Array.prototype.push.apply(this.errors,t.errors)},f.prototype.toString=function(t){return this.errors.map(n).join("")},Object.defineProperty(f.prototype,"valid",{get:function(){return!this.errors.length}});var d=r.SchemaError=function t(e,r){this.message=e,this.schema=r,Error.call(this,e),Error.captureStackTrace(this,t)};d.prototype=Object.create(Error.prototype,{constructor:{value:d,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var p=r.SchemaContext=function(t,e,r,n,o){this.schema=t,this.options=e,this.propertyPath=r,this.base=n,this.schemas=o};p.prototype.resolve=function(t){return l.resolve(this.base,t)},p.prototype.makeChild=function(t,e){var r=void 0===e?this.propertyPath:this.propertyPath+m(e),n=l.resolve(this.base,t.id||""),o=new p(t,this.options,r,n,Object.create(this.schemas));return t.id&&!o.schemas[n]&&(o.schemas[n]=t),o};var h=r.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(t){return"string"==typeof t&&parseFloat(t)===parseInt(t,10)&&!isNaN(t)},regex:function(t){var e=!0;try{new RegExp(t)}catch(t){e=!1}return e},style:/\s*(.+?):\s*([^;]+);?/g,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};h.regexp=h.regex,h.pattern=h.regex,h.ipv4=h["ip-address"],r.isFormat=function(t,e,r){if("string"==typeof t&&void 0!==h[e]){if(h[e]instanceof RegExp)return h[e].test(t);if("function"==typeof h[e])return h[e](t)}else if(r&&r.customFormats&&"function"==typeof r.customFormats[e])return r.customFormats[e](t);return!0};var m=r.makeSuffix=function(t){return t=t.toString(),t.match(/[.\s\[\]]/)||t.match(/^[\d]/)?t.match(/^\d+$/)?"["+t+"]":"["+JSON.stringify(t)+"]":"."+t};r.deepCompareStrict=function r(n,o){if(typeof n!=typeof o)return!1;if(n instanceof Array)return o instanceof Array&&(n.length===o.length&&n.every(function(t,e){return r(n[e],o[e])}));if("object"==typeof n){if(!n||!o)return n===o;var t=Object.keys(n),e=Object.keys(o);return t.length===e.length&&t.every(function(t){return r(n[t],o[t])})}return n===o},e.exports.deepMerge=s,r.objectGetPath=function(t,e){for(var r,n=e.split("/").slice(1);"string"==typeof(r=n.shift());){var o=decodeURIComponent(r.replace(/~0/,"~").replace(/~1/g,"/"));if(!(o in t))return;t=t[o]}return t},r.encodePath=function(t){return t.map(u).join("")}},{url:514}],199:[function(t,e,r){"use strict";var n=e.exports.Validator=t("./validator");e.exports.ValidatorResult=t("./helpers").ValidatorResult,e.exports.ValidationError=t("./helpers").ValidationError,e.exports.SchemaError=t("./helpers").SchemaError,e.exports.validate=function(t,e,r){return(new n).validate(t,e,r)}},{"./helpers":198,"./validator":200}],200:[function(t,e,r){"use strict";function h(t){var e="string"==typeof t?t:t.$ref;return"string"==typeof e&&e}var s=t("url"),m=t("./attribute"),g=t("./helpers"),v=g.ValidatorResult,y=g.SchemaError,b=g.SchemaContext,n=function t(){this.customFormats=Object.create(t.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(o),this.attributes=Object.create(m.validators)};n.prototype.customFormats={},n.prototype.schemas=null,n.prototype.types=null,n.prototype.attributes=null,n.prototype.unresolvedRefs=null,n.prototype.addSchema=function(t,e){if(!t)return null;var r=e||t.id;return this.addSubSchema(r,t),r&&(this.schemas[r]=t),this.schemas[r]},n.prototype.addSubSchema=function(t,e){if(e&&"object"==typeof e){if(e.$ref){var r=s.resolve(t,e.$ref);return void(void 0===this.schemas[r]&&(this.schemas[r]=null,this.unresolvedRefs.push(r)))}var n=e.id&&s.resolve(t,e.id),o=n||t;if(n){if(this.schemas[n]){if(!g.deepCompareStrict(this.schemas[n],e))throw new Error("Schema <"+e+"> already exists with different definition");return this.schemas[n]}this.schemas[n]=e;var i=n.replace(/^([^#]*)#$/,"$1");this.schemas[i]=e}return this.addSubSchemaArray(o,e.items instanceof Array?e.items:[e.items]),this.addSubSchemaArray(o,e.extends instanceof Array?e.extends:[e.extends]),this.addSubSchema(o,e.additionalItems),this.addSubSchemaObject(o,e.properties),this.addSubSchema(o,e.additionalProperties),this.addSubSchemaObject(o,e.definitions),this.addSubSchemaObject(o,e.patternProperties),this.addSubSchemaObject(o,e.dependencies),this.addSubSchemaArray(o,e.disallow),this.addSubSchemaArray(o,e.allOf),this.addSubSchemaArray(o,e.anyOf),this.addSubSchemaArray(o,e.oneOf),this.addSubSchema(o,e.not),this.schemas[n]}},n.prototype.addSubSchemaArray=function(t,e){if(e instanceof Array)for(var r=0;r<e.length;r++)this.addSubSchema(t,e[r])},n.prototype.addSubSchemaObject=function(t,e){if(e&&"object"==typeof e)for(var r in e)this.addSubSchema(t,e[r])},n.prototype.setSchemas=function(t){this.schemas=t},n.prototype.getSchema=function(t){return this.schemas[t]},n.prototype.validate=function(t,e,r,n){r||(r={});var o=r.propertyName||"instance",i=s.resolve(r.base||"/",e.id||"");if(n||(n=new b(e,r,o,i,Object.create(this.schemas)),n.schemas[i]||(n.schemas[i]=e)),e){var a=this.validateSchema(t,e,r,n);if(!a)throw new Error("Result undefined");return a}throw new y("no schema specified",e)},n.prototype.validateSchema=function(t,e,r,n){var o=new v(t,e,r,n);if(!e)throw new Error("schema is undefined");if(e.extends)if(e.extends instanceof Array){var i={schema:e,ctx:n};e.extends.forEach(this.schemaTraverser.bind(this,i)),e=i.schema,i.schema=null,i.ctx=null,i=null}else e=g.deepMerge(e,this.superResolve(e.extends,n));var a;if(a=h(e)){var s=this.resolve(e,a,n),u=new b(s.subschema,r,n.propertyPath,s.switchSchema,n.schemas);return this.validateSchema(t,s.subschema,r,u)}var l=r&&r.skipAttributes||[];for(var c in e)if(!m.ignoreProperties[c]&&l.indexOf(c)<0){var f=null,d=this.attributes[c];if(d)f=d.call(this,t,e,r,n);else if(!1===r.allowUnknownAttributes)throw new y("Unsupported attribute: "+c,e);f&&o.importErrors(f)}if("function"==typeof r.rewrite){var p=r.rewrite.call(this,t,e,r,n);o.instance=p}return o},n.prototype.schemaTraverser=function(t,e){t.schema=g.deepMerge(t.schema,this.superResolve(e,t.ctx))},n.prototype.superResolve=function(t,e){var r;return(r=h(t))?this.resolve(t,r,e).subschema:t},n.prototype.resolve=function(t,e,r){if(e=r.resolve(e),r.schemas[e])return{subschema:r.schemas[e],switchSchema:e};var n=s.parse(e),o=n&&n.hash,i=o&&o.length&&e.substr(0,e.length-o.length);if(!i||!r.schemas[i])throw new y("no such schema <"+e+">",t);var a=g.objectGetPath(r.schemas[i],o.substr(1));if(void 0===a)throw new y("no such schema "+o+" located in <"+i+">",t);return{subschema:a,switchSchema:e}},n.prototype.testType=function(t,e,r,n,o){if("function"==typeof this.types[o])return this.types[o].call(this,t);if(o&&"object"==typeof o){var i=this.validateSchema(t,o,r,n);return void 0===i||!(i&&i.errors.length)}return!0};var o=n.prototype.types={};o.string=function(t){return"string"==typeof t},o.number=function(t){return"number"==typeof t&&isFinite(t)},o.integer=function(t){return"number"==typeof t&&t%1==0},o.boolean=function(t){return"boolean"==typeof t},o.array=function(t){return t instanceof Array},o.null=function(t){return null===t},o.date=function(t){return t instanceof Date},o.any=function(t){return!0},o.object=function(t){return t&&"object"==typeof t&&!(t instanceof Array)&&!(t instanceof Date)},e.exports=n},{"./attribute":197,"./helpers":198,url:514}],201:[function(t,e,r){var n=t("./_getNative"),o=t("./_root"),i=n(o,"DataView");e.exports=i},{"./_getNative":324,"./_root":378}],202:[function(t,e,r){function n(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}var o=t("./_hashClear"),i=t("./_hashDelete"),a=t("./_hashGet"),s=t("./_hashHas"),u=t("./_hashSet");n.prototype.clear=o,n.prototype.delete=i,n.prototype.get=a,n.prototype.has=s,n.prototype.set=u,e.exports=n},{"./_hashClear":334,"./_hashDelete":335,"./_hashGet":336,"./_hashHas":337,"./_hashSet":338}],203:[function(t,e,r){function n(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=a,this.__views__=[]}var o=t("./_baseCreate"),i=t("./_baseLodash"),a=4294967295;n.prototype=o(i.prototype),n.prototype.constructor=n,e.exports=n},{"./_baseCreate":234,"./_baseLodash":258}],204:[function(t,e,r){function n(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}var o=t("./_listCacheClear"),i=t("./_listCacheDelete"),a=t("./_listCacheGet"),s=t("./_listCacheHas"),u=t("./_listCacheSet");n.prototype.clear=o,n.prototype.delete=i,n.prototype.get=a,n.prototype.has=s,n.prototype.set=u,e.exports=n},{"./_listCacheClear":352,"./_listCacheDelete":353,"./_listCacheGet":354,"./_listCacheHas":355,"./_listCacheSet":356}],205:[function(t,e,r){function n(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}var o=t("./_baseCreate"),i=t("./_baseLodash");n.prototype=o(i.prototype),n.prototype.constructor=n,e.exports=n},{"./_baseCreate":234,"./_baseLodash":258}],206:[function(t,e,r){var n=t("./_getNative"),o=t("./_root"),i=n(o,"Map");e.exports=i},{"./_getNative":324,"./_root":378}],207:[function(t,e,r){function n(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}var o=t("./_mapCacheClear"),i=t("./_mapCacheDelete"),a=t("./_mapCacheGet"),s=t("./_mapCacheHas"),u=t("./_mapCacheSet");n.prototype.clear=o,n.prototype.delete=i,n.prototype.get=a,n.prototype.has=s,n.prototype.set=u,e.exports=n},{"./_mapCacheClear":357,"./_mapCacheDelete":358,"./_mapCacheGet":359,"./_mapCacheHas":360,"./_mapCacheSet":361}],208:[function(t,e,r){var n=t("./_getNative"),o=t("./_root"),i=n(o,"Promise");e.exports=i},{"./_getNative":324,"./_root":378}],209:[function(t,e,r){var n=t("./_getNative"),o=t("./_root"),i=n(o,"Set");e.exports=i},{"./_getNative":324,"./_root":378}],210:[function(t,e,r){function n(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new o;++e<r;)this.add(t[e])}var o=t("./_MapCache"),i=t("./_setCacheAdd"),a=t("./_setCacheHas");n.prototype.add=n.prototype.push=i,n.prototype.has=a,e.exports=n},{"./_MapCache":207,"./_setCacheAdd":379,"./_setCacheHas":380}],211:[function(t,e,r){function n(t){var e=this.__data__=new o(t);this.size=e.size}var o=t("./_ListCache"),i=t("./_stackClear"),a=t("./_stackDelete"),s=t("./_stackGet"),u=t("./_stackHas"),l=t("./_stackSet");n.prototype.clear=i,n.prototype.delete=a,n.prototype.get=s,n.prototype.has=u,n.prototype.set=l,e.exports=n},{"./_ListCache":204,"./_stackClear":386,"./_stackDelete":387,"./_stackGet":388,"./_stackHas":389,"./_stackSet":390}],212:[function(t,e,r){var n=t("./_root"),o=n.Symbol;e.exports=o},{"./_root":378}],213:[function(t,e,r){var n=t("./_root"),o=n.Uint8Array;e.exports=o},{"./_root":378}],214:[function(t,e,r){var n=t("./_getNative"),o=t("./_root"),i=n(o,"WeakMap");e.exports=i},{"./_getNative":324,"./_root":378}],215:[function(t,e,r){function n(t,e){return t.set(e[0],e[1]),t}e.exports=n},{}],216:[function(t,e,r){function n(t,e){return t.add(e),t}e.exports=n},{}],217:[function(t,e,r){function n(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}e.exports=n},{}],218:[function(t,e,r){function n(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}e.exports=n},{}],219:[function(t,e,r){function n(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i}e.exports=n},{}],220:[function(t,e,r){function n(t,e){return!!(null==t?0:t.length)&&o(t,e,0)>-1}var o=t("./_baseIndexOf");e.exports=n},{"./_baseIndexOf":247}],221:[function(t,e,r){function n(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1}e.exports=n},{}],222:[function(t,e,r){function n(t,e){var r=d(t),n=!r&&f(t),o=!r&&!n&&p(t),i=!r&&!n&&!o&&m(t),a=r||n||o||i,s=a?c(t.length,String):[],u=s.length;for(var l in t)!e&&!g.call(t,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||h(l,u))||s.push(l);return s}var c=t("./_baseTimes"),f=t("./isArguments"),d=t("./isArray"),p=t("./isBuffer"),h=t("./_isIndex"),m=t("./isTypedArray"),o=Object.prototype,g=o.hasOwnProperty;e.exports=n},{"./_baseTimes":272,"./_isIndex":344,"./isArguments":443,"./isArray":444,"./isBuffer":447,"./isTypedArray":456}],223:[function(t,e,r){function n(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}e.exports=n},{}],224:[function(t,e,r){function n(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}e.exports=n},{}],225:[function(t,e,r){function n(t,e,r,n){var o=-1,i=null==t?0:t.length;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}e.exports=n},{}],226:[function(t,e,r){function n(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}e.exports=n},{}],227:[function(t,e,r){function n(t){return t.split("")}e.exports=n},{}],228:[function(t,e,r){function n(t,e,r){var n=t[e];s.call(t,e)&&i(n,r)&&(void 0!==r||e in t)||o(t,e,r)}var o=t("./_baseAssignValue"),i=t("./eq"),a=Object.prototype,s=a.hasOwnProperty;e.exports=n},{"./_baseAssignValue":232,"./eq":407}],229:[function(t,e,r){function n(t,e){for(var r=t.length;r--;)if(o(t[r][0],e))return r;return-1}var o=t("./eq");e.exports=n},{"./eq":407}],230:[function(t,e,r){function n(t,e){return t&&o(e,i(e),t)}var o=t("./_copyObject"),i=t("./keys");e.exports=n},{"./_copyObject":292,"./keys":458}],231:[function(t,e,r){function n(t,e){return t&&o(e,i(e),t)}var o=t("./_copyObject"),i=t("./keysIn");e.exports=n},{"./_copyObject":292,"./keysIn":459}],232:[function(t,e,r){function n(t,e,r){"__proto__"==e&&o?o(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var o=t("./_defineProperty");e.exports=n},{"./_defineProperty":311}],233:[function(t,e,r){function g(r,n,o,t,e,i){var a,s=n&I,u=n&L,l=n&D;if(o&&(a=e?o(r,t,e,i):o(r)),void 0!==a)return a;if(!N(r))return r;var c=M(r);if(c){if(a=T(r),!s)return S(r,a)}else{var f=P(r),d=f==G||f==z;if(R(r))return w(r,s);if(f==H||f==F||d&&!e){if(a=u||d?{}:k(r),!s)return u?A(r,x(a,r)):O(r,_(a,r))}else{if(!W[f])return e?r:{};a=C(r,f,g,s)}}i||(i=new v);var p=i.get(r);if(p)return p;i.set(r,a);var h=l?u?j:E:u?keysIn:B,m=c?void 0:h(r);return y(m||r,function(t,e){m&&(e=t,t=r[e]),b(a,e,g(t,n,o,e,r,i))}),a}var v=t("./_Stack"),y=t("./_arrayEach"),b=t("./_assignValue"),_=t("./_baseAssign"),x=t("./_baseAssignIn"),w=t("./_cloneBuffer"),S=t("./_copyArray"),O=t("./_copySymbols"),A=t("./_copySymbolsIn"),E=t("./_getAllKeys"),j=t("./_getAllKeysIn"),P=t("./_getTag"),T=t("./_initCloneArray"),C=t("./_initCloneByTag"),k=t("./_initCloneObject"),M=t("./isArray"),R=t("./isBuffer"),N=t("./isObject"),B=t("./keys"),I=1,L=2,D=4,F="[object Arguments]",G="[object Function]",z="[object GeneratorFunction]",H="[object Object]",W={};W[F]=W["[object Array]"]=W["[object ArrayBuffer]"]=W["[object DataView]"]=W["[object Boolean]"]=W["[object Date]"]=W["[object Float32Array]"]=W["[object Float64Array]"]=W["[object Int8Array]"]=W["[object Int16Array]"]=W["[object Int32Array]"]=W["[object Map]"]=W["[object Number]"]=W[H]=W["[object RegExp]"]=W["[object Set]"]=W["[object String]"]=W["[object Symbol]"]=W["[object Uint8Array]"]=W["[object Uint8ClampedArray]"]=W["[object Uint16Array]"]=W["[object Uint32Array]"]=!0,W["[object Error]"]=W[G]=W["[object WeakMap]"]=!1,e.exports=g},{"./_Stack":211,"./_arrayEach":218,"./_assignValue":228,"./_baseAssign":230,"./_baseAssignIn":231,"./_cloneBuffer":282,"./_copyArray":291,"./_copySymbols":293,"./_copySymbolsIn":294,"./_getAllKeys":317,"./_getAllKeysIn":318,"./_getTag":329,"./_initCloneArray":339,"./_initCloneByTag":340,"./_initCloneObject":341,"./isArray":444,"./isBuffer":447,"./isObject":452,"./keys":458}],234:[function(t,e,r){var n=t("./isObject"),o=Object.create,i=function(){function r(){}return function(t){if(!n(t))return{};if(o)return o(t);r.prototype=t;var e=new r;return r.prototype=void 0,e}}();e.exports=i},{"./isObject":452}],235:[function(t,e,r){function n(t,e,r,n){var o=-1,i=h,a=!0,s=t.length,u=[],l=e.length;if(!s)return u;r&&(e=g(e,v(r))),n?(i=m,a=!1):e.length>=b&&(i=y,a=!1,e=new p(e));t:for(;++o<s;){var c=t[o],f=null==r?c:r(c);if(c=n||0!==c?c:0,a&&f===f){for(var d=l;d--;)if(e[d]===f)continue t;u.push(c)}else i(e,f,n)||u.push(c)}return u}var p=t("./_SetCache"),h=t("./_arrayIncludes"),m=t("./_arrayIncludesWith"),g=t("./_arrayMap"),v=t("./_baseUnary"),y=t("./_cacheHas"),b=200;e.exports=n},{"./_SetCache":210,"./_arrayIncludes":220,"./_arrayIncludesWith":221,"./_arrayMap":223,"./_baseUnary":274,"./_cacheHas":278}],236:[function(t,e,r){var n=t("./_baseForOwn"),o=t("./_createBaseEach"),i=o(n);e.exports=i},{"./_baseForOwn":241,"./_createBaseEach":297}],237:[function(t,e,r){function n(t,n){var o=[];return i(t,function(t,e,r){n(t,e,r)&&o.push(t)}),o}var i=t("./_baseEach");e.exports=n},{"./_baseEach":236}],238:[function(t,e,r){function n(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}e.exports=n},{}],239:[function(t,e,r){function u(t,e,r,n,o){var i=-1,a=t.length;for(r||(r=c),o||(o=[]);++i<a;){var s=t[i];e>0&&r(s)?e>1?u(s,e-1,r,n,o):l(o,s):n||(o[o.length]=s)}return o}var l=t("./_arrayPush"),c=t("./_isFlattenable");e.exports=u},{"./_arrayPush":224,"./_isFlattenable":343}],240:[function(t,e,r){var n=t("./_createBaseFor"),o=n();e.exports=o},{"./_createBaseFor":298}],241:[function(t,e,r){function n(t,e){return t&&o(t,e,i)}var o=t("./_baseFor"),i=t("./keys");e.exports=n},{"./_baseFor":240,"./keys":458}],242:[function(t,e,r){function n(t,e){e=o(e,t);for(var r=0,n=e.length;null!=t&&r<n;)t=t[i(e[r++])];return r&&r==n?t:void 0}var o=t("./_castPath"),i=t("./_toKey");e.exports=n},{"./_castPath":279,"./_toKey":394}],243:[function(t,e,r){function n(t,e,r){var n=e(t);return i(t)?n:o(n,r(t))}var o=t("./_arrayPush"),i=t("./isArray");e.exports=n},{"./_arrayPush":224,"./isArray":444}],244:[function(t,e,r){function n(t){return null==t?void 0===t?u:s:l&&l in Object(t)?i(t):a(t)}var o=t("./_Symbol"),i=t("./_getRawTag"),a=t("./_objectToString"),s="[object Null]",u="[object Undefined]",l=o?o.toStringTag:void 0;e.exports=n},{"./_Symbol":212,"./_getRawTag":326,"./_objectToString":371}],245:[function(t,e,r){function n(t,e){return null!=t&&e in Object(t)}e.exports=n},{}],246:[function(t,e,r){function n(t,e,r){return t>=i(e,r)&&t<o(e,r)}var o=Math.max,i=Math.min;e.exports=n},{}],247:[function(t,e,r){function n(t,e,r){return e===e?a(t,e,r):o(t,i,r)}var o=t("./_baseFindIndex"),i=t("./_baseIsNaN"),a=t("./_strictIndexOf");e.exports=n},{"./_baseFindIndex":238,"./_baseIsNaN":252,"./_strictIndexOf":391}],248:[function(t,e,r){function n(t){return i(t)&&o(t)==a}var o=t("./_baseGetTag"),i=t("./isObjectLike"),a="[object Arguments]";e.exports=n},{"./_baseGetTag":244,"./isObjectLike":453}],249:[function(t,e,r){function i(t,e,r,n,o){return t===e||(null==t||null==e||!s(t)&&!s(e)?t!==t&&e!==e:a(t,e,r,n,i,o))}var a=t("./_baseIsEqualDeep"),s=t("./isObjectLike");e.exports=i},{"./_baseIsEqualDeep":250,"./isObjectLike":453}],250:[function(t,e,r){function n(t,e,r,n,o,i){var a=w(t),s=w(e),u=a?j:x(t),l=s?j:x(e);u=u==E?P:u,l=l==E?P:l;var c=u==P,f=l==P,d=u==l;if(d&&S(t)){if(!S(e))return!1;a=!0,c=!1}if(d&&!c)return i||(i=new v),a||O(t)?y(t,e,r,n,o,i):b(t,e,u,r,n,o,i);if(!(r&A)){var p=c&&T.call(t,"__wrapped__"),h=f&&T.call(e,"__wrapped__");if(p||h){var m=p?t.value():t,g=h?e.value():e;return i||(i=new v),o(m,g,r,n,i)}}return!!d&&(i||(i=new v),_(t,e,r,n,o,i))}var v=t("./_Stack"),y=t("./_equalArrays"),b=t("./_equalByTag"),_=t("./_equalObjects"),x=t("./_getTag"),w=t("./isArray"),S=t("./isBuffer"),O=t("./isTypedArray"),A=1,E="[object Arguments]",j="[object Array]",P="[object Object]",o=Object.prototype,T=o.hasOwnProperty;e.exports=n},{"./_Stack":211,"./_equalArrays":312,"./_equalByTag":313,"./_equalObjects":314,"./_getTag":329,"./isArray":444,"./isBuffer":447,"./isTypedArray":456}],251:[function(t,e,r){function n(t,e,r,n){var o=r.length,i=o,a=!n;if(null==t)return!i;for(t=Object(t);o--;){var s=r[o];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<i;){s=r[o];var u=s[0],l=t[u],c=s[1];if(a&&s[2]){if(void 0===l&&!(u in t))return!1}else{var f=new p;if(n)var d=n(l,c,u,t,e,f);if(!(void 0===d?h(c,l,m|g,n,f):d))return!1}}return!0}var p=t("./_Stack"),h=t("./_baseIsEqual"),m=1,g=2;e.exports=n},{"./_Stack":211,"./_baseIsEqual":249}],252:[function(t,e,r){function n(t){return t!==t}e.exports=n},{}],253:[function(t,e,r){function n(t){return!(!a(t)||i(t))&&(o(t)?h:l).test(s(t))}var o=t("./isFunction"),i=t("./_isMasked"),a=t("./isObject"),s=t("./_toSource"),u=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,c=Function.prototype,f=Object.prototype,d=c.toString,p=f.hasOwnProperty,h=RegExp("^"+d.call(p).replace(u,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=n},{"./_isMasked":349,"./_toSource":395,"./isFunction":450,"./isObject":452}],254:[function(t,e,r){function n(t){return a(t)&&i(t.length)&&!!s[o(t)]}var o=t("./_baseGetTag"),i=t("./isLength"),a=t("./isObjectLike"),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=n},{"./_baseGetTag":244,"./isLength":451,"./isObjectLike":453}],255:[function(t,e,r){function n(t){return"function"==typeof t?t:null==t?a:"object"==typeof t?s(t)?i(t[0],t[1]):o(t):u(t)}var o=t("./_baseMatches"),i=t("./_baseMatchesProperty"),a=t("./identity"),s=t("./isArray"),u=t("./property");e.exports=n},{"./_baseMatches":259,"./_baseMatchesProperty":260,"./identity":441,"./isArray":444,"./property":467}],256:[function(t,e,r){function n(t){if(!o(t))return i(t);var e=[];for(var r in Object(t))s.call(t,r)&&"constructor"!=r&&e.push(r);return e}var o=t("./_isPrototype"),i=t("./_nativeKeys"),a=Object.prototype,s=a.hasOwnProperty;e.exports=n},{"./_isPrototype":350,"./_nativeKeys":368}],257:[function(t,e,r){function n(t){if(!o(t))return a(t);var e=i(t),r=[];for(var n in t)("constructor"!=n||!e&&u.call(t,n))&&r.push(n);return r}var o=t("./isObject"),i=t("./_isPrototype"),a=t("./_nativeKeysIn"),s=Object.prototype,u=s.hasOwnProperty;e.exports=n},{"./_isPrototype":350,"./_nativeKeysIn":369,"./isObject":452}],258:[function(t,e,r){function n(){}e.exports=n},{}],259:[function(t,e,r){function n(e){var r=i(e);return 1==r.length&&r[0][2]?a(r[0][0],r[0][1]):function(t){return t===e||o(t,e,r)}}var o=t("./_baseIsMatch"),i=t("./_getMatchData"),a=t("./_matchesStrictComparable");e.exports=n},{"./_baseIsMatch":251,"./_getMatchData":323,"./_matchesStrictComparable":363}],260:[function(t,e,r){function n(r,n){return s(r)&&u(n)?l(c(r),n):function(t){var e=i(t,r);return void 0===e&&e===n?a(t,r):o(n,e,f|d)}}var o=t("./_baseIsEqual"),i=t("./get"),a=t("./hasIn"),s=t("./_isKey"),u=t("./_isStrictComparable"),l=t("./_matchesStrictComparable"),c=t("./_toKey"),f=1,d=2;e.exports=n},{"./_baseIsEqual":249,"./_isKey":346,"./_isStrictComparable":351,"./_matchesStrictComparable":363,"./_toKey":394,"./get":439,"./hasIn":440}],261:[function(t,e,r){function n(r,t){return o(r,t,function(t,e){return i(r,e)})}var o=t("./_basePickBy"),i=t("./hasIn");e.exports=n},{"./_basePickBy":262,"./hasIn":440}],262:[function(t,e,r){function n(t,e,r){for(var n=-1,o=e.length,i={};++n<o;){var a=e[n],s=u(t,a);r(s,a)&&l(i,c(a,t),s)}return i}var u=t("./_baseGet"),l=t("./_baseSet"),c=t("./_castPath");e.exports=n},{"./_baseGet":242,"./_baseSet":268,"./_castPath":279}],263:[function(t,e,r){function n(e){return function(t){return null==t?void 0:t[e]}}e.exports=n},{}],264:[function(t,e,r){function n(e){return function(t){return o(t,e)}}var o=t("./_baseGet");e.exports=n},{"./_baseGet":242}],265:[function(t,e,r){function n(t,e,r,n){for(var o=-1,i=u(s((e-t)/(r||1)),0),a=Array(i);i--;)a[n?i:++o]=t,t+=r;return a}var s=Math.ceil,u=Math.max;e.exports=n},{}],266:[function(t,e,r){function n(t,n,o,i,e){return e(t,function(t,e,r){o=i?(i=!1,t):n(o,t,e,r)}),o}e.exports=n},{}],267:[function(t,e,r){function n(t,e){return a(i(t,e,o),t+"")}var o=t("./identity"),i=t("./_overRest"),a=t("./_setToString");e.exports=n},{"./_overRest":373,"./_setToString":383,"./identity":441}],268:[function(t,e,r){function n(t,e,r,n){if(!h(t))return t;e=d(e,t);for(var o=-1,i=e.length,a=i-1,s=t;null!=s&&++o<i;){var u=m(e[o]),l=r;if(o!=a){var c=s[u];l=n?n(c,u,s):void 0,void 0===l&&(l=h(c)?c:p(e[o+1])?[]:{})}f(s,u,l),s=s[u]}return t}var f=t("./_assignValue"),d=t("./_castPath"),p=t("./_isIndex"),h=t("./isObject"),m=t("./_toKey");e.exports=n},{"./_assignValue":228,"./_castPath":279,"./_isIndex":344,"./_toKey":394,"./isObject":452}],269:[function(t,e,r){var n=t("./identity"),o=t("./_metaMap"),i=o?function(t,e){return o.set(t,e),t}:n;e.exports=i},{"./_metaMap":366,"./identity":441}],270:[function(t,e,r){var n=t("./constant"),o=t("./_defineProperty"),i=t("./identity"),a=o?function(t,e){return o(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:i;e.exports=a},{"./_defineProperty":311,"./constant":403,"./identity":441}],271:[function(t,e,r){function n(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),r=r>o?o:r,r<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(o);++n<o;)i[n]=t[n+e];return i}e.exports=n},{}],272:[function(t,e,r){function n(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}e.exports=n},{}],273:[function(t,e,r){function n(t){if("string"==typeof t)return t;if(a(t))return i(t,n)+"";if(s(t))return c?c.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}var o=t("./_Symbol"),i=t("./_arrayMap"),a=t("./isArray"),s=t("./isSymbol"),u=1/0,l=o?o.prototype:void 0,c=l?l.toString:void 0;e.exports=n},{"./_Symbol":212,"./_arrayMap":223,"./isArray":444,"./isSymbol":455}],274:[function(t,e,r){function n(e){return function(t){return e(t)}}e.exports=n},{}],275:[function(t,e,r){function n(t,e,r){var n=-1,o=h,i=t.length,a=!0,s=[],u=s;if(r)a=!1,o=m;else if(i>=b){var l=e?null:v(t);if(l)return y(l);a=!1,o=g,u=new p}else u=e?[]:s;t:for(;++n<i;){var c=t[n],f=e?e(c):c;if(c=r||0!==c?c:0,a&&f===f){for(var d=u.length;d--;)if(u[d]===f)continue t;e&&u.push(f),s.push(c)}else o(u,f,r)||(u!==s&&u.push(f),s.push(c))}return s}var p=t("./_SetCache"),h=t("./_arrayIncludes"),m=t("./_arrayIncludesWith"),g=t("./_cacheHas"),v=t("./_createSet"),y=t("./_setToArray"),b=200;e.exports=n},{"./_SetCache":210,"./_arrayIncludes":220,"./_arrayIncludesWith":221,"./_cacheHas":278,"./_createSet":308,"./_setToArray":382}],276:[function(t,e,r){function n(t,e){return e=o(e,t),null==(t=a(t,e))||delete t[s(i(e))]}var o=t("./_castPath"),i=t("./last"),a=t("./_parent"),s=t("./_toKey");e.exports=n},{"./_castPath":279,"./_parent":374,"./_toKey":394,"./last":460}],277:[function(t,e,r){function n(t,e,r){var n=t.length;if(n<2)return n?c(t[0]):[];for(var o=-1,i=Array(n);++o<n;)for(var a=t[o],s=-1;++s<n;)s!=o&&(i[o]=u(i[o]||a,t[s],e,r));return c(l(i,1),e,r)}var u=t("./_baseDifference"),l=t("./_baseFlatten"),c=t("./_baseUniq");e.exports=n},{"./_baseDifference":235,"./_baseFlatten":239,"./_baseUniq":275}],278:[function(t,e,r){function n(t,e){return t.has(e)}e.exports=n},{}],279:[function(t,e,r){function n(t,e){return o(t)?t:i(t,e)?[t]:a(s(t))}var o=t("./isArray"),i=t("./_isKey"),a=t("./_stringToPath"),s=t("./toString");e.exports=n},{"./_isKey":346,"./_stringToPath":393,"./isArray":444,"./toString":478}],280:[function(t,e,r){function n(t,e,r){var n=t.length;return r=void 0===r?n:r,!e&&r>=n?t:o(t,e,r)}var o=t("./_baseSlice");e.exports=n},{"./_baseSlice":271}],281:[function(t,e,r){function n(t){var e=new t.constructor(t.byteLength);return new o(e).set(new o(t)),e}var o=t("./_Uint8Array");e.exports=n},{"./_Uint8Array":213}],282:[function(t,e,r){function n(t,e){if(e)return t.slice();var r=t.length,n=l?l(r):new t.constructor(r);return t.copy(n),n}var o=t("./_root"),i="object"==typeof r&&r&&!r.nodeType&&r,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i,u=s?o.Buffer:void 0,l=u?u.allocUnsafe:void 0;e.exports=n},{"./_root":378}],283:[function(t,e,r){function n(t,e){var r=e?o(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var o=t("./_cloneArrayBuffer");e.exports=n},{"./_cloneArrayBuffer":281}],284:[function(t,e,r){function n(t,e,r){var n=e?r(a(t),s):a(t);return i(n,o,new t.constructor)}var o=t("./_addMapEntry"),i=t("./_arrayReduce"),a=t("./_mapToArray"),s=1;e.exports=n},{"./_addMapEntry":215,"./_arrayReduce":225,"./_mapToArray":362}],285:[function(t,e,r){function n(t){var e=new t.constructor(t.source,o.exec(t));return e.lastIndex=t.lastIndex,e}var o=/\w*$/;e.exports=n},{}],286:[function(t,e,r){function n(t,e,r){var n=e?r(a(t),s):a(t);return i(n,o,new t.constructor)}var o=t("./_addSetEntry"),i=t("./_arrayReduce"),a=t("./_setToArray"),s=1;e.exports=n},{"./_addSetEntry":216,"./_arrayReduce":225,"./_setToArray":382}],287:[function(t,e,r){function n(t){return a?Object(a.call(t)):{}}var o=t("./_Symbol"),i=o?o.prototype:void 0,a=i?i.valueOf:void 0;e.exports=n},{"./_Symbol":212}],288:[function(t,e,r){function n(t,e){var r=e?o(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var o=t("./_cloneArrayBuffer");e.exports=n},{"./_cloneArrayBuffer":281}],289:[function(t,e,r){function n(t,e,r,n){for(var o=-1,i=t.length,a=r.length,s=-1,u=e.length,l=d(i-a,0),c=Array(u+l),f=!n;++s<u;)c[s]=e[s];for(;++o<a;)(f||o<i)&&(c[r[o]]=t[o]);for(;l--;)c[s++]=t[o++];return c}var d=Math.max;e.exports=n},{}],290:[function(t,e,r){function n(t,e,r,n){for(var o=-1,i=t.length,a=-1,s=r.length,u=-1,l=e.length,c=h(i-s,0),f=Array(c+l),d=!n;++o<c;)f[o]=t[o];for(var p=o;++u<l;)f[p+u]=e[u];for(;++a<s;)(d||o<i)&&(f[p+r[a]]=t[o++]);return f}var h=Math.max;e.exports=n},{}],291:[function(t,e,r){function n(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}e.exports=n},{}],292:[function(t,e,r){function n(t,e,r,n){var o=!r;r||(r={});for(var i=-1,a=e.length;++i<a;){var s=e[i],u=n?n(r[s],t[s],s,r,t):void 0;void 0===u&&(u=t[s]),o?c(r,s,u):l(r,s,u)}return r}var l=t("./_assignValue"),c=t("./_baseAssignValue");e.exports=n},{"./_assignValue":228,"./_baseAssignValue":232}],293:[function(t,e,r){function n(t,e){return o(t,i(t),e)}var o=t("./_copyObject"),i=t("./_getSymbols");e.exports=n},{"./_copyObject":292,"./_getSymbols":327}],294:[function(t,e,r){function n(t,e){return o(t,i(t),e)}var o=t("./_copyObject"),i=t("./_getSymbolsIn");e.exports=n},{"./_copyObject":292,"./_getSymbolsIn":328}],295:[function(t,e,r){var n=t("./_root"),o=n["__core-js_shared__"];e.exports=o},{"./_root":378}],296:[function(t,e,r){function n(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&++n;return n}e.exports=n},{}],297:[function(t,e,r){function n(i,a){return function(t,e){if(null==t)return t;if(!s(t))return i(t,e);for(var r=t.length,n=a?r:-1,o=Object(t);(a?n--:++n<r)&&!1!==e(o[n],n,o););return t}}var s=t("./isArrayLike");e.exports=n},{"./isArrayLike":445}],298:[function(t,e,r){function n(u){return function(t,e,r){for(var n=-1,o=Object(t),i=r(t),a=i.length;a--;){var s=i[u?a:++n];if(!1===e(o[s],s,o))break}return t}}e.exports=n},{}],299:[function(t,e,r){function n(t,e,r){function n(){return(this&&this!==s&&this instanceof n?i:t).apply(o?r:this,arguments)}var o=e&u,i=a(t);return n}var a=t("./_createCtor"),s=t("./_root"),u=1;e.exports=n},{"./_createCtor":301,"./_root":378}],300:[function(t,e,r){function n(o){return function(t){t=u(t);var e=a(t)?s(t):void 0,r=e?e[0]:t.charAt(0),n=e?i(e,1).join(""):t.slice(1);return r[o]()+n}}var i=t("./_castSlice"),a=t("./_hasUnicode"),s=t("./_stringToArray"),u=t("./toString");e.exports=n},{"./_castSlice":280,"./_hasUnicode":333,"./_stringToArray":392,"./toString":478}],301:[function(t,e,r){function n(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var e=o(n.prototype),r=n.apply(e,t);return i(r)?r:e}}var o=t("./_baseCreate"),i=t("./isObject");e.exports=n},{"./_baseCreate":234,"./isObject":452}],302:[function(t,e,r){function n(i,a,s){function u(){for(var t=arguments.length,e=Array(t),r=t,n=p(u);r--;)e[r]=arguments[r];var o=t<3&&e[0]!==n&&e[t-1]!==n?[]:h(e,n);return(t-=o.length)<s?d(i,a,f,u.placeholder,void 0,e,o,void 0,void 0,s-t):c(this&&this!==m&&this instanceof u?l:i,this,e)}var l=o(i);return u}var c=t("./_apply"),o=t("./_createCtor"),f=t("./_createHybrid"),d=t("./_createRecurry"),p=t("./_getHolder"),h=t("./_replaceHolders"),m=t("./_root");e.exports=n},{"./_apply":217,"./_createCtor":301,"./_createHybrid":304,"./_createRecurry":307,"./_getHolder":321,"./_replaceHolders":377,"./_root":378}],303:[function(t,e,r){function n(u){return o(function(o){var i=o.length,t=i,e=l.prototype.thru;for(u&&o.reverse();t--;){var r=o[t];if("function"!=typeof r)throw new TypeError(h);if(e&&!a&&"wrapper"==f(r))var a=new l([],!0)}for(t=a?t:i;++t<i;){r=o[t];var n=f(r),s="wrapper"==n?c(r):void 0;a=s&&p(s[0])&&s[1]==(v|m|g|y)&&!s[4].length&&1==s[9]?a[f(s[0])].apply(a,s[3]):1==r.length&&p(r)?a[n]():a.thru(r)}return function(){var t=arguments,e=t[0];if(a&&1==t.length&&d(e))return a.plant(e).value();for(var r=0,n=i?o[r].apply(this,t):e;++r<i;)n=o[r].call(this,n);return n}})}var l=t("./_LodashWrapper"),o=t("./_flatRest"),c=t("./_getData"),f=t("./_getFuncName"),d=t("./isArray"),p=t("./_isLaziable"),h="Expected a function",m=8,g=32,v=128,y=256;e.exports=n},{"./_LodashWrapper":205,"./_flatRest":315,"./_getData":319,"./_getFuncName":320,"./_isLaziable":348,"./isArray":444}],304:[function(t,e,r){function A(u,l,c,f,d,p,h,m,g,v){function y(){for(var t=arguments.length,e=Array(t),r=t;r--;)e[r]=arguments[r];if(w)var n=k(y),o=P(e,n);if(f&&(e=E(e,f,d,w)),p&&(e=j(e,p,h,w)),t-=o,w&&t<v){var i=R(e,n);return C(u,l,A,y.placeholder,c,e,i,m,g,v-t)}var a=_?c:this,s=x?a[u]:u;return t=e.length,m?e=M(e,m):S&&t>1&&e.reverse(),b&&g<t&&(e.length=g),this&&this!==N&&this instanceof y&&(s=O||T(s)),s.apply(a,e)}var b=l&s,_=l&n,x=l&o,w=l&(i|a),S=l&B,O=x?void 0:T(u);return y}var E=t("./_composeArgs"),j=t("./_composeArgsRight"),P=t("./_countHolders"),T=t("./_createCtor"),C=t("./_createRecurry"),k=t("./_getHolder"),M=t("./_reorder"),R=t("./_replaceHolders"),N=t("./_root"),n=1,o=2,i=8,a=16,s=128,B=512;e.exports=A},{"./_composeArgs":289,"./_composeArgsRight":290,"./_countHolders":296,"./_createCtor":301,"./_createRecurry":307,"./_getHolder":321,"./_reorder":376,"./_replaceHolders":377,"./_root":378}],305:[function(t,e,r){function n(a,t,s,u){function l(){for(var t=-1,e=arguments.length,r=-1,n=u.length,o=Array(n+e),i=this&&this!==p&&this instanceof l?f:a;++r<n;)o[r]=u[r];for(;e--;)o[r++]=arguments[++t];return d(i,c?s:this,o)}var c=t&i,f=o(a);return l}var d=t("./_apply"),o=t("./_createCtor"),p=t("./_root"),i=1;e.exports=n},{"./_apply":217,"./_createCtor":301,"./_root":378}],306:[function(t,e,r){function n(n){return function(t,e,r){return r&&"number"!=typeof r&&i(t,e,r)&&(e=r=void 0),t=a(t),void 0===e?(e=t,t=0):e=a(e),r=void 0===r?t<e?1:-1:a(r),o(t,e,r,n)}}var o=t("./_baseRange"),i=t("./_isIterateeCall"),a=t("./toFinite");e.exports=n},{"./_baseRange":265,"./_isIterateeCall":345,"./toFinite":474}],307:[function(t,e,r){function n(t,e,r,n,o,i,a,s,u,l){var c=e&S,f=c?a:void 0,d=c?void 0:a,p=c?i:void 0,h=c?void 0:i;e|=c?O:A,(e&=~(c?A:O))&w||(e&=~(_|x));var m=[t,e,o,p,f,h,d,s,u,l],g=r.apply(void 0,m);return v(t)&&y(g,m),g.placeholder=n,b(g,t,e)}var v=t("./_isLaziable"),y=t("./_setData"),b=t("./_setWrapToString"),_=1,x=2,w=4,S=8,O=32,A=64;e.exports=n},{"./_isLaziable":348,"./_setData":381,"./_setWrapToString":384}],308:[function(t,e,r){var n=t("./_Set"),o=t("./noop"),i=t("./_setToArray"),a=n&&1/i(new n([,-0]))[1]==1/0?function(t){return new n(t)}:o;e.exports=a},{"./_Set":209,"./_setToArray":382,"./noop":462}],309:[function(t,e,r){function n(t,e,r,n,o,i,a,s){var u=e&j;if(!u&&"function"!=typeof t)throw new TypeError(A);var l=n?n.length:0;if(l||(e&=~(C|k),n=o=void 0),a=void 0===a?a:M(O(a),0),s=void 0===s?s:O(s),l-=o?o.length:0,e&k){var c=n,f=o;n=o=void 0}var d=u?void 0:_(t),p=[t,e,r,n,o,c,f,i,a,s];if(d&&x(p,d),t=p[0],e=p[1],r=p[2],n=p[3],o=p[4],s=p[9]=void 0===p[9]?u?0:t.length:M(p[9]-l,0),!s&&e&(P|T)&&(e&=~(P|T)),e&&e!=E)h=e==P||e==T?v(t,e,s):e!=C&&e!=(E|C)||o.length?y.apply(void 0,p):b(t,e,r,n);else var h=g(t,e,r);return S((d?m:w)(h,p),t,e)}var m=t("./_baseSetData"),g=t("./_createBind"),v=t("./_createCurry"),y=t("./_createHybrid"),b=t("./_createPartial"),_=t("./_getData"),x=t("./_mergeData"),w=t("./_setData"),S=t("./_setWrapToString"),O=t("./toInteger"),A="Expected a function",E=1,j=2,P=8,T=16,C=32,k=64,M=Math.max;e.exports=n},{"./_baseSetData":269,"./_createBind":299,"./_createCurry":302,"./_createHybrid":304,"./_createPartial":305,"./_getData":319,"./_mergeData":365,"./_setData":381,"./_setWrapToString":384,"./toInteger":475}],310:[function(t,e,r){function n(t){return o(t)?void 0:t}var o=t("./isPlainObject");e.exports=n},{"./isPlainObject":454}],311:[function(t,e,r){var n=t("./_getNative"),o=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();e.exports=o},{"./_getNative":324}],312:[function(t,e,r){function n(t,e,r,n,o,i){var a=r&b,s=t.length,u=e.length;if(s!=u&&!(a&&u>s))return!1;var l=i.get(t);if(l&&i.get(e))return l==e;var c=-1,f=!0,d=r&_?new g:void 0;for(i.set(t,e),i.set(e,t);++c<s;){var p=t[c],h=e[c];if(n)var m=a?n(h,p,c,e,t,i):n(p,h,c,t,e,i);if(void 0!==m){if(m)continue;f=!1;break}if(d){if(!v(e,function(t,e){if(!y(d,e)&&(p===t||o(p,t,r,n,i)))return d.push(e)})){f=!1;break}}else if(p!==h&&!o(p,h,r,n,i)){f=!1;break}}return i.delete(t),i.delete(e),f}var g=t("./_SetCache"),v=t("./_arraySome"),y=t("./_cacheHas"),b=1,_=2;e.exports=n},{"./_SetCache":210,"./_arraySome":226,"./_cacheHas":278}],313:[function(t,e,r){function n(t,e,r,n,o,i,a){switch(r){case P:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case j:return!(t.byteLength!=e.byteLength||!i(new f(t),new f(e)));case y:case b:case w:return d(+t,+e);case _:return t.name==e.name&&t.message==e.message;case S:case A:return t==e+"";case x:var s=h;case O:var u=n&g;if(s||(s=m),t.size!=e.size&&!u)return!1;var l=a.get(t);if(l)return l==e;n|=v,a.set(t,e);var c=p(s(t),s(e),n,o,i,a);return a.delete(t),c;case E:if(T)return T.call(t)==T.call(e)}return!1}var o=t("./_Symbol"),f=t("./_Uint8Array"),d=t("./eq"),p=t("./_equalArrays"),h=t("./_mapToArray"),m=t("./_setToArray"),g=1,v=2,y="[object Boolean]",b="[object Date]",_="[object Error]",x="[object Map]",w="[object Number]",S="[object RegExp]",O="[object Set]",A="[object String]",E="[object Symbol]",j="[object ArrayBuffer]",P="[object DataView]",i=o?o.prototype:void 0,T=i?i.valueOf:void 0;e.exports=n},{"./_Symbol":212,"./_Uint8Array":213,"./_equalArrays":312,"./_mapToArray":362,"./_setToArray":382,"./eq":407}],314:[function(t,e,r){function n(t,e,r,n,o,i){var a=r&_,s=b(t),u=s.length;if(u!=b(e).length&&!a)return!1;for(var l=u;l--;){var c=s[l];if(!(a?c in e:x.call(e,c)))return!1}var f=i.get(t);if(f&&i.get(e))return f==e;var d=!0;i.set(t,e),i.set(e,t);for(var p=a;++l<u;){c=s[l];var h=t[c],m=e[c];if(n)var g=a?n(m,h,c,e,t,i):n(h,m,c,t,e,i);if(!(void 0===g?h===m||o(h,m,r,n,i):g)){d=!1;break}p||(p="constructor"==c)}if(d&&!p){var v=t.constructor,y=e.constructor;v!=y&&"constructor"in t&&"constructor"in e&&!("function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y)&&(d=!1)}return i.delete(t),i.delete(e),d}var b=t("./_getAllKeys"),_=1,o=Object.prototype,x=o.hasOwnProperty;e.exports=n},{"./_getAllKeys":317}],315:[function(t,e,r){function n(t){return a(i(t,void 0,o),t+"")}var o=t("./flatten"),i=t("./_overRest"),a=t("./_setToString");e.exports=n},{"./_overRest":373,"./_setToString":383,"./flatten":412}],316:[function(t,r,e){(function(t){var e="object"==typeof t&&t&&t.Object===Object&&t;r.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],317:[function(t,e,r){function n(t){return o(t,a,i)}var o=t("./_baseGetAllKeys"),i=t("./_getSymbols"),a=t("./keys");e.exports=n},{"./_baseGetAllKeys":243,"./_getSymbols":327,"./keys":458}],318:[function(t,e,r){function n(t){return o(t,a,i)}var o=t("./_baseGetAllKeys"),i=t("./_getSymbolsIn"),a=t("./keysIn");e.exports=n},{"./_baseGetAllKeys":243,"./_getSymbolsIn":328,"./keysIn":459}],319:[function(t,e,r){var n=t("./_metaMap"),o=t("./noop"),i=n?function(t){return n.get(t)}:o;e.exports=i},{"./_metaMap":366,"./noop":462}],320:[function(t,e,r){function n(t){for(var e=t.name+"",r=a[e],n=s.call(a,e)?r.length:0;n--;){var o=r[n],i=o.func;if(null==i||i==t)return o.name}return e}var a=t("./_realNames"),o=Object.prototype,s=o.hasOwnProperty;e.exports=n},{"./_realNames":375}],321:[function(t,e,r){function n(t){return t.placeholder}e.exports=n},{}],322:[function(t,e,r){function n(t,e){var r=t.__data__;return o(e)?r["string"==typeof e?"string":"hash"]:r.map}var o=t("./_isKeyable");e.exports=n},{"./_isKeyable":347}],323:[function(t,e,r){function n(t){for(var e=a(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,i(o)]}return e}var i=t("./_isStrictComparable"),a=t("./keys");e.exports=n},{"./_isStrictComparable":351,"./keys":458}],324:[function(t,e,r){function n(t,e){var r=i(t,e);return o(r)?r:void 0}var o=t("./_baseIsNative"),i=t("./_getValue");e.exports=n},{"./_baseIsNative":253,"./_getValue":330}],325:[function(t,e,r){var n=t("./_overArg"),o=n(Object.getPrototypeOf,Object);e.exports=o},{"./_overArg":372}],326:[function(t,e,r){function n(t){var e=a.call(t,u),r=t[u];try{t[u]=void 0;var n=!0}catch(t){}var o=s.call(t);return n&&(e?t[u]=r:delete t[u]),o}var o=t("./_Symbol"),i=Object.prototype,a=i.hasOwnProperty,s=i.toString,u=o?o.toStringTag:void 0;e.exports=n},{"./_Symbol":212}],327:[function(t,e,r){var n=t("./_arrayFilter"),o=t("./stubArray"),i=Object.prototype,a=i.propertyIsEnumerable,s=Object.getOwnPropertySymbols,u=s?function(e){return null==e?[]:(e=Object(e),n(s(e),function(t){return a.call(e,t)}))}:o;e.exports=u},{"./_arrayFilter":219,"./stubArray":471}],328:[function(t,e,r){var n=t("./_arrayPush"),o=t("./_getPrototype"),i=t("./_getSymbols"),a=t("./stubArray"),s=Object.getOwnPropertySymbols,u=s?function(t){for(var e=[];t;)n(e,i(t)),t=o(t);return e}:a;e.exports=u},{"./_arrayPush":224,"./_getPrototype":325,"./_getSymbols":327,"./stubArray":471}],329:[function(t,e,r){var n=t("./_DataView"),o=t("./_Map"),i=t("./_Promise"),a=t("./_Set"),s=t("./_WeakMap"),u=t("./_baseGetTag"),l=t("./_toSource"),c=l(n),f=l(o),d=l(i),p=l(a),h=l(s),m=u;(n&&"[object DataView]"!=m(new n(new ArrayBuffer(1)))||o&&"[object Map]"!=m(new o)||i&&"[object Promise]"!=m(i.resolve())||a&&"[object Set]"!=m(new a)||s&&"[object WeakMap]"!=m(new s))&&(m=function(t){var e=u(t),r="[object Object]"==e?t.constructor:void 0,n=r?l(r):"";if(n)switch(n){case c:return"[object DataView]";case f:return"[object Map]";case d:return"[object Promise]";case p:return"[object Set]";case h:return"[object WeakMap]"}return e}),e.exports=m},{"./_DataView":201,"./_Map":206,"./_Promise":208,"./_Set":209,"./_WeakMap":214,"./_baseGetTag":244,"./_toSource":395}],330:[function(t,e,r){function n(t,e){return null==t?void 0:t[e]}e.exports=n},{}],331:[function(t,e,r){function n(t){var e=t.match(o);return e?e[1].split(i):[]}var o=/\{\n\/\* \[wrapped with (.+)\] \*/,i=/,? & /;e.exports=n},{}],332:[function(t,e,r){function n(t,e,r){e=s(e,t);for(var n=-1,o=e.length,i=!1;++n<o;){var a=d(e[n]);if(!(i=null!=t&&r(t,a)))break;t=t[a]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&f(o)&&c(a,o)&&(l(t)||u(t))}var s=t("./_castPath"),u=t("./isArguments"),l=t("./isArray"),c=t("./_isIndex"),f=t("./isLength"),d=t("./_toKey");e.exports=n},{"./_castPath":279,"./_isIndex":344,"./_toKey":394,"./isArguments":443,"./isArray":444,"./isLength":451}],333:[function(t,e,r){function n(t){return o.test(t)}var o=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=n},{}],334:[function(t,e,r){function n(){this.__data__=o?o(null):{},this.size=0}var o=t("./_nativeCreate");e.exports=n},{"./_nativeCreate":367}],335:[function(t,e,r){function n(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}e.exports=n},{}],336:[function(t,e,r){function n(t){var e=this.__data__;if(o){var r=e[t];return r===i?void 0:r}return s.call(e,t)?e[t]:void 0}var o=t("./_nativeCreate"),i="__lodash_hash_undefined__",a=Object.prototype,s=a.hasOwnProperty;e.exports=n},{"./_nativeCreate":367}],337:[function(t,e,r){function n(t){var e=this.__data__;return o?void 0!==e[t]:a.call(e,t)}var o=t("./_nativeCreate"),i=Object.prototype,a=i.hasOwnProperty;e.exports=n},{"./_nativeCreate":367}],338:[function(t,e,r){function n(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=o&&void 0===e?i:e,this}var o=t("./_nativeCreate"),i="__lodash_hash_undefined__";e.exports=n},{"./_nativeCreate":367}],339:[function(t,e,r){function n(t){var e=t.length,r=t.constructor(e);return e&&"string"==typeof t[0]&&i.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var o=Object.prototype,i=o.hasOwnProperty;e.exports=n},{}],340:[function(t,e,r){function n(t,e,r,n){var o=t.constructor;switch(e){case _:return i(t);case d:case p:return new o(+t);case x:return a(t,n);case w:case S:case O:case A:case E:case j:case P:case T:case C:return f(t,n);case h:return s(t,n,r);case m:case y:return new o(t);case g:return u(t);case v:return l(t,n,r);case b:return c(t)}}var i=t("./_cloneArrayBuffer"),a=t("./_cloneDataView"),s=t("./_cloneMap"),u=t("./_cloneRegExp"),l=t("./_cloneSet"),c=t("./_cloneSymbol"),f=t("./_cloneTypedArray"),d="[object Boolean]",p="[object Date]",h="[object Map]",m="[object Number]",g="[object RegExp]",v="[object Set]",y="[object String]",b="[object Symbol]",_="[object ArrayBuffer]",x="[object DataView]",w="[object Float32Array]",S="[object Float64Array]",O="[object Int8Array]",A="[object Int16Array]",E="[object Int32Array]",j="[object Uint8Array]",P="[object Uint8ClampedArray]",T="[object Uint16Array]",C="[object Uint32Array]";e.exports=n},{"./_cloneArrayBuffer":281,"./_cloneDataView":283,"./_cloneMap":284,"./_cloneRegExp":285,"./_cloneSet":286,"./_cloneSymbol":287,"./_cloneTypedArray":288}],341:[function(t,e,r){function n(t){return"function"!=typeof t.constructor||a(t)?{}:o(i(t))}var o=t("./_baseCreate"),i=t("./_getPrototype"),a=t("./_isPrototype");e.exports=n},{"./_baseCreate":234,"./_getPrototype":325,"./_isPrototype":350}],342:[function(t,e,r){function n(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(o,"{\n/* [wrapped with "+e+"] */\n")}var o=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=n},{}],343:[function(t,e,r){function n(t){return a(t)||i(t)||!!(s&&t&&t[s])}var o=t("./_Symbol"),i=t("./isArguments"),a=t("./isArray"),s=o?o.isConcatSpreadable:void 0;e.exports=n},{"./_Symbol":212,"./isArguments":443,"./isArray":444}],344:[function(t,e,r){function n(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||i.test(t))&&t>-1&&t%1==0&&t<e}var o=9007199254740991,i=/^(?:0|[1-9]\d*)$/;e.exports=n},{}],345:[function(t,e,r){function n(t,e,r){if(!s(r))return!1;var n=typeof e;return!!("number"==n?i(r)&&a(e,r.length):"string"==n&&e in r)&&o(r[e],t)}var o=t("./eq"),i=t("./isArrayLike"),a=t("./_isIndex"),s=t("./isObject");e.exports=n},{"./_isIndex":344,"./eq":407,"./isArrayLike":445,"./isObject":452}],346:[function(t,e,r){function n(t,e){if(o(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!i(t))||(s.test(t)||!a.test(t)||null!=e&&t in Object(e))}var o=t("./isArray"),i=t("./isSymbol"),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=n},{"./isArray":444,"./isSymbol":455}],347:[function(t,e,r){function n(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}e.exports=n},{}],348:[function(t,e,r){function n(t){var e=a(t),r=s[e];if("function"!=typeof r||!(e in o.prototype))return!1;if(t===r)return!0;var n=i(r);return!!n&&t===n[0]}var o=t("./_LazyWrapper"),i=t("./_getData"),a=t("./_getFuncName"),s=t("./wrapperLodash");e.exports=n},{"./_LazyWrapper":203,"./_getData":319,"./_getFuncName":320,"./wrapperLodash":482}],349:[function(t,e,r){function n(t){return!!i&&i in t}var o=t("./_coreJsData"),i=function(){var t=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();e.exports=n},{"./_coreJsData":295}],350:[function(t,e,r){function n(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||o)}var o=Object.prototype;e.exports=n},{}],351:[function(t,e,r){function n(t){return t===t&&!o(t)}var o=t("./isObject");e.exports=n},{"./isObject":452}],352:[function(t,e,r){function n(){this.__data__=[],this.size=0}e.exports=n},{}],353:[function(t,e,r){function n(t){var e=this.__data__,r=o(e,t);return!(r<0)&&(r==e.length-1?e.pop():a.call(e,r,1),--this.size,!0)}var o=t("./_assocIndexOf"),i=Array.prototype,a=i.splice;e.exports=n},{"./_assocIndexOf":229}],354:[function(t,e,r){function n(t){var e=this.__data__,r=o(e,t);return r<0?void 0:e[r][1]}var o=t("./_assocIndexOf");e.exports=n},{"./_assocIndexOf":229}],355:[function(t,e,r){function n(t){return o(this.__data__,t)>-1}var o=t("./_assocIndexOf");e.exports=n},{"./_assocIndexOf":229}],356:[function(t,e,r){function n(t,e){var r=this.__data__,n=o(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var o=t("./_assocIndexOf");e.exports=n},{"./_assocIndexOf":229}],357:[function(t,e,r){function n(){this.size=0,this.__data__={hash:new o,map:new(a||i),string:new o}}var o=t("./_Hash"),i=t("./_ListCache"),a=t("./_Map");e.exports=n},{"./_Hash":202,"./_ListCache":204,"./_Map":206}],358:[function(t,e,r){function n(t){var e=o(this,t).delete(t);return this.size-=e?1:0,e}var o=t("./_getMapData");e.exports=n},{"./_getMapData":322}],359:[function(t,e,r){function n(t){return o(this,t).get(t)}var o=t("./_getMapData");e.exports=n},{"./_getMapData":322}],360:[function(t,e,r){function n(t){return o(this,t).has(t)}var o=t("./_getMapData");e.exports=n},{"./_getMapData":322}],361:[function(t,e,r){function n(t,e){var r=o(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var o=t("./_getMapData");e.exports=n},{"./_getMapData":322}],362:[function(t,e,r){function n(t){var r=-1,n=Array(t.size);return t.forEach(function(t,e){n[++r]=[e,t]}),n}e.exports=n},{}],363:[function(t,e,r){function n(e,r){return function(t){return null!=t&&(t[e]===r&&(void 0!==r||e in Object(t)))}}e.exports=n},{}],364:[function(t,e,r){function n(t){var e=o(t,function(t){return r.size===i&&r.clear(),t}),r=e.cache;return e}var o=t("./memoize"),i=500;e.exports=n},{"./memoize":461}],365:[function(t,e,r){function n(t,e){var r=t[1],n=e[1],o=r|n,i=o<(p|h|v),a=n==v&&r==g||n==v&&r==y&&t[7].length<=e[8]||n==(v|y)&&e[7].length<=e[8]&&r==g;if(!i&&!a)return t;n&p&&(t[2]=e[2],o|=r&p?0:m);var s=e[3];if(s){var u=t[3];t[3]=u?l(u,s,e[4]):s,t[4]=u?f(t[3],d):e[4]}return s=e[5],s&&(u=t[5],t[5]=u?c(u,s,e[6]):s,t[6]=u?f(t[5],d):e[6]),s=e[7],s&&(t[7]=s),n&v&&(t[8]=null==t[8]?e[8]:b(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=o,t}var l=t("./_composeArgs"),c=t("./_composeArgsRight"),f=t("./_replaceHolders"),d="__lodash_placeholder__",p=1,h=2,m=4,g=8,v=128,y=256,b=Math.min;e.exports=n},{"./_composeArgs":289,"./_composeArgsRight":290,"./_replaceHolders":377}],366:[function(t,e,r){var n=t("./_WeakMap"),o=n&&new n;e.exports=o},{"./_WeakMap":214}],367:[function(t,e,r){var n=t("./_getNative"),o=n(Object,"create");e.exports=o},{"./_getNative":324}],368:[function(t,e,r){var n=t("./_overArg"),o=n(Object.keys,Object);e.exports=o},{"./_overArg":372}],369:[function(t,e,r){function n(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}e.exports=n},{}],370:[function(t,e,r){var n=t("./_freeGlobal"),o="object"==typeof r&&r&&!r.nodeType&&r,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o,s=a&&n.process,u=function(){try{return s&&s.binding&&s.binding("util")}catch(t){}}();e.exports=u},{"./_freeGlobal":316}],371:[function(t,e,r){function n(t){return i.call(t)}var o=Object.prototype,i=o.toString;e.exports=n},{}],372:[function(t,e,r){function n(e,r){return function(t){return e(r(t))}}e.exports=n},{}],373:[function(t,e,r){function n(i,a,s){return a=l(void 0===a?i.length-1:a,0),function(){for(var t=arguments,e=-1,r=l(t.length-a,0),n=Array(r);++e<r;)n[e]=t[a+e];e=-1;for(var o=Array(a+1);++e<a;)o[e]=t[e];return o[a]=s(n),u(i,this,o)}}var u=t("./_apply"),l=Math.max;e.exports=n},{"./_apply":217}],374:[function(t,e,r){function n(t,e){return e.length<2?t:o(t,i(e,0,-1))}var o=t("./_baseGet"),i=t("./_baseSlice");e.exports=n},{"./_baseGet":242,"./_baseSlice":271}],375:[function(t,e,r){var n={};e.exports=n},{}],376:[function(t,e,r){function n(t,e){for(var r=t.length,n=u(e.length,r),o=a(t);n--;){var i=e[n];t[n]=s(i,r)?o[i]:void 0}return t}var a=t("./_copyArray"),s=t("./_isIndex"),u=Math.min;e.exports=n},{"./_copyArray":291,"./_isIndex":344}],377:[function(t,e,r){function n(t,e){for(var r=-1,n=t.length,o=0,i=[];++r<n;){var a=t[r];a!==e&&a!==s||(t[r]=s,i[o++]=r)}return i}var s="__lodash_placeholder__";e.exports=n},{}],378:[function(t,e,r){var n=t("./_freeGlobal"),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();e.exports=i},{"./_freeGlobal":316}],379:[function(t,e,r){function n(t){return this.__data__.set(t,o),this}var o="__lodash_hash_undefined__";e.exports=n},{}],380:[function(t,e,r){function n(t){return this.__data__.has(t)}e.exports=n},{}],381:[function(t,e,r){var n=t("./_baseSetData"),o=t("./_shortOut"),i=o(n);e.exports=i},{"./_baseSetData":269,"./_shortOut":385}],382:[function(t,e,r){function n(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}e.exports=n},{}],383:[function(t,e,r){var n=t("./_baseSetToString"),o=t("./_shortOut"),i=o(n);e.exports=i},{"./_baseSetToString":270,"./_shortOut":385}],384:[function(t,e,r){function n(t,e,r){var n=e+"";return a(t,i(n,s(o(n),r)))}var o=t("./_getWrapDetails"),i=t("./_insertWrapDetails"),a=t("./_setToString"),s=t("./_updateWrapDetails");e.exports=n},{"./_getWrapDetails":331,"./_insertWrapDetails":342,"./_setToString":383,"./_updateWrapDetails":397}],385:[function(t,e,r){function n(r){var n=0,o=0;return function(){var t=s(),e=a-(t-o);if(o=t,e>0){if(++n>=i)return arguments[0]}else n=0;return r.apply(void 0,arguments)}}var i=800,a=16,s=Date.now;e.exports=n},{}],386:[function(t,e,r){function n(){this.__data__=new o,this.size=0}var o=t("./_ListCache");e.exports=n},{"./_ListCache":204}],387:[function(t,e,r){function n(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}e.exports=n},{}],388:[function(t,e,r){function n(t){return this.__data__.get(t)}e.exports=n},{}],389:[function(t,e,r){function n(t){return this.__data__.has(t)}e.exports=n},{}],390:[function(t,e,r){function n(t,e){var r=this.__data__;if(r instanceof o){var n=r.__data__;if(!i||n.length<s-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new a(n)}return r.set(t,e),this.size=r.size,this}var o=t("./_ListCache"),i=t("./_Map"),a=t("./_MapCache"),s=200;e.exports=n},{"./_ListCache":204,"./_Map":206,"./_MapCache":207}],391:[function(t,e,r){function n(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}e.exports=n},{}],392:[function(t,e,r){function n(t){return i(t)?a(t):o(t)}var o=t("./_asciiToArray"),i=t("./_hasUnicode"),a=t("./_unicodeToArray");e.exports=n},{"./_asciiToArray":227,"./_hasUnicode":333,"./_unicodeToArray":396}],393:[function(t,e,r){var n=t("./_memoizeCapped"),i=/^\./,a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,o=n(function(t){var o=[];return i.test(t)&&o.push(""),t.replace(a,function(t,e,r,n){o.push(r?n.replace(s,"$1"):e||t)}),o});e.exports=o},{"./_memoizeCapped":364}],394:[function(t,e,r){function n(t){if("string"==typeof t||o(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}var o=t("./isSymbol"),i=1/0;e.exports=n},{"./isSymbol":455}],395:[function(t,e,r){function n(t){if(null!=t){try{return i.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var o=Function.prototype,i=o.toString;e.exports=n},{}],396:[function(t,e,r){function n(t){return t.match(d)||[]}var o="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",l="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",a,s].join("|")+")[\\ufe0e\\ufe0f]?"+u+")*",c="[\\ufe0e\\ufe0f]?"+u+l,f="(?:"+["[^\\ud800-\\udfff]"+o+"?",o,a,s,"[\\ud800-\\udfff]"].join("|")+")",d=RegExp(i+"(?="+i+")|"+f+c,"g");e.exports=n},{}],397:[function(t,e,r){function n(r,n){return o(a,function(t){var e="_."+t[0];n&t[1]&&!i(r,e)&&r.push(e)}),r.sort()}var o=t("./_arrayEach"),i=t("./_arrayIncludes"),a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=n},{"./_arrayEach":218,"./_arrayIncludes":220}],398:[function(t,e,r){function n(t){if(t instanceof o)return t.clone();var e=new i(t.__wrapped__,t.__chain__);return e.__actions__=a(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var o=t("./_LazyWrapper"),i=t("./_LodashWrapper"),a=t("./_copyArray");e.exports=n},{"./_LazyWrapper":203,"./_LodashWrapper":205,"./_copyArray":291}],399:[function(t,e,r){function n(t,e,r){return e=r?void 0:e,e=t&&null==e?t.length:e,o(t,i,void 0,void 0,void 0,void 0,e)}var o=t("./_createWrap"),i=128;e.exports=n},{"./_createWrap":309}],400:[function(t,e,r){function n(t){return i(o(t).toLowerCase())}var o=t("./toString"),i=t("./upperFirst");e.exports=n},{"./toString":478,"./upperFirst":480}],401:[function(t,e,r){function n(t,e,r){e=(r?u(t,e,r):void 0===e)?1:f(l(e),0);var n=null==t?0:t.length;if(!n||e<1)return[];for(var o=0,i=0,a=Array(c(n/e));o<n;)a[i++]=s(t,o,o+=e);return a}var s=t("./_baseSlice"),u=t("./_isIterateeCall"),l=t("./toInteger"),c=Math.ceil,f=Math.max;e.exports=n},{"./_baseSlice":271,"./_isIterateeCall":345,"./toInteger":475}],402:[function(t,e,r){function n(t){return o(t,i)}var o=t("./_baseClone"),i=4;e.exports=n},{"./_baseClone":233}],403:[function(t,e,r){function n(t){return function(){return t}}e.exports=n},{}],404:[function(t,e,r){function o(t,e,r){e=r?void 0:e;var n=i(t,a,void 0,void 0,void 0,void 0,void 0,e);return n.placeholder=o.placeholder,n}var i=t("./_createWrap"),a=8;o.placeholder={},e.exports=o},{"./_createWrap":309}],405:[function(t,e,r){function n(n,o,t){function r(t){var e=d,r=p;return d=p=void 0,y=t,m=n.apply(r,e)}function i(t){return y=t,g=setTimeout(s,o),b?r(t):m}function e(t){var e=t-v,r=t-y,n=o-e;return _?j(n,h-r):n}function a(t){var e=t-v,r=t-y;return void 0===v||e>=o||e<0||_&&r>=h}function s(){var t=S();if(a(t))return u(t);g=setTimeout(s,e(t))}function u(t){return g=void 0,x&&d?r(t):(d=p=void 0,m)}function l(){void 0!==g&&clearTimeout(g),y=0,d=v=p=g=void 0}function c(){return void 0===g?m:u(S())}function f(){var t=S(),e=a(t);if(d=arguments,p=this,v=t,e){if(void 0===g)return i(v);if(_)return g=setTimeout(s,o),r(v)}return void 0===g&&(g=setTimeout(s,o)),m}var d,p,h,m,g,v,y=0,b=!1,_=!1,x=!0;if("function"!=typeof n)throw new TypeError(A);return o=O(o)||0,w(t)&&(b=!!t.leading,_="maxWait"in t,h=_?E(O(t.maxWait)||0,o):h,x="trailing"in t?!!t.trailing:x),f.cancel=l,f.flush=c,f}var w=t("./isObject"),S=t("./now"),O=t("./toNumber"),A="Expected a function",E=Math.max,j=Math.min;e.exports=n},{"./isObject":452,"./now":463,"./toNumber":476}],406:[function(t,e,r){var n=t("./_baseDifference"),o=t("./_baseFlatten"),i=t("./_baseRest"),a=t("./isArrayLikeObject"),s=i(function(t,e){return a(t)?n(t,o(e,1,a,!0)):[]});e.exports=s},{"./_baseDifference":235,"./_baseFlatten":239,"./_baseRest":267,"./isArrayLikeObject":446}],407:[function(t,e,r){function n(t,e){return t===e||t!==t&&e!==e}e.exports=n},{}],408:[function(t,e,r){function n(t){return t=o(t),t&&a.test(t)?t.replace(i,"\\$&"):t}var o=t("./toString"),i=/[\\^$.*+?()[\]{}|]/g,a=RegExp(i.source);e.exports=n},{"./toString":478}],409:[function(t,e,r){function n(t,e){return(s(t)?o:i)(t,a(e,3))}var o=t("./_arrayFilter"),i=t("./_baseFilter"),a=t("./_baseIteratee"),s=t("./isArray");e.exports=n},{"./_arrayFilter":219,"./_baseFilter":237,"./_baseIteratee":255,"./isArray":444}],410:[function(t,e,r){function n(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var o=null==r?0:s(r);return o<0&&(o=u(n+o,0)),i(t,a(e,3),o)}var i=t("./_baseFindIndex"),a=t("./_baseIteratee"),s=t("./toInteger"),u=Math.max;e.exports=n},{"./_baseFindIndex":238,"./_baseIteratee":255,"./toInteger":475}],411:[function(t,e,r){function n(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var o=n-1;return void 0!==r&&(o=s(r),o=r<0?u(n+o,0):l(o,n-1)),i(t,a(e,3),o,!0)}var i=t("./_baseFindIndex"),a=t("./_baseIteratee"),s=t("./toInteger"),u=Math.max,l=Math.min;e.exports=n},{"./_baseFindIndex":238,"./_baseIteratee":255,"./toInteger":475}],412:[function(t,e,r){function n(t){return(null==t?0:t.length)?o(t,1):[]}var o=t("./_baseFlatten");e.exports=n},{"./_baseFlatten":239}],413:[function(t,e,r){var n=t("./_createFlow"),o=n();e.exports=o},{"./_createFlow":303}],414:[function(t,e,r){function G(r,t){return 2==t?function(t,e){return r.apply(void 0,arguments)}:function(t){return r.apply(void 0,arguments)}}function z(r,t){return 2==t?function(t,e){return r(t,e)}:function(t){return r(t)}}function H(t){for(var e=t?t.length:0,r=Array(e);e--;)r[e]=t[e];return r}function W(e){return function(t){return e({},t)}}function U(i,a){return function(){for(var t=arguments.length,e=t-1,r=Array(t);t--;)r[t]=arguments[t];var n=r[a],o=r.slice(0,a);return n&&s.apply(o,n),a!=e&&s.apply(o,r.slice(a+1)),i.apply(this,o)}}function V(n,o){return function(){var t=arguments.length;if(t){for(var e=Array(t);t--;)e[t]=arguments[t];var r=e[0]=o.apply(void 0,e);return n.apply(void 0,e),r}}}function q(r,t,e,n){function s(t,e){if(y.cap){var r=Y.iterateeRearg[t];if(r)return a(e,r);var n=!g&&Y.iterateeAry[t];if(n)return i(e,n)}return e}function u(t,e,r){return b||y.curry&&r>1?P(e,r):e}function l(t,e,r){if(y.fixed&&(_||!Y.skipFixed[t])){var n=Y.methodSpread[t],o=n&&n.start;return void 0===o?A(e,r):U(e,o)}return e}function c(t,e,r){return y.rearg&&r>1&&(x||!Y.skipRearg[t])?R(e,Y.methodRearg[t]||Y.aryRearg[r]):e}function f(t,e){e=B(e);for(var r=-1,n=e.length,o=n-1,i=j(Object(t)),a=i;null!=a&&++r<n;){var s=e[r],u=a[s];null!=u&&(a[e[r]]=j(r==o?u:Object(u))),a=a[s]}return i}function o(t){return D.runInContext.convert(t)(void 0)}function d(t,o){var i=Y.aliasToReal[t]||t,a=Y.remap[i]||i,s=n;return function(t){var e=g?S:O,r=g?S[a]:o,n=E(E({},s),t);return q(e,i,r,n)}}function i(t,e){return p(t,function(t){return"function"==typeof t?z(t,e):t})}function a(t,r){return p(t,function(t){var e=r.length;return G(R(z(t,e),r),e)})}function p(n,o){return function(){var t=arguments.length;if(!t)return n();for(var e=Array(t);t--;)e[t]=arguments[t];var r=y.rearg?0:t-1;return e[r]=o(e[r]),n.apply(void 0,e)}}function h(t,e){var o,i=Y.aliasToReal[t]||t,a=e,r=L[i];return r?a=r(e):y.immutable&&(Y.mutate.array[i]?a=V(e,H):Y.mutate.object[i]?a=V(e,W(e)):Y.mutate.set[i]&&(a=V(e,f))),T(I,function(n){return T(Y.aryMethod[n],function(t){if(i==t){var e=Y.methodSpread[i],r=e&&e.afterRearg;return o=r?l(i,c(i,a,n),n):c(i,l(i,a,n),n),o=s(i,o),o=u(i,o,n),!1}}),!o}),o||(o=a),o==e&&(o=b?P(o,1):function(){return e.apply(this,arguments)}),o.convert=d(i,e),Y.placeholder[i]&&(m=!0,o.placeholder=e.placeholder=w),o}var m,g="function"==typeof t,v=t===Object(t);if(v&&(n=e,e=t,t=void 0),null==e)throw new TypeError;n||(n={});var y={cap:!("cap"in n)||n.cap,curry:!("curry"in n)||n.curry,fixed:!("fixed"in n)||n.fixed,immutable:!("immutable"in n)||n.immutable,rearg:!("rearg"in n)||n.rearg},b="curry"in n&&n.curry,_="fixed"in n&&n.fixed,x="rearg"in n&&n.rearg,w=g?e:K,S=g?e.runInContext():void 0,O=g?e:{ary:r.ary,assign:r.assign,clone:r.clone,curry:r.curry,forEach:r.forEach,isArray:r.isArray,isFunction:r.isFunction,iteratee:r.iteratee,keys:r.keys,rearg:r.rearg,toInteger:r.toInteger,toPath:r.toPath},A=O.ary,E=O.assign,j=O.clone,P=O.curry,T=O.forEach,C=O.isArray,k=O.isFunction,M=O.keys,R=O.rearg,N=O.toInteger,B=O.toPath,I=M(Y.aryMethod),L={castArray:function(e){return function(){var t=arguments[0];return C(t)?e(H(t)):e.apply(void 0,arguments)}},iteratee:function(o){return function(){var t=arguments[0],e=arguments[1],r=o(t,e),n=r.length;return y.cap&&"number"==typeof e?(e=e>2?e-2:1,n&&n<=e?r:z(r,e)):r}},mixin:function(t){return function(e){var r=this;if(!k(r))return t(r,Object(e));var n=[];return T(M(e),function(t){k(e[t])&&n.push([t,r.prototype[t]])}),t(r,Object(e)),T(n,function(t){var e=t[1];k(e)?r.prototype[t[0]]=e:delete r.prototype[t[0]]}),r}},nthArg:function(r){return function(t){var e=t<0?1:N(t)+1;return P(r(t),e)}},rearg:function(n){return function(t,e){var r=e?e.length:0;return P(n(t,e),r)}},runInContext:function(e){return function(t){return q(r,e(t),n)}}};if(!v)return h(t,e);var D=e,F=[];return T(I,function(t){T(Y.aryMethod[t],function(t){var e=D[Y.remap[t]||t];e&&F.push([t,h(t,e)])})}),T(M(D),function(t){var e=D[t];if("function"==typeof e){for(var r=F.length;r--;)if(F[r][0]==t)return;e.convert=d(t,e),F.push([t,e])}}),T(F,function(t){D[t[0]]=t[1]}),D.convert=o,m&&(D.placeholder=w),T(M(D),function(e){T(Y.realToAlias[e]||[],function(t){D[t]=D[e]})}),D}var Y=t("./_mapping"),K=t("./placeholder"),s=Array.prototype.push;e.exports=q},{"./_mapping":416,"./placeholder":432}],415:[function(t,e,r){e.exports={cap:!1,curry:!1,fixed:!1,immutable:!1,rearg:!1}},{}],416:[function(t,e,i){i.aliasToReal={each:"forEach",eachRight:"forEachRight",entries:"toPairs",entriesIn:"toPairsIn",extend:"assignIn",extendAll:"assignInAll",extendAllWith:"assignInAllWith",extendWith:"assignInWith",first:"head",conforms:"conformsTo",matches:"isMatch",property:"get",__:"placeholder",F:"stubFalse",T:"stubTrue",all:"every",allPass:"overEvery",always:"constant",any:"some",anyPass:"overSome",apply:"spread",assoc:"set",assocPath:"set",complement:"negate",compose:"flowRight",contains:"includes",dissoc:"unset",dissocPath:"unset",dropLast:"dropRight",dropLastWhile:"dropRightWhile",equals:"isEqual",identical:"eq",indexBy:"keyBy",init:"initial",invertObj:"invert",juxt:"over",omitAll:"omit",nAry:"ary",path:"get",pathEq:"matchesProperty",pathOr:"getOr",paths:"at",pickAll:"pick",pipe:"flow",pluck:"map",prop:"get",propEq:"matchesProperty",propOr:"getOr",props:"at",symmetricDifference:"xor",symmetricDifferenceBy:"xorBy",symmetricDifferenceWith:"xorWith",takeLast:"takeRight",takeLastWhile:"takeRightWhile",unapply:"rest",unnest:"flatten",useWith:"overArgs",where:"conformsTo",whereEq:"isMatch",zipObj:"zipObject"},i.aryMethod={1:["assignAll","assignInAll","attempt","castArray","ceil","create","curry","curryRight","defaultsAll","defaultsDeepAll","floor","flow","flowRight","fromPairs","invert","iteratee","memoize","method","mergeAll","methodOf","mixin","nthArg","over","overEvery","overSome","rest","reverse","round","runInContext","spread","template","trim","trimEnd","trimStart","uniqueId","words","zipAll"],2:["add","after","ary","assign","assignAllWith","assignIn","assignInAllWith","at","before","bind","bindAll","bindKey","chunk","cloneDeepWith","cloneWith","concat","conformsTo","countBy","curryN","curryRightN","debounce","defaults","defaultsDeep","defaultTo","delay","difference","divide","drop","dropRight","dropRightWhile","dropWhile","endsWith","eq","every","filter","find","findIndex","findKey","findLast","findLastIndex","findLastKey","flatMap","flatMapDeep","flattenDepth","forEach","forEachRight","forIn","forInRight","forOwn","forOwnRight","get","groupBy","gt","gte","has","hasIn","includes","indexOf","intersection","invertBy","invoke","invokeMap","isEqual","isMatch","join","keyBy","lastIndexOf","lt","lte","map","mapKeys","mapValues","matchesProperty","maxBy","meanBy","merge","mergeAllWith","minBy","multiply","nth","omit","omitBy","overArgs","pad","padEnd","padStart","parseInt","partial","partialRight","partition","pick","pickBy","propertyOf","pull","pullAll","pullAt","random","range","rangeRight","rearg","reject","remove","repeat","restFrom","result","sampleSize","some","sortBy","sortedIndex","sortedIndexOf","sortedLastIndex","sortedLastIndexOf","sortedUniqBy","split","spreadFrom","startsWith","subtract","sumBy","take","takeRight","takeRightWhile","takeWhile","tap","throttle","thru","times","trimChars","trimCharsEnd","trimCharsStart","truncate","union","uniqBy","uniqWith","unset","unzipWith","without","wrap","xor","zip","zipObject","zipObjectDeep"],3:["assignInWith","assignWith","clamp","differenceBy","differenceWith","findFrom","findIndexFrom","findLastFrom","findLastIndexFrom","getOr","includesFrom","indexOfFrom","inRange","intersectionBy","intersectionWith","invokeArgs","invokeArgsMap","isEqualWith","isMatchWith","flatMapDepth","lastIndexOfFrom","mergeWith","orderBy","padChars","padCharsEnd","padCharsStart","pullAllBy","pullAllWith","rangeStep","rangeStepRight","reduce","reduceRight","replace","set","slice","sortedIndexBy","sortedLastIndexBy","transform","unionBy","unionWith","update","xorBy","xorWith","zipWith"],4:["fill","setWith","updateWith"]},i.aryRearg={2:[1,0],3:[2,0,1],4:[3,2,0,1]},i.iterateeAry={dropRightWhile:1,dropWhile:1,every:1,filter:1,find:1,findFrom:1,findIndex:1,findIndexFrom:1,findKey:1,findLast:1,findLastFrom:1,findLastIndex:1,findLastIndexFrom:1,findLastKey:1,flatMap:1,flatMapDeep:1,flatMapDepth:1,forEach:1,forEachRight:1,forIn:1,forInRight:1,forOwn:1,forOwnRight:1,map:1,mapKeys:1,mapValues:1,partition:1,reduce:2,reduceRight:2,reject:1,remove:1,some:1,takeRightWhile:1,takeWhile:1,times:1,transform:2},i.iterateeRearg={mapKeys:[1],reduceRight:[1,0]},i.methodRearg={assignInAllWith:[1,0],assignInWith:[1,2,0],assignAllWith:[1,0],assignWith:[1,2,0],differenceBy:[1,2,0],differenceWith:[1,2,0],getOr:[2,1,0],intersectionBy:[1,2,0],intersectionWith:[1,2,0],isEqualWith:[1,2,0],isMatchWith:[2,1,0],mergeAllWith:[1,0],mergeWith:[1,2,0],padChars:[2,1,0],padCharsEnd:[2,1,0],padCharsStart:[2,1,0],pullAllBy:[2,1,0],pullAllWith:[2,1,0],rangeStep:[1,2,0],rangeStepRight:[1,2,0],setWith:[3,1,2,0],sortedIndexBy:[2,1,0],sortedLastIndexBy:[2,1,0],unionBy:[1,2,0],unionWith:[1,2,0],updateWith:[3,1,2,0],xorBy:[1,2,0],xorWith:[1,2,0],zipWith:[1,2,0]},i.methodSpread={assignAll:{start:0},assignAllWith:{start:0},assignInAll:{start:0},assignInAllWith:{start:0},defaultsAll:{start:0},defaultsDeepAll:{start:0},invokeArgs:{start:2},invokeArgsMap:{start:2},mergeAll:{start:0},mergeAllWith:{start:0},partial:{start:1},partialRight:{start:1},without:{start:1},zipAll:{start:0}},i.mutate={array:{fill:!0,pull:!0,pullAll:!0,pullAllBy:!0,pullAllWith:!0,pullAt:!0,remove:!0,reverse:!0},object:{assign:!0,assignAll:!0,assignAllWith:!0,assignIn:!0,assignInAll:!0,assignInAllWith:!0,assignInWith:!0,assignWith:!0,defaults:!0,defaultsAll:!0,defaultsDeep:!0,defaultsDeepAll:!0,merge:!0,mergeAll:!0,mergeAllWith:!0,mergeWith:!0},set:{set:!0,setWith:!0,unset:!0,update:!0,updateWith:!0}},i.placeholder={bind:!0,bindKey:!0,curry:!0,curryRight:!0,partial:!0,partialRight:!0},i.realToAlias=function(){var t=Object.prototype.hasOwnProperty,e=i.aliasToReal,r={};for(var n in e){var o=e[n];t.call(r,o)?r[o].push(n):r[o]=[n]}return r}(),i.remap={assignAll:"assign",assignAllWith:"assignWith",assignInAll:"assignIn",assignInAllWith:"assignInWith",curryN:"curry",curryRightN:"curryRight",defaultsAll:"defaults",defaultsDeepAll:"defaultsDeep",findFrom:"find",findIndexFrom:"findIndex",findLastFrom:"findLast",findLastIndexFrom:"findLastIndex",getOr:"get",includesFrom:"includes",indexOfFrom:"indexOf",invokeArgs:"invoke",invokeArgsMap:"invokeMap",lastIndexOfFrom:"lastIndexOf",mergeAll:"merge",mergeAllWith:"mergeWith",padChars:"pad",padCharsEnd:"padEnd",padCharsStart:"padStart",propertyOf:"get",rangeStep:"range",rangeStepRight:"rangeRight",restFrom:"rest",spreadFrom:"spread",trimChars:"trim",trimCharsEnd:"trimEnd",trimCharsStart:"trimStart",zipAll:"zip"},i.skipFixed={castArray:!0,flow:!0,flowRight:!0,iteratee:!0,mixin:!0,rearg:!0,runInContext:!0},i.skipRearg={add:!0,assign:!0,assignIn:!0,bind:!0,bindKey:!0,concat:!0,difference:!0,divide:!0,eq:!0,gt:!0,gte:!0,isEqual:!0,lt:!0,lte:!0,matchesProperty:!0,merge:!0,multiply:!0,overArgs:!0,partial:!0,partialRight:!0,propertyOf:!0,random:!0,range:!0,rangeRight:!0,subtract:!0,zip:!0,zipObject:!0,zipObjectDeep:!0}},{}],417:[function(t,e,r){e.exports={ary:t("../ary"),assign:t("../_baseAssign"),clone:t("../clone"),curry:t("../curry"),forEach:t("../_arrayEach"),isArray:t("../isArray"),isFunction:t("../isFunction"),iteratee:t("../iteratee"),keys:t("../_baseKeys"),rearg:t("../rearg"),toInteger:t("../toInteger"),toPath:t("../toPath")}},{"../_arrayEach":218,"../_baseAssign":230,"../_baseKeys":256,"../ary":399,"../clone":402,"../curry":404,"../isArray":444,"../isFunction":450,"../iteratee":457,"../rearg":469,"../toInteger":475,"../toPath":477}],418:[function(t,e,r){var n=t("./convert"),o=n("capitalize",t("../capitalize"),t("./_falseOptions"));o.placeholder=t("./placeholder"),e.exports=o},{"../capitalize":400,"./_falseOptions":415,"./convert":420,"./placeholder":432}],419:[function(t,e,r){var n=t("./convert"),o=n("chunk",t("../chunk"));o.placeholder=t("./placeholder"),e.exports=o},{"../chunk":401,"./convert":420,"./placeholder":432}],420:[function(t,e,r){function n(t,e,r){return o(i,t,e,r)}var o=t("./_baseConvert"),i=t("./_util");e.exports=n},{"./_baseConvert":414,"./_util":417}],421:[function(t,e,r){var n=t("./convert"),o=n("debounce",t("../debounce"));o.placeholder=t("./placeholder"),e.exports=o},{"../debounce":405,"./convert":420,"./placeholder":432}],422:[function(t,e,r){var n=t("./convert"),o=n("escapeRegExp",t("../escapeRegExp"),t("./_falseOptions"));o.placeholder=t("./placeholder"),e.exports=o},{"../escapeRegExp":408,"./_falseOptions":415,"./convert":420,"./placeholder":432}],423:[function(t,e,r){var n=t("./convert"),o=n("filter",t("../filter"));o.placeholder=t("./placeholder"),e.exports=o},{"../filter":409,"./convert":420,"./placeholder":432}],424:[function(t,e,r){var n=t("./convert"),o=n("findIndex",t("../findIndex"));o.placeholder=t("./placeholder"),e.exports=o},{"../findIndex":410,"./convert":420,"./placeholder":432}],425:[function(t,e,r){var n=t("./convert"),o=n("findLastIndex",t("../findLastIndex"));o.placeholder=t("./placeholder"),e.exports=o},{"../findLastIndex":411,"./convert":420,"./placeholder":432}],426:[function(t,e,r){var n=t("./convert"),o=n("flow",t("../flow"));o.placeholder=t("./placeholder"),e.exports=o},{"../flow":413,"./convert":420,"./placeholder":432}],427:[function(t,e,r){var n=t("./convert"),o=n("isEmpty",t("../isEmpty"),t("./_falseOptions"));o.placeholder=t("./placeholder"),e.exports=o},{"../isEmpty":448,"./_falseOptions":415,"./convert":420,"./placeholder":432}],428:[function(t,e,r){var n=t("./convert"),o=n("isEqual",t("../isEqual"));o.placeholder=t("./placeholder"),e.exports=o},{"../isEqual":449,"./convert":420,"./placeholder":432}],429:[function(t,e,r){var n=t("./convert"),o=n("omit",t("../omit"));o.placeholder=t("./placeholder"),e.exports=o},{"../omit":464,"./convert":420,"./placeholder":432}],430:[function(t,e,r){var n=t("./convert"),o=n("pick",t("../pick"));o.placeholder=t("./placeholder"),e.exports=o},{"../pick":465,"./convert":420,"./placeholder":432}],431:[function(t,e,r){var n=t("./convert"),o=n("pickBy",t("../pickBy"));o.placeholder=t("./placeholder"),e.exports=o},{"../pickBy":466,"./convert":420,"./placeholder":432}],432:[function(t,e,r){e.exports={}},{}],433:[function(t,e,r){var n=t("./convert"),o=n("range",t("../range"));o.placeholder=t("./placeholder"),e.exports=o},{"../range":468,"./convert":420,"./placeholder":432}],434:[function(t,e,r){var n=t("./convert"),o=n("reduce",t("../reduce"));o.placeholder=t("./placeholder"),e.exports=o},{"../reduce":470,"./convert":420,"./placeholder":432}],435:[function(t,e,r){var n=t("./convert"),o=n("throttle",t("../throttle"));o.placeholder=t("./placeholder"),e.exports=o},{"../throttle":473,"./convert":420,"./placeholder":432}],436:[function(t,e,r){var n=t("./convert"),o=n("upperFirst",t("../upperFirst"),t("./_falseOptions"));o.placeholder=t("./placeholder"),e.exports=o},{"../upperFirst":480,"./_falseOptions":415,"./convert":420,"./placeholder":432}],437:[function(t,e,r){var n=t("./convert"),o=n("without",t("../without"));o.placeholder=t("./placeholder"),e.exports=o},{"../without":481,"./convert":420,"./placeholder":432}],438:[function(t,e,r){var n=t("./convert"),o=n("xor",t("../xor"));o.placeholder=t("./placeholder"),e.exports=o},{"../xor":483,"./convert":420,"./placeholder":432}],439:[function(t,e,r){function n(t,e,r){var n=null==t?void 0:o(t,e);return void 0===n?r:n}var o=t("./_baseGet");e.exports=n},{"./_baseGet":242}],440:[function(t,e,r){function n(t,e){return null!=t&&i(t,e,o)}var o=t("./_baseHasIn"),i=t("./_hasPath");e.exports=n},{"./_baseHasIn":245,"./_hasPath":332}],441:[function(t,e,r){function n(t){return t}e.exports=n},{}],442:[function(t,e,r){function n(t,e,r){return e=i(e),void 0===r?(r=e,e=0):r=i(r),t=a(t),o(t,e,r)}var o=t("./_baseInRange"),i=t("./toFinite"),a=t("./toNumber");e.exports=n},{"./_baseInRange":246,"./toFinite":474,"./toNumber":476}],443:[function(t,e,r){var n=t("./_baseIsArguments"),o=t("./isObjectLike"),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(t){return o(t)&&a.call(t,"callee")&&!s.call(t,"callee")};e.exports=u},{"./_baseIsArguments":248,"./isObjectLike":453}],444:[function(t,e,r){var n=Array.isArray;e.exports=n},{}],445:[function(t,e,r){function n(t){return null!=t&&i(t.length)&&!o(t)}var o=t("./isFunction"),i=t("./isLength");e.exports=n},{"./isFunction":450,"./isLength":451}],446:[function(t,e,r){function n(t){return i(t)&&o(t)}var o=t("./isArrayLike"),i=t("./isObjectLike");e.exports=n},{"./isArrayLike":445,"./isObjectLike":453}],447:[function(t,e,r){var n=t("./_root"),o=t("./stubFalse"),i="object"==typeof r&&r&&!r.nodeType&&r,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i,u=s?n.Buffer:void 0,l=u?u.isBuffer:void 0,c=l||o;e.exports=c},{"./_root":378,"./stubFalse":472}],448:[function(t,e,r){function n(t){if(null==t)return!0;if(u(t)&&(s(t)||"string"==typeof t||"function"==typeof t.splice||l(t)||f(t)||a(t)))return!t.length;var e=i(t);if(e==d||e==p)return!t.size;if(c(t))return!o(t).length;for(var r in t)if(m.call(t,r))return!1;return!0}var o=t("./_baseKeys"),i=t("./_getTag"),a=t("./isArguments"),s=t("./isArray"),u=t("./isArrayLike"),l=t("./isBuffer"),c=t("./_isPrototype"),f=t("./isTypedArray"),d="[object Map]",p="[object Set]",h=Object.prototype,m=h.hasOwnProperty;e.exports=n},{"./_baseKeys":256,"./_getTag":329,"./_isPrototype":350,"./isArguments":443,"./isArray":444,"./isArrayLike":445,"./isBuffer":447,"./isTypedArray":456}],449:[function(t,e,r){function n(t,e){return o(t,e)}var o=t("./_baseIsEqual");e.exports=n},{"./_baseIsEqual":249}],450:[function(t,e,r){function n(t){if(!i(t))return!1;var e=o(t);return e==s||e==u||e==a||e==l}var o=t("./_baseGetTag"),i=t("./isObject"),a="[object AsyncFunction]",s="[object Function]",u="[object GeneratorFunction]",l="[object Proxy]";e.exports=n},{"./_baseGetTag":244,"./isObject":452}],451:[function(t,e,r){function n(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}var o=9007199254740991;e.exports=n},{}],452:[function(t,e,r){function n(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}e.exports=n},{}],453:[function(t,e,r){function n(t){return null!=t&&"object"==typeof t}e.exports=n},{}],454:[function(t,e,r){function n(t){if(!a(t)||o(t)!=s)return!1;var e=i(t);if(null===e)return!0;var r=f.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==d}var o=t("./_baseGetTag"),i=t("./_getPrototype"),a=t("./isObjectLike"),s="[object Object]",u=Function.prototype,l=Object.prototype,c=u.toString,f=l.hasOwnProperty,d=c.call(Object);e.exports=n},{"./_baseGetTag":244,"./_getPrototype":325,"./isObjectLike":453}],455:[function(t,e,r){function n(t){return"symbol"==typeof t||i(t)&&o(t)==a}var o=t("./_baseGetTag"),i=t("./isObjectLike"),a="[object Symbol]";e.exports=n},{"./_baseGetTag":244,"./isObjectLike":453}],456:[function(t,e,r){var n=t("./_baseIsTypedArray"),o=t("./_baseUnary"),i=t("./_nodeUtil"),a=i&&i.isTypedArray,s=a?o(a):n;e.exports=s},{"./_baseIsTypedArray":254,"./_baseUnary":274,"./_nodeUtil":370}],457:[function(t,e,r){function n(t){return i("function"==typeof t?t:o(t,a))}var o=t("./_baseClone"),i=t("./_baseIteratee"),a=1;e.exports=n},{"./_baseClone":233,"./_baseIteratee":255}],458:[function(t,e,r){function n(t){return a(t)?o(t):i(t)}var o=t("./_arrayLikeKeys"),i=t("./_baseKeys"),a=t("./isArrayLike");e.exports=n},{"./_arrayLikeKeys":222,"./_baseKeys":256,"./isArrayLike":445}],459:[function(t,e,r){function n(t){return a(t)?o(t,!0):i(t)}var o=t("./_arrayLikeKeys"),i=t("./_baseKeysIn"),a=t("./isArrayLike");e.exports=n},{"./_arrayLikeKeys":222,"./_baseKeysIn":257,"./isArrayLike":445}],460:[function(t,e,r){function n(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}e.exports=n},{}],461:[function(t,e,r){function n(o,i){if("function"!=typeof o||null!=i&&"function"!=typeof i)throw new TypeError(u);var a=function(){var t=arguments,e=i?i.apply(this,t):t[0],r=a.cache;if(r.has(e))return r.get(e);var n=o.apply(this,t);return a.cache=r.set(e,n)||r,n};return a.cache=new(n.Cache||s),a}var s=t("./_MapCache"),u="Expected a function";n.Cache=s,e.exports=n},{"./_MapCache":207}],462:[function(t,e,r){function n(){}e.exports=n},{}],463:[function(t,e,r){var n=t("./_root"),o=function(){return n.Date.now()};e.exports=o},{"./_root":378}],464:[function(t,e,r){var i=t("./_arrayMap"),a=t("./_baseClone"),s=t("./_baseUnset"),u=t("./_castPath"),l=t("./_copyObject"),c=t("./_customOmitClone"),n=t("./_flatRest"),f=t("./_getAllKeysIn"),o=n(function(e,t){var r={};if(null==e)return r;var n=!1;t=i(t,function(t){return t=u(t,e),n||(n=t.length>1),t}),l(e,f(e),r),n&&(r=a(r,7,c));for(var o=t.length;o--;)s(r,t[o]);return r});e.exports=o},{"./_arrayMap":223,"./_baseClone":233,"./_baseUnset":276,"./_castPath":279,"./_copyObject":292,"./_customOmitClone":310,"./_flatRest":315,"./_getAllKeysIn":318}],465:[function(t,e,r){var n=t("./_basePick"),o=t("./_flatRest"),i=o(function(t,e){return null==t?{}:n(t,e)});e.exports=i},{"./_basePick":261,"./_flatRest":315}],466:[function(t,e,r){function n(t,r){if(null==t)return{};var e=o(s(t),function(t){return[t]});return r=i(r),a(t,e,function(t,e){return r(t,e[0])})}var o=t("./_arrayMap"),i=t("./_baseIteratee"),a=t("./_basePickBy"),s=t("./_getAllKeysIn");e.exports=n},{"./_arrayMap":223,"./_baseIteratee":255,"./_basePickBy":262,"./_getAllKeysIn":318}],467:[function(t,e,r){function n(t){return a(t)?o(s(t)):i(t)}var o=t("./_baseProperty"),i=t("./_basePropertyDeep"),a=t("./_isKey"),s=t("./_toKey");e.exports=n},{"./_baseProperty":263,"./_basePropertyDeep":264,"./_isKey":346,"./_toKey":394}],468:[function(t,e,r){var n=t("./_createRange"),o=n();e.exports=o},{"./_createRange":306}],469:[function(t,e,r){var n=t("./_createWrap"),o=t("./_flatRest"),i=o(function(t,e){return n(t,256,void 0,void 0,void 0,e)});e.exports=i},{"./_createWrap":309,"./_flatRest":315}],470:[function(t,e,r){function n(t,e,r){var n=l(t)?i:u,o=arguments.length<3;return n(t,s(e,4),r,o,a)}var i=t("./_arrayReduce"),a=t("./_baseEach"),s=t("./_baseIteratee"),u=t("./_baseReduce"),l=t("./isArray");e.exports=n},{"./_arrayReduce":225,"./_baseEach":236,"./_baseIteratee":255,"./_baseReduce":266,"./isArray":444}],471:[function(t,e,r){function n(){return[]}e.exports=n},{}],472:[function(t,e,r){function n(){return!1}e.exports=n},{}],473:[function(t,e,r){function n(t,e,r){var n=!0,o=!0;if("function"!=typeof t)throw new TypeError(s);return a(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),i(t,e,{leading:n,maxWait:e,trailing:o})}var i=t("./debounce"),a=t("./isObject"),s="Expected a function";e.exports=n},{"./debounce":405,"./isObject":452}],474:[function(t,e,r){function n(t){if(!t)return 0===t?t:0;if((t=o(t))===i||t===-i){return(t<0?-1:1)*a}return t===t?t:0}var o=t("./toNumber"),i=1/0,a=17976931348623157e292;e.exports=n},{"./toNumber":476}],475:[function(t,e,r){function n(t){var e=o(t),r=e%1;return e===e?r?e-r:e:0}var o=t("./toFinite");e.exports=n},{"./toFinite":474}],476:[function(t,e,r){function n(t){if("number"==typeof t)return t;if(i(t))return a;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var r=l.test(t);return r||c.test(t)?f(t.slice(2),r?2:8):u.test(t)?a:+t}var o=t("./isObject"),i=t("./isSymbol"),a=NaN,s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,f=parseInt;e.exports=n},{"./isObject":452,"./isSymbol":455}],477:[function(t,e,r){function n(t){return a(t)?o(t,l):s(t)?[t]:i(u(c(t)))}var o=t("./_arrayMap"),i=t("./_copyArray"),a=t("./isArray"),s=t("./isSymbol"),u=t("./_stringToPath"),l=t("./_toKey"),c=t("./toString");e.exports=n},{"./_arrayMap":223,"./_copyArray":291,"./_stringToPath":393,"./_toKey":394,"./isArray":444,"./isSymbol":455,"./toString":478}],478:[function(t,e,r){function n(t){return null==t?"":o(t)}var o=t("./_baseToString");e.exports=n},{"./_baseToString":273}],479:[function(t,e,r){function n(t){return t&&t.length?o(t):[]}var o=t("./_baseUniq");e.exports=n},{"./_baseUniq":275}],480:[function(t,e,r){var n=t("./_createCaseFirst"),o=n("toUpperCase");e.exports=o},{"./_createCaseFirst":300}],481:[function(t,e,r){var n=t("./_baseDifference"),o=t("./_baseRest"),i=t("./isArrayLikeObject"),a=o(function(t,e){return i(t)?n(t,e):[]});e.exports=a},{"./_baseDifference":235,"./_baseRest":267,"./isArrayLikeObject":446}],482:[function(t,e,r){function n(t){if(u(t)&&!s(t)&&!(t instanceof o)){if(t instanceof i)return t;if(f.call(t,"__wrapped__"))return l(t)}return new i(t)}var o=t("./_LazyWrapper"),i=t("./_LodashWrapper"),a=t("./_baseLodash"),s=t("./isArray"),u=t("./isObjectLike"),l=t("./_wrapperClone"),c=Object.prototype,f=c.hasOwnProperty;n.prototype=a.prototype,n.prototype.constructor=n,e.exports=n},{"./_LazyWrapper":203,"./_LodashWrapper":205,"./_baseLodash":258,"./_wrapperClone":398,"./isArray":444,"./isObjectLike":453}],483:[function(t,e,r){var n=t("./_arrayFilter"),o=t("./_baseRest"),i=t("./_baseXor"),a=t("./isArrayLikeObject"),s=o(function(t){return i(n(t,a))});e.exports=s},{"./_arrayFilter":219,"./_baseRest":267,"./_baseXor":277,"./isArrayLikeObject":446}],484:[function(r,n,o){!function(t,e){"object"==typeof o&&void 0!==n?n.exports=e(r("preact"),r("redux")):"function"==typeof L&&L.amd?L(["preact","redux"],e):t.preactRedux=e(t.preact,t.Redux)}(this,function(x,r){function t(){}function e(){var r=[],n=[];return{clear:function(){n=G,r=G},notify:function(){for(var t=r=n,e=0;e<t.length;e++)t[e]()},subscribe:function(t){var e=!0;return n===r&&(n=r.slice()),n.push(t),function(){e&&r!==G&&(e=!1,n===r&&(n=r.slice()),n.splice(n.indexOf(t),1))}}}}function n(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t);try{throw new Error(t)}catch(t){}}function o(){U||(U=!0,n("<Provider> does not support changing `store` on the fly. It is most likely that you see this error because you updated to Redux 2.x and React Redux 2.x which no longer hot reload reducers automatically. See https://github.com/reactjs/react-redux/releases/tag/v2.0.0 for the migration instructions."))}function a(s){var t,e,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=r.getDisplayName,o=void 0===n?function(t){return"ConnectAdvanced("+t+")"}:n,i=r.methodName,u=void 0===i?"connectAdvanced":i,a=r.renderCountProp,l=void 0===a?void 0:a,c=r.shouldHandleStateChanges,f=void 0===c||c,d=r.storeKey,p=void 0===d?"store":d,h=r.withRef,m=void 0!==h&&h,g=D(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef"]),v=p+"Subscription",y=Z++,b=(t={},t[p]=W,t[v]=R.instanceOf(H),t),_=(e={},e[v]=R.instanceOf(H),e);return function(e){X("function"==typeof e,"You must pass a component to the function returned by connect. Instead received "+e);var t=e.displayName||e.name||"Component",i=o(t),a=I({},g,{getDisplayName:o,methodName:u,renderCountProp:l,shouldHandleStateChanges:f,storeKey:p,withRef:m,displayName:i,wrappedComponentName:t,WrappedComponent:e}),r=function(n){function o(t,e){B(this,o);var r=F(this,n.call(this,t,e));return r.version=y,r.state={},r.renderCount=0,r.store=r.props[p]||r.context[p],r.parentSub=t[v]||e[v],r.setWrappedInstance=r.setWrappedInstance.bind(r),X(r.store,'Could not find "'+p+'" in either the context or props of "'+i+'". Either wrap the root component in a <Provider>, or explicitly pass "'+p+'" as a prop to "'+i+'".'),r.getState=r.store.getState.bind(r.store),r.initSelector(),r.initSubscription(),r}return L(o,n),o.prototype.getChildContext=function(){var t;return t={},t[v]=this.subscription||this.parentSub,t},o.prototype.componentDidMount=function(){f&&(this.subscription.trySubscribe(),this.selector.run(this.props),this.selector.shouldComponentUpdate&&this.forceUpdate())},o.prototype.componentWillReceiveProps=function(t){this.selector.run(t)},o.prototype.shouldComponentUpdate=function(){return this.selector.shouldComponentUpdate},o.prototype.componentWillUnmount=function(){this.subscription&&this.subscription.tryUnsubscribe(),this.subscription=null,this.store=null,this.parentSub=null,this.selector.run=function(){}},o.prototype.getWrappedInstance=function(){return X(m,"To access the wrapped instance, you need to specify { withRef: true } in the options argument of the "+u+"() call."),this.wrappedInstance},o.prototype.setWrappedInstance=function(t){this.wrappedInstance=t},o.prototype.initSelector=function(){var t=this.store.dispatch,r=this.getState,n=s(t,a),o=this.selector={shouldComponentUpdate:!0,props:n(r(),this.props),run:function(t){try{var e=n(r(),t);(o.error||e!==o.props)&&(o.shouldComponentUpdate=!0,o.props=e,o.error=null)}catch(t){o.shouldComponentUpdate=!0,o.error=t}}}},o.prototype.initSubscription=function(){var r=this;f&&function(){var t=r.subscription=new H(r.store,r.parentSub),e={};t.onStateChange=function(){this.selector.run(this.props),this.selector.shouldComponentUpdate?(this.componentDidUpdate=function(){this.componentDidUpdate=void 0,t.notifyNestedSubs()},this.setState(e)):t.notifyNestedSubs()}.bind(r)}()},o.prototype.isSubscribed=function(){return Boolean(this.subscription)&&this.subscription.isSubscribed()},o.prototype.addExtraProps=function(t){if(!m&&!l)return t;var e=I({},t);return m&&(e.ref=this.setWrappedInstance),l&&(e[l]=this.renderCount++),e},o.prototype.render=function(){var t=this.selector;if(t.shouldComponentUpdate=!1,t.error)throw t.error;return x.h(e,this.addExtraProps(t.props))},o}(x.Component);return r.WrappedComponent=e,r.displayName=i,r.childContextTypes=_,r.contextTypes=b,r.prototype.componentWillUpdate=function(){this.version!==y&&(this.version=y,this.initSelector(),this.subscription&&this.subscription.tryUnsubscribe(),this.initSubscription(),f&&this.subscription.trySubscribe())},$(r,e)}}function S(t,e){if(t===e)return!0;var r=0,n=0;for(var o in t){if(Q.call(t,o)&&t[o]!==e[o])return!1;r++}for(var i in e)Q.call(e,i)&&n++;return r===n}function i(t){return J(Object(t))}function s(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function u(t){return!!t&&"object"==(void 0===t?"undefined":N(t))}function l(t){if(!u(t)||it.call(t)!=tt||s(t))return!1;var e=i(t);if(null===e)return!0;var r=nt.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&rt.call(r)==ot}function c(t,e,r){l(t)||n(r+"() in "+e+" must return a plain object. Instead received "+t+".")}function f(o){return function(t,e){function r(){return n}var n=o(t,e);return r.dependsOnOwnProps=!1,r}}function d(t){return null!==t.dependsOnOwnProps&&void 0!==t.dependsOnOwnProps?Boolean(t.dependsOnOwnProps):1!==t.length}function p(i,a){return function(t,e){var n=e.displayName,o=function(t,e){return o.dependsOnOwnProps?o.mapToProps(t,e):o.mapToProps(t)};return o.dependsOnOwnProps=d(i),o.mapToProps=function(t,e){o.mapToProps=i;var r=o(t,e);return"function"==typeof r&&(o.mapToProps=r,o.dependsOnOwnProps=d(r),r=o(t,e)),c(r,n,a),r},o}}function h(t){return"function"==typeof t?p(t,"mapDispatchToProps"):void 0}function m(t){return t?void 0:f(function(t){return{dispatch:t}})}function g(e){return e&&"object"===(void 0===e?"undefined":N(e))?f(function(t){return r.bindActionCreators(e,t)}):void 0}function v(t){return"function"==typeof t?p(t,"mapStateToProps"):void 0}function y(t){return t?void 0:f(function(){return{}})}function b(t,e,r){return I({},r,t,e)}function _(l){return function(t,e){var o=e.displayName,i=e.pure,a=e.areMergedPropsEqual,s=!1,u=void 0;return function(t,e,r){var n=l(t,e,r);return s?i&&a(n,u)||(u=n):(s=!0,u=n,c(u,o,"mergeProps")),u}}}function w(t){return"function"==typeof t?_(t):void 0}function O(t){return t?void 0:function(){return b}}function A(t,e,r){if(!t)throw new Error("Unexpected value for "+e+" in "+r+".");"mapStateToProps"!==e&&"mapDispatchToProps"!==e||t.hasOwnProperty("dependsOnOwnProps")||n("The selector for "+e+" of "+r+" did not specify a value for dependsOnOwnProps.")}function E(t,e,r,n){A(t,"mapStateToProps",n),A(e,"mapDispatchToProps",n),A(r,"mergeProps",n)}function j(r,n,o,i){return function(t,e){return o(r(t,e),n(i,e),e)}}function P(r,n,o,i,t){function a(t,e){return m=t,g=e,v=r(m,g),y=n(i,g),b=o(v,y,g),h=!0,b}function s(){return v=r(m,g),n.dependsOnOwnProps&&(y=n(i,g)),b=o(v,y,g)}function u(){return r.dependsOnOwnProps&&(v=r(m,g)),n.dependsOnOwnProps&&(y=n(i,g)),b=o(v,y,g)}function l(){var t=r(m,g),e=!p(t,v);return v=t,e&&(b=o(v,y,g)),b}function c(t,e){var r=!d(e,g),n=!f(t,m);return m=t,g=e,r&&n?s():r?u():n?l():b}var f=t.areStatesEqual,d=t.areOwnPropsEqual,p=t.areStatePropsEqual,h=!1,m=void 0,g=void 0,v=void 0,y=void 0,b=void 0;return function(t,e){return h?c(t,e):a(t,e)}}function T(t,e){var r=e.initMapStateToProps,n=e.initMapDispatchToProps,o=e.initMergeProps,i=D(e,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),a=r(t,i),s=n(t,i),u=o(t,i);return E(a,s,u,i.displayName),(i.pure?P:j)(a,s,u,t,i)}function C(r,t,n){for(var e=t.length-1;e>=0;e--){var o=t[e](r);if(o)return o}return function(t,e){throw new Error("Invalid value of type "+(void 0===r?"undefined":N(r))+" for "+n+" argument when connecting component "+e.wrappedComponentName+".")}}function k(t,e){return t===e}var M={only:function(t){return t&&t[0]||null}};t.isRequired=t;var R={element:t,func:t,shape:function(){return t},instanceOf:function(){return t}},N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},B=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},I=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},L=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},D=function(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r},F=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},G=null,z={notify:function(){}},H=function(){function r(t,e){B(this,r),this.store=t,this.parentSub=e,this.unsubscribe=null,this.listeners=z}return r.prototype.addNestedSub=function(t){return this.trySubscribe(),this.listeners.subscribe(t)},r.prototype.notifyNestedSubs=function(){this.listeners.notify()},r.prototype.isSubscribed=function(){return Boolean(this.unsubscribe)},r.prototype.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.onStateChange):this.store.subscribe(this.onStateChange),this.listeners=e())},r.prototype.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=z)},r}(),W=R.shape({subscribe:R.func.isRequired,dispatch:R.func.isRequired,getState:R.func.isRequired}),U=!1,V=function(n){function o(t,e){B(this,o);var r=F(this,n.call(this,t,e));return r.store=t.store,r}return L(o,n),o.prototype.getChildContext=function(){return{store:this.store,storeSubscription:null}},o.prototype.render=function(){return M.only(this.props.children)},o}(x.Component);V.prototype.componentWillReceiveProps=function(t){this.store!==t.store&&o()},V.childContextTypes={store:W.isRequired,storeSubscription:R.instanceOf(H)},V.displayName="Provider";var q={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,mixins:!0,propTypes:!0,type:!0},Y={name:!0,length:!0,prototype:!0,caller:!0,arguments:!0,arity:!0},K="function"==typeof Object.getOwnPropertySymbols,$=function(t,e,r){if("string"!=typeof e){var n=Object.getOwnPropertyNames(e);K&&(n=n.concat(Object.getOwnPropertySymbols(e)));for(var o=0;o<n.length;++o)if(!(q[n[o]]||Y[n[o]]||r&&r[n[o]]))try{t[n[o]]=e[n[o]]}catch(t){}}return t},X=function(){},Z=0,Q=Object.prototype.hasOwnProperty,J=Object.getPrototypeOf,tt="[object Object]",et=Object.prototype,rt=Function.prototype.toString,nt=et.hasOwnProperty,ot=rt.call(Object),it=et.toString,at=[h,m,g],st=[v,y],ut=[w,O];return{Provider:V,connect:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.connectHOC,y=void 0===e?a:e,r=t.mapStateToPropsFactories,b=void 0===r?st:r,n=t.mapDispatchToPropsFactories,_=void 0===n?at:n,o=t.mergePropsFactories,x=void 0===o?ut:o,i=t.selectorFactory,w=void 0===i?T:i;return function(t,e,r){var n=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],o=n.pure,i=void 0===o||o,a=n.areStatesEqual,s=void 0===a?k:a,u=n.areOwnPropsEqual,l=void 0===u?S:u,c=n.areStatePropsEqual,f=void 0===c?S:c,d=n.areMergedPropsEqual,p=void 0===d?S:d,h=D(n,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),m=C(t,b,"mapStateToProps"),g=C(e,_,"mapDispatchToProps"),v=C(r,x,"mergeProps");return y(w,I({methodName:"connect",getDisplayName:function(t){return"Connect("+t+")"},shouldHandleStateChanges:Boolean(t),initMapStateToProps:m,initMapDispatchToProps:g,initMergeProps:v,pure:i,areStatesEqual:s,areOwnPropsEqual:l,areStatePropsEqual:f,areMergedPropsEqual:p},h))}}(),connectAdvanced:a}})},{preact:485,redux:505}],485:[function(t,z,e){!function(){"use strict";function u(){}function r(t,e){var r,n,o,i,a=b;for(i=arguments.length;i-- >2;)y.push(arguments[i]);for(e&&null!=e.children&&(y.length||y.push(e.children),delete e.children);y.length;)if((n=y.pop())&&void 0!==n.pop)for(i=n.length;i--;)y.push(n[i]);else!0!==n&&!1!==n||(n=null),(o="function"!=typeof t)&&(null==n?n="":"number"==typeof n?n=String(n):"string"!=typeof n&&(o=!1)),o&&r?a[a.length-1]+=n:a===b?a=[n]:a.push(n),r=o;var s=new u;return s.nodeName=t,s.children=a,s.attributes=null==e?void 0:e,s.key=null==e?void 0:e.key,void 0!==N.vnode&&N.vnode(s),s}function A(t,e){for(var r in e)t[r]=e[r];return t}function t(t,e){return r(t.nodeName,A(A({},t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)}function i(t){!t.__d&&(t.__d=!0)&&1==O.push(t)&&(N.debounceRendering||setTimeout)(e)}function e(){var t,e=O;for(O=[];t=e.pop();)t.__d&&M(t)}function x(t,e,r){return"string"==typeof e||"number"==typeof e?void 0!==t.splitText:"string"==typeof e.nodeName?!t._componentConstructor&&c(t,e.nodeName):r||t._componentConstructor===e.nodeName}function c(t,e){return t.__n===e||t.nodeName.toLowerCase()===e.toLowerCase()}function E(t){var e=A({},t.attributes);e.children=t.children;var r=t.nodeName.defaultProps;if(void 0!==r)for(var n in r)void 0===e[n]&&(e[n]=r[n]);return e}function f(t,e){var r=e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return r.__n=t,r}function w(t){t.parentNode&&t.parentNode.removeChild(t)}function o(t,e,r,n,o){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)r&&r(null),n&&n(t);else if("class"!==e||o)if("style"===e){if(n&&"string"!=typeof n&&"string"!=typeof r||(t.style.cssText=n||""),n&&"object"==typeof n){if("string"!=typeof r)for(var i in r)i in n||(t.style[i]="");for(var i in n)t.style[i]="number"==typeof n[i]&&!1===_.test(i)?n[i]+"px":n[i]}}else if("dangerouslySetInnerHTML"===e)n&&(t.innerHTML=n.__html||"");else if("o"==e[0]&&"n"==e[1]){var a=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),n?r||t.addEventListener(e,d,a):t.removeEventListener(e,d,a),(t.__l||(t.__l={}))[e]=n}else if("list"!==e&&"type"!==e&&!o&&e in t)l(t,e,null==n?"":n),null!=n&&!1!==n||t.removeAttribute(e);else{var s=o&&e!==(e=e.replace(/^xlink\:?/,""));null==n||!1===n?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof n&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),n):t.setAttribute(e,n))}else t.className=n||""}function l(t,e,r){try{t[e]=r}catch(t){}}function d(t){return this.__l[t.type](N.event&&N.event(t)||t)}function j(){for(var t;t=B.pop();)N.afterMount&&N.afterMount(t),t.componentDidMount&&t.componentDidMount()}function P(t,e,r,n,o,i){I++||(L=null!=o&&void 0!==o.ownerSVGElement,D=null!=t&&!("__preactattr_"in t));var a=S(t,e,r,n,i);return o&&a.parentNode!==o&&o.appendChild(a),--I||(D=!1,i||j()),a}function S(t,e,r,n,o){var i=t,a=L;if(null==e&&(e=""),"string"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||o)?t.nodeValue!=e&&(t.nodeValue=e):(i=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(i,t),T(t,!0))),i.__preactattr_=!0,i;if("function"==typeof e.nodeName)return m(t,e,r,n);if(L="svg"===e.nodeName||"foreignObject"!==e.nodeName&&L,(!t||!c(t,String(e.nodeName)))&&(i=f(String(e.nodeName),L),t)){for(;t.firstChild;)i.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(i,t),T(t,!0)}var s=i.firstChild,u=i.__preactattr_||(i.__preactattr_={}),l=e.children;return!D&&l&&1===l.length&&"string"==typeof l[0]&&null!=s&&void 0!==s.splitText&&null==s.nextSibling?s.nodeValue!=l[0]&&(s.nodeValue=l[0]):(l&&l.length||null!=s)&&p(i,l,r,n,D||null!=u.dangerouslySetInnerHTML),h(i,e.attributes,u),L=a,i}function p(t,e,r,n,o){var i,a,s,u,l=t.childNodes,c=[],f={},d=0,p=0,h=l.length,m=0,g=e?e.length:0;if(0!==h)for(var v=0;v<h;v++){var y=l[v],b=y.__preactattr_,_=g&&b?y._component?y._component.__k:b.key:null;null!=_?(d++,f[_]=y):(b||(void 0!==y.splitText?!o||y.nodeValue.trim():o))&&(c[m++]=y)}if(0!==g)for(var v=0;v<g;v++){s=e[v],u=null;var _=s.key;if(null!=_)d&&void 0!==f[_]&&(u=f[_],f[_]=void 0,d--);else if(!u&&p<m)for(i=p;i<m;i++)if(void 0!==c[i]&&x(a=c[i],s,o)){u=a,c[i]=void 0,i===m-1&&m--,i===p&&p++;break}u=S(u,s,r,n),u&&u!==t&&(v>=h?t.appendChild(u):u!==l[v]&&(u===l[v+1]?w(l[v]):t.insertBefore(u,l[v]||null)))}if(d)for(var v in f)void 0!==f[v]&&T(f[v],!1);for(;p<=m;)void 0!==(u=c[m--])&&T(u,!1)}function T(t,e){var r=t._component;r?R(r):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||w(t),n(t))}function n(t){for(t=t.lastChild;t;){var e=t.previousSibling;T(t,!0),t=e}}function h(t,e,r){var n;for(n in r)e&&null!=e[n]||null==r[n]||o(t,n,r[n],r[n]=void 0,L);for(n in e)"children"===n||"innerHTML"===n||n in r&&e[n]===("value"===n||"checked"===n?t[n]:r[n])||o(t,n,r[n],r[n]=e[n],L)}function a(t){var e=t.constructor.name;(F[e]||(F[e]=[])).push(t)}function C(t,e,r){var n,o=F[t.name];if(t.prototype&&t.prototype.render?(n=new t(e,r),g.call(n,e,r)):(n=new g(e,r),n.constructor=t,n.render=s),o)for(var i=o.length;i--;)if(o[i].constructor===t){n.__b=o[i].__b,o.splice(i,1);break}return n}function s(t,e,r){return this.constructor(t,r)}function k(t,e,r,n,o){t.__x||(t.__x=!0,(t.__r=e.ref)&&delete e.ref,(t.__k=e.key)&&delete e.key,!t.base||o?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,n),n&&n!==t.context&&(t.__c||(t.__c=t.context),t.context=n),t.__p||(t.__p=t.props),t.props=e,t.__x=!1,0!==r&&(1!==r&&!1===N.syncComponentUpdates&&t.base?i(t):M(t,1,o)),t.__r&&t.__r(t))}function M(t,e,r,n){if(!t.__x){var o,i,a,s=t.props,u=t.state,l=t.context,c=t.__p||s,f=t.__s||u,d=t.__c||l,p=t.base,h=t.__b,m=p||h,g=t._component,v=!1;if(p&&(t.props=c,t.state=f,t.context=d,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(s,u,l)?v=!0:t.componentWillUpdate&&t.componentWillUpdate(s,u,l),t.props=s,t.state=u,t.context=l),t.__p=t.__s=t.__c=t.__b=null,t.__d=!1,!v){o=t.render(s,u,l),t.getChildContext&&(l=A(A({},l),t.getChildContext()));var y,b,_=o&&o.nodeName;if("function"==typeof _){var x=E(o);i=g,i&&i.constructor===_&&x.key==i.__k?k(i,x,1,l,!1):(y=i,t._component=i=C(_,x,l),i.__b=i.__b||h,i.__u=t,k(i,x,0,l,!1),M(i,1,r,!0)),b=i.base}else a=m,y=g,y&&(a=t._component=null),(m||1===e)&&(a&&(a._component=null),b=P(a,o,l,r||!p,m&&m.parentNode,!0));if(m&&b!==m&&i!==g){var w=m.parentNode;w&&b!==w&&(w.replaceChild(b,m),y||(m._component=null,T(m,!1)))}if(y&&R(y),t.base=b,b&&!n){for(var S=t,O=t;O=O.__u;)(S=O).base=b;b._component=S,b._componentConstructor=S.constructor}}if(!p||r?B.unshift(t):v||(j(),t.componentDidUpdate&&t.componentDidUpdate(c,f,d),N.afterUpdate&&N.afterUpdate(t)),null!=t.__h)for(;t.__h.length;)t.__h.pop().call(t);I||n||j()}}function m(t,e,r,n){for(var o=t&&t._component,i=o,a=t,s=o&&t._componentConstructor===e.nodeName,u=s,l=E(e);o&&!u&&(o=o.__u);)u=o.constructor===e.nodeName;return o&&u&&(!n||o._component)?(k(o,l,3,r,n),t=o.base):(i&&!s&&(R(i),t=a=null),o=C(e.nodeName,l,r),t&&!o.__b&&(o.__b=t,a=null),k(o,l,1,r,n),t=o.base,a&&t!==a&&(a._component=null,T(a,!1))),t}function R(t){N.beforeUnmount&&N.beforeUnmount(t);var e=t.base;t.__x=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var r=t._component;r?R(r):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.__b=e,w(e),a(t),n(e)),t.__r&&t.__r(null)}function g(t,e){this.__d=!0,this.context=e,this.props=t,this.state=this.state||{}}function v(t,e,r){return P(r,t,{},!1,e,!1)}var N={},y=[],b=[],_=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,O=[],B=[],I=0,L=!1,D=!1,F={};A(g.prototype,{setState:function(t,e){var r=this.state;this.__s||(this.__s=A({},r)),A(r,"function"==typeof t?t(r,this.props):t),e&&(this.__h=this.__h||[]).push(e),i(this)},forceUpdate:function(t){t&&(this.__h=this.__h||[]).push(t),M(this,2)},render:function(){}});var G={h:r,createElement:r,cloneElement:t,Component:g,render:v,rerender:e,options:N};void 0!==z?z.exports=G:self.preact=G}()},{}],486:[function(t,e,r){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function a(e){if(d===clearTimeout)return clearTimeout(e);if((d===o||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function s(){g&&h&&(g=!1,h.length?m=h.concat(m):v=-1,m.length&&u())}function u(){if(!g){var t=i(s);g=!0;for(var e=m.length;e;){for(h=m,m=[];++v<e;)h&&h[v].run();v=-1,e=m.length}h=null,g=!1,a(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var f,d,p=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(t){f=n}try{d="function"==typeof clearTimeout?clearTimeout:o}catch(t){d=o}}();var h,m=[],g=!1,v=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];m.push(new l(t,e)),1!==m.length||g||i(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],487:[function(t,e,r){"use strict";e.exports=t("./lib/core.js"),t("./lib/done.js"),t("./lib/es6-extensions.js"),t("./lib/node-extensions.js")},{"./lib/core.js":488,"./lib/done.js":489,"./lib/es6-extensions.js":490,"./lib/node-extensions.js":491}],488:[function(t,e,r){"use strict";function n(t){function o(r){if(null===a)return void u.push(r);d(function(){var t=a?r.onFulfilled:r.onRejected;if(null===t)return void(a?r.resolve:r.reject)(s);var e;try{e=t(s)}catch(t){return void r.reject(t)}r.resolve(e)})}function r(t){try{if(t===l)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void f(e.bind(t),r,n)}a=!0,s=t,i()}catch(t){n(t)}}function n(t){a=!1,s=t,i()}function i(){for(var t=0,e=u.length;t<e;t++)o(u[t]);u=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");var a=null,s=null,u=[],l=this;this.then=function(r,n){return new l.constructor(function(t,e){o(new c(r,n,t,e))})},f(t,r,n)}function c(t,e,r,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=r,this.reject=n}function f(t,e,r){var n=!1;try{t(function(t){n||(n=!0,e(t))},function(t){n||(n=!0,r(t))})}catch(t){if(n)return;n=!0,r(t)}}var d=t("asap");e.exports=n},{asap:1}],489:[function(t,e,r){"use strict";var n=t("./core.js"),o=t("asap");e.exports=n,n.prototype.done=function(t,e){(arguments.length?this.then.apply(this,arguments):this).then(null,function(t){o(function(){throw t})})}},{"./core.js":488,asap:1}],490:[function(t,e,r){"use strict";function n(n){this.then=function(r){return"function"!=typeof r?this:new o(function(t,e){i(function(){try{t(r(n))}catch(t){e(t)}})})}}var o=t("./core.js"),i=t("asap");e.exports=o,n.prototype=o.prototype;var a=new n(!0),s=new n(!1),u=new n(null),l=new n(void 0),c=new n(0),f=new n("");o.resolve=function(r){if(r instanceof o)return r;if(null===r)return u;if(void 0===r)return l;if(!0===r)return a;if(!1===r)return s;if(0===r)return c;if(""===r)return f;if("object"==typeof r||"function"==typeof r)try{var t=r.then;if("function"==typeof t)return new o(t.bind(r))}catch(r){return new o(function(t,e){e(r)})}return new n(r)},o.all=function(t){var s=Array.prototype.slice.call(t);return new o(function(n,o){function i(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if("function"==typeof r)return void r.call(t,function(t){i(e,t)},o)}s[e]=t,0==--a&&n(s)}catch(t){o(t)}}if(0===s.length)return n([]);for(var a=s.length,t=0;t<s.length;t++)i(t,s[t])})},o.reject=function(r){return new o(function(t,e){e(r)})},o.race=function(t){return new o(function(e,r){t.forEach(function(t){o.resolve(t).then(e,r)})})},o.prototype.catch=function(t){return this.then(null,t)}},{"./core.js":488,asap:1}],491:[function(t,e,r){"use strict";var s=t("./core.js"),o=t("asap");e.exports=s,s.denodeify=function(i,a){return a=a||1/0,function(){var e=this,o=Array.prototype.slice.call(arguments);return new s(function(r,n){for(;o.length&&o.length>a;)o.pop();o.push(function(t,e){t?n(t):r(e)});var t=i.apply(e,o);!t||"object"!=typeof t&&"function"!=typeof t||"function"!=typeof t.then||r(t)})}},s.nodeify=function(r){return function(){var t=Array.prototype.slice.call(arguments),e="function"==typeof t[t.length-1]?t.pop():null,n=this;try{return r.apply(this,arguments).nodeify(e,n)}catch(r){if(null===e||void 0===e)return new s(function(t,e){e(r)});o(function(){e.call(n,r)})}}},s.prototype.nodeify=function(e,r){if("function"!=typeof e)return this;this.then(function(t){o(function(){e.call(r,null,t)})},function(t){o(function(){e.call(r,t)})})}},{"./core.js":488,asap:1}],492:[function(t,B,I){(function(N){!function(t){function v(t){throw new RangeError(C[t])}function o(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function e(t,e){var r=t.split("@"),n="";return r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(T,"."),n+o(t.split("."),e).join(".")}function y(t){for(var e,r,n=[],o=0,i=t.length;o<i;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<i?(r=t.charCodeAt(o++),56320==(64512&r)?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),o--)):n.push(e);return n}function g(t){return o(t,function(t){var e="";return t>65535&&(t-=65536,e+=R(t>>>10&1023|55296),t=56320|1023&t),e+=R(t)}).join("")}function b(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:S}function _(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function x(t,e,r){var n=0;for(t=r?M(t/p):t>>1,t+=M(t/e);t>k*A>>1;n+=S)t=M(t/k);return M(n+(k+1)*t/(t+d))}function r(t){var e,r,n,o,i,a,s,u,l,c,f=[],d=t.length,p=0,h=j,m=E;for(r=t.lastIndexOf(P),r<0&&(r=0),n=0;n<r;++n)t.charCodeAt(n)>=128&&v("not-basic"),f.push(t.charCodeAt(n));for(o=r>0?r+1:0;o<d;){for(i=p,a=1,s=S;o>=d&&v("invalid-input"),u=b(t.charCodeAt(o++)),(u>=S||u>M((w-p)/a))&&v("overflow"),p+=u*a,l=s<=m?O:s>=m+A?A:s-m,!(u<l);s+=S)c=S-l,a>M(w/c)&&v("overflow"),a*=c;e=f.length+1,m=x(p-i,e,0==i),M(p/e)>w-h&&v("overflow"),h+=M(p/e),p%=e,f.splice(p++,0,h)}return g(f)}function n(t){var e,r,n,o,i,a,s,u,l,c,f,d,p,h,m,g=[];for(t=y(t),d=t.length,e=j,r=0,i=E,a=0;a<d;++a)(f=t[a])<128&&g.push(R(f));for(n=o=g.length,o&&g.push(P);n<d;){for(s=w,a=0;a<d;++a)(f=t[a])>=e&&f<s&&(s=f);for(p=n+1,s-e>M((w-r)/p)&&v("overflow"),r+=(s-e)*p,e=s,a=0;a<d;++a)if(f=t[a],f<e&&++r>w&&v("overflow"),f==e){for(u=r,l=S;c=l<=i?O:l>=i+A?A:l-i,!(u<c);l+=S)m=u-c,h=S-c,g.push(R(_(c+m%h,0))),u=M(m/h);g.push(R(_(u,0))),i=x(r,p,n==o),r=0,++n}++r,++e}return g.join("")}function i(t){return e(t,function(t){return h.test(t)?r(t.slice(4).toLowerCase()):t})}function a(t){return e(t,function(t){return m.test(t)?"xn--"+n(t):t})}var s="object"==typeof I&&I&&!I.nodeType&&I,u="object"==typeof B&&B&&!B.nodeType&&B,l="object"==typeof N&&N;l.global!==l&&l.window!==l&&l.self!==l||(t=l);var c,f,w=2147483647,S=36,O=1,A=26,d=38,p=700,E=72,j=128,P="-",h=/^xn--/,m=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=S-O,M=Math.floor,R=String.fromCharCode;if(c={version:"1.4.1",ucs2:{decode:y,encode:g},decode:r,encode:n,toASCII:a,toUnicode:i},"function"==typeof L&&"object"==typeof L.amd&&L.amd)L("punycode",function(){return c});else if(s&&u)if(B.exports==s)u.exports=c;else for(f in c)c.hasOwnProperty(f)&&(s[f]=c[f]);else t.punycode=c}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],493:[function(t,e,r){"use strict";var n=t("strict-uri-encode");r.extract=function(t){return t.split("?")[1]||""},r.parse=function(t){return"string"!=typeof t?{}:(t=t.trim().replace(/^(\?|#|&)/,""),t?t.split("&").reduce(function(t,e){var r=e.replace(/\+/g," ").split("="),n=r.shift(),o=r.length>0?r.join("="):void 0;return n=decodeURIComponent(n),o=void 0===o?null:decodeURIComponent(o),t.hasOwnProperty(n)?Array.isArray(t[n])?t[n].push(o):t[n]=[t[n],o]:t[n]=o,t},{}):{})},r.stringify=function(r){return r?Object.keys(r).sort().map(function(e){var t=r[e];return Array.isArray(t)?t.sort().map(function(t){return n(e)+"="+n(t)}).join("&"):n(e)+"="+n(t)}).filter(function(t){return t.length>0}).join("&"):""}},{"strict-uri-encode":509}],494:[function(t,e,r){"use strict";function m(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,r,n){e=e||"&",r=r||"=";var o={};if("string"!=typeof t||0===t.length)return o;var i=/\+/g;t=t.split(e);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var s=t.length;a>0&&s>a&&(s=a);for(var u=0;u<s;++u){var l,c,f,d,p=t[u].replace(i,"%20"),h=p.indexOf(r);h>=0?(l=p.substr(0,h),c=p.substr(h+1)):(l=p,c=""),f=decodeURIComponent(l),d=decodeURIComponent(c),m(o,f)?g(o[f])?o[f].push(d):o[f]=[o[f],d]:o[f]=d}return o};var g=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],495:[function(t,e,r){"use strict";function i(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var a=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(r,n,o,t){return n=n||"&",o=o||"=",null===r&&(r=void 0),"object"==typeof r?i(u(r),function(t){var e=encodeURIComponent(a(t))+o;return s(r[t])?i(r[t],function(t){return e+encodeURIComponent(a(t))}).join(n):e+encodeURIComponent(a(r[t]))}).join(n):t?encodeURIComponent(a(t))+o+encodeURIComponent(a(r)):""};var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},u=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},{}],496:[function(t,e,r){"use strict";r.decode=r.parse=t("./decode"),r.encode=r.stringify=t("./encode")},{"./decode":494,"./encode":495}],497:[function(t,r,n){!function(t,e){"object"==typeof n&&"object"==typeof r?r.exports=e():"function"==typeof L&&L.amd?L([],e):"object"==typeof n?n.Raphael=e():t.Raphael=e()}(this,function(){return function(r){function n(t){if(o[t])return o[t].exports;var e=o[t]={exports:{},id:t,loaded:!1};return r[t].call(e.exports,e,e.exports,n),e.loaded=!0,e.exports}var o={};return n.m=r,n.c=o,n.p="",n(0)}([function(t,e,r){var n,o;n=[r(1),r(3),r(4)],void 0!==(o=function(t){return t}.apply(e,n))&&(t.exports=o)},function(t,e,r){var n,o;n=[r(2)],void 0!==(o=function(N){function B(t){if(B.is(t,"function"))return n?t():N.on("raphael.DOMload",t);if(B.is(t,M))return B._engine.create[_](B,t.splice(0,3+B.is(t[0],z))).add(t);var e=Array.prototype.slice.call(arguments,0);if(B.is(e[e.length-1],"function")){var r=e.pop();return n?r.call(B._engine.create[_](B,e)):N.on("raphael.DOMload",function(){r.call(B._engine.create[_](B,e))})}return B._engine.create[_](B,arguments)}function v(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var r in t)t[F](r)&&(e[r]=v(t[r]));return e}function u(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return t.push(t.splice(r,1)[0])}function W(o,i,a){function s(){var t=Array.prototype.slice.call(arguments,0),e=t.join("␀"),r=s.cache=s.cache||{},n=s.count=s.count||[];return r[F](e)?(u(n,e),a?a(r[e]):r[e]):(n.length>=1e3&&delete r[n.shift()],n.push(e),r[e]=o[_](i,t),a?a(r[e]):r[e])}return s}function l(){return this.hex}function y(t,e){for(var r=[],n=0,o=t.length;o-2*!e>n;n+=2){var i=[{x:+t[n-2],y:+t[n-1]},{x:+t[n],y:+t[n+1]},{x:+t[n+2],y:+t[n+3]},{x:+t[n+4],y:+t[n+5]}];e?n?o-4==n?i[3]={x:+t[0],y:+t[1]}:o-2==n&&(i[2]={x:+t[0],y:+t[1]},i[3]={x:+t[2],y:+t[3]}):i[0]={x:+t[o-2],y:+t[o-1]}:o-4==n?i[3]=i[2]:n||(i[0]={x:+t[n],y:+t[n+1]}),r.push(["C",(-i[0].x+6*i[1].x+i[2].x)/6,(-i[0].y+6*i[1].y+i[2].y)/6,(i[1].x+6*i[2].x-i[3].x)/6,(i[1].y+6*i[2].y-i[3].y)/6,i[2].x,i[2].y])}return r}function b(t,e,r,n,o){return t*(t*(-3*e+9*r-9*n+3*o)+6*e-12*r+6*n)-3*e+3*r}function A(t,e,r,n,o,i,a,s,u){null==u&&(u=1),u=u>1?1:u<0?0:u;for(var l=u/2,c=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],f=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,p=0;p<12;p++){var h=l*c[p]+l,m=b(h,t,r,o,a),g=b(h,e,n,i,s),v=m*m+g*g;d+=f[p]*q.sqrt(v)}return l*d}function c(t,e,r,n,o,i,a,s,u){if(!(u<0||A(t,e,r,n,o,i,a,s)<u)){var l,c=.5,f=1-c;for(l=A(t,e,r,n,o,i,a,s,f);Y(l-u)>.01;)c/=2,f+=(l<u?1:-1)*c,l=A(t,e,r,n,o,i,a,s,f);return f}}function E(t,e,r,n,o,i,a,s){if(!(P(t,r)<T(o,a)||T(t,r)>P(o,a)||P(e,n)<T(i,s)||T(e,n)>P(i,s))){var u=(t*n-e*r)*(o-a)-(t-r)*(o*s-i*a),l=(t*n-e*r)*(i-s)-(e-n)*(o*s-i*a),c=(t-r)*(i-s)-(e-n)*(o-a);if(c){var f=u/c,d=l/c,p=+f.toFixed(2),h=+d.toFixed(2);if(!(p<+T(t,r).toFixed(2)||p>+P(t,r).toFixed(2)||p<+T(o,a).toFixed(2)||p>+P(o,a).toFixed(2)||h<+T(e,n).toFixed(2)||h>+P(e,n).toFixed(2)||h<+T(i,s).toFixed(2)||h>+P(i,s).toFixed(2)))return{x:f,y:d}}}}function S(t,e,r){var n=B.bezierBBox(t),o=B.bezierBBox(e);if(!B.isBBoxIntersect(n,o))return r?0:[];for(var i=A.apply(0,t),a=A.apply(0,e),s=P(~~(i/5),1),u=P(~~(a/5),1),l=[],c=[],f={},d=r?0:[],p=0;p<s+1;p++){var h=B.findDotsAtSegment.apply(B,t.concat(p/s));l.push({x:h.x,y:h.y,t:p/s})}for(p=0;p<u+1;p++)h=B.findDotsAtSegment.apply(B,e.concat(p/u)),c.push({x:h.x,y:h.y,t:p/u});for(p=0;p<s;p++)for(var m=0;m<u;m++){var g=l[p],v=l[p+1],y=c[m],b=c[m+1],_=Y(v.x-g.x)<.001?"y":"x",x=Y(b.x-y.x)<.001?"y":"x",w=E(g.x,g.y,v.x,v.y,y.x,y.y,b.x,b.y);if(w){if(f[w.x.toFixed(4)]==w.y.toFixed(4))continue;f[w.x.toFixed(4)]=w.y.toFixed(4);var S=g.t+Y((w[_]-g[_])/(v[_]-g[_]))*(v.t-g.t),O=y.t+Y((w[x]-y[x])/(b[x]-y[x]))*(b.t-y.t);S>=0&&S<=1.001&&O>=0&&O<=1.001&&(r?d++:d.push({x:w.x,y:w.y,t1:T(S,1),t2:T(O,1)}))}}return d}function o(t,e,r){t=B._path2curve(t),e=B._path2curve(e);for(var n,o,i,a,s,u,l,c,f,d,p=r?0:[],h=0,m=t.length;h<m;h++){var g=t[h];if("M"==g[0])n=s=g[1],o=u=g[2];else{"C"==g[0]?(f=[n,o].concat(g.slice(1)),n=f[6],o=f[7]):(f=[n,o,n,o,s,u,s,u],n=s,o=u);for(var v=0,y=e.length;v<y;v++){var b=e[v];if("M"==b[0])i=l=b[1],a=c=b[2];else{"C"==b[0]?(d=[i,a].concat(b.slice(1)),i=d[6],a=d[7]):(d=[i,a,i,a,l,c,l,c],i=l,a=c);var _=S(f,d,r);if(r)p+=_;else{for(var x=0,w=_.length;x<w;x++)_[x].segment1=h,_[x].segment2=v,_[x].bez1=f,_[x].bez2=d;p=p.concat(_)}}}}}return p}function I(t,e,r,n,o,i){null!=t?(this.a=+t,this.b=+e,this.c=+r,this.d=+n,this.e=+o,this.f=+i):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function r(){return this.x+j+this.y+j+this.width+" × "+this.height}function L(t,e,r,n,o,i){function u(t){return((f*t+c)*t+l)*t}function a(t,e){var r,n,o,i,a,s;for(o=t,s=0;s<8;s++){if(i=u(o)-t,Y(i)<e)return o;if(a=(3*f*o+2*c)*o+l,Y(a)<1e-6)break;o-=i/a}if(r=0,n=1,(o=t)<r)return r;if(o>n)return n;for(;r<n;){if(i=u(o),Y(i-t)<e)return o;t>i?r=o:n=o,o=(n-r)/2+r}return o}var l=3*e,c=3*(n-e)-l,f=1-l-c,s=3*r,d=3*(o-r)-s,p=1-s-d;return function(t,e){var r=a(t,e);return((p*r+d)*r+s)*r}(t,1/(200*i))}function f(t,e){var r=[],n={};if(this.ms=e,this.times=1,t){for(var o in t)t[F](o)&&(n[Q(o)]=t[o],r.push(Q(o)));r.sort(ct)}this.anim=n,this.top=r[r.length-1],this.percents=r}function w(t,e,r,n,o,i){r=Q(r);var a,s,u,l,c,f,d=t.ms,p={},h={},m={};if(n)for(v=0,y=ie.length;v<y;v++){var g=ie[v];if(g.el.id==e.id&&g.anim==t){g.percent!=r?(ie.splice(v,1),u=1):s=g,e.attr(g.totalOrigin);break}}else n=+h;for(var v=0,y=t.percents.length;v<y;v++){if(t.percents[v]==r||t.percents[v]>n*t.top){r=t.percents[v],c=t.percents[v-1]||0,d=d/t.top*(r-c),l=t.percents[v+1],a=t.anim[r];break}n&&e.attr(t.anim[t.percents[v]])}if(a){if(s)s.initstatus=n,s.start=new Date-s.ms*n;else{for(var b in a)if(a[F](b)&&(rt[F](b)||e.paper.customAttributes[F](b)))switch(p[b]=e.attr(b),null==p[b]&&(p[b]=et[b]),h[b]=a[b],rt[b]){case z:m[b]=(h[b]-p[b])/d;break;case"colour":p[b]=B.getRGB(p[b]);var _=B.getRGB(h[b]);m[b]={r:(_.r-p[b].r)/d,g:(_.g-p[b].g)/d,b:(_.b-p[b].b)/d};break;case"path":var x=Nt(p[b],h[b]),w=x[1];for(p[b]=x[0],m[b]=[],v=0,y=p[b].length;v<y;v++){m[b][v]=[0];for(var S=1,O=p[b][v].length;S<O;S++)m[b][v][S]=(w[v][S]-p[b][v][S])/d}break;case"transform":var A=e._,E=Ft(A[b],h[b]);if(E)for(p[b]=E.from,h[b]=E.to,m[b]=[],m[b].real=!0,v=0,y=p[b].length;v<y;v++)for(m[b][v]=[p[b][v][0]],S=1,O=p[b][v].length;S<O;S++)m[b][v][S]=(h[b][v][S]-p[b][v][S])/d;else{var j=e.matrix||new I,P={_:{transform:A.transform},getBBox:function(){return e.getBBox(1)}};p[b]=[j.a,j.b,j.c,j.d,j.e,j.f],Lt(P,h[b]),h[b]=P._.transform,m[b]=[(P.matrix.a-j.a)/d,(P.matrix.b-j.b)/d,(P.matrix.c-j.c)/d,(P.matrix.d-j.d)/d,(P.matrix.e-j.e)/d,(P.matrix.f-j.f)/d]}break;case"csv":var T=G(a[b])[V](D),C=G(p[b])[V](D);if("clip-rect"==b)for(p[b]=C,m[b]=[],v=C.length;v--;)m[b][v]=(T[v]-p[b][v])/d;h[b]=T;break;default:for(T=[][U](a[b]),C=[][U](p[b]),m[b]=[],v=e.paper.customAttributes[b].length;v--;)m[b][v]=((T[v]||0)-(C[v]||0))/d}var k=a.easing,M=B.easing_formulas[k];if(!M)if((M=G(k).match(X))&&5==M.length){var R=M;M=function(t){return L(t,+R[1],+R[2],+R[3],+R[4],d)}}else M=ft;if(f=a.start||t.start||+new Date,g={anim:t,percent:r,timestamp:f,start:f+(t.del||0),status:0,initstatus:n||0,stop:!1,ms:d,easing:M,from:p,diff:m,to:h,el:e,callback:a.callback,prev:c,next:l,repeat:i||t.times,origin:e.attr(),totalOrigin:o},ie.push(g),n&&!s&&!u&&(g.stop=!0,g.start=new Date-d*n,1==ie.length))return se();u&&(g.start=new Date-g.ms*n),1==ie.length&&ae(se)}N("raphael.anim.start."+e.id,e,t)}}function t(t){for(var e=0;e<ie.length;e++)ie[e].el.paper==t&&ie.splice(e--,1)}B.version="2.2.0",B.eve=N;var n,e,D=/[, ]+/,i={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},a=/\{(\d+)\}/g,F="hasOwnProperty",h={doc:document,win:window},s={was:Object.prototype[F].call(h.win,"Raphael"),is:h.win.Raphael},d=function(){this.ca=this.customAttributes={}},_="apply",U="concat",m="ontouchstart"in h.win||h.win.DocumentTouch&&h.doc instanceof DocumentTouch,O="",j=" ",G=String,V="split",p="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[V](j),g={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},x=G.prototype.toLowerCase,q=Math,P=q.max,T=q.min,Y=q.abs,C=q.pow,K=q.PI,z="number",k="string",M="array",R=Object.prototype.toString,H=(B._ISURL=/^url\(['"]?(.+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),$={NaN:1,Infinity:1,"-Infinity":1},X=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,Z=q.round,Q=parseFloat,J=parseInt,tt=G.prototype.toUpperCase,et=B._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,class:""},rt=B._availableAnimAttrs={blur:z,"clip-rect":"csv",cx:z,cy:z,fill:"colour","fill-opacity":z,"font-size":z,height:z,opacity:z,path:"path",r:z,rx:z,ry:z,stroke:"colour","stroke-opacity":z,"stroke-width":z,transform:"transform",width:z,x:z,y:z},nt=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,ot={hs:1,rg:1},it=/,?([achlmqrstvxz]),?/gi,at=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,st=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,ut=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,lt=(B._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),ct=function(t,e){return Q(t)-Q(e)},ft=function(t){return t},dt=B._rectPath=function(t,e,r,n,o){return o?[["M",t+o,e],["l",r-2*o,0],["a",o,o,0,0,1,o,o],["l",0,n-2*o],["a",o,o,0,0,1,-o,o],["l",2*o-r,0],["a",o,o,0,0,1,-o,-o],["l",0,2*o-n],["a",o,o,0,0,1,o,-o],["z"]]:[["M",t,e],["l",r,0],["l",0,n],["l",-r,0],["z"]]},pt=function(t,e,r,n){return null==n&&(n=r),[["M",t,e],["m",0,-n],["a",r,n,0,1,1,0,2*n],["a",r,n,0,1,1,0,-2*n],["z"]]},ht=B._getPath={path:function(t){return t.attr("path")},circle:function(t){var e=t.attrs;return pt(e.cx,e.cy,e.r)},ellipse:function(t){var e=t.attrs;return pt(e.cx,e.cy,e.rx,e.ry)},rect:function(t){var e=t.attrs;return dt(e.x,e.y,e.width,e.height,e.r)},image:function(t){var e=t.attrs;return dt(e.x,e.y,e.width,e.height)},text:function(t){var e=t._getBBox();return dt(e.x,e.y,e.width,e.height)},set:function(t){var e=t._getBBox();return dt(e.x,e.y,e.width,e.height)}},mt=B.mapPath=function(t,e){if(!e)return t;var r,n,o,i,a,s,u;for(t=Nt(t),o=0,a=t.length;o<a;o++)for(u=t[o],i=1,s=u.length;i<s;i+=2)r=e.x(u[i],u[i+1]),n=e.y(u[i],u[i+1]),u[i]=r,u[i+1]=n;return t};if(B._g=h,B.type=h.win.SVGAngle||h.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==B.type){var gt,vt=h.doc.createElement("div");if(vt.innerHTML='<v:shape adj="1"/>',gt=vt.firstChild,gt.style.behavior="url(#default#VML)",!gt||"object"!=typeof gt.adj)return B.type=O;vt=null}B.svg=!(B.vml="VML"==B.type),B._Paper=d,B.fn=e=d.prototype=B.prototype,B._id=0,B.is=function(t,e){return e=x.call(e),"finite"==e?!$[F](+t):"array"==e?t instanceof Array:"null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||R.call(t).slice(8,-1).toLowerCase()==e},B.angle=function(t,e,r,n,o,i){if(null==o){var a=t-r,s=e-n;return a||s?(180+180*q.atan2(-s,-a)/K+360)%360:0}return B.angle(t,e,o,i)-B.angle(r,n,o,i)},B.rad=function(t){return t%360*K/180},B.deg=function(t){return Math.round(180*t/K%360*1e3)/1e3},B.snapTo=function(t,e,r){if(r=B.is(r,"finite")?r:10,B.is(t,M)){for(var n=t.length;n--;)if(Y(t[n]-e)<=r)return t[n]}else{t=+t;var o=e%t;if(o<r)return e-o;if(o>t-r)return e-o+t}return e};B.createUUID=function(t,e){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(t,e).toUpperCase()}}(/[xy]/g,function(t){var e=16*q.random()|0;return("x"==t?e:3&e|8).toString(16)});B.setWindow=function(t){N("raphael.setWindow",B,h.win,t),h.win=t,h.doc=h.win.document,B._engine.initWin&&B._engine.initWin(h.win)};var yt=function(t){if(B.vml){var r,n=/^\s+|\s+$/g;try{var e=new ActiveXObject("htmlfile");e.write("<body>"),e.close(),r=e.body}catch(t){r=createPopup().document.body}var o=r.createTextRange();yt=W(function(t){try{r.style.color=G(t).replace(n,O);var e=o.queryCommandValue("ForeColor");return e=(255&e)<<16|65280&e|(16711680&e)>>>16,"#"+("000000"+e.toString(16)).slice(-6)}catch(t){return"none"}})}else{var i=h.doc.createElement("i");i.title="Raphaël Colour Picker",i.style.display="none",h.doc.body.appendChild(i),yt=W(function(t){return i.style.color=t,h.doc.defaultView.getComputedStyle(i,O).getPropertyValue("color")})}return yt(t)},bt=function(){return"hsb("+[this.h,this.s,this.b]+")"},_t=function(){return"hsl("+[this.h,this.s,this.l]+")"},xt=function(){return this.hex},wt=function(t,e,r){if(null==e&&B.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(r=t.b,e=t.g,t=t.r),null==e&&B.is(t,k)){var n=B.getRGB(t);t=n.r,e=n.g,r=n.b}return(t>1||e>1||r>1)&&(t/=255,e/=255,r/=255),[t,e,r]},St=function(t,e,r,n){t*=255,e*=255,r*=255;var o={r:t,g:e,b:r,hex:B.rgb(t,e,r),toString:xt};return B.is(n,"finite")&&(o.opacity=n),o};B.color=function(t){var e;return B.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(e=B.hsb2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.hex=e.hex):B.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(e=B.hsl2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.hex=e.hex):(B.is(t,"string")&&(t=B.getRGB(t)),B.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(e=B.rgb2hsl(t),t.h=e.h,t.s=e.s,t.l=e.l,e=B.rgb2hsb(t),t.v=e.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1)),t.toString=xt,t},B.hsb2rgb=function(t,e,r,n){this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(r=t.b,e=t.s,n=t.o,t=t.h),t*=360;var o,i,a,s,u;return t=t%360/60,u=r*e,s=u*(1-Y(t%2-1)),o=i=a=r-u,t=~~t,o+=[u,s,0,0,s,u][t],i+=[s,u,u,s,0,0][t],a+=[0,0,s,u,u,s][t],St(o,i,a,n)},B.hsl2rgb=function(t,e,r,n){this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(r=t.l,e=t.s,t=t.h),(t>1||e>1||r>1)&&(t/=360,e/=100,r/=100),t*=360;var o,i,a,s,u;return t=t%360/60,u=2*e*(r<.5?r:1-r),s=u*(1-Y(t%2-1)),o=i=a=r-u/2,t=~~t,o+=[u,s,0,0,s,u][t],i+=[s,u,u,s,0,0][t],a+=[0,0,s,u,u,s][t],St(o,i,a,n)},B.rgb2hsb=function(t,e,r){r=wt(t,e,r),t=r[0],e=r[1],r=r[2];var n,o,i,a;return i=P(t,e,r),a=i-T(t,e,r),n=0==a?null:i==t?(e-r)/a:i==e?(r-t)/a+2:(t-e)/a+4,n=(n+360)%6*60/360,o=0==a?0:a/i,{h:n,s:o,b:i,toString:bt}},B.rgb2hsl=function(t,e,r){r=wt(t,e,r),t=r[0],e=r[1],r=r[2];var n,o,i,a,s,u;return a=P(t,e,r),s=T(t,e,r),u=a-s,n=0==u?null:a==t?(e-r)/u:a==e?(r-t)/u+2:(t-e)/u+4,n=(n+360)%6*60/360,i=(a+s)/2,o=0==u?0:i<.5?u/(2*i):u/(2-2*i),{h:n,s:o,l:i,toString:_t}},B._path2string=function(){return this.join(",").replace(it,"$1")};B._preload=function(t,e){var r=h.doc.createElement("img");r.style.cssText="position:absolute;left:-9999em;top:-9999em",r.onload=function(){e.call(this),this.onload=null,h.doc.body.removeChild(this)},r.onerror=function(){h.doc.body.removeChild(this)},h.doc.body.appendChild(r),r.src=t};B.getRGB=W(function(t){if(!t||(t=G(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:l};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:l};!(ot[F](t.toLowerCase().substring(0,2))||"#"==t.charAt())&&(t=yt(t));var e,r,n,o,i,a,s=t.match(H);return s?(s[2]&&(n=J(s[2].substring(5),16),r=J(s[2].substring(3,5),16),e=J(s[2].substring(1,3),16)),s[3]&&(n=J((i=s[3].charAt(3))+i,16),r=J((i=s[3].charAt(2))+i,16),e=J((i=s[3].charAt(1))+i,16)),s[4]&&(a=s[4][V](nt),e=Q(a[0]),"%"==a[0].slice(-1)&&(e*=2.55),r=Q(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),n=Q(a[2]),"%"==a[2].slice(-1)&&(n*=2.55),"rgba"==s[1].toLowerCase().slice(0,4)&&(o=Q(a[3])),a[3]&&"%"==a[3].slice(-1)&&(o/=100)),s[5]?(a=s[5][V](nt),e=Q(a[0]),"%"==a[0].slice(-1)&&(e*=2.55),r=Q(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),n=Q(a[2]),"%"==a[2].slice(-1)&&(n*=2.55),("deg"==a[0].slice(-3)||"°"==a[0].slice(-1))&&(e/=360),"hsba"==s[1].toLowerCase().slice(0,4)&&(o=Q(a[3])),a[3]&&"%"==a[3].slice(-1)&&(o/=100),B.hsb2rgb(e,r,n,o)):s[6]?(a=s[6][V](nt),e=Q(a[0]),"%"==a[0].slice(-1)&&(e*=2.55),r=Q(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),n=Q(a[2]),"%"==a[2].slice(-1)&&(n*=2.55),("deg"==a[0].slice(-3)||"°"==a[0].slice(-1))&&(e/=360),"hsla"==s[1].toLowerCase().slice(0,4)&&(o=Q(a[3])),a[3]&&"%"==a[3].slice(-1)&&(o/=100),B.hsl2rgb(e,r,n,o)):(s={r:e,g:r,b:n,toString:l},s.hex="#"+(16777216|n|r<<8|e<<16).toString(16).slice(1),B.is(o,"finite")&&(s.opacity=o),s)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:l}},B),B.hsb=W(function(t,e,r){return B.hsb2rgb(t,e,r).hex}),B.hsl=W(function(t,e,r){return B.hsl2rgb(t,e,r).hex}),B.rgb=W(function(t,e,r){function n(t){return t+.5|0}return"#"+(16777216|n(r)|n(e)<<8|n(t)<<16).toString(16).slice(1)}),B.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},r=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),r.hex},B.getColor.reset=function(){delete this.start},B.parsePathString=function(t){if(!t)return null;var e=Ot(t);if(e.arr)return Et(e.arr);var i={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},a=[];return B.is(t,M)&&B.is(t[0],M)&&(a=Et(t)),a.length||G(t).replace(at,function(t,e,r){var n=[],o=e.toLowerCase();if(r.replace(ut,function(t,e){e&&n.push(+e)}),"m"==o&&n.length>2&&(a.push([e][U](n.splice(0,2))),o="l",e="m"==e?"l":"L"),"r"==o)a.push([e][U](n));else for(;n.length>=i[o]&&(a.push([e][U](n.splice(0,i[o]))),i[o]););}),a.toString=B._path2string,e.arr=Et(a),a},B.parseTransformString=W(function(t){if(!t)return null;var o=[];return B.is(t,M)&&B.is(t[0],M)&&(o=Et(t)),o.length||G(t).replace(st,function(t,e,r){var n=[];x.call(e);r.replace(ut,function(t,e){e&&n.push(+e)}),o.push([e][U](n))}),o.toString=B._path2string,o});var Ot=function(e){var r=Ot.ps=Ot.ps||{};return r[e]?r[e].sleep=100:r[e]={sleep:100},setTimeout(function(){for(var t in r)r[F](t)&&t!=e&&!--r[t].sleep&&delete r[t]}),r[e]};B.findDotsAtSegment=function(t,e,r,n,o,i,a,s,u){var l=1-u,c=C(l,3),f=C(l,2),d=u*u,p=d*u,h=c*t+3*f*u*r+3*l*u*u*o+p*a,m=c*e+3*f*u*n+3*l*u*u*i+p*s,g=t+2*u*(r-t)+d*(o-2*r+t),v=e+2*u*(n-e)+d*(i-2*n+e),y=r+2*u*(o-r)+d*(a-2*o+r),b=n+2*u*(i-n)+d*(s-2*i+n),_=l*t+u*r,x=l*e+u*n,w=l*o+u*a,S=l*i+u*s,O=90-180*q.atan2(g-y,v-b)/K;return(g>y||v<b)&&(O+=180),{x:h,y:m,m:{x:g,y:v},n:{x:y,y:b},start:{x:_,y:x},end:{x:w,y:S},alpha:O}},B.bezierBBox=function(t,e,r,n,o,i,a,s){B.is(t,"array")||(t=[t,e,r,n,o,i,a,s]);var u=Rt.apply(null,t);return{x:u.min.x,y:u.min.y,x2:u.max.x,y2:u.max.y,width:u.max.x-u.min.x,height:u.max.y-u.min.y}},B.isPointInsideBBox=function(t,e,r){return e>=t.x&&e<=t.x2&&r>=t.y&&r<=t.y2},B.isBBoxIntersect=function(t,e){var r=B.isPointInsideBBox;return r(e,t.x,t.y)||r(e,t.x2,t.y)||r(e,t.x,t.y2)||r(e,t.x2,t.y2)||r(t,e.x,e.y)||r(t,e.x2,e.y)||r(t,e.x,e.y2)||r(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)},B.pathIntersection=function(t,e){return o(t,e)},B.pathIntersectionNumber=function(t,e){return o(t,e,1)},B.isPointInsidePath=function(t,e,r){var n=B.pathBBox(t);return B.isPointInsideBBox(n,e,r)&&o(t,[["M",e,r],["H",n.x2+10]],1)%2==1},B._removedFactory=function(t){return function(){N("raphael.log",null,"Raphaël: you are calling to method “"+t+"” of removed object",t)}};var At=B.pathBBox=function(t){var e=Ot(t);if(e.bbox)return v(e.bbox);if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0};t=Nt(t);for(var r,n=0,o=0,i=[],a=[],s=0,u=t.length;s<u;s++)if(r=t[s],"M"==r[0])n=r[1],o=r[2],i.push(n),a.push(o);else{var l=Rt(n,o,r[1],r[2],r[3],r[4],r[5],r[6]);i=i[U](l.min.x,l.max.x),a=a[U](l.min.y,l.max.y),n=r[5],o=r[6]}var c=T[_](0,i),f=T[_](0,a),d=P[_](0,i),p=P[_](0,a),h=d-c,m=p-f,g={x:c,y:f,x2:d,y2:p,width:h,height:m,cx:c+h/2,cy:f+m/2};return e.bbox=v(g),g},Et=function(t){var e=v(t);return e.toString=B._path2string,e},jt=B._pathToRelative=function(t){var e=Ot(t);if(e.rel)return Et(e.rel);B.is(t,M)&&B.is(t&&t[0],M)||(t=B.parsePathString(t));var r=[],n=0,o=0,i=0,a=0,s=0;"M"==t[0][0]&&(n=t[0][1],o=t[0][2],i=n,a=o,s++,r.push(["M",n,o]));for(var u=s,l=t.length;u<l;u++){var c=r[u]=[],f=t[u];if(f[0]!=x.call(f[0]))switch(c[0]=x.call(f[0]),c[0]){case"a":c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=+(f[6]-n).toFixed(3),c[7]=+(f[7]-o).toFixed(3);break;case"v":c[1]=+(f[1]-o).toFixed(3);break;case"m":i=f[1],a=f[2];default:for(var d=1,p=f.length;d<p;d++)c[d]=+(f[d]-(d%2?n:o)).toFixed(3)}else{c=r[u]=[],"m"==f[0]&&(i=f[1]+n,a=f[2]+o);for(var h=0,m=f.length;h<m;h++)r[u][h]=f[h]}var g=r[u].length;switch(r[u][0]){case"z":n=i,o=a;break;case"h":n+=+r[u][g-1];break;case"v":o+=+r[u][g-1];break;default:n+=+r[u][g-2],o+=+r[u][g-1]}}return r.toString=B._path2string,e.rel=Et(r),r},Pt=B._pathToAbsolute=function(t){var e=Ot(t);if(e.abs)return Et(e.abs);if(B.is(t,M)&&B.is(t&&t[0],M)||(t=B.parsePathString(t)),!t||!t.length)return[["M",0,0]];var r=[],n=0,o=0,i=0,a=0,s=0;"M"==t[0][0]&&(n=+t[0][1],o=+t[0][2],i=n,a=o,s++,r[0]=["M",n,o]);for(var u,l,c=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),f=s,d=t.length;f<d;f++){if(r.push(u=[]),l=t[f],l[0]!=tt.call(l[0]))switch(u[0]=tt.call(l[0]),u[0]){case"A":u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=+(l[6]+n),u[7]=+(l[7]+o);break;case"V":u[1]=+l[1]+o;break;case"H":u[1]=+l[1]+n;break;case"R":for(var p=[n,o][U](l.slice(1)),h=2,m=p.length;h<m;h++)p[h]=+p[h]+n,p[++h]=+p[h]+o;r.pop(),r=r[U](y(p,c));break;case"M":i=+l[1]+n,a=+l[2]+o;default:for(h=1,m=l.length;h<m;h++)u[h]=+l[h]+(h%2?n:o)}else if("R"==l[0])p=[n,o][U](l.slice(1)),r.pop(),r=r[U](y(p,c)),u=["R"][U](l.slice(-2));else for(var g=0,v=l.length;g<v;g++)u[g]=l[g];switch(u[0]){case"Z":n=i,o=a;break;case"H":n=u[1];break;case"V":o=u[1];break;case"M":i=u[u.length-2],a=u[u.length-1];default:n=u[u.length-2],o=u[u.length-1]}}return r.toString=B._path2string,e.abs=Et(r),r},Tt=function(t,e,r,n){return[t,e,r,n,r,n]},Ct=function(t,e,r,n,o,i){var a=1/3,s=2/3;return[a*t+s*r,a*e+s*n,a*o+s*r,a*i+s*n,o,i]},kt=function(t,e,r,n,o,i,a,s,u,l){var c,f=120*K/180,d=K/180*(+o||0),p=[],h=W(function(t,e,r){return{x:t*q.cos(r)-e*q.sin(r),y:t*q.sin(r)+e*q.cos(r)}});if(l)S=l[0],O=l[1],x=l[2],w=l[3];else{c=h(t,e,-d),t=c.x,e=c.y,c=h(s,u,-d),s=c.x,u=c.y;var m=(q.cos(K/180*o),q.sin(K/180*o),(t-s)/2),g=(e-u)/2,v=m*m/(r*r)+g*g/(n*n);v>1&&(v=q.sqrt(v),r*=v,n*=v);var y=r*r,b=n*n,_=(i==a?-1:1)*q.sqrt(Y((y*b-y*g*g-b*m*m)/(y*g*g+b*m*m))),x=_*r*g/n+(t+s)/2,w=_*-n*m/r+(e+u)/2,S=q.asin(((e-w)/n).toFixed(9)),O=q.asin(((u-w)/n).toFixed(9));S=t<x?K-S:S,O=s<x?K-O:O,S<0&&(S=2*K+S),O<0&&(O=2*K+O),a&&S>O&&(S-=2*K),!a&&O>S&&(O-=2*K)}var A=O-S;if(Y(A)>f){var E=O,j=s,P=u;O=S+f*(a&&O>S?1:-1),s=x+r*q.cos(O),u=w+n*q.sin(O),p=kt(s,u,r,n,o,0,a,j,P,[O,E,x,w])}A=O-S;var T=q.cos(S),C=q.sin(S),k=q.cos(O),M=q.sin(O),R=q.tan(A/4),N=4/3*r*R,B=4/3*n*R,I=[t,e],L=[t+N*C,e-B*T],D=[s+N*M,u-B*k],F=[s,u];if(L[0]=2*I[0]-L[0],L[1]=2*I[1]-L[1],l)return[L,D,F][U](p);p=[L,D,F][U](p).join()[V](",");for(var G=[],z=0,H=p.length;z<H;z++)G[z]=z%2?h(p[z-1],p[z],d).y:h(p[z],p[z+1],d).x;return G},Mt=function(t,e,r,n,o,i,a,s,u){var l=1-u;return{x:C(l,3)*t+3*C(l,2)*u*r+3*l*u*u*o+C(u,3)*a,y:C(l,3)*e+3*C(l,2)*u*n+3*l*u*u*i+C(u,3)*s}},Rt=W(function(t,e,r,n,o,i,a,s){var u,l=o-2*r+t-(a-2*o+r),c=2*(r-t)-2*(o-r),f=t-r,d=(-c+q.sqrt(c*c-4*l*f))/2/l,p=(-c-q.sqrt(c*c-4*l*f))/2/l,h=[e,s],m=[t,a];return Y(d)>"1e12"&&(d=.5),Y(p)>"1e12"&&(p=.5),d>0&&d<1&&(u=Mt(t,e,r,n,o,i,a,s,d),m.push(u.x),h.push(u.y)),p>0&&p<1&&(u=Mt(t,e,r,n,o,i,a,s,p),m.push(u.x),h.push(u.y)),l=i-2*n+e-(s-2*i+n),c=2*(n-e)-2*(i-n),f=e-n,d=(-c+q.sqrt(c*c-4*l*f))/2/l,p=(-c-q.sqrt(c*c-4*l*f))/2/l,Y(d)>"1e12"&&(d=.5),Y(p)>"1e12"&&(p=.5),d>0&&d<1&&(u=Mt(t,e,r,n,o,i,a,s,d),m.push(u.x),h.push(u.y)),p>0&&p<1&&(u=Mt(t,e,r,n,o,i,a,s,p),m.push(u.x),h.push(u.y)),{min:{x:T[_](0,m),y:T[_](0,h)},max:{x:P[_](0,m),y:P[_](0,h)}}}),Nt=B._path2curve=W(function(t,e){var r=!e&&Ot(t);if(!e&&r.curve)return Et(r.curve);for(var i=Pt(t),a=e&&Pt(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s=function(t,e,r){var n,o,i={T:1,Q:1};if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in i)&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][U](kt[_](0,[e.x,e.y][U](t.slice(1))));break;case"S":"C"==r||"S"==r?(n=2*e.x-e.bx,o=2*e.y-e.by):(n=e.x,o=e.y),t=["C",n,o][U](t.slice(1));break;case"T":"Q"==r||"T"==r?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"][U](Ct(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][U](Ct(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][U](Tt(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][U](Tt(e.x,e.y,t[1],e.y));break;case"V":t=["C"][U](Tt(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][U](Tt(e.x,e.y,e.X,e.Y))}return t},u=function(t,e){if(t[e].length>7){t[e].shift();for(var r=t[e];r.length;)c[e]="A",a&&(f[e]="A"),t.splice(e++,0,["C"][U](r.splice(0,6)));t.splice(e,1),m=P(i.length,a&&a.length||0)}},l=function(t,e,r,n,o){t&&e&&"M"==t[o][0]&&"M"!=e[o][0]&&(e.splice(o,0,["M",n.x,n.y]),r.bx=0,r.by=0,r.x=t[o][1],r.y=t[o][2],m=P(i.length,a&&a.length||0))},c=[],f=[],d="",p="",h=0,m=P(i.length,a&&a.length||0);h<m;h++){i[h]&&(d=i[h][0]),"C"!=d&&(c[h]=d,h&&(p=c[h-1])),i[h]=s(i[h],n,p),"A"!=c[h]&&"C"==d&&(c[h]="C"),u(i,h),a&&(a[h]&&(d=a[h][0]),"C"!=d&&(f[h]=d,h&&(p=f[h-1])),a[h]=s(a[h],o,p),"A"!=f[h]&&"C"==d&&(f[h]="C"),u(a,h)),l(i,a,n,o,h),l(a,i,o,n,h);var g=i[h],v=a&&a[h],y=g.length,b=a&&v.length;n.x=g[y-2],n.y=g[y-1],n.bx=Q(g[y-4])||n.x,n.by=Q(g[y-3])||n.y,o.bx=a&&(Q(v[b-4])||o.x),o.by=a&&(Q(v[b-3])||o.y),o.x=a&&v[b-2],o.y=a&&v[b-1]}return a||(r.curve=Et(i)),a?[i,a]:i},null,Et),Bt=(B._parseDots=W(function(t){for(var e=[],r=0,n=t.length;r<n;r++){var o={},i=t[r].match(/^([^:]*):?([\d\.]*)/);if(o.color=B.getRGB(i[1]),o.color.error)return null;o.opacity=o.color.opacity,o.color=o.color.hex,i[2]&&(o.offset=i[2]+"%"),e.push(o)}for(r=1,n=e.length-1;r<n;r++)if(!e[r].offset){for(var a=Q(e[r-1].offset||0),s=0,u=r+1;u<n;u++)if(e[u].offset){s=e[u].offset;break}s||(s=100,u=n),s=Q(s);for(var l=(s-a)/(u-r+1);r<u;r++)a+=l,e[r].offset=a+"%"}return e}),B._tear=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)}),It=(B._tofront=function(t,e){e.top!==t&&(Bt(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},B._toback=function(t,e){e.bottom!==t&&(Bt(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},B._insertafter=function(t,e,r){Bt(t,r),e==r.top&&(r.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},B._insertbefore=function(t,e,r){Bt(t,r),e==r.bottom&&(r.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},B.toMatrix=function(t,e){var r=At(t),n={_:{transform:O},getBBox:function(){return r}};return Lt(n,e),n.matrix}),Lt=(B.transformPath=function(t,e){return mt(t,It(t,e))},B._extractTransform=function(t,e){if(null==e)return t._.transform;e=G(e).replace(/\.{3}|\u2026/g,t._.transform||O);var r=B.parseTransformString(e),n=0,o=0,i=0,a=1,s=1,u=t._,l=new I;if(u.transform=r||[],r)for(var c=0,f=r.length;c<f;c++){var d,p,h,m,g,v=r[c],y=v.length,b=G(v[0]).toLowerCase(),_=v[0]!=b,x=_?l.invert():0;"t"==b&&3==y?_?(d=x.x(0,0),p=x.y(0,0),h=x.x(v[1],v[2]),m=x.y(v[1],v[2]),l.translate(h-d,m-p)):l.translate(v[1],v[2]):"r"==b?2==y?(g=g||t.getBBox(1),l.rotate(v[1],g.x+g.width/2,g.y+g.height/2),n+=v[1]):4==y&&(_?(h=x.x(v[2],v[3]),m=x.y(v[2],v[3]),l.rotate(v[1],h,m)):l.rotate(v[1],v[2],v[3]),n+=v[1]):"s"==b?2==y||3==y?(g=g||t.getBBox(1),l.scale(v[1],v[y-1],g.x+g.width/2,g.y+g.height/2),a*=v[1],s*=v[y-1]):5==y&&(_?(h=x.x(v[3],v[4]),m=x.y(v[3],v[4]),l.scale(v[1],v[2],h,m)):l.scale(v[1],v[2],v[3],v[4]),a*=v[1],s*=v[2]):"m"==b&&7==y&&l.add(v[1],v[2],v[3],v[4],v[5],v[6]),u.dirtyT=1,t.matrix=l}t.matrix=l,u.sx=a,u.sy=s,u.deg=n,u.dx=o=l.e,u.dy=i=l.f,1==a&&1==s&&!n&&u.bbox?(u.bbox.x+=+o,u.bbox.y+=+i):u.dirtyT=1}),Dt=function(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}},Ft=B._equaliseTransform=function(t,e){e=G(e).replace(/\.{3}|\u2026/g,t),t=B.parseTransformString(t)||[],e=B.parseTransformString(e)||[];for(var r,n,o,i,a=P(t.length,e.length),s=[],u=[],l=0;l<a;l++){if(o=t[l]||Dt(e[l]),i=e[l]||Dt(o),o[0]!=i[0]||"r"==o[0].toLowerCase()&&(o[2]!=i[2]||o[3]!=i[3])||"s"==o[0].toLowerCase()&&(o[3]!=i[3]||o[4]!=i[4]))return;for(s[l]=[],u[l]=[],r=0,n=P(o.length,i.length);r<n;r++)r in o&&(s[l][r]=o[r]),r in i&&(u[l][r]=i[r])}return{from:s,to:u}};B._getContainer=function(t,e,r,n){var o;if(null!=(o=null!=n||B.is(t,"object")?t:h.doc.getElementById(t)))return o.tagName?null==e?{container:o,width:o.style.pixelWidth||o.offsetWidth,height:o.style.pixelHeight||o.offsetHeight}:{container:o,width:e,height:r}:{container:1,x:t,y:e,width:r,height:n}},B.pathToRelative=jt,B._engine={},B.path2curve=Nt,B.matrix=function(t,e,r,n,o,i){return new I(t,e,r,n,o,i)},function(t){function o(t){return t[0]*t[0]+t[1]*t[1]}function i(t){var e=q.sqrt(o(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}t.add=function(t,e,r,n,o,i){var a,s,u,l,c=[[],[],[]],f=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],d=[[t,r,o],[e,n,i],[0,0,1]];for(t&&t instanceof I&&(d=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),a=0;a<3;a++)for(s=0;s<3;s++){for(l=0,u=0;u<3;u++)l+=f[a][u]*d[u][s];c[a][s]=l}this.a=c[0][0],this.b=c[1][0],this.c=c[0][1],this.d=c[1][1],this.e=c[0][2],this.f=c[1][2]},t.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new I(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},t.clone=function(){return new I(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(t,e){this.add(1,0,0,1,t,e)},t.scale=function(t,e,r,n){null==e&&(e=t),(r||n)&&this.add(1,0,0,1,r,n),this.add(t,0,0,e,0,0),(r||n)&&this.add(1,0,0,1,-r,-n)},t.rotate=function(t,e,r){t=B.rad(t),e=e||0,r=r||0;var n=+q.cos(t).toFixed(9),o=+q.sin(t).toFixed(9);this.add(n,o,-o,n,e,r),this.add(1,0,0,1,-e,-r)},t.x=function(t,e){return t*this.a+e*this.c+this.e},t.y=function(t,e){return t*this.b+e*this.d+this.f},t.get=function(t){return+this[G.fromCharCode(97+t)].toFixed(4)},t.toString=function(){return B.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},t.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.split=function(){var t={};t.dx=this.e,t.dy=this.f;var e=[[this.a,this.c],[this.b,this.d]];t.scalex=q.sqrt(o(e[0])),i(e[0]),t.shear=e[0][0]*e[1][0]+e[0][1]*e[1][1],e[1]=[e[1][0]-e[0][0]*t.shear,e[1][1]-e[0][1]*t.shear],t.scaley=q.sqrt(o(e[1])),i(e[1]),t.shear/=t.scaley;var r=-e[0][1],n=e[1][1];return n<0?(t.rotate=B.deg(q.acos(n)),r<0&&(t.rotate=360-t.rotate)):t.rotate=B.deg(q.asin(r)),t.isSimple=!(+t.shear.toFixed(9)||t.scalex.toFixed(9)!=t.scaley.toFixed(9)&&t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},t.toTransformString=function(t){var e=t||this[V]();return e.isSimple?(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[e.dx,e.dy]:O)+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:O)+(e.rotate?"r"+[e.rotate,0,0]:O)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(I.prototype);for(var Gt=function(){this.returnValue=!1},zt=function(){return this.originalEvent.preventDefault()},Ht=function(){this.cancelBubble=!0},Wt=function(){return this.originalEvent.stopPropagation()},Ut=function(t){var e=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,r=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft;return{x:t.clientX+r,y:t.clientY+e}},Vt=function(){return h.doc.addEventListener?function(i,t,a,s){var e=function(t){var e=Ut(t);return a.call(s,t,e.x,e.y)};if(i.addEventListener(t,e,!1),m&&g[t]){var r=function(t){for(var e=Ut(t),r=t,n=0,o=t.targetTouches&&t.targetTouches.length;n<o;n++)if(t.targetTouches[n].target==i){t=t.targetTouches[n],t.originalEvent=r,t.preventDefault=zt,t.stopPropagation=Wt;break}return a.call(s,t,e.x,e.y)};i.addEventListener(g[t],r,!1)}return function(){return i.removeEventListener(t,e,!1),m&&g[t]&&i.removeEventListener(g[t],r,!1),!0}}:h.doc.attachEvent?function(t,e,i,a){var r=function(t){t=t||h.win.event;var e=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,r=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft,n=t.clientX+r,o=t.clientY+e;return t.preventDefault=t.preventDefault||Gt,t.stopPropagation=t.stopPropagation||Ht,i.call(a,t,n,o)};return t.attachEvent("on"+e,r),function(){return t.detachEvent("on"+e,r),!0}}:void 0}(),qt=[],Yt=function(t){for(var e,r=t.clientX,n=t.clientY,o=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,i=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft,a=qt.length;a--;){if(e=qt[a],m&&t.touches){for(var s,u=t.touches.length;u--;)if(s=t.touches[u],s.identifier==e.el._drag.id){r=s.clientX,n=s.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();var l,c=e.el.node,f=c.nextSibling,d=c.parentNode,p=c.style.display;h.win.opera&&d.removeChild(c),c.style.display="none",l=e.el.paper.getElementByPoint(r,n),c.style.display=p,h.win.opera&&(f?d.insertBefore(c,f):d.appendChild(c)),l&&N("raphael.drag.over."+e.el.id,e.el,l),r+=i,n+=o,N("raphael.drag.move."+e.el.id,e.move_scope||e.el,r-e.el._drag.x,n-e.el._drag.y,r,n,t)}},Kt=function(t){B.unmousemove(Yt).unmouseup(Kt);for(var e,r=qt.length;r--;)e=qt[r],e.el._drag={},N("raphael.drag.end."+e.el.id,e.end_scope||e.start_scope||e.move_scope||e.el,t);qt=[]},$t=B.el={},Xt=p.length;Xt--;)!function(n){B[n]=$t[n]=function(t,e){return B.is(t,"function")&&(this.events=this.events||[],this.events.push({name:n,f:t,unbind:Vt(this.shape||this.node||h.doc,n,t,e||this)})),this},B["un"+n]=$t["un"+n]=function(t){for(var e=this.events||[],r=e.length;r--;)e[r].name!=n||!B.is(t,"undefined")&&e[r].f!=t||(e[r].unbind(),e.splice(r,1),!e.length&&delete this.events);return this}}(p[Xt]);$t.data=function(t,e){var r=lt[this.id]=lt[this.id]||{};if(0==arguments.length)return r;if(1==arguments.length){if(B.is(t,"object")){for(var n in t)t[F](n)&&this.data(n,t[n]);return this}return N("raphael.data.get."+this.id,this,r[t],t),r[t]}return r[t]=e,N("raphael.data.set."+this.id,this,e,t),this},$t.removeData=function(t){return null==t?lt[this.id]={}:lt[this.id]&&delete lt[this.id][t],this},$t.getData=function(){return v(lt[this.id]||{})},$t.hover=function(t,e,r,n){return this.mouseover(t,r).mouseout(e,n||r)},$t.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var Zt=[];$t.drag=function(s,u,l,c,f,d){function t(t){(t.originalEvent||t).preventDefault();var e=t.clientX,r=t.clientY,n=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,o=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft;if(this._drag.id=t.identifier,m&&t.touches)for(var i,a=t.touches.length;a--;)if(i=t.touches[a],this._drag.id=i.identifier,i.identifier==this._drag.id){e=i.clientX,r=i.clientY;break}this._drag.x=e+o,this._drag.y=r+n,!qt.length&&B.mousemove(Yt).mouseup(Kt),qt.push({el:this,move_scope:c,start_scope:f,end_scope:d}),u&&N.on("raphael.drag.start."+this.id,u),s&&N.on("raphael.drag.move."+this.id,s),l&&N.on("raphael.drag.end."+this.id,l),N("raphael.drag.start."+this.id,f||c||this,t.clientX+o,t.clientY+n,t)}return this._drag={},Zt.push({el:this,start:t}),this.mousedown(t),this},$t.onDragOver=function(t){t?N.on("raphael.drag.over."+this.id,t):N.unbind("raphael.drag.over."+this.id)},$t.undrag=function(){for(var t=Zt.length;t--;)Zt[t].el==this&&(this.unmousedown(Zt[t].start),Zt.splice(t,1),N.unbind("raphael.drag.*."+this.id));!Zt.length&&B.unmousemove(Yt).unmouseup(Kt),qt=[]},e.circle=function(t,e,r){var n=B._engine.circle(this,t||0,e||0,r||0);return this.__set__&&this.__set__.push(n),n},e.rect=function(t,e,r,n,o){var i=B._engine.rect(this,t||0,e||0,r||0,n||0,o||0);return this.__set__&&this.__set__.push(i),i},e.ellipse=function(t,e,r,n){var o=B._engine.ellipse(this,t||0,e||0,r||0,n||0);return this.__set__&&this.__set__.push(o),o},e.path=function(t){t&&!B.is(t,k)&&!B.is(t[0],M)&&(t+=O);var e=B._engine.path(B.format[_](B,arguments),this);return this.__set__&&this.__set__.push(e),e},e.image=function(t,e,r,n,o){var i=B._engine.image(this,t||"about:blank",e||0,r||0,n||0,o||0);return this.__set__&&this.__set__.push(i),i},e.text=function(t,e,r){var n=B._engine.text(this,t||0,e||0,G(r));return this.__set__&&this.__set__.push(n),n},e.set=function(t){!B.is(t,"array")&&(t=Array.prototype.splice.call(arguments,0,arguments.length));var e=new le(t);return this.__set__&&this.__set__.push(e),e.paper=this,e.type="set",e},e.setStart=function(t){this.__set__=t||this.set()},e.setFinish=function(t){var e=this.__set__;return delete this.__set__,e},e.getSize=function(){var t=this.canvas.parentNode;return{width:t.offsetWidth,height:t.offsetHeight}},e.setSize=function(t,e){return B._engine.setSize.call(this,t,e)},e.setViewBox=function(t,e,r,n,o){return B._engine.setViewBox.call(this,t,e,r,n,o)},e.top=e.bottom=null,e.raphael=B;var Qt=function(t){var e=t.getBoundingClientRect(),r=t.ownerDocument,n=r.body,o=r.documentElement,i=o.clientTop||n.clientTop||0,a=o.clientLeft||n.clientLeft||0;return{y:e.top+(h.win.pageYOffset||o.scrollTop||n.scrollTop)-i,x:e.left+(h.win.pageXOffset||o.scrollLeft||n.scrollLeft)-a}};e.getElementByPoint=function(t,e){var r=this,n=r.canvas,o=h.doc.elementFromPoint(t,e);if(h.win.opera&&"svg"==o.tagName){var i=Qt(n),a=n.createSVGRect();a.x=t-i.x,a.y=e-i.y,a.width=a.height=1;var s=n.getIntersectionList(a,null);s.length&&(o=s[s.length-1])}if(!o)return null;for(;o.parentNode&&o!=n.parentNode&&!o.raphael;)o=o.parentNode;return o==r.canvas.parentNode&&(o=n),o=o&&o.raphael?r.getById(o.raphaelid):null},e.getElementsByBBox=function(e){var r=this.set();return this.forEach(function(t){B.isBBoxIntersect(t.getBBox(),e)&&r.push(t)}),r},e.getById=function(t){for(var e=this.bottom;e;){if(e.id==t)return e;e=e.next}return null},e.forEach=function(t,e){for(var r=this.bottom;r;){if(!1===t.call(e,r))return this;r=r.next}return this},e.getElementsByPoint=function(e,r){var n=this.set();return this.forEach(function(t){t.isPointInside(e,r)&&n.push(t)}),n},$t.isPointInside=function(t,e){var r=this.realPath=ht[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(r=B.transformPath(r,this.attr("transform"))),B.isPointInsidePath(r,t,e)},$t.getBBox=function(t){if(this.removed)return{};var e=this._;return t?(!e.dirty&&e.bboxwt||(this.realPath=ht[this.type](this),e.bboxwt=At(this.realPath),e.bboxwt.toString=r,e.dirty=0),e.bboxwt):((e.dirty||e.dirtyT||!e.bbox)&&(!e.dirty&&this.realPath||(e.bboxwt=0,this.realPath=ht[this.type](this)),e.bbox=At(mt(this.realPath,this.matrix)),e.bbox.toString=r,e.dirty=e.dirtyT=0),e.bbox)},$t.clone=function(){if(this.removed)return null;var t=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(t),t},$t.glow=function(t){if("text"==this.type)return null;t=t||{};var e={width:(t.width||10)+(+this.attr("stroke-width")||1),fill:t.fill||!1,opacity:null==t.opacity?.5:t.opacity,offsetx:t.offsetx||0,offsety:t.offsety||0,color:t.color||"#000"},r=e.width/2,n=this.paper,o=n.set(),i=this.realPath||ht[this.type](this);i=this.matrix?mt(i,this.matrix):i;for(var a=1;a<r+1;a++)o.push(n.path(i).attr({stroke:e.color,fill:e.fill?e.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(e.width/r*a).toFixed(3),opacity:+(e.opacity/r).toFixed(3)}));return o.insertBefore(this).translate(e.offsetx,e.offsety)};var Jt=function(t,e,r,n,o,i,a,s,u){return null==u?A(t,e,r,n,o,i,a,s):B.findDotsAtSegment(t,e,r,n,o,i,a,s,c(t,e,r,n,o,i,a,s,u))},te=function(p,h){return function(t,e,r){t=Nt(t);for(var n,o,i,a,s,u="",l={},c=0,f=0,d=t.length;f<d;f++){if(i=t[f],"M"==i[0])n=+i[1],o=+i[2];else{if(a=Jt(n,o,i[1],i[2],i[3],i[4],i[5],i[6]),c+a>e){if(h&&!l.start){if(s=Jt(n,o,i[1],i[2],i[3],i[4],i[5],i[6],e-c),u+=["C"+s.start.x,s.start.y,s.m.x,s.m.y,s.x,s.y],r)return u;l.start=u,u=["M"+s.x,s.y+"C"+s.n.x,s.n.y,s.end.x,s.end.y,i[5],i[6]].join(),c+=a,n=+i[5],o=+i[6];continue}if(!p&&!h)return s=Jt(n,o,i[1],i[2],i[3],i[4],i[5],i[6],e-c),{x:s.x,y:s.y,alpha:s.alpha}}c+=a,n=+i[5],o=+i[6]}u+=i.shift()+i}return l.end=u,s=p?c:h?l:B.findDotsAtSegment(n,o,i[0],i[1],i[2],i[3],i[4],i[5],1),s.alpha&&(s={x:s.x,y:s.y,alpha:s.alpha}),s}},ee=te(1),re=te(),ne=te(0,1);B.getTotalLength=ee,B.getPointAtLength=re,B.getSubpath=function(t,e,r){if(this.getTotalLength(t)-r<1e-6)return ne(t,e).end;var n=ne(t,r,1);return e?ne(n,e).end:n},$t.getTotalLength=function(){var t=this.getPath();if(t)return this.node.getTotalLength?this.node.getTotalLength():ee(t)},$t.getPointAtLength=function(t){var e=this.getPath();if(e)return re(e,t)},$t.getPath=function(){var t,e=B._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return e&&(t=e(this)),t},$t.getSubpath=function(t,e){var r=this.getPath();if(r)return B.getSubpath(r,t,e)};var oe=B.easing_formulas={linear:function(t){return t},"<":function(t){return C(t,1.7)},">":function(t){return C(t,.48)},"<>":function(t){var e=.48-t/1.04,r=q.sqrt(.1734+e*e),n=r-e,o=C(Y(n),1/3)*(n<0?-1:1),i=-r-e,a=C(Y(i),1/3)*(i<0?-1:1),s=o+a+.5;return 3*(1-s)*s*s+s*s*s},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){return t==!!t?t:C(2,-10*t)*q.sin(2*K*(t-.075)/.3)+1},bounce:function(t){var e,r=7.5625,n=2.75;return t<1/n?e=r*t*t:t<2/n?(t-=1.5/n,e=r*t*t+.75):t<2.5/n?(t-=2.25/n,e=r*t*t+.9375):(t-=2.625/n,e=r*t*t+.984375),e}};oe.easeIn=oe["ease-in"]=oe["<"],oe.easeOut=oe["ease-out"]=oe[">"],oe.easeInOut=oe["ease-in-out"]=oe["<>"],oe["back-in"]=oe.backIn,oe["back-out"]=oe.backOut;var ie=[],ae=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,16)},se=function(){for(var t=+new Date,e=0;e<ie.length;e++){var r=ie[e];if(!r.el.removed&&!r.paused){var n,o,i=t-r.start,a=r.ms,s=r.easing,u=r.from,l=r.diff,c=r.to,f=(r.t,r.el),d={},p={};if(r.initstatus?(i=(r.initstatus*r.anim.top-r.prev)/(r.percent-r.prev)*a,r.status=r.initstatus,delete r.initstatus,r.stop&&ie.splice(e--,1)):r.status=(r.prev+(r.percent-r.prev)*(i/a))/r.anim.top,!(i<0))if(i<a){var h=s(i/a);for(var m in u)if(u[F](m)){switch(rt[m]){case z:n=+u[m]+h*a*l[m];break;case"colour":n="rgb("+[ue(Z(u[m].r+h*a*l[m].r)),ue(Z(u[m].g+h*a*l[m].g)),ue(Z(u[m].b+h*a*l[m].b))].join(",")+")";break;case"path":n=[];for(var g=0,v=u[m].length;g<v;g++){n[g]=[u[m][g][0]];for(var y=1,b=u[m][g].length;y<b;y++)n[g][y]=+u[m][g][y]+h*a*l[m][g][y];n[g]=n[g].join(j)}n=n.join(j);break;case"transform":if(l[m].real)for(n=[],g=0,v=u[m].length;g<v;g++)for(n[g]=[u[m][g][0]],y=1,b=u[m][g].length;y<b;y++)n[g][y]=u[m][g][y]+h*a*l[m][g][y];else{var _=function(t){return+u[m][t]+h*a*l[m][t]};n=[["m",_(0),_(1),_(2),_(3),_(4),_(5)]]}break;case"csv":if("clip-rect"==m)for(n=[],g=4;g--;)n[g]=+u[m][g]+h*a*l[m][g];break;default:var x=[][U](u[m]);for(n=[],g=f.paper.customAttributes[m].length;g--;)n[g]=+x[g]+h*a*l[m][g]}d[m]=n}f.attr(d),function(t,e,r){setTimeout(function(){N("raphael.anim.frame."+t,e,r)})}(f.id,f,r.anim)}else{if(function(t,e,r){setTimeout(function(){N("raphael.anim.frame."+e.id,e,r),N("raphael.anim.finish."+e.id,e,r),B.is(t,"function")&&t.call(e)})}(r.callback,f,r.anim),f.attr(c),ie.splice(e--,1),r.repeat>1&&!r.next){for(o in c)c[F](o)&&(p[o]=r.totalOrigin[o]);r.el.attr(p),w(r.anim,r.el,r.anim.percents[0],null,r.totalOrigin,r.repeat-1)}r.next&&!r.stop&&w(r.anim,r.el,r.next,null,r.totalOrigin,r.repeat)}}}ie.length&&ae(se)},ue=function(t){return t>255?255:t<0?0:t};$t.animateWith=function(t,e,r,n,o,i){var a=this;if(a.removed)return i&&i.call(a),a;var s=r instanceof f?r:B.animation(r,n,o,i);w(s,a,s.percents[0],null,a.attr());for(var u=0,l=ie.length;u<l;u++)if(ie[u].anim==e&&ie[u].el==t){ie[l-1].start=ie[u].start;break}return a},$t.onAnimation=function(t){return t?N.on("raphael.anim.frame."+this.id,t):N.unbind("raphael.anim.frame."+this.id),this},f.prototype.delay=function(t){var e=new f(this.anim,this.ms);return e.times=this.times,e.del=+t||0,e},f.prototype.repeat=function(t){var e=new f(this.anim,this.ms);return e.del=this.del,e.times=q.floor(P(t,0))||1,e},B.animation=function(t,e,r,n){if(t instanceof f)return t;!B.is(r,"function")&&r||(n=n||r||null,r=null),t=Object(t),e=+e||0;var o,i,a={};for(i in t)t[F](i)&&Q(i)!=i&&Q(i)+"%"!=i&&(o=!0,a[i]=t[i]);if(o)return r&&(a.easing=r),n&&(a.callback=n),new f({100:a},e);if(n){var s=0;for(var u in t){var l=J(u);t[F](u)&&l>s&&(s=l)}s+="%",!t[s].callback&&(t[s].callback=n)}return new f(t,e)},$t.animate=function(t,e,r,n){var o=this;if(o.removed)return n&&n.call(o),o;var i=t instanceof f?t:B.animation(t,e,r,n);return w(i,o,i.percents[0],null,o.attr()),o},$t.setTime=function(t,e){return t&&null!=e&&this.status(t,T(e,t.ms)/t.ms),this},$t.status=function(t,e){var r,n,o=[],i=0;if(null!=e)return w(t,this,-1,T(e,1)),this;for(r=ie.length;i<r;i++)if(n=ie[i],n.el.id==this.id&&(!t||n.anim==t)){if(t)return n.status;o.push({anim:n.anim,status:n.status})}return t?0:o},$t.pause=function(t){for(var e=0;e<ie.length;e++)ie[e].el.id!=this.id||t&&ie[e].anim!=t||!1!==N("raphael.anim.pause."+this.id,this,ie[e].anim)&&(ie[e].paused=!0);return this},$t.resume=function(t){for(var e=0;e<ie.length;e++)if(ie[e].el.id==this.id&&(!t||ie[e].anim==t)){var r=ie[e];!1!==N("raphael.anim.resume."+this.id,this,r.anim)&&(delete r.paused,this.status(r.anim,r.status))}return this},$t.stop=function(t){for(var e=0;e<ie.length;e++)ie[e].el.id!=this.id||t&&ie[e].anim!=t||!1!==N("raphael.anim.stop."+this.id,this,ie[e].anim)&&ie.splice(e--,1);return this},N.on("raphael.remove",t),N.on("raphael.clear",t),$t.toString=function(){return"Raphaël’s object"};var le=function(t){if(this.items=[],this.length=0,this.type="set",t)for(var e=0,r=t.length;e<r;e++)!t[e]||t[e].constructor!=$t.constructor&&t[e].constructor!=le||(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},ce=le.prototype;ce.push=function(){for(var t,e,r=0,n=arguments.length;r<n;r++)!(t=arguments[r])||t.constructor!=$t.constructor&&t.constructor!=le||(e=this.items.length,this[e]=this.items[e]=t,this.length++);return this},ce.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},ce.forEach=function(t,e){for(var r=0,n=this.items.length;r<n;r++)if(!1===t.call(e,this.items[r],r))return this;return this};for(var fe in $t)$t[F](fe)&&(ce[fe]=function(r){return function(){var e=arguments;return this.forEach(function(t){t[r][_](t,e)})}}(fe));return ce.attr=function(t,e){if(t&&B.is(t,M)&&B.is(t[0],"object"))for(var r=0,n=t.length;r<n;r++)this.items[r].attr(t[r]);else for(var o=0,i=this.items.length;o<i;o++)this.items[o].attr(t,e);return this},ce.clear=function(){for(;this.length;)this.pop()},ce.splice=function(t,e,r){t=t<0?P(this.length+t,0):t,e=P(0,T(this.length-t,e));var n,o=[],i=[],a=[];for(n=2;n<arguments.length;n++)a.push(arguments[n]);for(n=0;n<e;n++)i.push(this[t+n]);for(;n<this.length-t;n++)o.push(this[t+n]);var s=a.length;for(n=0;n<s+o.length;n++)this.items[t+n]=this[t+n]=n<s?a[n]:o[n-s];for(n=this.items.length=this.length-=e-s;this[n];)delete this[n++];return new le(i)},ce.exclude=function(t){for(var e=0,r=this.length;e<r;e++)if(this[e]==t)return this.splice(e,1),!0},ce.animate=function(t,e,r,n){(B.is(r,"function")||!r)&&(n=r||null);var o,i,a=this.items.length,s=a,u=this;if(!a)return this;n&&(i=function(){!--a&&n.call(u)}),r=B.is(r,k)?r:i;var l=B.animation(t,e,r,i);for(o=this.items[--s].animate(l);s--;)this.items[s]&&!this.items[s].removed&&this.items[s].animateWith(o,l,l),this.items[s]&&!this.items[s].removed||a--;return this},ce.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},ce.getBBox=function(){for(var t=[],e=[],r=[],n=[],o=this.items.length;o--;)if(!this.items[o].removed){var i=this.items[o].getBBox();t.push(i.x),e.push(i.y),r.push(i.x+i.width),n.push(i.y+i.height)}return t=T[_](0,t),e=T[_](0,e),r=P[_](0,r),n=P[_](0,n),{x:t,y:e,x2:r,y2:n,width:r-t,height:n-e}},ce.clone=function(t){t=this.paper.set();for(var e=0,r=this.items.length;e<r;e++)t.push(this.items[e].clone());return t},ce.toString=function(){return"Raphaël‘s set"},ce.glow=function(n){var o=this.paper.set();return this.forEach(function(t,e){var r=t.glow(n);null!=r&&r.forEach(function(t,e){o.push(t)})}),o},ce.isPointInside=function(e,r){var n=!1;return this.forEach(function(t){if(t.isPointInside(e,r))return n=!0,!1}),n},B.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},r=t.face["font-family"];for(var n in t.face)t.face[F](n)&&(e.face[n]=t.face[n]);if(this.fonts[r]?this.fonts[r].push(e):this.fonts[r]=[e],!t.svg){e.face["units-per-em"]=J(t.face["units-per-em"],10);for(var o in t.glyphs)if(t.glyphs[F](o)){var i=t.glyphs[o];if(e.glyphs[o]={w:i.w,k:{},d:i.d&&"M"+i.d.replace(/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},i.k)for(var a in i.k)i[F](a)&&(e.glyphs[o].k[a]=i.k[a])}}return t},e.getFont=function(t,e,r,n){if(n=n||"normal",r=r||"normal",e=+e||{normal:400,bold:700,lighter:300,bolder:800}[e]||400,B.fonts){var o=B.fonts[t];if(!o){var i=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,O)+"(\\s|$)","i");for(var a in B.fonts)if(B.fonts[F](a)&&i.test(a)){o=B.fonts[a];break}}var s;if(o)for(var u=0,l=o.length;u<l&&(s=o[u],s.face["font-weight"]!=e||s.face["font-style"]!=r&&s.face["font-style"]||s.face["font-stretch"]!=n);u++);return s}},e.print=function(t,e,r,n,o,i,a,s){i=i||"middle",a=P(T(a||0,1),-1),s=P(T(s||1,3),1);var u,l=G(r)[V](O),c=0,f=0,d=O;if(B.is(n,"string")&&(n=this.getFont(n)),n){u=(o||16)/n.face["units-per-em"];for(var p=n.face.bbox[V](D),h=+p[0],m=p[3]-p[1],g=0,v=+p[1]+("baseline"==i?m+ +n.face.descent:m/2),y=0,b=l.length;y<b;y++){if("\n"==l[y])c=0,x=0,f=0,g+=m*s;else{var _=f&&n.glyphs[l[y-1]]||{},x=n.glyphs[l[y]];c+=f?(_.w||n.w)+(_.k&&_.k[l[y]]||0)+n.w*a:0,f=1}x&&x.d&&(d+=B.transformPath(x.d,["t",c*u,g*u,"s",u,u,h,v,"t",(t-h)/u,(e-v)/u]))}}return this.path(d).attr({fill:"#000",stroke:"none"})},e.add=function(t){if(B.is(t,"array"))for(var e,r=this.set(),n=0,o=t.length;n<o;n++)e=t[n]||{},i[F](e.type)&&r.push(this[e.type]().attr(e));return r},B.format=function(t,e){var r=B.is(e,M)?[0][U](e):arguments;return t&&B.is(t,k)&&r.length-1&&(t=t.replace(a,function(t,e){return null==r[++e]?O:r[e]})),t||O},B.fullfill=function(){var e=/\{([^\}]+)\}/g,n=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,o=function(t,e,r){var i=r;return e.replace(n,function(t,e,r,n,o){e=e||n,i&&(e in i&&(i=i[e]),"function"==typeof i&&o&&(i=i()))}),i=(null==i||i==r?t:i)+""};return function(t,r){return String(t).replace(e,function(t,e){return o(t,e,r)})}}(),B.ninja=function(){if(s.was)h.win.Raphael=s.is;else{window.Raphael=void 0;try{delete window.Raphael}catch(t){}}return B},B.st=ce,N.on("raphael.DOMload",function(){n=!0}),function(t,e,r){function n(){/ in/.test(t.readyState)?setTimeout(n,9):B.eve("raphael.DOMload")}null==t.readyState&&t.addEventListener&&(t.addEventListener(e,r=function(){t.removeEventListener(e,r,!1),t.readyState="complete"},!1),t.readyState="loading"),n()}(document,"DOMContentLoaded"),B}.apply(e,n))&&(t.exports=o)},function(n,o,t){var i,a;!function(t){var p,h,e="0.5.0",d="hasOwnProperty",m=/ [\.\ / ] /,g=/\s*,\s*/,v=function(t,e){return t-e},y={n:{}},b=function(){for(var t=0,e=this.length;t<e;t++)if(void 0!==this[t])return this[t]},_=function(){for(var t=this.length;--t;)if(void 0!==this[t])return this[t]},r=Object.prototype.toString,x=String,w=Array.isArray||function(t){return t instanceof Array||"[object Array]"==r.call(t)};eve=function(t,e){var r,n=h,o=Array.prototype.slice.call(arguments,2),i=eve.listeners(t),a=0,s=[],u={},l=[],c=p;l.firstDefined=b,l.lastDefined=_,p=t,h=0;for(var f=0,d=i.length;f<d;f++)"zIndex"in i[f]&&(s.push(i[f].zIndex),i[f].zIndex<0&&(u[i[f].zIndex]=i[f]));for(s.sort(v);s[a]<0;)if(r=u[s[a++]],l.push(r.apply(e,o)),h)return h=n,l;for(f=0;f<d;f++)if("zIndex"in(r=i[f]))if(r.zIndex==s[a]){if(l.push(r.apply(e,o)),h)break;do{if(a++,r=u[s[a]],r&&l.push(r.apply(e,o)),h)break}while(r)}else u[r.zIndex]=r;else if(l.push(r.apply(e,o)),h)break;return h=n,p=c,l},eve._events=y,eve.listeners=function(t){var e,r,n,o,i,a,s,u,l=w(t)?t:t.split(m),c=y,f=[c],d=[];for(o=0,i=l.length;o<i;o++){for(u=[],a=0,s=f.length;a<s;a++)for(c=f[a].n,r=[c[l[o]],c["*"]],n=2;n--;)(e=r[n])&&(u.push(e),d=d.concat(e.f||[]));f=u}return d},eve.separator=function(t){t?(t=x(t).replace(/(?=[\.\^\]\[\-])/g,"\\"),t="["+t+"]",m=new RegExp(t)):m=/[\.\/]/},eve.on=function(t,a){if("function"!=typeof a)return function(){};for(var e=w(t)?w(t[0])?t:[t]:x(t).split(g),r=0,n=e.length;r<n;r++)!function(t){for(var e,r=w(t)?t:x(t).split(m),n=y,o=0,i=r.length;o<i;o++)n=n.n,n=n.hasOwnProperty(r[o])&&n[r[o]]||(n[r[o]]={n:{}});for(n.f=n.f||[],o=0,i=n.f.length;o<i;o++)if(n.f[o]==a){e=!0;break}!e&&n.f.push(a)}(e[r]);return function(t){+t==+t&&(a.zIndex=+t)}},eve.f=function(t){var e=[].slice.call(arguments,1);return function(){eve.apply(null,[t,null].concat(e).concat([].slice.call(arguments,0)))}},eve.stop=function(){h=1},eve.nt=function(t){var e=w(p)?p.join("."):p;return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(e):e},eve.nts=function(){return w(p)?p:p.split(m)},eve.off=eve.unbind=function(t,e){if(!t)return void(eve._events=y={n:{}});var r=w(t)?w(t[0])?t:[t]:x(t).split(g);if(r.length>1)for(var n=0,o=r.length;n<o;n++)eve.off(r[n],e);else{r=w(t)?t:x(t).split(m);var i,a,s,n,o,u,l,c=[y];for(n=0,o=r.length;n<o;n++)for(u=0;u<c.length;u+=s.length-2){if(s=[u,1],i=c[u].n,"*"!=r[n])i[r[n]]&&s.push(i[r[n]]);else for(a in i)i[d](a)&&s.push(i[a]);c.splice.apply(c,s)}for(n=0,o=c.length;n<o;n++)for(i=c[n];i.n;){if(e){if(i.f){for(u=0,l=i.f.length;u<l;u++)if(i.f[u]==e){i.f.splice(u,1);break}!i.f.length&&delete i.f}for(a in i.n)if(i.n[d](a)&&i.n[a].f){var f=i.n[a].f;for(u=0,l=f.length;u<l;u++)if(f[u]==e){f.splice(u,1);break}!f.length&&delete i.n[a].f}}else{delete i.f;for(a in i.n)i.n[d](a)&&i.n[a].f&&delete i.n[a].f}i=i.n}}},eve.once=function(t,e){var r=function(){return eve.off(t,r),e.apply(this,arguments)};return eve.on(t,r)},eve.version=e,eve.toString=function(){return"You are running Eve "+e},void 0!==n&&n.exports?n.exports=eve:(i=[],void 0!==(a=function(){return eve}.apply(o,i))&&(n.exports=a))}()},function(t,e,r){var n,o;n=[r(1)],void 0!==(o=function(A){if(!A||A.svg){var E="hasOwnProperty",j=String,g=parseFloat,w=parseInt,v=Math,S=v.max,O=v.abs,y=v.pow,P=/[, ]+/,d=A.eve,T="",f=" ",C="http://www.w3.org/1999/xlink",k={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},M={};A.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var R=function(t,e){if(e){"string"==typeof t&&(t=R(t));for(var r in e)e[E](r)&&("xlink:"==r.substring(0,6)?t.setAttributeNS(C,r.substring(6),j(e[r])):t.setAttribute(r,j(e[r])))}else t=A._g.doc.createElementNS("http://www.w3.org/2000/svg",t),t.style&&(t.style.webkitTapHighlightColor="rgba(0,0,0,0)");return t},N=function(t,e){var o="linear",r=t.id+e,i=.5,a=.5,n=t.node,s=t.paper,u=n.style,l=A._g.doc.getElementById(r);if(!l){if(e=j(e).replace(A._radial_gradient,function(t,e,r){if(o="radial",e&&r){i=g(e),a=g(r);var n=2*(a>.5)-1;y(i-.5,2)+y(a-.5,2)>.25&&(a=v.sqrt(.25-y(i-.5,2))*n+.5)&&.5!=a&&(a=a.toFixed(5)-1e-5*n)}return T}),e=e.split(/\s*\-\s*/),"linear"==o){var c=e.shift();if(c=-g(c),isNaN(c))return null;var f=[0,0,v.cos(A.rad(c)),v.sin(A.rad(c))],d=1/(S(O(f[2]),O(f[3]))||1);f[2]*=d,f[3]*=d,f[2]<0&&(f[0]=-f[2],f[2]=0),f[3]<0&&(f[1]=-f[3],f[3]=0)}var p=A._parseDots(e);if(!p)return null;if(r=r.replace(/[\(\)\s,\xb0#]/g,"_"),t.gradient&&r!=t.gradient.id&&(s.defs.removeChild(t.gradient),delete t.gradient),!t.gradient){l=R(o+"Gradient",{id:r}),t.gradient=l,R(l,"radial"==o?{fx:i,fy:a}:{x1:f[0],y1:f[1],x2:f[2],y2:f[3],gradientTransform:t.matrix.invert()}),s.defs.appendChild(l);for(var h=0,m=p.length;h<m;h++)l.appendChild(R("stop",{offset:p[h].offset?p[h].offset:h?"100%":"0%","stop-color":p[h].color||"#fff","stop-opacity":isFinite(p[h].opacity)?p[h].opacity:1}))}}return R(n,{fill:b(r),opacity:1,"fill-opacity":1}),u.fill=T,u.opacity=1,u.fillOpacity=1,1},r=function(){var t=document.documentMode;return t&&(9===t||10===t)},b=function(t){if(r())return"url('#"+t+"')";var e=document.location;return"url('"+e.protocol+"//"+e.host+e.pathname+e.search+"#"+t+"')"},B=function(t){var e=t.getBBox(1);R(t.pattern,{patternTransform:t.matrix.invert()+" translate("+e.x+","+e.y+")"})},I=function(t,e,r){if("path"==t.type){for(var n,o,i,a,s,u=j(e).toLowerCase().split("-"),l=t.paper,c=r?"end":"start",f=t.node,d=t.attrs,p=d["stroke-width"],h=u.length,m="classic",g=3,v=3,y=5;h--;)switch(u[h]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":m=u[h];break;case"wide":v=5;break;case"narrow":v=2;break;case"long":g=5;break;case"short":g=2}if("open"==m?(g+=2,v+=2,y+=2,i=1,a=r?4:1,s={fill:"none",stroke:d.stroke}):(a=i=g/2,s={fill:d.stroke,stroke:"none"}),t._.arrows?r?(t._.arrows.endPath&&M[t._.arrows.endPath]--,t._.arrows.endMarker&&M[t._.arrows.endMarker]--):(t._.arrows.startPath&&M[t._.arrows.startPath]--,t._.arrows.startMarker&&M[t._.arrows.startMarker]--):t._.arrows={},"none"!=m){var b="raphael-marker-"+m,_="raphael-marker-"+c+m+g+v+"-obj"+t.id;A._g.doc.getElementById(b)?M[b]++:(l.defs.appendChild(R(R("path"),{"stroke-linecap":"round",d:k[m],id:b})),M[b]=1);var x,w=A._g.doc.getElementById(_);w?(M[_]++,x=w.getElementsByTagName("use")[0]):(w=R(R("marker"),{id:_,markerHeight:v,markerWidth:g,orient:"auto",refX:a,refY:v/2}),x=R(R("use"),{"xlink:href":"#"+b,transform:(r?"rotate(180 "+g/2+" "+v/2+") ":T)+"scale("+g/y+","+v/y+")","stroke-width":(1/((g/y+v/y)/2)).toFixed(4)}),w.appendChild(x),l.defs.appendChild(w),M[_]=1),R(x,s);var S=i*("diamond"!=m&&"oval"!=m);r?(n=t._.arrows.startdx*p||0,o=A.getTotalLength(d.path)-S*p):(n=S*p,o=A.getTotalLength(d.path)-(t._.arrows.enddx*p||0)),s={},s["marker-"+c]="url(#"+_+")",(o||n)&&(s.d=A.getSubpath(d.path,n,o)),R(f,s),t._.arrows[c+"Path"]=b,t._.arrows[c+"Marker"]=_,t._.arrows[c+"dx"]=S,t._.arrows[c+"Type"]=m,t._.arrows[c+"String"]=e}else r?(n=t._.arrows.startdx*p||0,o=A.getTotalLength(d.path)-n):(n=0,o=A.getTotalLength(d.path)-(t._.arrows.enddx*p||0)),t._.arrows[c+"Path"]&&R(f,{d:A.getSubpath(d.path,n,o)}),delete t._.arrows[c+"Path"],delete t._.arrows[c+"Marker"],delete t._.arrows[c+"dx"],delete t._.arrows[c+"Type"],delete t._.arrows[c+"String"];for(s in M)if(M[E](s)&&!M[s]){var O=A._g.doc.getElementById(s);O&&O.parentNode.removeChild(O)}}},s={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},L=function(t,e,r){if(e=s[j(e).toLowerCase()]){for(var n=t.attrs["stroke-width"]||"1",o={round:n,square:n,butt:0}[t.attrs["stroke-linecap"]||r["stroke-linecap"]]||0,i=[],a=e.length;a--;)i[a]=e[a]*n+(a%2?1:-1)*o;R(t.node,{"stroke-dasharray":i.join(",")})}else R(t.node,{"stroke-dasharray":"none"})},p=function(t,e){var r=t.node,n=t.attrs,o=r.style.visibility;r.style.visibility="hidden";for(var i in e)if(e[E](i)){if(!A._availableAttrs[E](i))continue;var a=e[i];switch(n[i]=a,i){case"blur":t.blur(a);break;case"title":var s=r.getElementsByTagName("title");if(s.length&&(s=s[0]))s.firstChild.nodeValue=a;else{s=R("title");var u=A._g.doc.createTextNode(a);s.appendChild(u),r.appendChild(s)}break;case"href":case"target":var l=r.parentNode;if("a"!=l.tagName.toLowerCase()){var c=R("a");l.insertBefore(c,r),c.appendChild(r),l=c}"target"==i?l.setAttributeNS(C,"show","blank"==a?"new":a):l.setAttributeNS(C,i,a);break;case"cursor":r.style.cursor=a;break;case"transform":t.transform(a);break;case"arrow-start":I(t,a);break;case"arrow-end":I(t,a,1);break;case"clip-rect":var f=j(a).split(P);if(4==f.length){t.clip&&t.clip.parentNode.parentNode.removeChild(t.clip.parentNode);var d=R("clipPath"),p=R("rect");d.id=A.createUUID(),R(p,{x:f[0],y:f[1],width:f[2],height:f[3]}),d.appendChild(p),t.paper.defs.appendChild(d),R(r,{"clip-path":"url(#"+d.id+")"}),t.clip=p}if(!a){var h=r.getAttribute("clip-path");if(h){var m=A._g.doc.getElementById(h.replace(/(^url\(#|\)$)/g,T));m&&m.parentNode.removeChild(m),R(r,{"clip-path":T}),delete t.clip}}break;case"path":"path"==t.type&&(R(r,{d:a?n.path=A._pathToAbsolute(a):"M0,0"}),t._.dirty=1,t._.arrows&&("startString"in t._.arrows&&I(t,t._.arrows.startString),"endString"in t._.arrows&&I(t,t._.arrows.endString,1)));break;case"width":if(r.setAttribute(i,a),t._.dirty=1,!n.fx)break;i="x",a=n.x;case"x":n.fx&&(a=-n.x-(n.width||0));case"rx":if("rx"==i&&"rect"==t.type)break;case"cx":r.setAttribute(i,a),t.pattern&&B(t),t._.dirty=1;break;case"height":if(r.setAttribute(i,a),t._.dirty=1,!n.fy)break;i="y",a=n.y;case"y":n.fy&&(a=-n.y-(n.height||0));case"ry":if("ry"==i&&"rect"==t.type)break;case"cy":r.setAttribute(i,a),t.pattern&&B(t),t._.dirty=1;break;case"r":"rect"==t.type?R(r,{rx:a,ry:a}):r.setAttribute(i,a),t._.dirty=1;break;case"src":"image"==t.type&&r.setAttributeNS(C,"href",a);break;case"stroke-width":1==t._.sx&&1==t._.sy||(a/=S(O(t._.sx),O(t._.sy))||1),r.setAttribute(i,a),n["stroke-dasharray"]&&L(t,n["stroke-dasharray"],e),t._.arrows&&("startString"in t._.arrows&&I(t,t._.arrows.startString),"endString"in t._.arrows&&I(t,t._.arrows.endString,1));break;case"stroke-dasharray":L(t,a,e);break;case"fill":var g=j(a).match(A._ISURL);if(g){d=R("pattern");var v=R("image");d.id=A.createUUID(),R(d,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),R(v,{x:0,y:0,"xlink:href":g[1]}),d.appendChild(v),function(r){A._preload(g[1],function(){var t=this.offsetWidth,e=this.offsetHeight;R(r,{width:t,height:e}),R(v,{width:t,height:e})})}(d),t.paper.defs.appendChild(d),R(r,{fill:"url(#"+d.id+")"}),t.pattern=d,t.pattern&&B(t);break}var y=A.getRGB(a);if(y.error){if(("circle"==t.type||"ellipse"==t.type||"r"!=j(a).charAt())&&N(t,a)){if("opacity"in n||"fill-opacity"in n){var b=A._g.doc.getElementById(r.getAttribute("fill").replace(/^url\(#|\)$/g,T));if(b){var _=b.getElementsByTagName("stop");R(_[_.length-1],{"stop-opacity":("opacity"in n?n.opacity:1)*("fill-opacity"in n?n["fill-opacity"]:1)})}}n.gradient=a,n.fill="none";break}}else delete e.gradient,delete n.gradient,!A.is(n.opacity,"undefined")&&A.is(e.opacity,"undefined")&&R(r,{opacity:n.opacity}),!A.is(n["fill-opacity"],"undefined")&&A.is(e["fill-opacity"],"undefined")&&R(r,{"fill-opacity":n["fill-opacity"]});y[E]("opacity")&&R(r,{"fill-opacity":y.opacity>1?y.opacity/100:y.opacity});case"stroke":y=A.getRGB(a),r.setAttribute(i,y.hex),"stroke"==i&&y[E]("opacity")&&R(r,{"stroke-opacity":y.opacity>1?y.opacity/100:y.opacity}),"stroke"==i&&t._.arrows&&("startString"in t._.arrows&&I(t,t._.arrows.startString),"endString"in t._.arrows&&I(t,t._.arrows.endString,1));break;case"gradient":("circle"==t.type||"ellipse"==t.type||"r"!=j(a).charAt())&&N(t,a);break;case"opacity":n.gradient&&!n[E]("stroke-opacity")&&R(r,{"stroke-opacity":a>1?a/100:a});case"fill-opacity":if(n.gradient){(b=A._g.doc.getElementById(r.getAttribute("fill").replace(/^url\(#|\)$/g,T)))&&(_=b.getElementsByTagName("stop"),R(_[_.length-1],{"stop-opacity":a}));break}default:"font-size"==i&&(a=w(a,10)+"px");var x=i.replace(/(\-.)/g,function(t){return t.substring(1).toUpperCase()});r.style[x]=a,t._.dirty=1,r.setAttribute(i,a)}}D(t,e),r.style.visibility=o},D=function(t,e){if("text"==t.type&&(e[E]("text")||e[E]("font")||e[E]("font-size")||e[E]("x")||e[E]("y"))){var r=t.attrs,n=t.node,o=n.firstChild?w(A._g.doc.defaultView.getComputedStyle(n.firstChild,T).getPropertyValue("font-size"),10):10;if(e[E]("text")){for(r.text=e.text;n.firstChild;)n.removeChild(n.firstChild);for(var i,a=j(e.text).split("\n"),s=[],u=0,l=a.length;u<l;u++)i=R("tspan"),u&&R(i,{dy:1.2*o,x:r.x}),i.appendChild(A._g.doc.createTextNode(a[u])),n.appendChild(i),s[u]=i}else for(s=n.getElementsByTagName("tspan"),u=0,l=s.length;u<l;u++)u?R(s[u],{dy:1.2*o,x:r.x}):R(s[0],{dy:0});R(n,{x:r.x,y:r.y}),t._.dirty=1;var c=t._getBBox(),f=r.y-(c.y+c.height/2);f&&A.is(f,"finite")&&R(s[0],{dy:f})}},n=function(t){return t.parentNode&&"a"===t.parentNode.tagName.toLowerCase()?t.parentNode:t},u=function(t,e){this[0]=this.node=t,t.raphael=!0,this.id=function(){return("0000"+(Math.random()*Math.pow(36,5)<<0).toString(36)).slice(-5)}(),t.raphaelid=this.id,this.matrix=A.matrix(),this.realPath=null,this.paper=e,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!e.bottom&&(e.bottom=this),this.prev=e.top,e.top&&(e.top.next=this),e.top=this,this.next=null},t=A.el;u.prototype=t,t.constructor=u,A._engine.path=function(t,e){var r=R("path");e.canvas&&e.canvas.appendChild(r);var n=new u(r,e);return n.type="path",p(n,{fill:"none",stroke:"#000",path:t}),n},t.rotate=function(t,e,r){if(this.removed)return this;if(t=j(t).split(P),t.length-1&&(e=g(t[1]),r=g(t[2])),t=g(t[0]),null==r&&(e=r),null==e||null==r){var n=this.getBBox(1);e=n.x+n.width/2,r=n.y+n.height/2}return this.transform(this._.transform.concat([["r",t,e,r]])),this},t.scale=function(t,e,r,n){if(this.removed)return this;if(t=j(t).split(P),t.length-1&&(e=g(t[1]),r=g(t[2]),n=g(t[3])),t=g(t[0]),null==e&&(e=t),null==n&&(r=n),null==r||null==n)var o=this.getBBox(1);return r=null==r?o.x+o.width/2:r,n=null==n?o.y+o.height/2:n,this.transform(this._.transform.concat([["s",t,e,r,n]])),this},t.translate=function(t,e){return this.removed?this:(t=j(t).split(P),t.length-1&&(e=g(t[1])),t=g(t[0])||0,e=+e||0,this.transform(this._.transform.concat([["t",t,e]])),this)},t.transform=function(t){var e=this._;if(null==t)return e.transform;if(A._extractTransform(this,t),this.clip&&R(this.clip,{transform:this.matrix.invert()}),this.pattern&&B(this),this.node&&R(this.node,{transform:this.matrix}),1!=e.sx||1!=e.sy){var r=this.attrs[E]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":r})}return this},t.hide=function(){return this.removed||(this.node.style.display="none"),this},t.show=function(){return this.removed||(this.node.style.display=""),this},t.remove=function(){var t=n(this.node);if(!this.removed&&t.parentNode){var e=this.paper;e.__set__&&e.__set__.exclude(this),d.unbind("raphael.*.*."+this.id),this.gradient&&e.defs.removeChild(this.gradient),A._tear(this,e),t.parentNode.removeChild(t),this.removeData();for(var r in this)this[r]="function"==typeof this[r]?A._removedFactory(r):null;this.removed=!0}},t._getBBox=function(){if("none"==this.node.style.display){this.show();var t=!0}var e,r=!1;this.paper.canvas.parentElement?e=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(e=this.paper.canvas.parentNode.style),e&&"none"==e.display&&(r=!0,e.display="");var n={};try{n=this.node.getBBox()}catch(t){n={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{n=n||{},r&&(e.display="none")}return t&&this.hide(),n},t.attr=function(t,e){if(this.removed)return this;if(null==t){var r={};for(var n in this.attrs)this.attrs[E](n)&&(r[n]=this.attrs[n]);return r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r.transform=this._.transform,r}if(null==e&&A.is(t,"string")){if("fill"==t&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==t)return this._.transform;for(var o=t.split(P),i={},a=0,s=o.length;a<s;a++)t=o[a],t in this.attrs?i[t]=this.attrs[t]:A.is(this.paper.customAttributes[t],"function")?i[t]=this.paper.customAttributes[t].def:i[t]=A._availableAttrs[t];return s-1?i:i[o[0]]}if(null==e&&A.is(t,"array")){for(i={},a=0,s=t.length;a<s;a++)i[t[a]]=this.attr(t[a]);return i}if(null!=e){var u={};u[t]=e}else null!=t&&A.is(t,"object")&&(u=t);for(var l in u)d("raphael.attr."+l+"."+this.id,this,u[l]);for(l in this.paper.customAttributes)if(this.paper.customAttributes[E](l)&&u[E](l)&&A.is(this.paper.customAttributes[l],"function")){var c=this.paper.customAttributes[l].apply(this,[].concat(u[l]));this.attrs[l]=u[l];for(var f in c)c[E](f)&&(u[f]=c[f])}return p(this,u),this},t.toFront=function(){if(this.removed)return this;var t=n(this.node);t.parentNode.appendChild(t);var e=this.paper;return e.top!=this&&A._tofront(this,e),this},t.toBack=function(){if(this.removed)return this;var t=n(this.node),e=t.parentNode;e.insertBefore(t,e.firstChild),A._toback(this,this.paper);this.paper;return this},t.insertAfter=function(t){if(this.removed||!t)return this;var e=n(this.node),r=n(t.node||t[t.length-1].node);return r.nextSibling?r.parentNode.insertBefore(e,r.nextSibling):r.parentNode.appendChild(e),A._insertafter(this,t,this.paper),this},t.insertBefore=function(t){if(this.removed||!t)return this;var e=n(this.node),r=n(t.node||t[0].node);return r.parentNode.insertBefore(e,r),A._insertbefore(this,t,this.paper),this},t.blur=function(t){var e=this;if(0!=+t){var r=R("filter"),n=R("feGaussianBlur");e.attrs.blur=t,r.id=A.createUUID(),R(n,{stdDeviation:+t||1.5}),r.appendChild(n),e.paper.defs.appendChild(r),e._blur=r,R(e.node,{filter:"url(#"+r.id+")"})}else e._blur&&(e._blur.parentNode.removeChild(e._blur),delete e._blur,delete e.attrs.blur),e.node.removeAttribute("filter");return e},A._engine.circle=function(t,e,r,n){var o=R("circle");t.canvas&&t.canvas.appendChild(o);var i=new u(o,t);return i.attrs={cx:e,cy:r,r:n,fill:"none",stroke:"#000"},i.type="circle",R(o,i.attrs),i},A._engine.rect=function(t,e,r,n,o,i){var a=R("rect");t.canvas&&t.canvas.appendChild(a);var s=new u(a,t);return s.attrs={x:e,y:r,width:n,height:o,rx:i||0,ry:i||0,fill:"none",stroke:"#000"},s.type="rect",R(a,s.attrs),s},A._engine.ellipse=function(t,e,r,n,o){var i=R("ellipse");t.canvas&&t.canvas.appendChild(i);var a=new u(i,t);return a.attrs={cx:e,cy:r,rx:n,ry:o,fill:"none",stroke:"#000"},a.type="ellipse",R(i,a.attrs),a},A._engine.image=function(t,e,r,n,o,i){var a=R("image");R(a,{x:r,y:n,width:o,height:i,preserveAspectRatio:"none"}),a.setAttributeNS(C,"href",e),t.canvas&&t.canvas.appendChild(a);var s=new u(a,t);return s.attrs={x:r,y:n,width:o,height:i,src:e},s.type="image",s},A._engine.text=function(t,e,r,n){var o=R("text");t.canvas&&t.canvas.appendChild(o);var i=new u(o,t);return i.attrs={x:e,y:r,"text-anchor":"middle",text:n,"font-family":A._availableAttrs["font-family"],"font-size":A._availableAttrs["font-size"],stroke:"none",fill:"#000"},i.type="text",p(i,i.attrs),i},A._engine.setSize=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},A._engine.create=function(){var t=A._getContainer.apply(0,arguments),e=t&&t.container,r=t.x,n=t.y,o=t.width,i=t.height;if(!e)throw new Error("SVG container not found.");var a,s=R("svg"),u="overflow:hidden;";return r=r||0,n=n||0,o=o||512,i=i||342,R(s,{height:i,version:1.1,width:o,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),1==e?(s.style.cssText=u+"position:absolute;left:"+r+"px;top:"+n+"px",A._g.doc.body.appendChild(s),a=1):(s.style.cssText=u+"position:relative",e.firstChild?e.insertBefore(s,e.firstChild):e.appendChild(s)),e=new A._Paper,e.width=o,e.height=i,e.canvas=s,e.clear(),e._left=e._top=0,a&&(e.renderfix=function(){}),e.renderfix(),e},A._engine.setViewBox=function(t,e,r,n,o){d("raphael.setViewBox",this,this._viewBox,[t,e,r,n,o]);var i,a,s=this.getSize(),u=S(r/s.width,n/s.height),l=this.top,c=o?"xMidYMid meet":"xMinYMin";for(null==t?(this._vbSize&&(u=1),delete this._vbSize,i="0 0 "+this.width+f+this.height):(this._vbSize=u,i=t+f+e+f+r+f+n),R(this.canvas,{viewBox:i,preserveAspectRatio:c});u&&l;)a="stroke-width"in l.attrs?l.attrs["stroke-width"]:1,l.attr({"stroke-width":a}),l._.dirty=1,l._.dirtyT=1,l=l.prev;return this._viewBox=[t,e,r,n,!!o],this},A.prototype.renderfix=function(){var t,e=this.canvas,r=e.style;try{t=e.getScreenCTM()||e.createSVGMatrix()}catch(r){t=e.createSVGMatrix()}var n=-t.e%1,o=-t.f%1;(n||o)&&(n&&(this._left=(this._left+n)%1,r.left=this._left+"px"),o&&(this._top=(this._top+o)%1,r.top=this._top+"px"))},A.prototype.clear=function(){A.eve("raphael.clear",this);for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=R("desc")).appendChild(A._g.doc.createTextNode("Created with Raphaël "+A.version)),t.appendChild(this.desc),t.appendChild(this.defs=R("defs"))},A.prototype.remove=function(){d("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]="function"==typeof this[t]?A._removedFactory(t):null};var e=A.st;for(var o in t)t[E](o)&&!e[E](o)&&(e[o]=function(r){return function(){var e=arguments;return this.forEach(function(t){t[r].apply(t,e)})}}(o))}}.apply(e,n))&&(t.exports=o)},function(t,e,r){var n,o;n=[r(1)],void 0!==(o=function(M){if(!M||M.vml){var R="hasOwnProperty",N=String,B=parseFloat,f=Math,I=f.round,L=f.max,D=f.min,v=f.abs,F="fill",G=/[, ]+/,d=M.eve,z=" ",H="",p={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},h=/([clmz]),?([^clmz]*)/gi,n=/ progid:\S+Blur\([^\)]+\)/g,m=/-?[^,\s-]+/g,c="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",W=21600,U={path:1,rect:1,image:1},V={circle:1,ellipse:1},q=function(t){var e=/[ahqstv]/gi,r=M._pathToAbsolute;if(N(t).match(e)&&(r=M._path2curve),e=/[clmz]/g,r==M._pathToAbsolute&&!N(t).match(e)){var n=N(t).replace(h,function(t,e,r){var n=[],o="m"==e.toLowerCase(),i=p[e];return r.replace(m,function(t){o&&2==n.length&&(i+=n+p["m"==e?"l":"L"],n=[]),n.push(I(t*W))}),i+n});return n}var o,i,a=r(t);n=[];for(var s=0,u=a.length;s<u;s++){o=a[s],"z"==(i=a[s][0].toLowerCase())&&(i="x");for(var l=1,c=o.length;l<c;l++)i+=I(o[l]*W)+(l!=c-1?",":H);n.push(i)}return n.join(z)},y=function(t,e,r){var n=M.matrix();return n.rotate(-t,.5,.5),{dx:n.x(e,r),dy:n.y(e,r)}},Y=function(t,e,r,n,o,i){var a=t._,s=t.matrix,u=a.fillpos,l=t.node,c=l.style,f=1,d="",p=W/e,h=W/r;if(c.visibility="hidden",e&&r){if(l.coordsize=v(p)+z+v(h),c.rotation=i*(e*r<0?-1:1),i){var m=y(i,n,o);n=m.dx,o=m.dy}if(e<0&&(d+="x"),r<0&&(d+=" y")&&(f=-1),c.flip=d,l.coordorigin=n*-p+z+o*-h,u||a.fillsize){var g=l.getElementsByTagName(F);g=g&&g[0],l.removeChild(g),u&&(m=y(i,s.x(u[0],u[1]),s.y(u[0],u[1])),g.position=m.dx*f+z+m.dy*f),a.fillsize&&(g.size=a.fillsize[0]*v(e)+z+a.fillsize[1]*v(r)),l.appendChild(g)}c.visibility="visible"}};M.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var K=function(t,e,r){for(var n=N(e).toLowerCase().split("-"),o=r?"end":"start",i=n.length,a="classic",s="medium",u="medium";i--;)switch(n[i]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":a=n[i];break;case"wide":case"narrow":u=n[i];break;case"long":case"short":s=n[i]}var l=t.node.getElementsByTagName("stroke")[0];l[o+"arrow"]=a,l[o+"arrowlength"]=s,l[o+"arrowwidth"]=u},g=function(t,e){t.attrs=t.attrs||{};var r=t.node,n=t.attrs,o=r.style,i=U[t.type]&&(e.x!=n.x||e.y!=n.y||e.width!=n.width||e.height!=n.height||e.cx!=n.cx||e.cy!=n.cy||e.rx!=n.rx||e.ry!=n.ry||e.r!=n.r),a=V[t.type]&&(n.cx!=e.cx||n.cy!=e.cy||n.r!=e.r||n.rx!=e.rx||n.ry!=e.ry),s=t;for(var u in e)e[R](u)&&(n[u]=e[u]);if(i&&(n.path=M._getPath[t.type](t),t._.dirty=1),e.href&&(r.href=e.href),e.title&&(r.title=e.title),e.target&&(r.target=e.target),e.cursor&&(o.cursor=e.cursor),"blur"in e&&t.blur(e.blur),(e.path&&"path"==t.type||i)&&(r.path=q(~N(n.path).toLowerCase().indexOf("r")?M._pathToAbsolute(n.path):n.path),t._.dirty=1,"image"==t.type&&(t._.fillpos=[n.x,n.y],t._.fillsize=[n.width,n.height],Y(t,1,1,0,0,0))),"transform"in e&&t.transform(e.transform),a){var l=+n.cx,c=+n.cy,f=+n.rx||+n.r||0,d=+n.ry||+n.r||0;r.path=M.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",I((l-f)*W),I((c-d)*W),I((l+f)*W),I((c+d)*W),I(l*W)),t._.dirty=1}if("clip-rect"in e){var p=N(e["clip-rect"]).split(G);if(4==p.length){p[2]=+p[2]+ +p[0],p[3]=+p[3]+ +p[1];var h=r.clipRect||M._g.doc.createElement("div"),m=h.style;m.clip=M.format("rect({1}px {2}px {3}px {0}px)",p),r.clipRect||(m.position="absolute",m.top=0,m.left=0,m.width=t.paper.width+"px",m.height=t.paper.height+"px",r.parentNode.insertBefore(h,r),h.appendChild(r),r.clipRect=h)}e["clip-rect"]||r.clipRect&&(r.clipRect.style.clip="auto")}if(t.textpath){var g=t.textpath.style;e.font&&(g.font=e.font),e["font-family"]&&(g.fontFamily='"'+e["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,H)+'"'),e["font-size"]&&(g.fontSize=e["font-size"]),e["font-weight"]&&(g.fontWeight=e["font-weight"]),e["font-style"]&&(g.fontStyle=e["font-style"])}if("arrow-start"in e&&K(s,e["arrow-start"]),"arrow-end"in e&&K(s,e["arrow-end"],1),null!=e.opacity||null!=e.fill||null!=e.src||null!=e.stroke||null!=e["stroke-width"]||null!=e["stroke-opacity"]||null!=e["fill-opacity"]||null!=e["stroke-dasharray"]||null!=e["stroke-miterlimit"]||null!=e["stroke-linejoin"]||null!=e["stroke-linecap"]){var v=r.getElementsByTagName(F);if(v=v&&v[0],!v&&(v=X(F)),"image"==t.type&&e.src&&(v.src=e.src),e.fill&&(v.on=!0),null!=v.on&&"none"!=e.fill&&null!==e.fill||(v.on=!1),v.on&&e.fill){var y=N(e.fill).match(M._ISURL);if(y){v.parentNode==r&&r.removeChild(v),v.rotate=!0,v.src=y[1],v.type="tile";var b=t.getBBox(1);v.position=b.x+z+b.y,t._.fillpos=[b.x,b.y],M._preload(y[1],function(){t._.fillsize=[this.offsetWidth,this.offsetHeight]})}else v.color=M.getRGB(e.fill).hex,v.src=H,v.type="solid",M.getRGB(e.fill).error&&(s.type in{circle:1,ellipse:1}||"r"!=N(e.fill).charAt())&&$(s,e.fill,v)&&(n.fill="none",n.gradient=e.fill,v.rotate=!1)}if("fill-opacity"in e||"opacity"in e){var _=((+n["fill-opacity"]+1||2)-1)*((+n.opacity+1||2)-1)*((+M.getRGB(e.fill).o+1||2)-1);_=D(L(_,0),1),v.opacity=_,v.src&&(v.color="none")}r.appendChild(v);var x=r.getElementsByTagName("stroke")&&r.getElementsByTagName("stroke")[0],w=!1;!x&&(w=x=X("stroke")),(e.stroke&&"none"!=e.stroke||e["stroke-width"]||null!=e["stroke-opacity"]||e["stroke-dasharray"]||e["stroke-miterlimit"]||e["stroke-linejoin"]||e["stroke-linecap"])&&(x.on=!0),("none"==e.stroke||null===e.stroke||null==x.on||0==e.stroke||0==e["stroke-width"])&&(x.on=!1);var S=M.getRGB(e.stroke);x.on&&e.stroke&&(x.color=S.hex),_=((+n["stroke-opacity"]+1||2)-1)*((+n.opacity+1||2)-1)*((+S.o+1||2)-1);var O=.75*(B(e["stroke-width"])||1);if(_=D(L(_,0),1),null==e["stroke-width"]&&(O=n["stroke-width"]),e["stroke-width"]&&(x.weight=O),O&&O<1&&(_*=O)&&(x.weight=1),x.opacity=_,e["stroke-linejoin"]&&(x.joinstyle=e["stroke-linejoin"]||"miter"),x.miterlimit=e["stroke-miterlimit"]||8,e["stroke-linecap"]&&(x.endcap="butt"==e["stroke-linecap"]?"flat":"square"==e["stroke-linecap"]?"square":"round"),"stroke-dasharray"in e){var A={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};x.dashstyle=A[R](e["stroke-dasharray"])?A[e["stroke-dasharray"]]:H}w&&r.appendChild(x)}if("text"==s.type){s.paper.canvas.style.display=H;var E=s.paper.span,j=n.font&&n.font.match(/\d+(?:\.\d*)?(?=px)/);o=E.style,n.font&&(o.font=n.font),n["font-family"]&&(o.fontFamily=n["font-family"]),n["font-weight"]&&(o.fontWeight=n["font-weight"]),n["font-style"]&&(o.fontStyle=n["font-style"]),j=B(n["font-size"]||j&&j[0])||10,o.fontSize=100*j+"px",s.textpath.string&&(E.innerHTML=N(s.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var P=E.getBoundingClientRect();s.W=n.w=(P.right-P.left)/100,s.H=n.h=(P.bottom-P.top)/100,s.X=n.x,s.Y=n.y+s.H/2,("x"in e||"y"in e)&&(s.path.v=M.format("m{0},{1}l{2},{1}",I(n.x*W),I(n.y*W),I(n.x*W)+1));for(var T=["x","y","text","font","font-family","font-weight","font-style","font-size"],C=0,k=T.length;C<k;C++)if(T[C]in e){s._.dirty=1;break}switch(n["text-anchor"]){case"start":s.textpath.style["v-text-align"]="left",s.bbx=s.W/2;break;case"end":s.textpath.style["v-text-align"]="right",s.bbx=-s.W/2;break;default:s.textpath.style["v-text-align"]="center",s.bbx=0}s.textpath.style["v-text-kern"]=!0}},$=function(t,e,r){t.attrs=t.attrs||{};var n=(t.attrs,Math.pow),o="linear",i=".5 .5";if(t.attrs.gradient=e,e=N(e).replace(M._radial_gradient,function(t,e,r){return o="radial",e&&r&&(e=B(e),r=B(r),n(e-.5,2)+n(r-.5,2)>.25&&(r=f.sqrt(.25-n(e-.5,2))*(2*(r>.5)-1)+.5),i=e+z+r),H}),e=e.split(/\s*\-\s*/),"linear"==o){var a=e.shift();if(a=-B(a),isNaN(a))return null}var s=M._parseDots(e);if(!s)return null;if(t=t.shape||t.node,s.length){t.removeChild(r),r.on=!0,r.method="none",r.color=s[0].color,r.color2=s[s.length-1].color;for(var u=[],l=0,c=s.length;l<c;l++)s[l].offset&&u.push(s[l].offset+z+s[l].color);r.colors=u.length?u.join():"0% "+r.color,"radial"==o?(r.type="gradientTitle",r.focus="100%",r.focussize="0 0",r.focusposition=i,r.angle=0):(r.type="gradient",r.angle=(270-a)%360),t.appendChild(r)}return 1},b=function(t,e){this[0]=this.node=t,t.raphael=!0,this.id=M._oid++,t.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=e,this.matrix=M.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!e.bottom&&(e.bottom=this),this.prev=e.top,e.top&&(e.top.next=this),e.top=this,this.next=null},t=M.el;b.prototype=t,t.constructor=b,t.transform=function(t){if(null==t)return this._.transform;var e,r=this.paper._viewBoxShift,n=r?"s"+[r.scale,r.scale]+"-1-1t"+[r.dx,r.dy]:H;r&&(e=t=N(t).replace(/\.{3}|\u2026/g,this._.transform||H)),M._extractTransform(this,n+t);var o,i=this.matrix.clone(),a=this.skew,s=this.node,u=~N(this.attrs.fill).indexOf("-"),l=!N(this.attrs.fill).indexOf("url(");if(i.translate(1,1),l||u||"image"==this.type)if(a.matrix="1 0 0 1",a.offset="0 0",o=i.split(),u&&o.noRotation||!o.isSimple){s.style.filter=i.toFilter();var c=this.getBBox(),f=this.getBBox(1),d=c.x-f.x,p=c.y-f.y;s.coordorigin=d*-W+z+p*-W,Y(this,1,1,d,p,0)}else s.style.filter=H,Y(this,o.scalex,o.scaley,o.dx,o.dy,o.rotate);else s.style.filter=H,a.matrix=N(i),a.offset=i.offset();return null!==e&&(this._.transform=e,M._extractTransform(this,e)),this},t.rotate=function(t,e,r){if(this.removed)return this;if(null!=t){if(t=N(t).split(G),t.length-1&&(e=B(t[1]),r=B(t[2])),t=B(t[0]),null==r&&(e=r),null==e||null==r){var n=this.getBBox(1);e=n.x+n.width/2,r=n.y+n.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",t,e,r]])),this}},t.translate=function(t,e){return this.removed?this:(t=N(t).split(G),t.length-1&&(e=B(t[1])),t=B(t[0])||0,e=+e||0,this._.bbox&&(this._.bbox.x+=t,this._.bbox.y+=e),this.transform(this._.transform.concat([["t",t,e]])),this)},t.scale=function(t,e,r,n){if(this.removed)return this;if(t=N(t).split(G),t.length-1&&(e=B(t[1]),r=B(t[2]),n=B(t[3]),isNaN(r)&&(r=null),isNaN(n)&&(n=null)),t=B(t[0]),null==e&&(e=t),null==n&&(r=n),null==r||null==n)var o=this.getBBox(1);return r=null==r?o.x+o.width/2:r,n=null==n?o.y+o.height/2:n,this.transform(this._.transform.concat([["s",t,e,r,n]])),this._.dirtyT=1,this},t.hide=function(){return!this.removed&&(this.node.style.display="none"),this},t.show=function(){return!this.removed&&(this.node.style.display=H),this},t.auxGetBBox=M.el.getBBox,t.getBBox=function(){var t=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var e={},r=1/this.paper._viewBoxShift.scale;return e.x=t.x-this.paper._viewBoxShift.dx,e.x*=r,e.y=t.y-this.paper._viewBoxShift.dy,e.y*=r,e.width=t.width*r,e.height=t.height*r,e.x2=e.x+e.width,e.y2=e.y+e.height,e}return t},t._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},t.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),M.eve.unbind("raphael.*.*."+this.id),M._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)this[t]="function"==typeof this[t]?M._removedFactory(t):null;this.removed=!0}},t.attr=function(t,e){if(this.removed)return this;if(null==t){var r={};for(var n in this.attrs)this.attrs[R](n)&&(r[n]=this.attrs[n]);return r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r.transform=this._.transform,r}if(null==e&&M.is(t,"string")){if(t==F&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var o=t.split(G),i={},a=0,s=o.length;a<s;a++)t=o[a],t in this.attrs?i[t]=this.attrs[t]:M.is(this.paper.customAttributes[t],"function")?i[t]=this.paper.customAttributes[t].def:i[t]=M._availableAttrs[t];return s-1?i:i[o[0]]}if(this.attrs&&null==e&&M.is(t,"array")){for(i={},a=0,s=t.length;a<s;a++)i[t[a]]=this.attr(t[a]);return i}var u;null!=e&&(u={},u[t]=e),null==e&&M.is(t,"object")&&(u=t);for(var l in u)d("raphael.attr."+l+"."+this.id,this,u[l]);if(u){for(l in this.paper.customAttributes)if(this.paper.customAttributes[R](l)&&u[R](l)&&M.is(this.paper.customAttributes[l],"function")){var c=this.paper.customAttributes[l].apply(this,[].concat(u[l]));this.attrs[l]=u[l];for(var f in c)c[R](f)&&(u[f]=c[f])}u.text&&"text"==this.type&&(this.textpath.string=u.text),g(this,u)}return this},t.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&M._tofront(this,this.paper),this},t.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),M._toback(this,this.paper)),this)},t.insertAfter=function(t){return this.removed?this:(t.constructor==M.st.constructor&&(t=t[t.length-1]),t.node.nextSibling?t.node.parentNode.insertBefore(this.node,t.node.nextSibling):t.node.parentNode.appendChild(this.node),M._insertafter(this,t,this.paper),this)},t.insertBefore=function(t){return this.removed?this:(t.constructor==M.st.constructor&&(t=t[0]),t.node.parentNode.insertBefore(this.node,t.node),M._insertbefore(this,t,this.paper),this)},t.blur=function(t){var e=this.node.runtimeStyle,r=e.filter;return r=r.replace(n,H),0!=+t?(this.attrs.blur=t,e.filter=r+z+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+t||1.5)+")",e.margin=M.format("-{0}px 0 0 -{0}px",I(+t||1.5))):(e.filter=r,e.margin=0,delete this.attrs.blur),this},M._engine.path=function(t,e){var r=X("shape");r.style.cssText=c,r.coordsize=W+z+W,r.coordorigin=e.coordorigin;var n=new b(r,e),o={fill:"none",stroke:"#000"};t&&(o.path=t),n.type="path",n.path=[],n.Path=H,g(n,o),e.canvas&&e.canvas.appendChild(r);var i=X("skew");return i.on=!0,r.appendChild(i),n.skew=i,n.transform(H),n},M._engine.rect=function(t,e,r,n,o,i){var a=M._rectPath(e,r,n,o,i),s=t.path(a),u=s.attrs;return s.X=u.x=e,s.Y=u.y=r,s.W=u.width=n,s.H=u.height=o,u.r=i,u.path=a,s.type="rect",s},M._engine.ellipse=function(t,e,r,n,o){var i=t.path();i.attrs;return i.X=e-n,i.Y=r-o,i.W=2*n,i.H=2*o,i.type="ellipse",g(i,{cx:e,cy:r,rx:n,ry:o}),i},M._engine.circle=function(t,e,r,n){var o=t.path();o.attrs;return o.X=e-n,o.Y=r-n,o.W=o.H=2*n,o.type="circle",g(o,{cx:e,cy:r,r:n}),o},M._engine.image=function(t,e,r,n,o,i){var a=M._rectPath(r,n,o,i),s=t.path(a).attr({stroke:"none"}),u=s.attrs,l=s.node,c=l.getElementsByTagName(F)[0];return u.src=e,s.X=u.x=r,s.Y=u.y=n,s.W=u.width=o,s.H=u.height=i,u.path=a,s.type="image",c.parentNode==l&&l.removeChild(c),c.rotate=!0,c.src=e,c.type="tile",s._.fillpos=[r,n],s._.fillsize=[o,i],l.appendChild(c),Y(s,1,1,0,0,0),s},M._engine.text=function(t,e,r,n){var o=X("shape"),i=X("path"),a=X("textpath");e=e||0,r=r||0,n=n||"",i.v=M.format("m{0},{1}l{2},{1}",I(e*W),I(r*W),I(e*W)+1),i.textpathok=!0,a.string=N(n),a.on=!0,o.style.cssText=c,o.coordsize=W+z+W,o.coordorigin="0 0";var s=new b(o,t),u={fill:"#000",stroke:"none",font:M._availableAttrs.font,text:n};s.shape=o,s.path=i,s.textpath=a,s.type="text",s.attrs.text=N(n),s.attrs.x=e,s.attrs.y=r,s.attrs.w=1,s.attrs.h=1,g(s,u),o.appendChild(a),o.appendChild(i),t.canvas.appendChild(o);var l=X("skew");return l.on=!0,o.appendChild(l),s.skew=l,s.transform(H),s},M._engine.setSize=function(t,e){var r=this.canvas.style;return this.width=t,this.height=e,t==+t&&(t+="px"),e==+e&&(e+="px"),r.width=t,r.height=e,r.clip="rect(0 "+t+" "+e+" 0)",this._viewBox&&M._engine.setViewBox.apply(this,this._viewBox),this},M._engine.setViewBox=function(t,e,r,n,o){M.eve("raphael.setViewBox",this,this._viewBox,[t,e,r,n,o]);var i,a,s=this.getSize(),u=s.width,l=s.height;return o&&(i=l/n,a=u/r,r*i<u&&(t-=(u-r*i)/2/i),n*a<l&&(e-=(l-n*a)/2/a)),this._viewBox=[t,e,r,n,!!o],this._viewBoxShift={dx:-t,dy:-e,scale:s},this.forEach(function(t){t.transform("...")}),this};var X;M._engine.initWin=function(t){var e=t.document;e.styleSheets.length<31?e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):e.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!e.namespaces.rvml&&e.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),X=function(t){return e.createElement("<rvml:"+t+' class="rvml">')}}catch(t){X=function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},M._engine.initWin(M._g.win),M._engine.create=function(){var t=M._getContainer.apply(0,arguments),e=t.container,r=t.height,n=t.width,o=t.x,i=t.y;if(!e)throw new Error("VML container not found.");var a=new M._Paper,s=a.canvas=M._g.doc.createElement("div"),u=s.style;return o=o||0,i=i||0,n=n||512,r=r||342,a.width=n,a.height=r,n==+n&&(n+="px"),r==+r&&(r+="px"),a.coordsize=216e5+z+216e5,a.coordorigin="0 0",a.span=M._g.doc.createElement("span"),a.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",s.appendChild(a.span),u.cssText=M.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",n,r),1==e?(M._g.doc.body.appendChild(s),u.left=o+"px",u.top=i+"px",u.position="absolute"):e.firstChild?e.insertBefore(s,e.firstChild):e.appendChild(s),a.renderfix=function(){},a},M.prototype.clear=function(){M.eve("raphael.clear",this),this.canvas.innerHTML=H,this.span=M._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},M.prototype.remove=function(){M.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]="function"==typeof this[t]?M._removedFactory(t):null;return!0};var e=M.st;for(var r in t)t[R](r)&&!e[R](r)&&(e[r]=function(r){return function(){var e=arguments;return this.forEach(function(t){t[r].apply(t,e)})}}(r))}}.apply(e,n))&&(t.exports=o)}])})},{}],498:[function(t,r,n){(function(M){!function(t,e){"object"==typeof n&&void 0!==r?e(n):"function"==typeof L&&L.amd?L(["exports"],e):e(t.reduxLogger=t.reduxLogger||{})}(this,function(t){"use strict";function e(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}function r(t,e){Object.defineProperty(this,"kind",{value:t,enumerable:!0}),e&&e.length&&Object.defineProperty(this,"path",{value:e,enumerable:!0})}function g(t,e,r){g.super_.call(this,"E",t),Object.defineProperty(this,"lhs",{value:e,enumerable:!0}),Object.defineProperty(this,"rhs",{value:r,enumerable:!0})}function v(t,e){v.super_.call(this,"N",t),Object.defineProperty(this,"rhs",{value:e,enumerable:!0})}function y(t,e){y.super_.call(this,"D",t),Object.defineProperty(this,"lhs",{value:e,enumerable:!0})}function b(t,e,r){b.super_.call(this,"A",t),Object.defineProperty(this,"index",{value:e,enumerable:!0}),Object.defineProperty(this,"item",{value:r,enumerable:!0})}function _(t,e,r){var n=t.slice((r||e)+1||t.length);return t.length=e<0?t.length+e:e,t.push.apply(t,n),t}function x(t){var e=void 0===t?"undefined":E(t);return"object"!==e?e:t===Math?"math":null===t?"null":Array.isArray(t)?"array":"[object Date]"===Object.prototype.toString.call(t)?"date":"function"==typeof t.toString&&/^\/.*\//.test(t.toString())?"regexp":"object"}function w(n,o,i,a,t,e,s){t=t||[],s=s||[];var u=t.slice(0);if(void 0!==e){if(a){if("function"==typeof a&&a(u,e))return;if("object"===(void 0===a?"undefined":E(a))){if(a.prefilter&&a.prefilter(u,e))return;if(a.normalize){var r=a.normalize(u,e,n,o);r&&(n=r[0],o=r[1])}}}u.push(e)}"regexp"===x(n)&&"regexp"===x(o)&&(n=n.toString(),o=o.toString());var l=void 0===n?"undefined":E(n),c=void 0===o?"undefined":E(o),f="undefined"!==l||s&&s[s.length-1].lhs&&s[s.length-1].lhs.hasOwnProperty(e),d="undefined"!==c||s&&s[s.length-1].rhs&&s[s.length-1].rhs.hasOwnProperty(e);if(!f&&d)i(new v(u,o));else if(!d&&f)i(new y(u,n));else if(x(n)!==x(o))i(new g(u,n,o));else if("date"===x(n)&&n-o!=0)i(new g(u,n,o));else if("object"===l&&null!==n&&null!==o)if(s.filter(function(t){return t.lhs===n}).length)n!==o&&i(new g(u,n,o));else{if(s.push({lhs:n,rhs:o}),Array.isArray(n)){var p;for(n.length,p=0;p<n.length;p++)p>=o.length?i(new b(u,p,new y(void 0,n[p]))):w(n[p],o[p],i,a,u,p,s);for(;p<o.length;)i(new b(u,p,new v(void 0,o[p++])))}else{var h=Object.keys(n),m=Object.keys(o);h.forEach(function(t,e){var r=m.indexOf(t);r>=0?(w(n[t],o[t],i,a,u,t,s),m=_(m,r)):w(n[t],void 0,i,a,u,t,s)}),m.forEach(function(t){w(void 0,o[t],i,a,u,t,s)})}s.length=s.length-1}else n!==o&&("number"===l&&isNaN(n)&&isNaN(o)||i(new g(u,n,o)))}function i(t,e,r,n){return n=n||[],w(t,e,function(t){t&&n.push(t)},r),n.length?n:void 0}function a(t,e,r){if(r.path&&r.path.length){var n,o=t[e],i=r.path.length-1;for(n=0;n<i;n++)o=o[r.path[n]];switch(r.kind){case"A":a(o[r.path[n]],r.index,r.item);break;case"D":delete o[r.path[n]];break;case"E":case"N":o[r.path[n]]=r.rhs}}else switch(r.kind){case"A":a(t[e],r.index,r.item);break;case"D":t=_(t,e);break;case"E":case"N":t[e]=r.rhs}return t}function o(t,e,r){if(t&&e&&r&&r.kind){for(var n=t,o=-1,i=r.path?r.path.length-1:0;++o<i;)void 0===n[r.path[o]]&&(n[r.path[o]]="number"==typeof r.path[o]?[]:{}),n=n[r.path[o]];switch(r.kind){case"A":a(r.path?n[r.path[o]]:n,r.index,r.item);break;case"D":delete n[r.path[o]];break;case"E":case"N":n[r.path[o]]=r.rhs}}}function s(t,e,r){if(r.path&&r.path.length){var n,o=t[e],i=r.path.length-1;for(n=0;n<i;n++)o=o[r.path[n]];switch(r.kind){case"A":s(o[r.path[n]],r.index,r.item);break;case"D":case"E":o[r.path[n]]=r.lhs;break;case"N":delete o[r.path[n]]}}else switch(r.kind){case"A":s(t[e],r.index,r.item);break;case"D":case"E":t[e]=r.lhs;break;case"N":t=_(t,e)}return t}function n(t,e,r){if(t&&e&&r&&r.kind){var n,o,i=t;for(o=r.path.length-1,n=0;n<o;n++)void 0===i[r.path[n]]&&(i[r.path[n]]={}),i=i[r.path[n]];switch(r.kind){case"A":s(i[r.path[n]],r.index,r.item);break;case"D":case"E":i[r.path[n]]=r.lhs;break;case"N":delete i[r.path[n]]}}}function u(e,r,n){if(e&&r){w(e,r,function(t){n&&!n(e,r,t)||o(e,r,t)})}}function l(t){return"color: "+T[t].color+"; font-weight: bold"}function c(t){var e=t.kind,r=t.path,n=t.lhs,o=t.rhs,i=t.index,a=t.item;switch(e){case"E":return[r.join("."),n,"→",o];case"N":return[r.join("."),o];case"D":return[r.join(".")];case"A":return[r.join(".")+"["+i+"]",a];default:return[]}}function N(t,e,n,r){var o=i(t,e);try{r?n.groupCollapsed("diff"):n.group("diff")}catch(t){n.log("diff")}o?o.forEach(function(t){var e=t.kind,r=c(t);n.log.apply(n,["%c "+T[e].text,l(e)].concat(j(r)))}):n.log("—— no diff ——");try{n.groupEnd()}catch(t){n.log("—— diff end —— ")}}function B(t,e,r,n){switch(void 0===t?"undefined":E(t)){case"object":return"function"==typeof t[n]?t[n].apply(t,j(r)):t[n];case"function":return t(e);default:return t}}function f(t){var o=t.timestamp,i=t.duration;return function(t,e,r){var n=["action"];return n.push("%c"+String(t.type)),o&&n.push("%c@ "+e),i&&n.push("%c(in "+r.toFixed(2)+" ms)"),n.join(" ")}}function p(O,A){var E=A.logger,j=A.actionTransformer,t=A.titleFormatter,P=void 0===t?f(A):t,T=A.collapsed,C=A.colors,k=A.level,M=A.diff,R=void 0===A.titleFormatter;O.forEach(function(t,e){var r=t.started,n=t.startedTime,o=t.action,i=t.prevState,a=t.error,s=t.took,u=t.nextState,l=O[e+1];l&&(u=l.prevState,s=l.started-r);var c=j(o),f="function"==typeof T?T(function(){return u},o,t):T,d=I(n),p=C.title?"color: "+C.title(c)+";":"",h=["color: gray; font-weight: lighter;"];h.push(p),A.timestamp&&h.push("color: gray; font-weight: lighter;"),A.duration&&h.push("color: gray; font-weight: lighter;");var m=P(c,d,s);try{f?C.title&&R?E.groupCollapsed.apply(E,["%c "+m].concat(h)):E.groupCollapsed(m):C.title&&R?E.group.apply(E,["%c "+m].concat(h)):E.group(m)}catch(t){E.log(m)}var g=B(k,c,[i],"prevState"),v=B(k,c,[c],"action"),y=B(k,c,[a,i],"error"),b=B(k,c,[u],"nextState");if(g)if(C.prevState){var _="color: "+C.prevState(i)+"; font-weight: bold";E[g]("%c prev state",_,i)}else E[g]("prev state",i);if(v)if(C.action){var x="color: "+C.action(c)+"; font-weight: bold";E[v]("%c action    ",x,c)}else E[v]("action    ",c);if(a&&y)if(C.error){var w="color: "+C.error(a,i)+"; font-weight: bold;";E[y]("%c error     ",w,a)}else E[y]("error     ",a);if(b)if(C.nextState){var S="color: "+C.nextState(u)+"; font-weight: bold";E[b]("%c next state",S,u)}else E[b]("next state",u);M&&N(i,u,E,f);try{E.groupEnd()}catch(t){E.log("—— log end ——")}})}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Object.assign({},C,t),e=a.logger,s=a.stateTransformer,u=a.errorTransformer,l=a.predicate,c=a.logErrors,f=a.diffPredicate;if(void 0===e)return function(){return function(e){return function(t){return e(t)}}};if(t.getState&&t.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var d=[];return function(t){var i=t.getState;return function(o){return function(t){if("function"==typeof l&&!l(i,t))return o(t);var e={};d.push(e),e.started=A.now(),e.startedTime=new Date,e.prevState=s(i()),e.action=t;var r=void 0;if(c)try{r=o(t)}catch(t){e.error=u(t)}else r=o(t);e.took=A.now()-e.started,e.nextState=s(i());var n=a.diff&&"function"==typeof f?f(i,t):a.diff;if(p(d,Object.assign({},a,{diff:n})),d.length=0,e.error)throw e.error;return r}}}}var h,m,S=function(t,e){return new Array(e+1).join(t)},O=function(t,e){return S("0",e-t.toString().length)+t},I=function(t){return O(t.getHours(),2)+":"+O(t.getMinutes(),2)+":"+O(t.getSeconds(),2)+"."+O(t.getMilliseconds(),3)},A="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},P=[];h="object"===(void 0===M?"undefined":E(M))&&M?M:"undefined"!=typeof window?window:{},m=h.DeepDiff,m&&P.push(function(){void 0!==m&&h.DeepDiff===i&&(h.DeepDiff=m,m=void 0)}),e(g,r),e(v,r),e(y,r),e(b,r),Object.defineProperties(i,{diff:{value:i,enumerable:!0},observableDiff:{value:w,enumerable:!0},applyDiff:{value:u,enumerable:!0},applyChange:{value:o,enumerable:!0},revertChange:{value:n,enumerable:!0},isConflict:{value:function(){return void 0!==m},enumerable:!0},noConflict:{value:function(){return P&&(P.forEach(function(t){t()}),P=null),i},enumerable:!0}});var T={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},C={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(t){return t},actionTransformer:function(t){return t},errorTransformer:function(t){return t},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},k=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.dispatch,r=t.getState;return"function"==typeof e||"function"==typeof r?d()({dispatch:e,getState:r}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};t.defaults=C,t.createLogger=d,t.logger=k,t.default=k,Object.defineProperty(t,"__esModule",{value:!0})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],499:[function(t,e,r){"use strict";function n(o){return function(t){var r=t.dispatch,n=t.getState;return function(e){return function(t){return"function"==typeof t?t(r,n,o):e(t)}}}}r.__esModule=!0;var o=n();o.withExtraArgument=n,r.default=o},{}],500:[function(t,e,r){"use strict";function n(){for(var t=arguments.length,u=Array(t),e=0;e<t;e++)u[e]=arguments[e];return function(s){return function(t,e,r){var n=s(t,e,r),o=n.dispatch,i=[],a={getState:n.getState,dispatch:function(t){return o(t)}};return i=u.map(function(t){return t(a)}),o=c.default.apply(void 0,i)(n.dispatch),l({},n,{dispatch:o})}}}r.__esModule=!0;var l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};r.default=n;var o=t("./compose"),c=function(t){return t&&t.__esModule?t:{default:t}}(o)},{"./compose":503}],501:[function(t,e,r){"use strict";function s(t,e){return function(){return e(t.apply(void 0,arguments))}}function n(t,e){if("function"==typeof t)return s(t,e);if("object"!=typeof t||null===t)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===t?"null":typeof t)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var r=Object.keys(t),n={},o=0;o<r.length;o++){var i=r[o],a=t[i];"function"==typeof a&&(n[i]=s(a,e))}return n}r.__esModule=!0,r.default=n},{}],502:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function p(t,e){var r=e&&e.type;return"Given action "+(r&&'"'+r.toString()+'"'||"an action")+', reducer "'+t+'" returned undefined. To ignore an action, you must explicitly return the previous state.'}function o(r){Object.keys(r).forEach(function(t){var e=r[t];if(void 0===e(void 0,{type:a.ActionTypes.INIT}))throw new Error('Reducer "'+t+'" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined.');if(void 0===e(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+a.ActionTypes.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined.')})}function i(t){for(var e=Object.keys(t),c={},r=0;r<e.length;r++){var n=e[r];"function"==typeof t[n]&&(c[n]=t[n])}var f,d=Object.keys(c);try{o(c)}catch(t){f=t}return function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=arguments[1];if(f)throw f;for(var r=!1,n={},o=0;o<d.length;o++){var i=d[o],a=c[i],s=t[i],u=a(s,e);if(void 0===u){var l=p(i,e);throw new Error(l)}n[i]=u,r=r||u!==s}return r?n:t}}r.__esModule=!0,r.default=i;var a=t("./createStore"),s=t("lodash/isPlainObject"),u=(n(s),t("./utils/warning"));n(u)},{"./createStore":504,"./utils/warning":506,"lodash/isPlainObject":454}],503:[function(t,e,r){"use strict";function n(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];if(0===e.length)return function(t){return t};if(1===e.length)return e[0];var n=e[e.length-1],o=e.slice(0,-1);return function(){return o.reduceRight(function(t,e){return e(t)},n.apply(void 0,arguments))}}r.__esModule=!0,r.default=n},{}],504:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function m(t,e,r){function n(){p===d&&(p=d.slice())}function o(){return f}function i(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var r=!0;return n(),p.push(e),function(){if(r){r=!1,n();var t=p.indexOf(e);p.splice(t,1)}}}function a(t){if(!(0,g.default)(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(h)throw new Error("Reducers may not dispatch actions.");try{h=!0,f=c(f,t)}finally{h=!1}for(var e=d=p,r=0;r<e.length;r++)e[r]();return t}function s(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");c=t,a({type:y.INIT})}function u(){var t,r=i;return t={subscribe:function(t){function e(){t.next&&t.next(o())}if("object"!=typeof t)throw new TypeError("Expected the observer to be an object.");return e(),{unsubscribe:r(e)}}},t[v.default]=function(){return this},t}var l;if("function"==typeof e&&void 0===r&&(r=e,e=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(m)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var c=t,f=e,d=[],p=d,h=!1;return a({type:y.INIT}),l={dispatch:a,subscribe:i,getState:o,replaceReducer:s},l[v.default]=u,l}r.__esModule=!0,r.ActionTypes=void 0,r.default=m;var o=t("lodash/isPlainObject"),g=n(o),i=t("symbol-observable"),v=n(i),y=r.ActionTypes={INIT:"@@redux/INIT"}},{"lodash/isPlainObject":454,"symbol-observable":511}],505:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.compose=r.applyMiddleware=r.bindActionCreators=r.combineReducers=r.createStore=void 0;var o=t("./createStore"),i=n(o),a=t("./combineReducers"),s=n(a),u=t("./bindActionCreators"),l=n(u),c=t("./applyMiddleware"),f=n(c),d=t("./compose"),p=n(d),h=t("./utils/warning");n(h);r.createStore=i.default,r.combineReducers=s.default,r.bindActionCreators=l.default,r.applyMiddleware=f.default,r.compose=p.default},{"./applyMiddleware":500,"./bindActionCreators":501,"./combineReducers":502,"./compose":503,"./createStore":504,"./utils/warning":506}],506:[function(t,e,r){"use strict";function n(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t);try{throw new Error(t)}catch(t){}}r.__esModule=!0,r.default=n},{}],507:[function(t,R,e){(function(t){!function(r){"use strict";function i(t,e,r,n){var o=e&&e.prototype instanceof s?e:s,i=Object.create(o.prototype),a=new d(n||[]);return i._invoke=u(t,r,a),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}function s(){}function n(){}function e(){}function t(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function a(s){function u(t,e,r,n){var o=l(s[t],s,e);if("throw"!==o.type){var i=o.arg,a=i.value;return a&&"object"==typeof a&&v.call(a,"__await")?Promise.resolve(a.__await).then(function(t){u("next",t,r,n)},function(t){u("throw",t,r,n)}):Promise.resolve(a).then(function(t){i.value=t,r(i)},n)}n(o.arg)}function t(r,n){function t(){return new Promise(function(t,e){u(r,n,t,e)})}return e=e?e.then(t,t):t()}"object"==typeof r.process&&r.process.domain&&(u=r.process.domain.bind(u));var e;this._invoke=t}function u(i,a,s){var u=O;return function(t,e){if(u===E)throw new Error("Generator is already running");if(u===j){if("throw"===t)throw e;return h()}for(s.method=t,s.arg=e;;){var r=s.delegate;if(r){var n=c(r,s);if(n){if(n===P)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(u===O)throw u=j,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);u=E;var o=l(i,a,s);if("normal"===o.type){if(u=s.done?j:A,o.arg===P)continue;return{value:o.arg,done:s.done}}"throw"===o.type&&(u=j,s.method="throw",s.arg=o.arg)}}}function c(t,e){var r=t.iterator[e.method];if(r===m){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=m,c(t,e),"throw"===e.method))return P;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return P}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,P;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=m),e.delegate=null,P):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,P)}function o(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function f(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(o,this),this.reset(!0)}function p(e){if(e){var t=e[b];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(v.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=m,t.done=!0,t};return n.next=n}}return{next:h}}function h(){return{value:m,done:!0}}var m,g=Object.prototype,v=g.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},b=y.iterator||"@@iterator",_=y.asyncIterator||"@@asyncIterator",x=y.toStringTag||"@@toStringTag",w="object"==typeof R,S=r.regeneratorRuntime;if(S)return void(w&&(R.exports=S));S=r.regeneratorRuntime=w?R.exports:{},S.wrap=i;var O="suspendedStart",A="suspendedYield",E="executing",j="completed",P={},T={};T[b]=function(){return this};var C=Object.getPrototypeOf,k=C&&C(C(p([])));k&&k!==g&&v.call(k,b)&&(T=k);var M=e.prototype=s.prototype=Object.create(T);n.prototype=M.constructor=e,e.constructor=n,e[x]=n.displayName="GeneratorFunction",S.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))},S.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,e):(t.__proto__=e,x in t||(t[x]="GeneratorFunction")),t.prototype=Object.create(M),t},S.awrap=function(t){return{__await:t}},t(a.prototype),a.prototype[_]=function(){return this},S.AsyncIterator=a,S.async=function(t,e,r,n){var o=new a(i(t,e,r,n));return S.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},t(M),M[x]="Generator",M[b]=function(){return this},M.toString=function(){return"[object Generator]"},S.keys=function(r){var n=[];for(var t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},S.values=p,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(f),!t)for(var e in this)"t"===e.charAt(0)&&v.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=m)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){function t(t,e){return i.type="throw",i.arg=r,n.next=t,e&&(n.method="next",n.arg=m),!!e}if(this.done)throw r;for(var n=this,e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=v.call(o,"catchLoc"),s=v.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&v.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,P):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),P},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),f(r),P}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;f(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:p(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=m),P}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],508:[function(t,e,r){"use strict";function o(t,e){return t===e}function i(t,e,r){if(null===e||null===r||e.length!==r.length)return!1;for(var n=e.length,o=0;o<n;o++)if(!t(e[o],r[o]))return!1;return!0}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=null,n=null;return function(){return i(e,r,arguments)||(n=t.apply(null,arguments)),r=arguments,n}}function f(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every(function(t){return"function"==typeof t})){var r=e.map(function(t){return typeof t}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return e}function n(u){for(var t=arguments.length,l=Array(t>1?t-1:0),e=1;e<t;e++)l[e-1]=arguments[e];return function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=0,o=e.pop(),i=f(e),a=u.apply(void 0,[function(){return n++,o.apply(null,arguments)}].concat(l)),s=c(function(){for(var t=[],e=i.length,r=0;r<e;r++)t.push(i[r].apply(null,arguments));return a.apply(null,t)});return s.resultFunc=o,s.recomputations=function(){return n},s.resetRecomputations=function(){return n=0},s}}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map(function(t){return e[t]}),function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce(function(t,e,r){return t[n[r]]=e,t},{})})}r.__esModule=!0,r.defaultMemoize=c,r.createSelectorCreator=n,r.createStructuredSelector=a;var s=r.createSelector=n(c)},{}],509:[function(t,e,r){"use strict";e.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}},{}],510:[function(t,e,r){function n(t,e,r){this.f=t,this.once=e,this.priority=r}function o(){this.handlers=[]}function i(t,e){for(var r=0;r<t.handlers.length&&!(t.handlers[r].priority<e.priority);r++);t.handlers=t.handlers.slice(0,r).concat(e).concat(t.handlers.slice(r))}function a(){o.call(this)}function s(){o.call(this)}function u(){o.call(this)}r.Subscription=o,o.prototype.handlersForDispatch=function(){for(var t=this.handlers,e=null,r=t.length-1;r>=0;r--)t[r].once&&(e||(e=t.slice()),e.splice(r,1));return e&&(this.handlers=e),t},o.prototype.add=function(t,e){i(this,new n(t,!1,e||0))},o.prototype.addOnce=function(t,e){i(this,new n(t,!0,e||0))},o.prototype.remove=function(t){for(var e=0;e<this.handlers.length;e++)if(this.handlers[e].f==t)return void(this.handlers=this.handlers.slice(0,e).concat(this.handlers.slice(e+1)))},o.prototype.hasHandler=function(){return this.handlers.length>0},o.prototype.dispatch=function(){for(var t=this.handlersForDispatch(),e=0;e<t.length;e++)t[e].f.apply(null,arguments)},r.PipelineSubscription=a,a.prototype=new o,a.prototype.dispatch=function(t){for(var e=this.handlersForDispatch(),r=0;r<e.length;r++)t=e[r].f(t);return t},r.StoppableSubscription=s,s.prototype=new o,s.prototype.dispatch=function(){for(var t=this.handlersForDispatch(),e=0;e<t.length;e++){var r=t[e].f.apply(null,arguments);if(r)return r}},r.DOMSubscription=u,u.prototype=new o,u.prototype.dispatch=function(t){for(var e=this.handlersForDispatch(),r=0;r<e.length;r++)if(e[r].f(t)||t.defaultPrevented)return!0;return!1}},{}],511:[function(i,a,s){(function(t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e,r=i("./ponyfill.js"),n=function(t){return t&&t.__esModule?t:{default:t}}(r);e="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:void 0!==a?a:Function("return this")();var o=(0,n.default)(e);s.default=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ponyfill.js":512}],512:[function(t,e,r){"use strict";function n(t){var e,r=t.Symbol;return"function"==typeof r?r.observable?e=r.observable:(e=r("observable"),r.observable=e):e="@@observable",e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],513:[function(u,t,l){(function(t,e){function r(t,e){this._id=t,this._clearFn=e}var n=u("process/browser.js").nextTick,o=Function.prototype.apply,i=Array.prototype.slice,a={},s=0;l.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},l.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},l.clearTimeout=l.clearInterval=function(t){t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},l.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},l.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},l._unrefActive=l.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},l.setImmediate="function"==typeof t?t:function(t){var e=s++,r=!(arguments.length<2)&&i.call(arguments,1);return a[e]=!0,n(function(){a[e]&&(r?t.apply(null,r):t.call(null),l.clearImmediate(e))}),e},l.clearImmediate="function"==typeof e?e:function(t){delete a[t]}}).call(this,u("timers").setImmediate,u("timers").clearImmediate)},{"process/browser.js":486,timers:513}],514:[function(t,e,r){"use strict";function j(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function n(t,e,r){if(t&&B.isObject(t)&&t instanceof j)return t;var n=new j;return n.parse(t,e,r),n}function o(t){return B.isString(t)&&(t=n(t)),t instanceof j?t.format():j.prototype.format.call(t)}function i(t,e){return n(t,!1,!0).resolve(e)}function a(t,e){return t?n(t,!1,!0).resolveObject(e):e}var N=t("punycode"),B=t("./util");r.parse=n,r.resolve=i,r.resolveObject=a,r.format=o,r.Url=j;var I=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,L=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["<",">",'"',"`"," ","\r","\n","\t"],l=["{","}","|","\\","^","`"].concat(u),D=["'"].concat(l),F=["%","/","?",";","#"].concat(D),G=["/","?","#"],z=/^[+a-z0-9A-Z_-]{0,63}$/,H=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,W={javascript:!0,"javascript:":!0},U={javascript:!0,"javascript:":!0},V={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},q=t("querystring");j.prototype.parse=function(t,e,r){if(!B.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),o=-1!==n&&n<t.indexOf("#")?"?":"#",i=t.split(o),a=/\\/g;i[0]=i[0].replace(a,"/"),t=i.join(o);var s=t;if(s=s.trim(),!r&&1===t.split("#").length){var u=L.exec(s);if(u)return this.path=s,this.href=s,this.pathname=u[1],u[2]?(this.search=u[2],this.query=e?q.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var l=I.exec(s);if(l){l=l[0];var c=l.toLowerCase();this.protocol=c,s=s.substr(l.length)}if(r||l||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var f="//"===s.substr(0,2);!f||l&&U[l]||(s=s.substr(2),this.slashes=!0)}if(!U[l]&&(f||l&&!V[l])){for(var d=-1,p=0;p<G.length;p++){var h=s.indexOf(G[p]);-1!==h&&(-1===d||h<d)&&(d=h)}var m,g;g=-1===d?s.lastIndexOf("@"):s.lastIndexOf("@",d),-1!==g&&(m=s.slice(0,g),s=s.slice(g+1),this.auth=decodeURIComponent(m)),d=-1;for(var p=0;p<F.length;p++){var h=s.indexOf(F[p]);-1!==h&&(-1===d||h<d)&&(d=h)}-1===d&&(d=s.length),this.host=s.slice(0,d),s=s.slice(d),this.parseHost(),this.hostname=this.hostname||"";var v="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!v)for(var y=this.hostname.split(/\./),p=0,b=y.length;p<b;p++){var _=y[p];if(_&&!_.match(z)){for(var x="",w=0,S=_.length;w<S;w++)_.charCodeAt(w)>127?x+="x":x+=_[w];if(!x.match(z)){var O=y.slice(0,p),A=y.slice(p+1),E=_.match(H);E&&(O.push(E[1]),A.unshift(E[2])),A.length&&(s="/"+A.join(".")+s),this.hostname=O.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=N.toASCII(this.hostname));var j=this.port?":"+this.port:"",P=this.hostname||"";this.host=P+j,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!W[c])for(var p=0,b=D.length;p<b;p++){var T=D[p];if(-1!==s.indexOf(T)){var C=encodeURIComponent(T);C===T&&(C=escape(T)),s=s.split(T).join(C)}}var k=s.indexOf("#");-1!==k&&(this.hash=s.substr(k),s=s.slice(0,k));var M=s.indexOf("?");if(-1!==M?(this.search=s.substr(M),this.query=s.substr(M+1),e&&(this.query=q.parse(this.query)),s=s.slice(0,M)):e&&(this.search="",this.query={}),s&&(this.pathname=s),V[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var j=this.pathname||"",R=this.search||"";this.path=j+R}return this.href=this.format(),this},j.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&B.isObject(this.query)&&Object.keys(this.query).length&&(i=q.stringify(this.query));var a=this.search||i&&"?"+i||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||V[e])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),a=a.replace("#","%23"),e+o+r+a+n},j.prototype.resolve=function(t){return this.resolveObject(n(t,!1,!0)).format()},j.prototype.resolveObject=function(t){if(B.isString(t)){var e=new j;e.parse(t,!1,!0),t=e}for(var r=new j,n=Object.keys(this),o=0;o<n.length;o++){var i=n[o];r[i]=this[i]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),s=0;s<a.length;s++){var u=a[s];"protocol"!==u&&(r[u]=t[u])}return V[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!V[t.protocol]){for(var l=Object.keys(t),c=0;c<l.length;c++){var f=l[c];r[f]=t[f]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||U[t.protocol])r.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var p=r.pathname||"",h=r.search||"";r.path=p+h}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&"/"===r.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=g||m||r.host&&t.pathname,y=v,b=r.pathname&&r.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],_=r.protocol&&!V[r.protocol];if(_&&(r.hostname="",r.port=null,r.host&&(""===b[0]?b[0]=r.host:b.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),v=v&&(""===d[0]||""===b[0])),g)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,b=d;else if(d.length)b||(b=[]),b.pop(),b=b.concat(d),r.search=t.search,r.query=t.query;else if(!B.isNullOrUndefined(t.search)){if(_){r.hostname=r.host=b.shift();var x=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");x&&(r.auth=x.shift(),r.host=r.hostname=x.shift())}return r.search=t.search,r.query=t.query,B.isNull(r.pathname)&&B.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var w=b.slice(-1)[0],S=(r.host||t.host||b.length>1)&&("."===w||".."===w)||""===w,O=0,A=b.length;A>=0;A--)w=b[A],"."===w?b.splice(A,1):".."===w?(b.splice(A,1),O++):O&&(b.splice(A,1),O--);if(!v&&!y)for(;O--;O)b.unshift("..");!v||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),S&&"/"!==b.join("/").substr(-1)&&b.push("");var E=""===b[0]||b[0]&&"/"===b[0].charAt(0);if(_){r.hostname=r.host=E?"":b.length?b.shift():"";var x=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");x&&(r.auth=x.shift(),r.host=r.hostname=x.shift())}return v=v||r.host&&b.length,v&&!E&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),B.isNull(r.pathname)&&B.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},j.prototype.parseHost=function(){var t=this.host,e=s.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":515,punycode:492,querystring:496}],515:[function(t,e,r){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],516:[function(t,e,r){function n(t){var e=c&&(t.ctrlKey||t.altKey||t.metaKey)||s&&t.shiftKey&&t.key&&1==t.key.length,r=!e&&t.key||(t.shiftKey?i:o)[t.keyCode]||t.key||"Unidentified";return"Esc"==r&&(r="Escape"),"Del"==r&&(r="Delete"),"Left"==r&&(r="ArrowLeft"),"Up"==r&&(r="ArrowUp"),"Right"==r&&(r="ArrowRight"),"Down"==r&&(r="ArrowDown"),r}for(var o={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},i={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:";",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},a="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),s="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),u="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),l="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),c=a&&(l||+a[1]<57)||u&&l,f=0;f<10;f++)o[48+f]=o[96+f]=String(f);for(var f=1;f<=24;f++)o[f+111]="F"+f;for(var f=65;f<=90;f++)o[f]=String.fromCharCode(f+32),i[f]=String.fromCharCode(f);for(var d in o)i.hasOwnProperty(d)||(i[d]=o[d]);e.exports=n,n.base=o,n.shift=i},{}],517:[function(t,e,r){!function(t){"use strict";function n(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function o(t){return"string"!=typeof t&&(t=String(t)),t}function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return v.iterable&&(t[Symbol.iterator]=function(){return t}),t}function a(e){this.map={},e instanceof a?e.forEach(function(t,e){this.append(e,t)},this):Array.isArray(e)?e.forEach(function(t){this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function e(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function s(r){return new Promise(function(t,e){r.onload=function(){t(r.result)},r.onerror=function(){e(r.error)}})}function r(t){var e=new FileReader,r=s(e);return e.readAsArrayBuffer(t),r}function u(t){var e=new FileReader,r=s(e);return e.readAsText(t),r}function l(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}function c(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(v.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(v.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(v.arrayBuffer&&v.blob&&b(t))this._bodyArrayBuffer=c(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!_(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=c(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var t=e(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?e(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(r)}),this.text=function(){var t=e(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(l(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function d(t){var e=t.toUpperCase();return x.indexOf(e)>-1?e:t}function p(t,e){e=e||{};var r=e.body;if(t instanceof p){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new a(t.headers)),this.method=t.method,this.mode=t.mode,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new a(e.headers)),this.method=d(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function h(t){var o=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),r=e.shift().replace(/\+/g," "),n=e.join("=").replace(/\+/g," ");o.append(decodeURIComponent(r),decodeURIComponent(n))}}),o}function m(t){var o=new a;return t.split(/\r?\n/).forEach(function(t){var e=t.split(":"),r=e.shift().trim();if(r){var n=e.join(":").trim();o.append(r,n)}}),o}function g(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"确定",this.headers=new a(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var v={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(v.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=function(t){return t&&DataView.prototype.isPrototypeOf(t)},_=ArrayBuffer.isView||function(t){return t&&y.indexOf(Object.prototype.toString.call(t))>-1};a.prototype.append=function(t,e){t=n(t),e=o(e);var r=this.map[t];this.map[t]=r?r+","+e:e},a.prototype.delete=function(t){delete this.map[n(t)]},a.prototype.get=function(t){return t=n(t),this.has(t)?this.map[t]:null},a.prototype.has=function(t){return this.map.hasOwnProperty(n(t))},a.prototype.set=function(t,e){this.map[n(t)]=o(e)},a.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},a.prototype.keys=function(){var r=[];return this.forEach(function(t,e){r.push(e)}),i(r)},a.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),i(e)},a.prototype.entries=function(){var r=[];return this.forEach(function(t,e){r.push([e,t])}),i(r)},v.iterable&&(a.prototype[Symbol.iterator]=a.prototype.entries);var x=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},f.call(p.prototype),f.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},g.error=function(){var t=new g(null,{status:0,statusText:""});return t.type="error",t};var w=[301,302,303,307,308];g.redirect=function(t,e){if(-1===w.indexOf(e))throw new RangeError("Invalid status code");return new g(null,{status:e,headers:{location:t}})},t.Headers=a,t.Request=p,t.Response=g,t.fetch=function(o,i){return new Promise(function(r,t){var e=new p(o,i),n=new XMLHttpRequest;n.onload=function(){var t={status:n.status,statusText:n.statusText,headers:m(n.getAllResponseHeaders()||"")};t.url="responseURL"in n?n.responseURL:t.headers.get("X-Request-URL");var e="response"in n?n.response:n.responseText;r(new g(e,t))},n.onerror=function(){t(new TypeError("Network request failed"))},n.ontimeout=function(){t(new TypeError("Network request failed"))},n.open(e.method,e.url,!0),"include"===e.credentials&&(n.withCredentials=!0),"responseType"in n&&v.blob&&(n.responseType="blob"),e.headers.forEach(function(t,e){n.setRequestHeader(e,t)}),n.send(void 0===e._bodyInit?null:e._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},{}],518:[function(t,e,r){"use strict";function i(t,o,i,a){return new Promise(function(e,r){function n(){t().then(function(t){try{o(t)?e(t):setTimeout(n,i)}catch(t){r(t)}},function(t){return r(t)})}setTimeout(n,a||0)})}function n(t,a){function s(t,e,r,n){return Promise.resolve({indigo_version:1,imago_versions:2})}function e(n,o,i){return function(t,e){var r=Object.assign({},i,t);return r.options=Object.assign(r.options||{},a,e),u.then(function(){return s(n,o,JSON.stringify(r),{"Content-Type":"application/json"})})}}var u=(!t||/\/$/.test(t),s("GET","info").then(function(t){return{indigoVersion:t.indigo_version,imagoVersions:t.imago_versions}}).catch(function(){}));return Object.assign(u,{convert:e("POST","indigo/convert"),layout:e("POST","indigo/layout"),clean:e("POST","indigo/clean"),aromatize:e("POST","indigo/aromatize"),dearomatize:e("POST","indigo/dearomatize"),calculateCip:e("POST","indigo/calculate_cip"),automap:e("POST","indigo/automap"),check:e("POST","indigo/check"),calculate:e("POST","indigo/calculate"),recognize:function(t,e){var r=e?"?version="+e:"",n=s("POST","imago/uploads"+r,t,{"Content-Type":t.type||"application/octet-stream"}),o=s.bind(null,"GET","imago/uploads/:id");return n.then(function(t){return i(o.bind(null,{id:t.upload_id}),function(t){if("FAILURE"===t.state)throw t;return"SUCCESS"===t.state},500,300)}).then(function(t){return{struct:t.metadata.mol_str}})}})}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],519:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={H:["#000000","#000000"],He:["#89a1a1","#d9ffff"],Li:["#bd77ed","#cc80ff"],Be:["#8fbc00","#c2ff00"],B:["#c18989","#ffb5b5"],C:["#000000","#000000"],N:["#304ff7","#304ff7"],O:["#ff0d0d","#ff0d0d"],F:["#78bc42","#8fe04f"],Ne:["#80a2af","#b3e3f5"],Na:["#ab5cf2","#ab5cf2"],Mg:["#6fcd00","#8aff00"],Al:["#a99393","#bfa6a6"],Si:["#b29478","#f0c7a1"],P:["#ff8000","#ff8000"],S:["#c99a19","#d9a61a"],Cl:["#1fd01f","#1fd01f"],Ar:["#69acba","#80d1e3"],K:["#8f40d4","#8f40d4"],Ca:["#38e900","#3dff00"],Sc:["#999999","#e6e6e6"],Ti:["#979a9e","#bfc2c7"],V:["#99999e","#a6a6ab"],Cr:["#8a99c7","#8a99c7"],Mn:["#9c7ac7","#9c7ac7"],Fe:["#e06633","#e06633"],Co:["#d37e8e","#f08fa1"],Ni:["#4ece4e","#4fd14f"],Cu:["#c78033","#c78033"],Zn:["#7d80b0","#7d80b0"],Ga:["#bc8b8b","#c28f8f"],Ge:["#668f8f","#668f8f"],As:["#b87ddd","#bd80e3"],Se:["#e59100","#ffa100"],Br:["#a62929","#a62929"],Kr:["#59b1c9","#5cb8d1"],Rb:["#702eb0","#702eb0"],Sr:["#00ff00","#00ff00"],Y:["#66afaf","#94ffff"],Zr:["#71abab","#94e0e0"],Nb:["#67aeb4","#73c2c9"],Mo:["#54b5b5","#54b5b5"],Tc:["#3b9e9e","#3b9e9e"],Ru:["#248f8f","#248f8f"],Rh:["#0a7d8c","#0a7d8c"],Pd:["#006985","#006985"],Ag:["#9a9a9a","#bfbfbf"],Cd:["#b29764","#ffd98f"],In:["#a67573","#a67573"],Sn:["#668080","#668080"],Sb:["#9e63b5","#9e63b5"],Te:["#d47a00","#d47a00"],I:["#940094","#940094"],Xe:["#429eb0","#429eb0"],Cs:["#57178f","#57178f"],Ba:["#00c900","#00c900"],La:["#5caed1","#70d4ff"],Ce:["#9d9d7b","#ffffc7"],Pr:["#8ca581","#d9ffc7"],Nd:["#84a984","#c7ffc7"],Pm:["#71b18a","#a3ffc7"],Sm:["#66b68e","#8fffc7"],Eu:["#4ac298","#61ffc7"],Gd:["#37cb9e","#45ffc7"],Tb:["#28d1a4","#30ffc7"],Dy:["#1bd7a8","#1fffc7"],Ho:["#00e98f","#00ff9c"],Er:["#00e675","#00e675"],Tm:["#00d452","#00d452"],Yb:["#00bf38","#00bf38"],Lu:["#00ab24","#00ab24"],Hf:["#47b3ec","#4dc2ff"],Ta:["#4da6ff","#4da6ff"],W:["#2194d6","#2194d6"],Re:["#267dab","#267dab"],Os:["#266696","#266696"],Ir:["#175487","#175487"],Pt:["#9898a3","#d1d1e0"],Au:["#c19e1c","#ffd124"],Hg:["#9797ac","#b8b8d1"],Tl:["#a6544d","#a6544d"],Pb:["#575961","#575961"],Bi:["#9e4fb5","#9e4fb5"],Po:["#ab5c00","#ab5c00"],At:["#754f45","#754f45"],Rn:["#428296","#428296"],Fr:["#420066","#420066"],Ra:["#007d00","#007d00"],Ac:["#6aa2ec","#70abfa"],Th:["#00baff","#00baff"],Pa:["#00a1ff","#00a1ff"],U:["#008fff","#008fff"],Np:["#0080ff","#0080ff"],Pu:["#006bff","#006bff"],Am:["#545cf2","#545cf2"],Cm:["#785ce3","#785ce3"],Bk:["#8a4fe3","#8a4fe3"],Cf:["#a136d4","#a136d4"],Es:["#b31fd4","#b31fd4"],Fm:["#000000","#000000"],Md:["#000000","#000000"],No:["#000000","#000000"],Lr:["#000000","#000000"],Rf:["#47b3ec","#4dc2ff"],Db:["#4da6ff","#4da6ff"],Sg:["#2194d6","#2194d6"],Bh:["#267dab","#267dab"],Hs:["#266696","#266696"],Mt:["#175487","#175487"],Ds:["#9898a3","#d1d1e0"],Rg:["#c19e1c","#ffd124"],Cn:["#9797ac","#b8b8d1"],Nh:["#000000","#000000"],Fl:["#000000","#000000"],Mc:["#000000","#000000"],Lv:["#000000","#000000"],Ts:["#000000","#000000"],Og:["#000000","#000000"]};r.sketchingColors=Object.keys(n).reduce(function(t,e){return t[e]=n[e][0],t},{}),r.oldColors=Object.keys(n).reduce(function(t,e){return t[e]=n[e][1],t},{})},{}],520:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=[null,{label:"H",period:1,group:1,title:"Hydrogen",state:"gas",origin:"primordial",type:"diatomic",atomic_mass:1.00794},{label:"He",period:1,group:8,title:"Helium",state:"gas",origin:"primordial",type:"noble",atomic_mass:4.0026022},{label:"Li",period:2,group:1,title:"Lithium",state:"solid",origin:"primordial",type:"alkali",atomic_mass:6.94},{label:"Be",period:2,group:2,title:"Beryllium",state:"solid",origin:"primordial",type:"alkaline-earth",atomic_mass:9.01218315},{label:"B",period:2,group:3,title:"Boron",state:"solid",origin:"primordial",type:"metalloid",atomic_mass:10.81},{label:"C",period:2,group:4,title:"Carbon",state:"solid",origin:"primordial",type:"polyatomic",atomic_mass:12.011},{label:"N",period:2,group:5,title:"Nitrogen",state:"gas",origin:"primordial",type:"diatomic",atomic_mass:14.007},{label:"O",period:2,group:6,leftH:!0,title:"Oxygen",state:"gas",origin:"primordial",type:"diatomic",atomic_mass:15.999},{label:"F",period:2,group:7,leftH:!0,title:"Fluorine",state:"gas",origin:"primordial",type:"diatomic",atomic_mass:18.9984031636},{label:"Ne",period:2,group:8,title:"Neon",state:"gas",origin:"primordial",type:"noble",atomic_mass:20.17976},{label:"Na",period:3,group:1,title:"Sodium",state:"solid",origin:"primordial",type:"alkali",atomic_mass:22.989769282},{label:"Mg",period:3,group:2,title:"Magnesium",state:"solid",origin:"primordial",type:"alkaline-earth",atomic_mass:24.305},{label:"Al",period:3,group:3,title:"Aluminium",state:"solid",origin:"primordial",type:"post-transition",atomic_mass:26.98153857},{label:"Si",period:3,group:4,title:"Silicon",state:"solid",origin:"primordial",type:"metalloid",atomic_mass:28.085},{label:"P",period:3,group:5,title:"Phosphorus",state:"solid",origin:"primordial",type:"polyatomic",atomic_mass:30.9737619985},{label:"S",period:3,group:6,leftH:!0,title:"Sulfur",state:"solid",origin:"primordial",type:"polyatomic",atomic_mass:32.06},{label:"Cl",period:3,group:7,leftH:!0,title:"Chlorine",state:"gas",origin:"primordial",type:"diatomic",atomic_mass:35.45},{label:"Ar",period:3,group:8,title:"Argon",state:"gas",origin:"primordial",type:"noble",atomic_mass:39.9481},{label:"K",period:4,group:1,title:"Potassium",state:"solid",origin:"primordial",type:"alkali",atomic_mass:39.09831},{label:"Ca",period:4,group:2,title:"Calcium",state:"solid",origin:"primordial",type:"alkaline-earth",atomic_mass:40.0784},{label:"Sc",period:4,group:3,title:"Scandium",state:"solid",origin:"primordial",type:"transition",atomic_mass:44.9559085},{label:"Ti",period:4,group:4,title:"Titanium",state:"solid",origin:"primordial",type:"transition",atomic_mass:47.8671},{label:"V",period:4,group:5,title:"Vanadium",state:"solid",origin:"primordial",type:"transition",atomic_mass:50.94151},{label:"Cr",period:4,group:6,title:"Chromium",state:"solid",origin:"primordial",type:"transition",atomic_mass:51.99616},{label:"Mn",period:4,group:7,title:"Manganese",state:"solid",origin:"primordial",type:"transition",atomic_mass:54.9380443},{label:"Fe",period:4,group:8,title:"Iron",state:"solid",origin:"primordial",type:"transition",atomic_mass:55.8452},{label:"Co",period:4,group:8,title:"Cobalt",state:"solid",origin:"primordial",type:"transition",atomic_mass:58.9331944},{label:"Ni",period:4,group:8,title:"Nickel",state:"solid",origin:"primordial",type:"transition",atomic_mass:58.69344},{label:"Cu",period:4,group:1,title:"Copper",state:"solid",origin:"primordial",type:"transition",atomic_mass:63.5463},{label:"Zn",period:4,group:2,title:"Zinc",state:"solid",origin:"primordial",type:"transition",atomic_mass:65.382},{label:"Ga",period:4,group:3,title:"Gallium",state:"solid",origin:"primordial",type:"post-transition",atomic_mass:69.7231},{label:"Ge",period:4,group:4,title:"Germanium",state:"solid",origin:"primordial",type:"metalloid",atomic_mass:72.6308},{label:"As",period:4,group:5,title:"Arsenic",state:"solid",origin:"primordial",type:"metalloid",atomic_mass:74.9215956},{label:"Se",period:4,group:6,leftH:!0,title:"Selenium",state:"solid",origin:"primordial",type:"polyatomic",atomic_mass:78.9718},{label:"Br",period:4,group:7,leftH:!0,title:"Bromine",state:"liquid",origin:"primordial",type:"diatomic",atomic_mass:79.904},{label:"Kr",period:4,group:8,title:"Krypton",state:"gas",origin:"primordial",type:"noble",atomic_mass:83.7982},{label:"Rb",period:5,group:1,title:"Rubidium",state:"solid",origin:"primordial",type:"alkali",atomic_mass:85.46783},{label:"Sr",period:5,group:2,title:"Strontium",state:"solid",origin:"primordial",type:"alkaline-earth",atomic_mass:87.621},{label:"Y",period:5,group:3,title:"Yttrium",state:"solid",origin:"primordial",type:"transition",atomic_mass:88.905842},{label:"Zr",period:5,group:4,title:"Zirconium",state:"solid",origin:"primordial",type:"transition",atomic_mass:91.2242},{label:"Nb",period:5,group:5,title:"Niobium",state:"solid",origin:"primordial",type:"transition",atomic_mass:92.906372},{label:"Mo",period:5,group:6,title:"Molybdenum",state:"solid",origin:"primordial",type:"transition",atomic_mass:95.951},{label:"Tc",period:5,group:7,title:"Technetium",state:"solid",origin:"decay",type:"transition",atomic_mass:98},{label:"Ru",period:5,group:8,title:"Ruthenium",state:"solid",origin:"primordial",type:"transition",atomic_mass:101.072},{label:"Rh",period:5,group:8,title:"Rhodium",state:"solid",origin:"primordial",type:"transition",atomic_mass:102.905502},{label:"Pd",period:5,group:8,title:"Palladium",state:"solid",origin:"primordial",type:"transition",atomic_mass:106.421},{label:"Ag",period:5,group:1,title:"Silver",state:"solid",origin:"primordial",type:"transition",atomic_mass:107.86822},{label:"Cd",period:5,group:2,title:"Cadmium",state:"solid",origin:"primordial",type:"transition",atomic_mass:112.4144},{label:"In",period:5,group:3,title:"Indium",state:"solid",origin:"primordial",type:"post-transition",atomic_mass:114.8181},{label:"Sn",period:5,group:4,title:"Tin",state:"solid",origin:"primordial",type:"post-transition",atomic_mass:118.7107},{label:"Sb",period:5,group:5,title:"Antimony",state:"solid",origin:"primordial",type:"metalloid",atomic_mass:121.7601},{label:"Te",period:5,group:6,title:"Tellurium",state:"solid",origin:"primordial",type:"metalloid",atomic_mass:127.603},{label:"I",period:5,group:7,leftH:!0,title:"Iodine",state:"solid",origin:"primordial",type:"diatomic",atomic_mass:126.904473},{label:"Xe",period:5,group:8,title:"Xenon",state:"gas",origin:"primordial",type:"noble",atomic_mass:131.2936},{label:"Cs",period:6,group:1,title:"Caesium",state:"solid",origin:"primordial",type:"alkali",atomic_mass:132.905451966},{label:"Ba",period:6,group:2,title:"Barium",state:"solid",origin:"primordial",type:"alkaline-earth",atomic_mass:137.3277},{label:"La",period:6,group:3,title:"Lanthanum",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:138.905477},{label:"Ce",period:6,group:3,title:"Cerium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:140.1161},{label:"Pr",period:6,group:3,title:"Praseodymium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:140.907662},{label:"Nd",period:6,group:3,title:"Neodymium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:144.2423},{label:"Pm",period:6,group:3,title:"Promethium",state:"solid",origin:"decay",type:"lanthanide",atomic_mass:145},{label:"Sm",period:6,group:3,title:"Samarium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:150.362},{label:"Eu",period:6,group:3,title:"Europium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:151.9641},{label:"Gd",period:6,group:3,title:"Gadolinium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:157.253},{label:"Tb",period:6,group:3,title:"Terbium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:158.925352},{label:"Dy",period:6,group:3,title:"Dysprosium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:162.5001},{label:"Ho",period:6,group:3,title:"Holmium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:164.930332},{label:"Er",period:6,group:3,title:"Erbium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:167.2593},{label:"Tm",period:6,group:3,title:"Thulium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:168.934222},{label:"Yb",period:6,group:3,title:"Ytterbium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:173.0451},{label:"Lu",period:6,group:3,title:"Lutetium",state:"solid",origin:"primordial",type:"lanthanide",atomic_mass:174.96681},{label:"Hf",period:6,group:4,title:"Hafnium",state:"solid",origin:"primordial",type:"transition",atomic_mass:178.492},{label:"Ta",period:6,group:5,title:"Tantalum",state:"solid",origin:"primordial",type:"transition",atomic_mass:180.947882},{label:"W",period:6,group:6,title:"Tungsten",state:"solid",origin:"primordial",type:"transition",atomic_mass:183.841},{label:"Re",period:6,group:7,title:"Rhenium",state:"solid",origin:"primordial",type:"transition",atomic_mass:186.2071},{label:"Os",period:6,group:8,title:"Osmium",state:"solid",origin:"primordial",type:"transition",atomic_mass:190.233},{label:"Ir",period:6,group:8,title:"Iridium",state:"solid",origin:"primordial",type:"transition",atomic_mass:192.2173},{label:"Pt",period:6,group:8,title:"Platinum",state:"solid",origin:"primordial",type:"transition",atomic_mass:195.0849},{label:"Au",period:6,group:1,title:"Gold",state:"solid",origin:"primordial",type:"transition",atomic_mass:196.9665695},{label:"Hg",period:6,group:2,title:"Mercury",state:"liquid",origin:"primordial",type:"transition",atomic_mass:200.5923},{label:"Tl",period:6,group:3,title:"Thallium",state:"solid",origin:"primordial",type:"post-transition",atomic_mass:204.38},{label:"Pb",period:6,group:4,title:"Lead",state:"solid",origin:"primordial",type:"post-transition",atomic_mass:207.21},{label:"Bi",period:6,group:5,title:"Bismuth",state:"solid",origin:"primordial",type:"post-transition",atomic_mass:208.980401},{label:"Po",period:6,group:6,title:"Polonium",state:"solid",origin:"decay",type:"post-transition",atomic_mass:209},{label:"At",period:6,group:7,title:"Astatine",state:"solid",origin:"decay",type:"metalloid",atomic_mass:210},{label:"Rn",period:6,group:8,title:"Radon",state:"gas",origin:"decay",type:"noble",atomic_mass:222},{label:"Fr",period:7,group:1,title:"Francium",state:"solid",origin:"decay",type:"alkali",atomic_mass:223},{label:"Ra",period:7,group:2,title:"Radium",state:"solid",origin:"decay",type:"alkaline-earth",atomic_mass:226},{label:"Ac",period:7,group:3,title:"Actinium",state:"solid",origin:"decay",type:"actinide",atomic_mass:227},{label:"Th",period:7,group:3,title:"Thorium",state:"solid",origin:"primordial",type:"actinide",atomic_mass:232.03774},{label:"Pa",period:7,group:3,title:"Protactinium",state:"solid",origin:"decay",type:"actinide",atomic_mass:231.035882},{label:"U",period:7,group:3,title:"Uranium",state:"solid",origin:"primordial",type:"actinide",atomic_mass:238.028913},{label:"Np",period:7,group:3,title:"Neptunium",state:"solid",origin:"decay",type:"actinide",atomic_mass:237},{label:"Pu",period:7,group:3,title:"Plutonium",state:"solid",origin:"decay",type:"actinide",atomic_mass:244},{label:"Am",period:7,group:3,title:"Americium",state:"solid",origin:"synthetic",type:"actinide",atomic_mass:243},{label:"Cm",period:7,group:3,title:"Curium",state:"solid",origin:"synthetic",type:"actinide",atomic_mass:247},{label:"Bk",period:7,group:3,title:"Berkelium",state:"solid",origin:"synthetic",type:"actinide",atomic_mass:247},{label:"Cf",period:7,group:3,title:"Californium",state:"solid",origin:"synthetic",type:"actinide",atomic_mass:251},{label:"Es",period:7,group:3,title:"Einsteinium",state:"solid",origin:"synthetic",type:"actinide",atomic_mass:252},{label:"Fm",period:7,group:3,title:"Fermium",origin:"synthetic",type:"actinide",atomic_mass:257},{label:"Md",period:7,group:3,title:"Mendelevium",origin:"synthetic",type:"actinide",atomic_mass:258},{label:"No",period:7,group:3,title:"Nobelium",origin:"synthetic",type:"actinide",atomic_mass:259},{label:"Lr",period:7,group:3,title:"Lawrencium",origin:"synthetic",type:"actinide",atomic_mass:266},{label:"Rf",period:7,group:4,title:"Rutherfordium",origin:"synthetic",type:"transition",atomic_mass:267},{label:"Db",period:7,group:5,title:"Dubnium",origin:"synthetic",type:"transition",atomic_mass:268},{label:"Sg",period:7,group:6,title:"Seaborgium",origin:"synthetic",type:"transition",atomic_mass:269},{label:"Bh",period:7,group:7,title:"Bohrium",origin:"synthetic",type:"transition",atomic_mass:270},{label:"Hs",period:7,group:8,title:"Hassium",origin:"synthetic",type:"transition",atomic_mass:269},{label:"Mt",period:7,group:8,title:"Meitnerium",origin:"synthetic",atomic_mass:278},{label:"Ds",period:7,group:8,title:"Darmstadtium",origin:"synthetic",atomic_mass:281},{label:"Rg",period:7,group:1,title:"Roentgenium",origin:"synthetic",atomic_mass:282},{label:"Cn",period:7,group:2,title:"Copernicium",origin:"synthetic",type:"transition",atomic_mass:285},{label:"Nh",period:7,group:3,title:"Nihonium",origin:"synthetic",atomic_mass:286},{label:"Fl",period:7,group:4,title:"Flerovium",origin:"synthetic",type:"post-transition",atomic_mass:289},{label:"Mc",period:7,group:5,title:"Moscovium",origin:"synthetic",atomic_mass:289},{label:"Lv",period:7,group:6,title:"Livermorium",origin:"synthetic",atomic_mass:293},{label:"Ts",period:7,group:7,title:"Tennessine",origin:"synthetic",atomic_mass:294},{label:"Og",period:7,group:8,title:"Oganesson",origin:"synthetic",atomic_mass:294}];n.map=n.reduce(function(t,e,r){return e&&(t[e.label]=r),t},{}),r.default=n},{}],521:[function(t,e,r){"use strict";function o(r,n,t){return Object.keys(r).reduce(function(t,e){return"labels"===e?r.labels.reduce(function(t,e){return t[e]=n||!0,t},t):o(r[e],n?n.concat(e):[e],t)},t||{})}function n(t,e){return e.reduce(function(t,e){return t&&t[e]||null},t)}Object.defineProperty(r,"__esModule",{value:!0});var i={atom:{any:{labels:["A","AH"]},"no-carbon":{labels:["Q","QH"]},metal:{labels:["M","MH"]},halogen:{labels:["X","XH"]}},group:{labels:["G","GH","G*","GH*"],acyclic:{labels:["ACY","ACH"],carbo:{labels:["ABC","ABH"],alkynyl:{labels:["AYL","AYH"]},alkyl:{labels:["ALK","ALH"]},alkenyl:{labels:["AEL","AEH"]}},hetero:{labels:["AHC","AHH"],alkoxy:{labels:["AOX","AOH"]}}},cyclic:{labels:["CYC","CYH"],"no-carbon":{labels:["CXX","CXH"]},carbo:{labels:["CBC","CBH"],aryl:{labels:["ARY","ARH"]},cycloalkyl:{labels:["CAL","CAH"]},cycloalkenyl:{labels:["CEL","CEH"]}},hetero:{labels:["CHC","CHH"],aryl:{labels:["HAR","HAH"]}}}},special:{labels:["H+","D","T","R","Pol"]}};i.map=o(i),i.map["*"]=i.map.A,i.get=function(t){return o(n(t))},r.default=i},{}],522:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(0===t[0].search("\\$MDL")){var e=x.default.parseRg2000(t);return e.name=t[3].trim(),e}var r=i(t.slice(3));return r.name=t[0].trim(),r}function i(t){var e=b(t[0],P.default.fmtInfo.countsLinePartition),r=e[11].trim();if(t=t.slice(1),"V2000"===r)return x.default.parseCTabV2000(t,e);if("V3000"===r)return S.default.parseCTabV3000(t,!T);throw new Error("Molfile version unknown: "+r)}function a(t,e){var r=t[0].trim().split(" ");if(r.length>1&&"V3000"===r[1])return S.default.parseRxn3000(t,e);var n=x.default.parseRxn2000(t,e);return n.name=t[1].trim(),n}function s(o,i){var a=[];if(i.bonds.forEach(function(t,e){var r=i.atoms.get(t.begin),n=i.atoms.get(t.end);(r.sgs.has(o.id)&&!n.sgs.has(o.id)||n.sgs.has(o.id)&&!r.sgs.has(o.id))&&a.push(e)},o),0!==a.length&&2!==a.length)throw{id:o.id,"error-type":"cross-bond-number",message:"Unsupported cross-bonds number"};o.bonds=a}function u(o,i){var a=[];i.bonds.forEach(function(t,e){var r=i.atoms.get(t.begin),n=i.atoms.get(t.end);(r.sgs.has(o.id)&&!n.sgs.has(o.id)||n.sgs.has(o.id)&&!r.sgs.has(o.id))&&a.push(e)},o),o.bonds=a}function l(t,e){}function c(t,e){t.atoms=E.SGroup.getAtoms(e,t)}function f(t,e,r,n,o){var i=(r[t.id]+"").padStart(3),a=[];a=a.concat(g("SAL",i,Array.from(t.atomSet.values()),n)),a=a.concat(g("SPA",i,Array.from(t.parentAtomSet.values()),n)),a=a.concat(g("SBL",i,t.bonds,o));var s="M  SMT "+i+" "+t.data.mul;return a.push(s),a=a.concat(v(e,t,i)),a.join("\n")}function d(t,e,r,n,o){var i=(r[t.id]+"").padStart(3),a=[];return a=a.concat(g("SAL",i,t.atoms,n)),a=a.concat(g("SBL",i,t.bonds,o)),a=a.concat(v(e,t,i)),a.join("\n")}function p(t,e,r,n,o){var i=(r[t.id]+"").padStart(3),a=[];return a=a.concat(g("SAL",i,t.atoms,n)),a=a.concat(g("SBL",i,t.bonds,o)),t.data.name&&""!==t.data.name&&a.push("M  SMT "+i+" "+t.data.name),a.join("\n")}function h(t,e,r,n){var o=(r[t.id]+"").padStart(3),i=t.data,a=t.pp;i.absolute||(a=a.sub(E.SGroup.getMassCentre(e,t.atoms)));var s=[];s=s.concat(g("SAL",o,t.atoms,n));var u="M  SDT "+o+" "+(i.fieldName||"").padEnd(30)+(i.fieldType||"").padStart(2)+(i.units||"").padEnd(20)+(i.query||"").padStart(2);i.queryOp&&(u+=i.queryOp.padEnd(15)),s.push(u);var l="M  SDD "+o+" "+P.default.paddedNum(a.x,10,4)+P.default.paddedNum(-a.y,10,4)+"    "+(i.attached?"A":"D")+(i.absolute?"A":"R")+(i.showUnits?"U":" ")+"   "+(i.nCharnCharsToDisplay>=0?P.default.paddedNum(i.nCharnCharsToDisplay,3):"ALL")+"  1   "+(i.tagChar||" ")+"  "+P.default.paddedNum(i.daspPos,1)+"  ";s.push(l);var c=y(i.fieldValue).replace(/\n*$/,"");return c.split("\n").forEach(function(t){for(;t.length>69;)s.push("M  SCD "+o+" "+t.slice(0,69)),t=t.slice(69);s.push("M  SED "+o+" "+t)}),s.join("\n")}function m(t,e,r,n,o){var i=(r[t.id]+"").padStart(3),a=[];return a=a.concat(g("SAL",i,t.atoms,n)),a=a.concat(g("SBL",i,t.bonds,o)),a=a.concat(v(e,t,i)),a.join("\n")}function g(t,e,r,n){if(!r)return[];for(var o=[],i=0;i<Math.floor((r.length+14)/15);++i){for(var a=Math.min(r.length-15*i,15),s="M  "+t+" "+e+" "+P.default.paddedNum(a,2),u=0;u<a;++u)s+=" "+P.default.paddedNum(n[r[15*i+u]],3);o.push(s)}return o}function v(t,e,r){var n=[],o=[],i=new A.default(e.atoms);E.SGroup.getCrossBonds(n,o,t,i),E.SGroup.bracketPos(e,t,o);for(var a=e.bracketBox,s=e.bracketDir,u=s.rotateSC(1,0),l=E.SGroup.getBracketParameters(t,o,i,a,s,u),c=[],f=0;f<l.length;++f){for(var d=l[f],p=d.c.addScaled(d.n,-.5*d.h).yComplement(),h=d.c.addScaled(d.n,.5*d.h).yComplement(),m="M  SDI "+r+P.default.paddedNum(4,3),g=[p.x,p.y,h.x,h.y],v=0;v<g.length;++v)m+=P.default.paddedNum(g[v],10,4);c.push(m)}return c}function y(t){return t.replace(M,"\n")}function b(t,e,r){for(var n=[],o=0,i=0;o<e.length;++o)n.push(t.slice(i,i+e[o])),r&&i++,i+=e[o];return n}Object.defineProperty(r,"__esModule",{value:!0});var _=t("./v2000"),x=n(_),w=t("./v3000"),S=n(w),O=t("../../util/pile"),A=n(O),E=t("./../struct/index"),j=t("./utils"),P=n(j),T=!0,C={MUL:E.SGroup.prepareMulForSaving,SRU:s,SUP:u,DAT:c,GEN:l},k={MUL:f,SRU:d,SUP:p,DAT:h,GEN:m},M=/\r\n|[\n\r]/g;r.default={parseCTab:i,parseMol:o,parseRxn:a,prepareForSaving:C,saveToMolfile:k}},{"../../util/pile":683,"./../struct/index":537,"./utils":526,"./v2000":527,"./v3000":528}],523:[function(t,e,r){"use strict";function n(t,e){var r=new i.default,n=t.split(/\r\n|[\n\r]/g);try{return r.parseCTFile(n,e.reactionRelayout)}catch(t){if(e.badHeaderRecover){try{return r.parseCTFile(n.slice(1),e.reactionRelayout)}catch(t){}try{return r.parseCTFile([""].concat(n),e.reactionRelayout)}catch(t){}}throw t}}Object.defineProperty(r,"__esModule",{value:!0});var o=t("./molfile"),i=function(t){return t&&t.__esModule?t:{default:t}}(o);r.default={stringify:function(t,e){var r=e||{};return new i.default(r.v3000).saveMolecule(t,r.ignoreErrors,r.noRgroups,r.preserveIndigoDesc)},parse:function(t,e){return n(t,e||{})}}},{"./molfile":524}],524:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function h(t){this.molecule=null,this.molfile=null,this.v3000=t||!1}Object.defineProperty(r,"__esModule",{value:!0});var o=t("./../element"),P=n(o),i=t("./common"),T=n(i),a=t("./utils"),C=n(a);h.prototype.parseCTFile=function(t,e){var r=null;return r=0===t[0].search("\\$RXN")?T.default.parseRxn(t,e):T.default.parseMol(t),r.initHalfBonds(),r.initNeighbors(),r.markFragments(),r},h.prototype.prepareSGroups=function(n,o){var i=this.molecule,a=[],s=0;if(this.molecule.sGroupForest.getSGroupsBFS().reverse().forEach(function(t){var e=i.sgroups.get(t),r=!1;try{T.default.prepareForSaving[e.type](e,i)}catch(t){if(!n||"number"!=typeof t.id)throw new Error("Error: "+t.message);r=!0}(r||!o&&/^INDIGO_.+_DESC$/i.test(e.data.fieldName))&&(s+=r,a.push(e.id))},this),s)throw new Error("Warning: "+s+" invalid S-groups were detected. They will be omitted.");for(var t=0;t<a.length;++t)i.sGroupDelete(a[t]);return i},h.prototype.getCTab=function(t,e){return this.molecule=t.clone(),this.prepareSGroups(!1,!1),this.molfile="",this.writeCTab2000(e),this.molfile},h.prototype.saveMolecule=function(r,t,e,n){var o=this;if(this.reaction=r.rxnArrows.size>0,r.rxnArrows.size>1)throw new Error("Reaction may not contain more than one arrow");if(this.molfile=""+r.name,this.reaction){if(r.rgroups.size>0)throw new Error("Reactions with r-groups are not supported at the moment");var i=r.getComponents(),a=i.reactants,s=i.products,u=a.concat(s);this.molfile="$RXN\n"+r.name+"\n\n\n"+C.default.paddedNum(a.length,3)+C.default.paddedNum(s.length,3)+C.default.paddedNum(0,3)+"\n";for(var l=0;l<u.length;++l){var c=new h(!1),f=r.clone(u[l],null,!0),d=c.saveMolecule(f,!1,!0);this.molfile+="$MOL\n"+d}return this.molfile}if(r.rgroups.size>0){if(!e){var p=new h(!1).getCTab(r.getScaffold(),r.rgroups);return this.molfile="$MDL  REV  1\n$MOL\n$HDR\n"+r.name+"\n\n\n$END HDR\n",this.molfile+="$CTAB\n"+p+"$END CTAB\n",r.rgroups.forEach(function(t,e){o.molfile+="$RGP\n",o.writePaddedNumber(e,3),o.molfile+="\n",t.frags.forEach(function(t){var e=new h(!1).getCTab(r.getFragment(t));o.molfile+="$CTAB\n"+e+"$END CTAB\n"}),o.molfile+="$END RGP\n"}),this.molfile+="$END MOL\n",this.molfile}r=r.getScaffold()}return this.molecule=r.clone(),this.prepareSGroups(t,n),this.writeHeader(),this.writeCTab2000(),this.molfile},h.prototype.writeHeader=function(){var t=new Date;this.writeCR(),this.writeWhiteSpace(2),this.write("Ketcher"),this.writeWhiteSpace(),this.writeCR((t.getMonth()+1+"").padStart(2)+(t.getDate()+"").padStart(2)+(t.getFullYear()%100+"").padStart(2)+(t.getHours()+"").padStart(2)+(t.getMinutes()+"").padStart(2)+"2D 1   1.00000     0.00000     0"),this.writeCR()},h.prototype.write=function(t){this.molfile+=t},h.prototype.writeCR=function(t){0==arguments.length&&(t=""),this.molfile+=t+"\n"},h.prototype.writeWhiteSpace=function(t){0==arguments.length&&(t=1),this.write(" ".repeat(Math.max(t,0)))},h.prototype.writePadded=function(t,e){this.write(t),this.writeWhiteSpace(e-t.length)},h.prototype.writePaddedNumber=function(t,e){var r=(t-0).toString();this.writeWhiteSpace(e-r.length),this.write(r)},h.prototype.writePaddedFloat=function(t,e,r){this.write(C.default.paddedNum(t,e,r))},h.prototype.writeCTab2000Header=function(){this.writePaddedNumber(this.molecule.atoms.size,3),this.writePaddedNumber(this.molecule.bonds.size,3),this.writePaddedNumber(0,3),this.writeWhiteSpace(3),this.writePaddedNumber(this.molecule.isChiral?1:0,3),this.writePaddedNumber(0,3),this.writeWhiteSpace(12),this.writePaddedNumber(999,3),this.writeCR(" V2000")},h.prototype.writeCTab2000=function(t){function e(t,e){for(var r=this;e.length>0;){for(var n=[];e.length>0&&n.length<8;)n.push(e[0]),e.splice(0,1);this.write(t),this.writePaddedNumber(n.length,3),n.forEach(function(t){r.writeWhiteSpace(),r.writePaddedNumber(r.mapping[t[0]],3),r.writeWhiteSpace(),r.writePaddedNumber(t[1],3)}),this.writeCR()}}var n=this;this.writeCTab2000Header(),this.mapping={};var o=1,i=[],a=[];for(this.molecule.atoms.forEach(function(t,e){n.writePaddedFloat(t.pp.x,10,4),n.writePaddedFloat(-t.pp.y,10,4),n.writePaddedFloat(t.pp.z,10,4),n.writeWhiteSpace();var r=t.label;null!=t.atomList?(r="L",i.push(e)):t.pseudo?t.pseudo.length>3&&(r="A",a.push({id:e,value:"'"+t.pseudo+"'"})):t.alias?a.push({id:e,value:t.alias}):P.default.map[r]||-1!=["A","Q","X","*","R#"].indexOf(r)||(r="C",a.push({id:e,value:t.label})),n.writePadded(r,3),n.writePaddedNumber(0,2),n.writePaddedNumber(0,3),n.writePaddedNumber(0,3),void 0===t.hCount&&(t.hCount=0),n.writePaddedNumber(t.hCount,3),void 0===t.stereoCare&&(t.stereoCare=0),n.writePaddedNumber(t.stereoCare,3),n.writePaddedNumber(t.explicitValence<0?0:0==t.explicitValence?15:t.explicitValence,3),n.writePaddedNumber(0,3),n.writePaddedNumber(0,3),n.writePaddedNumber(0,3),void 0===t.aam&&(t.aam=0),n.writePaddedNumber(t.aam,3),void 0===t.invRet&&(t.invRet=0),n.writePaddedNumber(t.invRet,3),void 0===t.exactChangeFlag&&(t.exactChangeFlag=0),n.writePaddedNumber(t.exactChangeFlag,3),n.writeCR(),n.mapping[e]=o,o++},this),this.bondMapping={},o=1,this.molecule.bonds.forEach(function(t,e){n.bondMapping[e]=o++,n.writePaddedNumber(n.mapping[t.begin],3),n.writePaddedNumber(n.mapping[t.end],3),n.writePaddedNumber(t.type,3),void 0===t.stereo&&(t.stereo=0),n.writePaddedNumber(t.stereo,3),n.writePadded(t.xxx,3),void 0===t.topology&&(t.topology=0),n.writePaddedNumber(t.topology,3),void 0===t.reactingCenterStatus&&(t.reactingCenterStatus=0),n.writePaddedNumber(t.reactingCenterStatus,3),n.writeCR()});a.length>0;)this.write("A  "),this.writePaddedNumber(a[0].id+1,3),this.writeCR(),this.writeCR(a[0].value),a.splice(0,1);var s=[],u=[],l=[],c=[],f=[],d=[],p=[],h=[],m=[];this.molecule.atoms.forEach(function(t,e){if(0!=t.charge&&s.push([e,t.charge]),0!=t.isotope&&u.push([e,t.isotope]),0!=t.radical&&l.push([e,t.radical]),null!=t.rglabel&&"R#"==t.label)for(var r=0;r<32;r++)t.rglabel&1<<r&&c.push([e,r+1]);null!=t.attpnt&&d.push([e,t.attpnt]),0!=t.ringBondCount&&p.push([e,t.ringBondCount]),0!=t.substitutionCount&&m.push([e,t.substitutionCount]),0!=t.unsaturatedAtom&&h.push([e,t.unsaturatedAtom])}),t&&t.forEach(function(t,e){if(t.resth||t.ifthen>0||t.range.length>0){var r="  1 "+C.default.paddedNum(e,3)+" "+C.default.paddedNum(t.ifthen,3)+" "+C.default.paddedNum(t.resth?1:0,3)+"   "+t.range;f.push(r)}}),e.call(this,"M  CHG",s),e.call(this,"M  ISO",u),e.call(this,"M  RAD",l),e.call(this,"M  RGP",c);for(var r=0;r<f.length;++r)this.write("M  LOG"+f[r]+"\n");if(e.call(this,"M  APO",d),e.call(this,"M  RBC",p),e.call(this,"M  SUB",m),e.call(this,"M  UNS",h),i.length>0)for(r=0;r<i.length;++r){var g=i[r],v=this.molecule.atoms.get(g).atomList;this.write("M  ALS"),this.writePaddedNumber(g+1,4),this.writePaddedNumber(v.ids.length,3),this.writeWhiteSpace(),this.write(v.notList?"T":"F");for(var y=v.labelList(),b=0;b<y.length;++b)this.writeWhiteSpace(),this.writePadded(y[b],3);this.writeCR()}var _={},x=1,w={};this.molecule.sGroupForest.getSGroupsBFS().forEach(function(t){w[x]=t,_[t]=x++});for(var S=1;S<x;++S){var O=w[S],A=this.molecule.sgroups.get(O);this.write("M  STY"),this.writePaddedNumber(1,3),this.writeWhiteSpace(1),this.writePaddedNumber(S,3),this.writeWhiteSpace(1),this.writePadded(A.type,3),this.writeCR(),this.write("M  SLB"),this.writePaddedNumber(1,3),this.writeWhiteSpace(1),this.writePaddedNumber(S,3),this.writeWhiteSpace(1),this.writePaddedNumber(S,3),this.writeCR();var E=this.molecule.sGroupForest.parent.get(O);if(E>=0&&(this.write("M  SPL"),this.writePaddedNumber(1,3),this.writeWhiteSpace(1),this.writePaddedNumber(S,3),this.writeWhiteSpace(1),this.writePaddedNumber(_[E],3),this.writeCR()),"SRU"==A.type&&A.data.connectivity){var j="";j+=" ",j+=S.toString().padStart(3),j+=" ",j+=(A.data.connectivity||"").padEnd(3),this.write("M  SCN"),this.writePaddedNumber(1,3),this.write(j.toUpperCase()),this.writeCR()}"SRU"==A.type&&(this.write("M  SMT "),this.writePaddedNumber(S,3),this.writeWhiteSpace(),this.write(A.data.subscript||"n"),this.writeCR()),this.writeCR(T.default.saveToMolfile[A.type](A,this.molecule,_,this.mapping,this.bondMapping))}this.writeCR("M  END")},r.default=h},{"./../element":520,"./common":522,"./utils":526}],525:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function p(t,e){for(var r=new C.default,n=R.default.partitionLineFixed(t,3,!0),o=R.default.parseDecimalInt(n[0]),i=0;i<o;++i){var a=R.default.parseDecimalInt(n[2*i+1])-1,s=e?n[2*i+2].trim():R.default.parseDecimalInt(n[2*i+2]);r.set(a,s)}return r}function o(t,e){for(var r=[],n=R.default.partitionLineFixed(t,3,!0),o=R.default.parseDecimalInt(n[0]),i=0;i<o;++i)r.push([R.default.parseDecimalInt(n[2*i+1])-1,e?n[2*i+2].trim():R.default.parseDecimalInt(n[2*i+2])]);return r}function i(t,e,r){t.data.mul=t.data.subscript-0;var o={};t.atoms=k.SGroup.filterAtoms(t.atoms,r),t.patoms=k.SGroup.filterAtoms(t.patoms,r);for(var n=1;n<t.data.mul;++n)for(var i=0;i<t.patoms.length;++i){var a=t.atoms[n*t.patoms.length+i];if(!(a<0)){if(t.patoms[i]<0)throw new Error("parent atom missing");o[a]=t.patoms[i]}}t.patoms=k.SGroup.removeNegative(t.patoms);var s=A(t.patoms),u=[];e.bonds.forEach(function(t,e){var r=t.begin in o,n=t.end in o;r&&n||r&&t.end in s||n&&t.begin in s?u.push(e):r?t.begin=o[t.begin]:n&&(t.end=o[t.end])},t);for(var l=0;l<u.length;++l)e.bonds.delete(u[l]);for(var c in o)e.atoms.delete(+c),r[c]=-1;t.atoms=t.patoms,t.patoms=null}function a(t){t.data.connectivity=(t.data.connectivity||"EU").trim().toLowerCase()}function s(t){t.data.name=(t.data.subscript||"").trim(),t.data.subscript=""}function u(t,e,r){}function l(t,e){t.data.absolute||(t.pp=t.pp.add(k.SGroup.getMassCentre(e,t.atoms)))}function c(t,e,r){var n={MUL:i,SRU:a,SUP:s,DAT:l,GEN:u};e.id=t.sgroups.add(e),n[e.type](e,t,r);for(var o=0;o<e.atoms.length;++o)t.atoms.has(e.atoms[o])&&t.atoms.get(e.atoms[o]).sgs.add(e.id);return"DAT"===e.type?t.sGroupForest.insert(e.id,-1,[]):t.sGroupForest.insert(e.id),e.id}function f(t,e){var r=p(e,!0),n=!0,o=!1,i=void 0;try{for(var a,s=r[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value,l=E(u,2),c=l[0],f=l[1];if(!(f in k.SGroup.TYPES))throw new Error("Unsupported S-group type");var d=new k.SGroup(f);d.number=c,t[c]=d}}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}}function d(t,e,r,n,o){var i=p(r,!n),a=!0,s=!1,u=void 0;try{for(var l,c=i.keys()[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value;(o?t[f]:t[f].data)[e]=i.get(f)}}catch(t){s=!0,u=t}finally{try{!a&&c.return&&c.return()}finally{if(s)throw u}}}function h(t,e,r,n){var o=R.default.parseDecimalInt(r.slice(1,4))-1,i=R.default.parseDecimalInt(r.slice(4,8)),a=S(R.default.partitionLineFixed(r.slice(8),3,!0));if(a.length!==i)throw new Error("File format invalid");n&&(a=a.map(function(t){return t+n})),t[o][e]=t[o][e].concat(a)}function m(t,e){t.data.fieldName=e}function g(t,e){t.data.query=e}function v(t,e){t.data.queryOp=e}function y(t,e){var r=R.default.partitionLine(e,[4,31,2,20,2,3],!1),n=R.default.parseDecimalInt(r[0])-1,o=r[1].trim(),i=r[2].trim(),a=r[3].trim(),s=r[4].trim(),u=r[5].trim(),l=t[n];l.data.fieldType=i,l.data.fieldName=o,l.data.units=a,l.data.query=s,l.data.queryOp=u}function b(t,e){var r=R.default.partitionLine(e,[10,10,4,1,1,1,3,3,3,3,2,3,2],!1),n=parseFloat(r[0]),o=parseFloat(r[1]),i="A"==r[3].trim(),a="A"==r[4].trim(),s="U"==r[5].trim(),u=r[7].trim();u="ALL"==u?-1:R.default.parseDecimalInt(u);var l=r[10].trim(),c=R.default.parseDecimalInt(r[11].trim());t.pp=new P.default(n,-o),t.data.attached=i,t.data.absolute=a,t.data.showUnits=s,t.data.nCharsToDisplay=u,t.data.tagChar=l,t.data.daspPos=c}function _(t,e){b(t[R.default.parseDecimalInt(e.substr(0,4))-1],e.substr(5))}function x(t,e,r){t.data.fieldValue=(t.data.fieldValue||"")+e,r&&(t.data.fieldValue=O(t.data.fieldValue),t.data.fieldValue.startsWith('"')&&t.data.fieldValue.endsWith('"')&&(t.data.fieldValue=t.data.fieldValue.substr(1,t.data.fieldValue.length-2)))}function w(t,e,r){var n=R.default.parseDecimalInt(e.substr(0,5))-1,o=e.substr(5);x(t[n],o,r)}function S(t){for(var e=[],r=0;r<t.length;++r)e[r]=R.default.parseDecimalInt(t[r]);return e}function O(t){return t.replace(/\s+$/,"")}function A(t){for(var e={},r=0;r<t.length;++r)e[t[r]]=t[r];return e}Object.defineProperty(r,"__esModule",{value:!0});var E=function(){function r(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),j=t("../../util/vec2"),P=n(j),T=t("../../util/pool"),C=n(T),k=t("./../struct/index"),M=t("./utils"),R=n(M);r.default={readKeyValuePairs:p,readKeyMultiValuePairs:o,loadSGroup:c,initSGroup:f,applySGroupProp:d,applySGroupArrayProp:h,applyDataSGroupName:m,applyDataSGroupQuery:g,applyDataSGroupQueryOp:v,applyDataSGroupDesc:y,applyDataSGroupInfo:b,applyDataSGroupData:x,applyDataSGroupInfoLine:_,applyDataSGroupDataLine:w}},{"../../util/pool":684,"../../util/vec2":686,"./../struct/index":537,"./utils":526}],526:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r){t=parseFloat(t);var n=t.toFixed(r||0).replace(",",".");if(n.length>e)throw new Error("number does not fit");return n.padStart(e)}function i(t){var e=parseInt(t,10);return isNaN(e)?0:e}function a(t,e,r){for(var n=[],o=0,i=0;o<e.length;++o)n.push(t.slice(i,i+e[o])),r&&i++,i+=e[o];return n}function s(t,e,r){for(var n=[],o=0;o<t.length;o+=e)n.push(t.slice(o,o+e)),r&&o++;return n}function u(t,e,r,n,o){function i(t,e,r,n,o){var i=new T.default(n-r.min.x,o?1-r.min.y:-(r.min.y+r.max.y)/2);return e.atoms.forEach(function(t){t.pp.add_(i)}),e.sgroups.forEach(function(t){t.pp&&t.pp.add_(i)}),r.min.add_(i),r.max.add_(i),e.mergeInto(t),r.max.x-r.min.x}var a,s=new k.default,u=[],l=[],c=[],f=[],d=[],p=[],h={cnt:0,totalLength:0};for(a=0;a<t.length;++a){var m=t[a],g=m.getBondLengthData();h.cnt+=g.cnt,h.totalLength+=g.totalLength}if(R){var v=1/(0==h.cnt?1:h.totalLength/h.cnt);for(a=0;a<t.length;++a)m=t[a],m.scale(v)}for(a=0;a<t.length;++a){m=t[a];var y=m.getCoordBoundingBoxObj();if(y){var b=a<e?M.REACTANT:a<e+r?M.PRODUCT:M.AGENT;b==M.REACTANT?(u.push(y),f.push(m)):b==M.AGENT?(l.push(y),d.push(m)):b==M.PRODUCT&&(c.push(y),p.push(m)),m.atoms.forEach(function(t){t.rxnFragmentType=b})}}if(o){var _=0;for(a=0;a<f.length;++a)_+=i(s,f[a],u[a],_,!1)+2;for(_+=2,a=0;a<d.length;++a)_+=i(s,d[a],l[a],_,!0)+2;for(_+=2,a=0;a<p.length;++a)_+=i(s,p[a],c[a],_,!1)+2}else{for(a=0;a<f.length;++a)f[a].mergeInto(s);for(a=0;a<d.length;++a)d[a].mergeInto(s);for(a=0;a<p.length;++a)p[a].mergeInto(s)}var x,w,S,O,A=null,E=null;for(a=0;a<u.length-1;++a)x=u[a],w=u[a+1],S=(x.max.x+w.min.x)/2,O=(x.max.y+x.min.y+w.max.y+w.min.y)/4,s.rxnPluses.add(new C.RxnPlus({pp:new T.default(S,O)}));for(a=0;a<u.length;++a)0==a?(A={},A.max=new T.default(u[a].max),A.min=new T.default(u[a].min)):(A.max=T.default.max(A.max,u[a].max),A.min=T.default.min(A.min,u[a].min));for(a=0;a<c.length-1;++a)x=c[a],w=c[a+1],S=(x.max.x+w.min.x)/2,O=(x.max.y+x.min.y+w.max.y+w.min.y)/4,s.rxnPluses.add(new C.RxnPlus({pp:new T.default(S,O)}));for(a=0;a<c.length;++a)0==a?(E={},E.max=new T.default(c[a].max),E.min=new T.default(c[a].min)):(E.max=T.default.max(E.max,c[a].max),E.min=T.default.min(E.min,c[a].min));if(x=A,w=E,x||w){var j=x?new T.default(x.max.x,(x.max.y+x.min.y)/2):null,P=w?new T.default(w.min.x,(w.max.y+w.min.y)/2):null;j||(j=new T.default(P.x-3,P.y)),P||(P=new T.default(j.x+3,j.y)),s.rxnArrows.add(new C.RxnArrow({pp:T.default.lc2(j,.5,P,.5)}))}else s.rxnArrows.add(new C.RxnArrow({pp:new T.default(0,0)}));return s.isReaction=!0,s}Object.defineProperty(r,"__esModule",{value:!0});var l=t("../../util/vec2"),T=n(l),C=t("./../struct/index"),k=n(C),c={bondTypeMap:{1:C.Bond.PATTERN.TYPE.SINGLE,2:C.Bond.PATTERN.TYPE.DOUBLE,3:C.Bond.PATTERN.TYPE.TRIPLE,4:C.Bond.PATTERN.TYPE.AROMATIC,5:C.Bond.PATTERN.TYPE.SINGLE_OR_DOUBLE,6:C.Bond.PATTERN.TYPE.SINGLE_OR_AROMATIC,7:C.Bond.PATTERN.TYPE.DOUBLE_OR_AROMATIC,8:C.Bond.PATTERN.TYPE.ANY},bondStereoMap:{0:C.Bond.PATTERN.STEREO.NONE,1:C.Bond.PATTERN.STEREO.UP,4:C.Bond.PATTERN.STEREO.EITHER,6:C.Bond.PATTERN.STEREO.DOWN,3:C.Bond.PATTERN.STEREO.CIS_TRANS},v30bondStereoMap:{0:C.Bond.PATTERN.STEREO.NONE,1:C.Bond.PATTERN.STEREO.UP,2:C.Bond.PATTERN.STEREO.EITHER,3:C.Bond.PATTERN.STEREO.DOWN},bondTopologyMap:{0:C.Bond.PATTERN.TOPOLOGY.EITHER,1:C.Bond.PATTERN.TOPOLOGY.RING,2:C.Bond.PATTERN.TOPOLOGY.CHAIN},countsLinePartition:[3,3,3,3,3,3,3,3,3,3,3,6],atomLinePartition:[10,10,10,1,3,2,3,3,3,3,3,3,3,3,3,3,3],bondLinePartition:[3,3,3,3,3,3,3],atomListHeaderPartition:[3,1,1,4,1,1],atomListHeaderLength:11,atomListHeaderItemLength:4,chargeMap:[0,3,2,1,0,-1,-2,-3],valenceMap:[void 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,0],implicitHydrogenMap:[void 0,0,1,2,3,4],v30atomPropMap:{CHG:"charge",RAD:"radical",MASS:"isotope",VAL:"explicitValence",HCOUNT:"hCount",INVRET:"invRet",SUBST:"substitutionCount",UNSAT:"unsaturatedAtom",RBCNT:"ringBondCount"},rxnItemsPartition:[3,3,3]},M={NONE:0,REACTANT:1,PRODUCT:2,AGENT:3},R=!0;r.default={fmtInfo:c,paddedNum:o,parseDecimalInt:i,partitionLine:a,partitionLineFixed:s,rxnMerge:u}},{"../../util/vec2":686,"./../struct/index":537}],527:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function A(t){var e=R.default.partitionLine(t,R.default.fmtInfo.atomLinePartition),r={pp:new u.default(parseFloat(e[0]),-parseFloat(e[1]),parseFloat(e[2])),label:e[4].trim(),explicitValence:R.default.fmtInfo.valenceMap[R.default.parseDecimalInt(e[10])],massDifference:R.default.parseDecimalInt(e[5]),charge:R.default.fmtInfo.chargeMap[R.default.parseDecimalInt(e[6])],hCount:R.default.parseDecimalInt(R.default.parseDecimalInt(e[8])),stereoCare:0!=R.default.parseDecimalInt(e[9]),aam:R.default.parseDecimalInt(e[14]),invRet:R.default.parseDecimalInt(e[15]),exactChangeFlag:0!=R.default.parseDecimalInt(e[16])};return new C.Atom(r)}function E(t){var e=R.default.partitionLine(t,R.default.fmtInfo.bondLinePartition),r={begin:R.default.parseDecimalInt(e[0])-1,end:R.default.parseDecimalInt(e[1])-1,type:R.default.fmtInfo.bondTypeMap[R.default.parseDecimalInt(e[2])],stereo:R.default.fmtInfo.bondStereoMap[R.default.parseDecimalInt(e[3])],xxx:e[4],topology:R.default.fmtInfo.bondTopologyMap[R.default.parseDecimalInt(e[5])],reactingCenterStatus:R.default.parseDecimalInt(e[6])};return new C.Bond(r)}function j(t){for(var e=R.default.partitionLine(t,R.default.fmtInfo.atomListHeaderPartition),r=R.default.parseDecimalInt(e[0])-1,n="T"==e[2].trim(),o=R.default.parseDecimalInt(e[4].trim()),i=t.slice(R.default.fmtInfo.atomListHeaderLength),a=[],s=R.default.fmtInfo.atomListHeaderItemLength,u=0;u<o;++u)a[u]=R.default.parseDecimalInt(i.slice(u*s,(u+1)*s-1));return{aid:r,atomList:new C.AtomList({notList:n,ids:a})}}function P(t,e,r,n,o,i){for(var a=new O.default;r<n;){var s=e[r];if("A"==s.charAt(0)){var u=e[++r],l=/'.+'/.test(u);l&&!a.get("pseudo")&&a.set("pseudo",new O.default),l||a.get("alias")||a.set("alias",new O.default),l&&(u=u.replace(/'/g,"")),a.get(l?"pseudo":"alias").set(R.default.parseDecimalInt(s.slice(3,6))-1,u)}else if("M"==s.charAt(0)){var c=s.slice(3,6),f=s.slice(6);if("END"==c)break;if("CHG"==c)a.get("charge")||a.set("charge",M.default.readKeyValuePairs(f));else if("RAD"==c)a.get("radical")||a.set("radical",M.default.readKeyValuePairs(f));else if("ISO"==c)a.get("isotope")||a.set("isotope",M.default.readKeyValuePairs(f));else if("RBC"==c)a.get("ringBondCount")||a.set("ringBondCount",M.default.readKeyValuePairs(f));else if("SUB"==c)a.get("substitutionCount")||a.set("substitutionCount",M.default.readKeyValuePairs(f));else if("UNS"==c)a.get("unsaturatedAtom")||a.set("unsaturatedAtom",M.default.readKeyValuePairs(f));else if("RGP"==c){a.get("rglabel")||a.set("rglabel",new O.default);for(var d=a.get("rglabel"),p=M.default.readKeyMultiValuePairs(f),h=0;h<p.length;h++){var m=p[h];d.set(m[0],(d.get(m[0])||0)|1<<m[1]-1)}}else if("LOG"==c){f=f.slice(4);var g=R.default.parseDecimalInt(f.slice(0,3).trim()),v=R.default.parseDecimalInt(f.slice(4,7).trim()),y=R.default.parseDecimalInt(f.slice(8,11).trim()),b=f.slice(12).trim(),_={};v>0&&(_.ifthen=v),_.resth=1==y,_.range=b,i[g]=_}else if("APO"==c)a.get("attpnt")||a.set("attpnt",M.default.readKeyValuePairs(f));else if("ALS"==c){var x=S(R.default.partitionLine(f,[1,3,3,1,1,1]),R.default.partitionLineFixed(f.slice(10),4,!1));a.get("atomList")||a.set("atomList",new O.default),a.get("label")||a.set("label",new O.default),x.forEach(function(t,e){a.get("label").set(e,"L#"),a.get("atomList").set(e,t)})}else if("STY"==c)M.default.initSGroup(o,f);else if("SST"==c)M.default.applySGroupProp(o,"subtype",f);else if("SLB"==c)M.default.applySGroupProp(o,"label",f,!0);else if("SPL"==c)M.default.applySGroupProp(o,"parent",f,!0,!0);else if("SCN"==c)M.default.applySGroupProp(o,"connectivity",f);else if("SAL"==c)M.default.applySGroupArrayProp(o,"atoms",f,-1);else if("SBL"==c)M.default.applySGroupArrayProp(o,"bonds",f,-1);else if("SPA"==c)M.default.applySGroupArrayProp(o,"patoms",f,-1);else if("SMT"==c){var w=R.default.parseDecimalInt(f.slice(0,4))-1;o[w].data.subscript=f.slice(4).trim()}else"SDT"==c?M.default.applyDataSGroupDesc(o,f):"SDD"==c?M.default.applyDataSGroupInfoLine(o,f):"SCD"==c?M.default.applyDataSGroupDataLine(o,f,!1):"SED"==c&&M.default.applyDataSGroupDataLine(o,f,!0)}++r}return a}function T(r,t,n){t.forEach(function(t,e){r.get(e)[n]=t})}function o(t,e){var r=new k.default,n=void 0,o=R.default.parseDecimalInt(e[0]),i=R.default.parseDecimalInt(e[1]),a=R.default.parseDecimalInt(e[2]);r.isChiral=!!r.isChiral||0!==R.default.parseDecimalInt(e[4]);var s=R.default.parseDecimalInt(e[5]),u=R.default.parseDecimalInt(e[10]),l=0,c=t.slice(l,l+o);l+=o;var f=t.slice(l,l+i);l+=i;var d=t.slice(l,l+a);l+=a+s;var p=c.map(A);for(n=0;n<p.length;++n)r.atoms.add(p[n]);var h=f.map(E);for(n=0;n<h.length;++n)r.bonds.add(h[n]);d.map(j).forEach(function(t){r.atoms.get(t.aid).atomList=t.atomList,r.atoms.get(t.aid).label="L#"});var m={},g={};P(r,t,l,Math.min(t.length,l+u),m,g).forEach(function(t,e){T(r.atoms,t,e)});var v={},y=void 0;for(y in m){var b=m[y];if("DAT"===b.type&&0===b.atoms.length){var _=m[y].parent;if(_>=0){var x=m[_-1];"GEN"===x.type&&(b.atoms=[].slice.call(x.atoms))}}}for(y in m)M.default.loadSGroup(r,m[y],v);var w=[];for(y in m)C.SGroup.filter(r,m[y],v),0!==m[y].atoms.length||m[y].allAtoms||w.push(+y);for(n=0;n<w.length;++n)r.sGroupForest.remove(w[n]),r.sgroups.delete(w[n]);for(var S in g){var O=parseInt(S,10);r.rgroups.set(O,new C.RGroup(g[O]))}return r}function c(t){if(t=t.slice(7),"$CTAB"!==t[0].trim())throw new Error("RGFile format invalid");for(var e=1;"$"!==t[e].charAt(0);)e++;if("$END CTAB"!==t[e].trim())throw new Error("RGFile format invalid");var r=t.slice(1,e);t=t.slice(e+1);for(var n={};;){if(0===t.length)throw new Error("Unexpected end of file");var o=t[0].trim();if("$END MOL"===o){t=t.slice(1);break}if("$RGP"!==o)throw new Error("RGFile format invalid");var i=parseInt(t[1].trim(),10);for(n[i]=[],t=t.slice(2);;){if(0===t.length)throw new Error("Unexpected end of file");if("$END RGP"===(o=t[0].trim())){t=t.slice(1);break}if("$CTAB"!==o)throw new Error("RGFile format invalid");for(e=1;"$"!==t[e].charAt(0);)e++;if("$END CTAB"!==t[e].trim())throw new Error("RGFile format invalid");n[i].push(t.slice(1,e)),t=t.slice(e+1)}}var a=f(r),s={};if(v)for(var u in n){var l=parseInt(u,10);s[l]=[];for(var c=0;c<n[l].length;++c)s[l].push(f(n[l][c]))}return d(a,s)}function i(t,e){t=t.slice(4);var r=R.default.partitionLine(t[0],R.default.fmtInfo.rxnItemsPartition),n=r[0]-0,o=r[1]-0,i=r[2]-0;t=t.slice(1);for(var a=[];t.length>0&&"$MOL"==t[0].substr(0,4);){t=t.slice(1);for(var s=0;s<t.length&&"$MOL"!=t[s].substr(0,4);)s++;var u,l=t.slice(0,s);0==l[0].search("\\$MDL")?u=c(l):(u=f(l.slice(3)),u.name=l[0].trim()),a.push(u),t=t.slice(s)}return R.default.rxnMerge(a,n,o,i,e)}function f(t){var e=R.default.partitionLine(t[0],R.default.fmtInfo.countsLinePartition);return t=t.slice(1),o(t,e)}function d(t,i){var a=new k.default;return t.mergeInto(a,null,null,!1,!0),Object.keys(i).forEach(function(t){for(var o=parseInt(t,10),e=0;e<i[o].length;++e)!function(t){var e=i[o][t];e.rgroups.set(o,new C.RGroup);var r={},n=e.frags.add(r);e.rgroups.get(o).frags.add(n),e.atoms.forEach(function(t){t.fragment=n}),e.mergeInto(a)}(e)}),a}function s(t){for(var e=[],r=0;r<t.length;++r)e.push(h.default.map[t[r].trim()]);return e}function S(t,e){var r=R.default.parseDecimalInt(t[1])-1,n=R.default.parseDecimalInt(t[2]),o="T"==t[4].trim(),i=s(e.slice(0,n)),a=new O.default;return a.set(r,new C.AtomList({notList:o,ids:i})),a}Object.defineProperty(r,"__esModule",{value:!0});var a=t("../../util/vec2"),u=n(a),l=t("../../util/pool"),O=n(l),p=t("./../element"),h=n(p),C=t("./../struct/index"),k=n(C),m=t("./parseSGroup"),M=n(m),g=t("./utils"),R=n(g),v=!0;r.default={parseCTabV2000:o,parseRg2000:c,parseRxn2000:i}},{"../../util/pool":684,"../../util/vec2":686,"./../element":520,"./../struct/index":537,"./parseSGroup":525,"./utils":526}],528:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function u(t){var e,r,n,o,i;e=d(t);var a={pp:new h.default(parseFloat(e[2]),-parseFloat(e[3]),parseFloat(e[4])),aam:e[5].trim()},s=e[1].trim();if('"'==s.charAt(0)&&'"'==s.charAt(s.length-1)&&(s=s.substr(1,s.length-2)),"]"==s.charAt(s.length-1)){s=s.substr(0,s.length-1);var u={};if(u.notList=!1,"NOT ["==s.substr(0,5))u.notList=!0,s=s.substr(5);else{if("["!=s.charAt(0))throw new Error("Error: atom list expected, found '"+s+"'");s=s.substr(1)}u.ids=p(s.split(",")),a.atomList=new w.AtomList(u),a.label="L#"}else a.label=s;for(e.splice(0,6),i=0;i<e.length;++i)if(r=g(e[i],"="),n=r[0],o=r[1],n in j.default.fmtInfo.v30atomPropMap){var l=j.default.parseDecimalInt(o);if("VAL"==n){if(0==l)continue;-1==l&&(l=0)}a[j.default.fmtInfo.v30atomPropMap[n]]=l}else if("RGROUPS"==n){o=o.trim().substr(1,o.length-2);var c=o.split(" ").slice(1);a.rglabel=0;for(var f=0;f<c.length;++f)a.rglabel|=1<<c[f]-1}else"ATTCHPT"==n&&(a.attpnt=o.trim()-0);return new w.Atom(a)}function l(t){var e,r,n,o,i;e=d(t);var a={begin:j.default.parseDecimalInt(e[2])-1,end:j.default.parseDecimalInt(e[3])-1,type:j.default.fmtInfo.bondTypeMap[j.default.parseDecimalInt(e[1])]};for(e.splice(0,4),i=0;i<e.length;++i)r=g(e[i],"="),n=r[0],o=r[1],"CFG"==n?(a.stereo=j.default.fmtInfo.v30bondStereoMap[j.default.parseDecimalInt(o)],a.type==w.Bond.PATTERN.TYPE.DOUBLE&&a.stereo==w.Bond.PATTERN.STEREO.EITHER&&(a.stereo=w.Bond.PATTERN.STEREO.CIS_TRANS)):"TOPO"==n?a.topology=j.default.fmtInfo.bondTopologyMap[j.default.parseDecimalInt(o)]:"RXCTR"==n?a.reactingCenterStatus=j.default.parseDecimalInt(o):"STBOX"==n&&(a.stereoCare=j.default.parseDecimalInt(o));return new w.Bond(a)}function c(t,e,r){for(r++;"M  V30 END COLLECTION"!=e[r].trim();)r++;return++r}function f(t,e,r,n,o){var i="";for(o++;o<e.length;){if(i=x(e[o++]).trim(),"END SGROUP"==i.trim())return o;for(;"-"==i.charAt(i.length-1);)i=(i.substr(0,i.length-1)+x(e[o++])).trim();var a=b(i),s=a[1],u=new w.SGroup(s);u.number=a[0]-0,u.type=s,u.label=a[2]-0,r[u.number]=u;for(var l={},c=3;c<a.length;++c){var f=g(a[c],"=");if(2!=f.length)throw new Error("A record of form AAA=BBB or AAA=(...) expected, got '"+a[c]+"'");var d=f[0];d in l||(l[d]=[]),l[d].push(f[1])}u.atoms=_(l.ATOMS[0],-1),l.PATOMS&&(u.patoms=_(l.PATOMS[0],-1)),u.bonds=l.BONDS?_(l.BONDS[0],-1):[];var p=l.BRKXYZ;if(u.brkxyz=[],p)for(var h=0;h<p.length;++h)u.brkxyz.push(_(p[h]));l.MULT&&(u.data.subscript=l.MULT[0]-0),l.LABEL&&(u.data.subscript=l.LABEL[0].trim()),l.CONNECT&&(u.data.connectivity=l.CONNECT[0].toLowerCase()),l.FIELDDISP&&A.default.applyDataSGroupInfo(u,m(l.FIELDDISP[0])),l.FIELDDATA&&A.default.applyDataSGroupData(u,l.FIELDDATA[0],!0),l.FIELDNAME&&A.default.applyDataSGroupName(u,l.FIELDNAME[0]),l.QUERYTYPE&&A.default.applyDataSGroupQuery(u,l.QUERYTYPE[0]),l.QUERYOP&&A.default.applyDataSGroupQueryOp(u,l.QUERYOP[0]),A.default.loadSGroup(t,u,n)}throw new Error("S-group declaration incomplete.")}function v(t,e){var r=new S.default,n=0;if("M  V30 BEGIN CTAB"!=t[n++].trim())throw Error("CTAB V3000 invalid");if("M  V30 COUNTS"!=t[n].slice(0,13))throw Error("CTAB V3000 invalid");var o=t[n].slice(14).split(" ");if(r.isChiral=1==j.default.parseDecimalInt(o[4]),n++,"M  V30 BEGIN ATOM"==t[n].trim()){n++;for(var i;n<t.length&&"END ATOM"!=(i=x(t[n++]).trim());){for(;"-"==i.charAt(i.length-1);)i=(i.substring(0,i.length-1)+x(t[n++])).trim();r.atoms.add(u(i))}if("M  V30 BEGIN BOND"==t[n].trim())for(n++;n<t.length&&"END BOND"!=(i=x(t[n++]).trim());){for(;"-"==i.charAt(i.length-1);)i=(i.substring(0,i.length-1)+x(t[n++])).trim();r.bonds.add(l(i))}for(var a={},s={};"M  V30 END CTAB"!=t[n].trim();)if("M  V30 BEGIN COLLECTION"==t[n].trim())n=c(r,t,n);else{if("M  V30 BEGIN SGROUP"!=t[n].trim())throw Error("CTAB V3000 invalid");n=f(r,t,a,s,n)}}if("M  V30 END CTAB"!=t[n++].trim())throw Error("CTAB V3000 invalid");return e||y(r,t.slice(n)),r}function y(n,t){for(var e={},o={},r=0;r<t.length&&0==t[r].search("M  V30 BEGIN RGROUP");){var i=t[r++].split(" ").pop();for(e[i]=[],o[i]={};;){var a=t[r].trim();if(0!=a.search("M  V30 RLOGIC")){if("M  V30 BEGIN CTAB"!=a)throw Error("CTAB V3000 invalid");for(var s=0;s<t.length&&"M  V30 END CTAB"!=t[r+s].trim();++s);var u=t.slice(r,r+s+1),l=v(u,!0);if(e[i].push(l),r=r+s+1,"M  V30 END RGROUP"==t[r].trim()){r++;break}}else{a=a.slice(13);var c=a.trim().split(/\s+/g),f=j.default.parseDecimalInt(c[0]),d=j.default.parseDecimalInt(c[1]),p=c.slice(2).join(" "),h={};f>0&&(h.ifthen=f),h.resth=1==d,h.range=p,o[i]=h,r++}}}Object.keys(e).forEach(function(r){e[r].forEach(function(t){t.rgroups.set(r,new w.RGroup(o[r]));var e=t.frags.add({});t.rgroups.get(r).frags.add(e),t.atoms.forEach(function(t){t.fragment=e}),t.mergeInto(n)})})}function o(r,t){r=r.slice(4);for(var e=r[0].split(/\s+/g).slice(3),n=e[0]-0,o=e[1]-0,i=e.length>2?e[2]-0:0,a=[],s=[],u=null,l=[],c=0;c<r.length;++c){var f,d=r[c].trim();if(d.startsWith("M  V30 COUNTS"));else{if("M  END"==d)break;if("M  V30 BEGIN PRODUCT"==d)console.assert(null==u,"CTab format invalid"),u=s;else if("M  V30 END PRODUCT"==d)console.assert(u===s,"CTab format invalid"),u=null;else if("M  V30 BEGIN REACTANT"==d)console.assert(null==u,"CTab format invalid"),u=a;else if("M  V30 END REACTANT"==d)console.assert(u===a,"CTab format invalid"),u=null;else if(d.startsWith("M  V30 BEGIN RGROUP"))console.assert(null==u,"CTab format invalid"),f=function(t){for(var e=t;e<r.length;++e)if("M  V30 END RGROUP"==r[e].trim())return e;return console.error("CTab format invalid")}(c),l.push(r.slice(c,f+1)),c=f;else{if("M  V30 BEGIN CTAB"!=d)throw new Error("line unrecognized: "+d);f=function(t){for(var e=t;e<r.length;++e)if("M  V30 END CTAB"==r[e].trim())return e;return console.error("CTab format invalid")}(c),u.push(r.slice(c,f+1)),c=f}}}var p=[],h=a.concat(s);for(f=0;f<h.length;++f){var m=v(h[f],e);p.push(m)}var g=j.default.rxnMerge(p,n,o,i,t);return y(g,function(t){for(var e=[],r=0;r<t.length;++r)e=e.concat(t[r]);return e}(l)),g}function d(t){var e,r,n=[],o=0,i=-1,a=!1;for(r=0;r<t.length;++r)e=t[r],"("==e?o++:")"==e&&o--,'"'==e&&(a=!a),a||" "!=t[r]||0!=o||(r>i+1&&n.push(t.slice(i+1,r)),i=r);return r>i+1&&n.push(t.slice(i+1,r)),n}function m(t){return'"'===t[0]&&'"'===t[t.length-1]?t.substr(1,t.length-2):t}function g(t,e){var r=t.indexOf(e);return[t.slice(0,r),t.slice(r+1)]}function b(t){for(var e=[],r=0,n=!1,o=0;o<t.length;++o){var i=t.charAt(o);'"'==i?n=!n:n||("("==i?r++:")"==i?r--:" "==i&&0==r&&(e.push(t.slice(0,o)),t=t.slice(o+1).trim(),o=0))}if(0!=r)throw new Error("Brace balance broken. S-group properies invalid!");return t.length>0&&e.push(t.trim()),e}function _(t,e){if(!t)return null;var r=[];t=t.trim(),t=t.substr(1,t.length-2);var n=t.split(" ");e=e||0;for(var o=1;o<n.length;++o){var i=parseInt(n[o]);isNaN(i)||r.push(i+e)}return r}function x(t){if("M  V30 "!=t.slice(0,7))throw new Error("Prefix invalid");return t.slice(7)}function p(t){for(var e=[],r=0;r<t.length;++r)e.push(s.default.map[t[r].trim()]);return e}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/vec2"),h=n(i),a=t("./../element"),s=n(a),w=t("./../struct/index"),S=n(w),O=t("./parseSGroup"),A=n(O),E=t("./utils"),j=n(E);r.default={parseCTabV3000:v,readRGroups3000:y,parseRxn3000:o}},{"../../util/vec2":686,"./../element":520,"./../struct/index":537,"./parseSGroup":525,"./utils":526}],529:[function(t,e,r){"use strict";function n(t,e){for(var r,n,o=/^[^]+?\$\$\$\$$/gm,i=[];null!==(r=o.exec(t));){n=r[0].replace(/\r/g,""),n=n.trim();var a=n.indexOf("M  END");if(-1!==a){var s={},u=n.substr(a+7).trim().split(/^$\n?/m);s.struct=l.default.parse(n.substring(0,a+6),e),s.props=u.reduce(function(t,e){var r=e.match(/^> [ \d]*<(\S+)>/);if(r){var n=r[1],o=e.split("\n")[1].trim();t[n]=isFinite(o)?+o:o}return t},{}),i.push(s)}}return i}function o(t,n){return t.reduce(function(e,r){return e+=l.default.stringify(r.struct,n),Object.keys(r.props).forEach(function(t){e+="> <"+t+">\n",e+=r.props[t]+"\n\n"}),e+"$$$$"},"")}Object.defineProperty(r,"__esModule",{value:!0});var i=t("./molfile"),l=function(t){return t&&t.__esModule?t:{default:t}}(i);r.default={stringify:o,parse:n}},{"./molfile":523}],530:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e,r){this.molecule=t,this.bonds=new s.default,this.getNeighbors=e,this.context=r}function i(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../../util/pool"),s=n(o),u=t("../../util/vec2"),c=n(u),l=t("../struct");a.PARITY={NONE:0,CIS:1,TRANS:2},a.prototype.each=function(t){this.bonds.forEach(t)},a.prototype.getParity=function(t){return this.bonds.get(t).parity},a.prototype.getSubstituents=function(t){return this.bonds.get(t).substituents},a.prototype.sameside=function(t,e,r,n){var o=c.default.diff(t,e),i=new c.default(-o.y,o.x);if(!i.normalize())return 0;var a=c.default.diff(r,t),s=c.default.diff(n,e);if(!a.normalize())return 0;if(!s.normalize())return 0;var u=c.default.dot(a,i),l=c.default.dot(s,i);return Math.abs(u)<.001||Math.abs(l)<.001?0:u*l>0?1:-1},a.prototype.samesides=function(t,e,r,n){return this.sameside(this.molecule.atoms.get(t).pp,this.molecule.atoms.get(e).pp,this.molecule.atoms.get(r).pp,this.molecule.atoms.get(n).pp)},a.prototype.sortSubstituents=function(t){var e=this.molecule.atoms.get(t[0]).pureHydrogen(),r=t[1]<0||this.molecule.atoms.get(t[1]).pureHydrogen(),n=this.molecule.atoms.get(t[2]).pureHydrogen(),o=t[3]<0||this.molecule.atoms.get(t[3]).pureHydrogen();return(!e||!r)&&((!n||!o)&&(r?t[1]=-1:e?(t[0]=t[1],t[1]=-1):t[0]>t[1]&&i(t,0,1),o?t[3]=-1:n?(t[2]=t[3],t[3]=-1):t[2]>t[3]&&i(t,2,3),!0))},a.prototype.isGeomStereoBond=function(t,e){var r=this.molecule.bonds.get(t);if(r.type!=l.Bond.PATTERN.TYPE.DOUBLE)return!1;var n=this.molecule.atoms.get(r.begin).label,o=this.molecule.atoms.get(r.end).label;if("C"!=n&&"N"!=n&&"Si"!=n&&"Ge"!=n)return!1;if("C"!=o&&"N"!=o&&"Si"!=o&&"Ge"!=o)return!1;var i=this.getNeighbors.call(this.context,r.begin),a=this.getNeighbors.call(this.context,r.end);if(i.length<2||i.length>3||a.length<2||a.length>3)return!1;e[0]=-1,e[1]=-1,e[2]=-1,e[3]=-1;var s,u;for(s=0;s<i.length;s++)if(u=i[s],u.bid!=t){if(this.molecule.bonds.get(u.bid).type!=l.Bond.PATTERN.TYPE.SINGLE)return!1;-1==e[0]?e[0]=u.aid:e[1]=u.aid}for(s=0;s<a.length;s++)if(u=a[s],u.bid!=t){if(this.molecule.bonds.get(u.bid).type!=l.Bond.PATTERN.TYPE.SINGLE)return!1;-1==e[2]?e[2]=u.aid:e[3]=u.aid}return(-1==e[1]||-1==this.samesides(r.begin,r.end,e[0],e[1]))&&(-1==e[3]||-1==this.samesides(r.begin,r.end,e[2],e[3]))},a.prototype.build=function(o){var i=this;this.molecule.bonds.forEach(function(t,e){var r={parity:0,substituents:[]};if(i.bonds.set(e,r),(!Array.isArray(o)||!o[e])&&i.isGeomStereoBond(e,r.substituents)&&i.sortSubstituents(r.substituents)){var n=i.samesides(t.begin,t.end,r.substituents[0],r.substituents[2]);1===n?r.parity=a.PARITY.CIS:-1===n&&(r.parity=a.PARITY.TRANS)}})},r.default=a},{"../../util/pool":684,"../../util/vec2":686,"../struct":537}],531:[function(t,e,r){"use strict";function h(t,e,r,n){var o=this;this.molecule=t,this.atom_data=e,this.components=r,this.nComponentsInReactants=-1,this.nReactants=n,this.vertices=new Array(this.molecule.atoms.size),this.molecule.atoms.forEach(function(t,e){o.vertices[e]=new h.VertexDesc},this),this.edges=new Array(this.molecule.bonds.size),this.molecule.bonds.forEach(function(t,e){o.edges[e]=new h.EdgeDesc},this),this.v_seq=[]}Object.defineProperty(r,"__esModule",{value:!0}),h.VertexDesc=function(){this.dfs_state=0,this.parent_vertex=0,this.parent_edge=0,this.branches=0},h.EdgeDesc=function(){this.opening_cycles=0,this.closing_cycle=0},h.SeqElem=function(t,e,r){this.idx=t,this.parent_vertex=e,this.parent_edge=r},h.prototype.walk=function(){for(var t,e,r=this,n=[],o=0,i=0;;){if(n.length<1){for(var a=-1;o<this.components.length&&-1==a;)a=this.components[o].find(function(t){return 0===r.vertices[t].dfs_state&&(a=t,!0)}),null===a&&(a=-1,o++),o==this.nReactants&&(this.nComponentsInReactants=i);if(a<-1&&this.molecule.atoms.find(function(t){return 0===r.vertices[t].dfs_state&&(a=t,!0)}),-1==a)break;this.vertices[a].parent_vertex=-1,this.vertices[a].parent_edge=-1,n.push(a),i++}var s=n.pop(),u=this.vertices[s].parent_vertex,l=new h.SeqElem(s,u,this.vertices[s].parent_edge);this.v_seq.push(l),this.vertices[s].dfs_state=2;var c=this.atom_data[s];for(t=0;t<c.neighbours.length;t++){var f=c.neighbours[t].aid,d=c.neighbours[t].bid;if(f!=u)if(2==this.vertices[f].dfs_state){for(this.edges[d].closing_cycle=1,e=s;-1!=e&&this.vertices[e].parent_vertex!=f;)e=this.vertices[e].parent_vertex;if(-1==e)throw new Error("cycle unwind error");this.edges[this.vertices[e].parent_edge].opening_cycles++,this.vertices[s].branches++,l=new h.SeqElem(f,s,d),this.v_seq.push(l)}else{if(1==this.vertices[f].dfs_state){if(-1==(e=n.indexOf(f)))throw new Error("internal: removing vertex from stack");n.splice(e,1);var p=this.vertices[f].parent_vertex;p>=0&&this.vertices[p].branches--}this.vertices[s].branches++,this.vertices[f].parent_vertex=s,this.vertices[f].parent_edge=d,this.vertices[f].dfs_state=1,n.push(f)}}}},h.prototype.edgeClosingCycle=function(t){return 0!==this.edges[t].closing_cycle},h.prototype.numBranches=function(t){return this.vertices[t].branches},h.prototype.numOpeningCycles=function(t){return this.edges[t].opening_cycles},h.prototype.toString=function(){var e="";return this.v_seq.forEach(function(t){e+=t.idx+" -> "}),e+="*"},r.default=h},{}],532:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function S(){this.smiles="",this.writtenAtoms=[],this.writtenComponents=0,this.ignore_errors=!1}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../../util/pile"),O=n(o),A=t("../struct"),i=t("./cis_trans"),c=n(i),a=t("./dfs"),E=n(a),s=t("./stereocenters"),j=n(s);S._Atom=function(t){this.neighbours=[],this.aromatic=!1,this.lowercase=!1,this.chirality=0,this.branch_cnt=0,this.paren_written=!1,this.h_count=t,this.parent=-1},S.prototype.isBondInRing=function(t){return console.assert(this.inLoop,"Init this.inLoop prior to calling this method"),this.inLoop[t]},S.prototype.saveMolecule=function(n,t){var e,a,s,u=this;t||(this.ignore_errors=t),n=n.clone(),n.initHalfBonds(),n.initNeighbors(),n.sortNeighbors(),n.setImplicitHydrogen(),n.sgroups.forEach(function(t){if("MUL"===t.type)try{A.SGroup.prepareMulForSaving(t,n)}catch(t){throw Error("Bad s-group ("+t.message+")")}}),this.atoms=new Array(n.atoms.size),n.atoms.forEach(function(t,e){u.atoms[e]=new S._Atom(t.implicitH)});var r=["B","C","N","O","P","S","Se","As"];n.bonds.forEach(function(t,e){t.type===A.Bond.PATTERN.TYPE.AROMATIC&&(u.atoms[t.begin].aromatic=!0,-1!==r.indexOf(n.atoms.get(t.begin).label)&&(u.atoms[t.begin].lowercase=!0),u.atoms[t.end].aromatic=!0,-1!==r.indexOf(n.atoms.get(t.end).label)&&(u.atoms[t.end].lowercase=!0)),u.atoms[t.begin].neighbours.push({aid:t.end,bid:e}),u.atoms[t.end].neighbours.push({aid:t.begin,bid:e})}),this.inLoop=function(){n.prepareLoopStructure();var r=new O.default;n.loops.forEach(function(t){if(t.hbs.length<=6){var e=t.hbs.map(function(t){return n.halfBonds.get(t).bid});r=r.union(new O.default(e))}});var e={};return r.forEach(function(t){e[t]=1}),e}(),this.touchedCistransbonds=0,this.markCisTrans(n);var o=n.getComponents(),i=o.reactants.concat(o.products),l=new E.default(n,this.atoms,i,o.reactants.length);for(l.walk(),this.atoms.forEach(function(t){t.neighbours=[]}),e=0;e<l.v_seq.length;e++){var c=l.v_seq[e],f=c.idx,d=c.parent_edge,p=c.parent_vertex;if(d>=0){var h=this.atoms[f],m=l.numOpeningCycles(d);for(a=0;a<m;a++)this.atoms[p].neighbours.push({aid:-1,bid:-1});if(l.edgeClosingCycle(d)){for(s=0;s<h.neighbours.length;s++)if(-1===h.neighbours[s].aid){h.neighbours[s].aid=p,h.neighbours[s].bid=d;break}if(s===h.neighbours.length)throw new Error("internal: can not put closing bond to its place")}else h.neighbours.push({aid:p,bid:d}),h.parent=p;this.atoms[p].neighbours.push({aid:f,bid:d})}}try{var g=new j.default(n,function(t){return this.atoms[t].neighbours},this);g.buildFromBonds(this.ignore_errors),g.each(function(t,e){var r=-1;-1==t.pyramid[3]&&(r=3);var n=[],o=0,i=u.atoms[e];if(-1!=i.parent)for(s=0;s<4;s++)if(t.pyramid[s]==i.parent){n[o++]=s;break}for(-1!=r&&(n[o++]=r),a=0;a!=i.neighbours.length;a++)if(i.neighbours[a].aid!=i.parent)for(s=0;s<4;s++)if(i.neighbours[a].aid==t.pyramid[s]){if(o>=4)throw new Error("internal: pyramid overflow");n[o++]=s;break}if(4==o)o=n[0],n[0]=n[1],n[1]=n[2],n[2]=n[3],n[3]=o;else if(3!=o)throw new Error("cannot calculate chirality");j.default.isPyramidMappingRigid(n)?u.atoms[e].chirality=1:u.atoms[e].chirality=2})}catch(n){alert("Warning: "+n.message)}var v=[];v.push(0);var y=!0;for(e=0;e<l.v_seq.length;e++){c=l.v_seq[e],f=c.idx,d=c.parent_edge,p=c.parent_vertex;var b=!0;if(p>=0){for(l.numBranches(p)>1&&this.atoms[p].branch_cnt>0&&this.atoms[p].paren_written&&(this.smiles+=")"),m=l.numOpeningCycles(d),a=0;a<m;a++){for(s=1;s<v.length&&-1!=v[s];s++);s==v.length?v.push(p):v[s]=p,this.writeCycleNumber(s)}if(p>=0){var _=l.numBranches(p);if(_>1&&this.atoms[p].branch_cnt<_-1&&(l.edgeClosingCycle(d)?this.atoms[p].paren_written=!1:(this.smiles+="(",this.atoms[p].paren_written=!0)),++this.atoms[p].branch_cnt>_)throw new Error("unexpected branch")}var x=n.bonds.get(d),w=0;if(x.type==A.Bond.PATTERN.TYPE.SINGLE&&(w=this.calcBondDirection(n,d,p)),1==w&&f==x.end||2==w&&f==x.begin?this.smiles+="/":2==w&&f==x.end||1==w&&f==x.begin?this.smiles+="\\":x.type==A.Bond.PATTERN.TYPE.ANY?this.smiles+="~":x.type==A.Bond.PATTERN.TYPE.DOUBLE?this.smiles+="=":x.type==A.Bond.PATTERN.TYPE.TRIPLE?this.smiles+="#":x.type!=A.Bond.PATTERN.TYPE.AROMATIC||this.atoms[x.begin].lowercase&&this.atoms[x.end].lowercase&&this.isBondInRing(d)?x.type==A.Bond.PATTERN.TYPE.SINGLE&&this.atoms[x.begin].aromatic&&this.atoms[x.end].aromatic&&(this.smiles+="-"):this.smiles+=":",l.edgeClosingCycle(d)){for(a=1;a<v.length&&v[a]!=f;a++);if(a==v.length)throw new Error("cycle number not found");this.writeCycleNumber(a),v[a]=-1,b=!1}}else y||(this.smiles+=this.writtenComponents===l.nComponentsInReactants&&0!==l.nReactants?">>":"."),y=!1,this.writtenComponents++;b&&(this.writeAtom(n,f,this.atoms[f].aromatic,this.atoms[f].lowercase,this.atoms[f].chirality),this.writtenAtoms.push(c.idx))}return this.comma=!1,this.writeRadicals(n),this.comma&&(this.smiles+="|"),this.smiles},S.prototype.writeCycleNumber=function(t){if(t>0&&t<10)this.smiles+=t;else if(t>=10&&t<100)this.smiles+="%"+t;else{if(!(t>=100&&t<1e3))throw new Error("bad cycle number: "+t);this.smiles+="%%"+t}},S.prototype.writeAtom=function(t,e,r,n,o){var i=t.atoms.get(e),a=!1,s=-1,u=0;if("A"==i.label)return void(this.smiles+="*");if("R"==i.label||"R#"==i.label)return void(this.smiles+="[*]");u=i.aam,"C"!=i.label&&"P"!=i.label&&"N"!=i.label&&"S"!=i.label&&"O"!=i.label&&"Cl"!=i.label&&"F"!=i.label&&"Br"!=i.label&&"B"!=i.label&&"I"!=i.label&&(a=!0),(i.explicitValence>=0||0!=i.radical||o>0||r&&"C"!=i.label&&"O"!=i.label||r&&"C"==i.label&&this.atoms[e].neighbours.length<3&&0==this.atoms[e].h_count)&&(s=this.atoms[e].h_count);var l=i.label;if(i.atomList&&!i.atomList.notList?(l=i.atomList.label(),a=!1):i.isPseudo()||i.atomList&&i.atomList.notList?(l="*",a=!0):(o||0!=i.charge||i.isotope>0||s>=0||u>0)&&(a=!0),a&&(-1==s&&(s=this.atoms[e].h_count),this.smiles+="["),i.isotope>0&&(this.smiles+=i.isotope),this.smiles+=n?l.toLowerCase():l,o>0&&(this.smiles+=1==o?"@@":"@",i.implicitH>1))throw new Error(i.implicitH+" implicit H near stereocenter");"H"!=i.label&&(s>1||0==s&&!a?this.smiles+="H"+s:1==s&&(this.smiles+="H")),i.charge>1?this.smiles+="+"+i.charge:i.charge<-1?this.smiles+=i.charge:1==i.charge?this.smiles+="+":-1==i.charge&&(this.smiles+="-"),u>0&&(this.smiles+=":"+u),a&&(this.smiles+="]")},S.prototype.markCisTrans=function(s){var u=this;this.cis_trans=new c.default(s,function(t){return this.atoms[t].neighbours},this),this.cis_trans.build(),this.dbonds=new Array(s.bonds.size),s.bonds.forEach(function(t,e){u.dbonds[e]={ctbond_beg:-1,ctbond_end:-1,saved:0}}),this.cis_trans.each(function(t,e){var r=s.bonds.get(e);if(0!==t.parity&&!u.isBondInRing(e)){var n=u.atoms[r.begin].neighbours,o=u.atoms[r.end].neighbours,i=!0,a=!0;if(n.forEach(function(t){t.bid!==e&&s.bonds.get(t.bid).type===A.Bond.PATTERN.TYPE.SINGLE&&(i=!1)}),o.forEach(function(t){t.bid!==e&&s.bonds.get(t.bid).type===A.Bond.PATTERN.TYPE.SINGLE&&(a=!1)}),i||a)return;n.forEach(function(t){t.bid!==e&&(s.bonds.get(t.bid).begin===r.begin?u.dbonds[t.bid].ctbond_beg=e:u.dbonds[t.bid].ctbond_end=e)}),o.forEach(function(t){t.bid!==e&&(s.bonds.get(t.bid).begin===r.end?u.dbonds[t.bid].ctbond_beg=e:u.dbonds[t.bid].ctbond_end=e)})}})},S.prototype.updateSideBonds=function(t,e){var r=t.bonds.get(e),n=this.cis_trans.getSubstituents(e),o=this.cis_trans.getParity(e),i=[-1,-1,-1,-1];i[0]=t.findBondId(n[0],r.begin),-1!=n[1]&&(i[1]=t.findBondId(n[1],r.begin)),i[2]=t.findBondId(n[2],r.end),-1!=n[3]&&(i[3]=t.findBondId(n[3],r.end));var a=0,s=0,u=0,l=0;if(0!=this.dbonds[i[0]].saved&&(1==this.dbonds[i[0]].saved&&t.bonds.get(i[0]).begin==r.begin||2==this.dbonds[i[0]].saved&&t.bonds.get(i[0]).end==r.begin?a++:s++),-1!=i[1]&&0!=this.dbonds[i[1]].saved&&(2==this.dbonds[i[1]].saved&&t.bonds.get(i[1]).begin==r.begin||1==this.dbonds[i[1]].saved&&t.bonds.get(i[1]).end==r.begin?a++:s++),0!=this.dbonds[i[2]].saved&&(1==this.dbonds[i[2]].saved&&t.bonds.get(i[2]).begin==r.end||2==this.dbonds[i[2]].saved&&t.bonds.get(i[2]).end==r.end?u++:l++),-1!=i[3]&&0!=this.dbonds[i[3]].saved&&(2==this.dbonds[i[3]].saved&&t.bonds.get(i[3]).begin==r.end||1==this.dbonds[i[3]].saved&&t.bonds.get(i[3]).end==r.end?u++:l++),o==c.default.PARITY.CIS?(a+=u,s+=l):(a+=l,s+=u),a>0&&s>0)throw new Error("incompatible cis-trans configuration");return(0!=a||0!=s)&&(a>0&&(this.dbonds[i[0]].saved=t.bonds.get(i[0]).begin==r.begin?1:2,-1!=i[1]&&(this.dbonds[i[1]].saved=t.bonds.get(i[1]).begin==r.begin?2:1),this.dbonds[i[2]].saved=t.bonds.get(i[2]).begin==r.end==(o==c.default.PARITY.CIS)?1:2,-1!=i[3]&&(this.dbonds[i[3]].saved=t.bonds.get(i[3]).begin==r.end==(o==c.default.PARITY.CIS)?2:1)),s>0&&(this.dbonds[i[0]].saved=t.bonds.get(i[0]).begin==r.begin?2:1,-1!=i[1]&&(this.dbonds[i[1]].saved=t.bonds.get(i[1]).begin==r.begin?1:2),this.dbonds[i[2]].saved=t.bonds.get(i[2]).begin==r.end==(o==c.default.PARITY.CIS)?2:1,-1!=i[3]&&(this.dbonds[i[3]].saved=t.bonds.get(i[3]).begin==r.end==(o==c.default.PARITY.CIS)?1:2)),!0)},S.prototype.calcBondDirection=function(r,t,e){var n,o=this;if(-1==this.dbonds[t].ctbond_beg&&-1==this.dbonds[t].ctbond_end)return 0;if(r.bonds.get(t).type!=A.Bond.PATTERN.TYPE.SINGLE)throw new Error("internal: directed bond type "+r.bonds.get(t).type);for(;;){if(n=0,this.cis_trans.each(function(t,e){0===t.parity||o.isBondInRing(e)||o.updateSideBonds(r,e)&&n++}),n===this.touchedCistransbonds)break;this.touchedCistransbonds=n}return 0===this.dbonds[t].saved&&(e===r.bonds.get(t).begin?this.dbonds[t].saved=1:this.dbonds[t].saved=2),this.dbonds[t].saved},S.prototype.writeRadicals=function(t){var e,r,n=new Array(this.writtenAtoms.length);for(e=0;e<this.writtenAtoms.length;e++)if(!n[e]){var o=t.atoms.get(this.writtenAtoms[e]).radical;if(0!=o)for(this.comma?this.smiles+=",":(this.smiles+=" |",this.comma=!0),o==A.Atom.PATTERN.RADICAL.SINGLET?this.smiles+="^3:":o==A.Atom.PATTERN.RADICAL.DOUPLET?this.smiles+="^1:":this.smiles+="^4:",this.smiles+=e,r=e+1;r<this.writtenAtoms.length;r++)t.atoms.get(this.writtenAtoms[r]).radical==o&&(n[r]=!0,this.smiles+=","+r)}},r.default={stringify:function(t,e){var r=e||{};return(new S).saveMolecule(t,r.ignoreErrors)}}},{"../../util/pile":683,"../struct":537,"./cis_trans":530,"./dfs":531,"./stereocenters":533}],533:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function P(t,e,r){this.molecule=t,this.atoms=new a.default,this.getNeighbors=e,this.context=r}function T(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../../util/vec2"),C=n(o),i=t("../../util/pool"),a=n(i),s=t("../../util/pile"),f=n(s),k=t("../struct");P.prototype.each=function(t,e){this.atoms.forEach(t,e)},P.prototype.buildFromBonds=function(t){var s=this,u=this.molecule.atoms,l=this.molecule.bonds,c=new f.default;u.forEach(function(t,e){var r=s.getNeighbors.call(s.context,e);if(2!==r.length)return!1;var n=r[0],o=r[1];if([e,n.aid,o.aid].findIndex(function(t){return["C","Si"].indexOf(u.get(t).label)<0},s)>=0)return!1;if([n.bid,o.bid].findIndex(function(t){return l.get(t).type!==k.Bond.PATTERN.TYPE.DOUBLE},s)>=0)return!1;var i=s.getNeighbors.call(s.context,n.aid).filter(function(t){return t.aid!=e}),a=s.getNeighbors.call(s.context,o.aid).filter(function(t){return t.aid!=e});return!(i.length<1||i.length>2||a.length<1||a.length>2)&&(!(i.concat(a).findIndex(function(t){return l.get(t.bid).type!=k.Bond.PATTERN.TYPE.SINGLE},s)>=0)&&(!(i.concat(a).findIndex(function(t){return l.get(t.bid).stereo==k.Bond.PATTERN.STEREO.EITHER},s)>=0)&&(c.add(n.aid).add(o.aid),!0)))}),c.size>0&&alert("This structure may contain allenes, which cannot be represented in the SMILES notation. Relevant stereo-information will be discarded."),u.forEach(function(t,r){if(!c.has(r)){var e=s.getNeighbors.call(s.context,r),n=!1;e.find(function(t){var e=this.molecule.bonds.get(t.bid);return e.type===k.Bond.PATTERN.TYPE.SINGLE&&e.begin==r&&(e.stereo===k.Bond.PATTERN.STEREO.UP||e.stereo==k.Bond.PATTERN.STEREO.DOWN)&&(n=!0,!0)},s),n&&s.buildOneCenter(r)}})},P.allowed_stereocenters=[{elem:"C",charge:0,degree:3,n_double_bonds:0,implicit_degree:4},{elem:"C",charge:0,degree:4,n_double_bonds:0,implicit_degree:4},{elem:"Si",charge:0,degree:3,n_double_bonds:0,implicit_degree:4},{elem:"Si",charge:0,degree:4,n_double_bonds:0,implicit_degree:4},{elem:"N",charge:1,degree:3,n_double_bonds:0,implicit_degree:4},{elem:"N",charge:1,degree:4,n_double_bonds:0,implicit_degree:4},{elem:"N",charge:0,degree:3,n_double_bonds:0,implicit_degree:3},{elem:"S",charge:0,degree:4,n_double_bonds:2,implicit_degree:4},{elem:"S",charge:1,degree:3,n_double_bonds:0,implicit_degree:3},{elem:"S",charge:0,degree:3,n_double_bonds:1,implicit_degree:3},{elem:"P",charge:0,degree:3,n_double_bonds:0,implicit_degree:3},{elem:"P",charge:1,degree:4,n_double_bonds:0,implicit_degree:4},{elem:"P",charge:0,degree:4,n_double_bonds:1,implicit_degree:4}],P.prototype.buildOneCenter=function(t){var o=this,i=this.molecule.atoms.get(t),e=this.getNeighbors.call(this.context,t),r=e.length,n=-1,a={group:0,type:0,pyramid:[]},s=[],u=0,l=0;a.pyramid[0]=-1,a.pyramid[1]=-1,a.pyramid[2]=-1,a.pyramid[3]=-1;var c=0;if(r>4)throw new Error("stereocenter with %d bonds are not supported"+r);if(e.forEach(function(t,e){var r=o.molecule.atoms.get(t.aid),n=o.molecule.bonds.get(t.bid);if(s[e]={edge_idx:t.bid,nei_idx:t.aid,rank:t.aid,vec:C.default.diff(r.pp,i.pp).yComplement()},r.pureHydrogen()?(c++,s[e].rank=1e4):"H"===r.label&&(s[e].rank=5e3),!s[e].vec.normalize())throw new Error("zero bond length");if(n.type===k.Bond.PATTERN.TYPE.TRIPLE)throw new Error("non-single bonds not allowed near stereocenter");if(n.type===k.Bond.PATTERN.TYPE.AROMATIC)throw new Error("aromatic bonds not allowed near stereocenter");n.type===k.Bond.PATTERN.TYPE.DOUBLE&&l++}),P.allowed_stereocenters.find(function(t){return t.elem===i.label&&t.charge===i.charge&&t.degree===r&&t.n_double_bonds===l&&(n=t.implicit_degree,!0)}),-1===n)throw new Error("unknown stereocenter configuration: "+i.label+", charge "+i.charge+", "+r+" bonds ("+l+" double)");if(4===r&&c>1)throw new Error(c+" hydrogens near stereocenter");if(3===r&&4===n&&c>0)throw new Error("have hydrogen(s) besides implicit hydrogen near stereocenter");if(4===r){s[0].rank>s[1].rank&&T(s,0,1),s[1].rank>s[2].rank&&T(s,1,2),s[2].rank>s[3].rank&&T(s,2,3),s[1].rank>s[2].rank&&T(s,1,2),s[0].rank>s[1].rank&&T(s,0,1),s[1].rank>s[2].rank&&T(s,1,2);for(var f=-1,d=-1,p=-1,h=-1,m=0,g=0;g<4;g++){var v=this.getBondStereo(t,s[g].edge_idx);if(v===k.Bond.PATTERN.STEREO.UP||v==k.Bond.PATTERN.STEREO.DOWN){f=g,m=v;break}}if(-1===f)throw new Error("none of 4 bonds going from stereocenter is stereobond");var y,b;if(-1===d&&(y=P.xyzzy(s[f].vec,s[(f+1)%4].vec,s[(f+2)%4].vec),b=P.xyzzy(s[f].vec,s[(f+1)%4].vec,s[(f+3)%4].vec),y+b!=3&&y+b!=12||(d=(f+1)%4,p=(f+2)%4,h=(f+3)%4)),-1==d&&(y=P.xyzzy(s[f].vec,s[(f+2)%4].vec,s[(f+1)%4].vec),b=P.xyzzy(s[f].vec,s[(f+2)%4].vec,s[(f+3)%4].vec),y+b!=3&&y+b!=12||(d=(f+2)%4,p=(f+1)%4,h=(f+3)%4)),-1==d&&(y=P.xyzzy(s[f].vec,s[(f+3)%4].vec,s[(f+1)%4].vec),b=P.xyzzy(s[f].vec,s[(f+3)%4].vec,s[(f+2)%4].vec),y+b!=3&&y+b!=12||(d=(f+3)%4,p=(f+2)%4,h=(f+1)%4)),-1==d)throw new Error("internal error: can not find opposite bond");if(m==k.Bond.PATTERN.STEREO.UP&&this.getBondStereo(t,s[d].edge_idx)==k.Bond.PATTERN.STEREO.DOWN)throw new Error("stereo types of the opposite bonds mismatch");if(m==k.Bond.PATTERN.STEREO.DOWN&&this.getBondStereo(t,s[d].edge_idx)==k.Bond.PATTERN.STEREO.UP)throw new Error("stereo types of the opposite bonds mismatch");if(m==this.getBondStereo(t,s[p].edge_idx))throw new Error("stereo types of non-opposite bonds match");if(m==this.getBondStereo(t,s[h].edge_idx))throw new Error("stereo types of non-opposite bonds match");u=3==f||3==d?m:m==k.Bond.PATTERN.STEREO.UP?k.Bond.PATTERN.STEREO.DOWN:k.Bond.PATTERN.STEREO.UP,E=P.sign(s[0].vec,s[1].vec,s[2].vec),u==k.Bond.PATTERN.STEREO.UP&&E>0||u==k.Bond.PATTERN.STEREO.DOWN&&E<0?(a.pyramid[0]=s[0].nei_idx,a.pyramid[1]=s[1].nei_idx,a.pyramid[2]=s[2].nei_idx):(a.pyramid[0]=s[0].nei_idx,a.pyramid[1]=s[2].nei_idx,a.pyramid[2]=s[1].nei_idx),a.pyramid[3]=s[3].nei_idx}else if(3===r){s[0].rank>s[1].rank&&T(s,0,1),s[1].rank>s[2].rank&&T(s,1,2),s[0].rank>s[1].rank&&T(s,0,1);var _=this.getBondStereo(t,s[0].edge_idx),x=this.getBondStereo(t,s[1].edge_idx),w=this.getBondStereo(t,s[2].edge_idx),S=0,O=0;if(S+=_===k.Bond.PATTERN.STEREO.UP?1:0,S+=x===k.Bond.PATTERN.STEREO.UP?1:0,S+=w===k.Bond.PATTERN.STEREO.UP?1:0,O+=_===k.Bond.PATTERN.STEREO.DOWN?1:0,O+=x===k.Bond.PATTERN.STEREO.DOWN?1:0,O+=w===k.Bond.PATTERN.STEREO.DOWN?1:0,4==n){if(3==S)throw new Error("all 3 bonds up near stereoatom");if(3==O)throw new Error("all 3 bonds down near stereoatom");if(0==S&&0==O)throw new Error("no up/down bonds near stereoatom -- indefinite case");if(1==S&&1==O)throw new Error("one bond up, one bond down -- indefinite case");if(m=0,2==S)u=k.Bond.PATTERN.STEREO.DOWN;else if(2==O)u=k.Bond.PATTERN.STEREO.UP;else{for(f=-1,p=-1,h=-1,g=0;g<3;g++)if((j=this.getBondStereo(t,s[g].edge_idx))==k.Bond.PATTERN.STEREO.UP||j==k.Bond.PATTERN.STEREO.DOWN){f=g,m=j,p=(g+1)%3,h=(g+2)%3;break}if(-1==f)throw new Error("internal error: can not find up or down bond");var A=P.xyzzy(s[p].vec,s[h].vec,s[f].vec);if(3==A||4==A)throw new Error("degenerate case for 3 bonds near stereoatom");u=1==A?m:m==k.Bond.PATTERN.STEREO.UP?k.Bond.PATTERN.STEREO.DOWN:k.Bond.PATTERN.STEREO.UP}var E=P.sign(s[0].vec,s[1].vec,s[2].vec);u==k.Bond.PATTERN.STEREO.UP&&E>0||u==k.Bond.PATTERN.STEREO.DOWN&&E<0?(a.pyramid[0]=s[0].nei_idx,a.pyramid[1]=s[1].nei_idx,a.pyramid[2]=s[2].nei_idx):(a.pyramid[0]=s[0].nei_idx,a.pyramid[1]=s[2].nei_idx,a.pyramid[2]=s[1].nei_idx),a.pyramid[3]=-1}else{var j;if(O>0&&S>0)throw new Error("one bond up, one bond down -- indefinite case");if(0==O&&0==S)throw new Error("no up-down bonds attached to stereocenter");j=S>0?1:-1,1!==P.xyzzy(s[0].vec,s[1].vec,s[2].vec)&&1!==P.xyzzy(s[0].vec,s[2].vec,s[1].vec)&&1!==P.xyzzy(s[2].vec,s[1].vec,s[0].vec)||(j=-j),E=P.sign(s[0].vec,s[1].vec,s[2].vec),E==j?(a.pyramid[0]=s[0].nei_idx,a.pyramid[1]=s[2].nei_idx,a.pyramid[2]=s[1].nei_idx):(a.pyramid[0]=s[0].nei_idx,a.pyramid[1]=s[1].nei_idx,a.pyramid[2]=s[2].nei_idx),a.pyramid[3]=-1}}this.atoms.set(t,a)},P.prototype.getBondStereo=function(t,e){var r=this.molecule.bonds.get(e);return t!=r.begin?0:r.stereo},P.xyzzy=function(t,e,r){var n=C.default.cross(t,e),o=C.default.dot(t,e),i=C.default.cross(t,r),a=C.default.dot(t,r);if(Math.abs(n)<.001){if(Math.abs(i)<.001)throw new Error("degenerate case -- bonds overlap");return i>0?4:8}return n*i<-1e-6?2:a<o?2:1},P.sign=function(t,e,r){var n=(t.x-r.x)*(e.y-r.y)-(t.y-r.y)*(e.x-r.x);if(n>.001)return 1;if(n<-.001)return-1;throw new Error("degenerate triangle")},P.isPyramidMappingRigid=function(t){var e=t.slice(),r=!0;return e[0]>e[1]&&(T(e,0,1),r=!r),e[1]>e[2]&&(T(e,1,2),r=!r),e[2]>e[3]&&(T(e,2,3),r=!r),e[1]>e[2]&&(T(e,1,2),r=!r),e[0]>e[1]&&(T(e,0,1),r=!r),e[1]>e[2]&&(T(e,1,2),r=!r),r},r.default=P},{"../../util/pile":683,"../../util/pool":684,"../../util/vec2":686,"../struct":537}],534:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=o.attrGetDefault;console.assert(t||"label"in t,"label must be specified!"),this.label=t.label,this.fragment="fragment"in t?t.fragment:-1,this.pseudo=t.pseudo||a(t.label),i(this,t,"alias",e("alias")),i(this,t,"isotope",e("isotope")),i(this,t,"radical",e("radical")),i(this,t,"charge",e("charge")),i(this,t,"rglabel",e("rglabel")),i(this,t,"attpnt",e("attpnt")),i(this,t,"explicitValence",e("explicitValence")),this.valence=0,this.implicitH=0,this.pp=t.pp?new u.default(t.pp):new u.default,this.sgs=new f.default,i(this,t,"ringBondCount",e("ringBondCount")),i(this,t,"substitutionCount",e("substitutionCount")),i(this,t,"unsaturatedAtom",e("unsaturatedAtom")),i(this,t,"hCount",e("hCount")),i(this,t,"aam",e("aam")),i(this,t,"invRet",e("invRet")),i(this,t,"exactChangeFlag",e("exactChangeFlag")),i(this,t,"rxnFragmentType",-1),this.atomList=t.atomList?new m.default(t.atomList):null,this.neighbors=[],this.badConn=!1}function c(t){return t-=0,t===o.PATTERN.RADICAL.NONE?0:t===o.PATTERN.RADICAL.DOUPLET?1:t===o.PATTERN.RADICAL.SINGLET||t===o.PATTERN.RADICAL.TRIPLET?2:console.assert(!1,"Unknown radical value")}function i(t,e,r,n){t[r]=void 0!==e[r]?e[r]:n}function a(t){return p.default.map[t]||"L"===t||"L#"===t||"R#"===t?null:t}Object.defineProperty(r,"__esModule",{value:!0}),r.radicalElectrons=c;var s=t("../../util/vec2"),u=n(s),l=t("../../util/pile"),f=n(l),d=t("../element"),p=n(d),h=t("./atomlist"),m=n(h);o.getAttrHash=function(t){var e={};for(var r in o.attrlist)void 0!==t[r]&&(e[r]=t[r]);return e},o.attrGetDefault=function(t){return t in o.attrlist?o.attrlist[t]:console.assert(!1,"Attribute unknown")},o.PATTERN={RADICAL:{NONE:0,SINGLET:1,DOUPLET:2,TRIPLET:3}},o.attrlist={alias:null,label:"C",pseudo:null,isotope:0,radical:0,charge:0,explicitValence:-1,ringBondCount:0,substitutionCount:0,unsaturatedAtom:0,hCount:0,atomList:null,invRet:0,exactChangeFlag:0,rglabel:null,attpnt:null,aam:0},o.prototype.clone=function(t){var e=new o(this);return t&&t.has(this.fragment)&&(e.fragment=t.get(this.fragment)),e},o.prototype.isQuery=function(){return null!==this.atomList||"A"===this.label||this.attpnt||this.hCount},o.prototype.pureHydrogen=function(){return"H"===this.label&&0===this.isotope},o.prototype.isPlainCarbon=function(){return"C"===this.label&&0===this.isotope&&0===this.radical&&0===this.charge&&this.explicitValence<0&&0===this.ringBondCount&&0===this.substitutionCount&&0===this.unsaturatedAtom&&0===this.hCount&&!this.atomList},o.prototype.isPseudo=function(){return!this.atomList&&!this.rglabel&&!p.default.map[this.label]},o.prototype.hasRxnProps=function(){return!!(this.invRet||this.exactChangeFlag||null!==this.attpnt||this.aam)},o.prototype.calcValence=function(t){var e=this,r=e.charge,n=e.label;if(e.isQuery())return this.implicitH=0,!0;var o=p.default.map[n];if(void 0===o)return this.implicitH=0,!0;var i=p.default[o].group,a=c(e.radical),s=t,u=0,l=Math.abs(r);return 1===i?"H"!==n&&"Li"!==n&&"Na"!==n&&"K"!==n&&"Rb"!==n&&"Cs"!==n&&"Fr"!==n||(s=1,u=1-a-t-l):2===i?t+a+l===2||t+a+l===0?s=2:u=-1:3===i?"B"===n||"Al"===n||"Ga"===n||"In"===n?-1===r?(s=4,u=4-a-t):(s=3,u=3-a-t-l):"Tl"===n&&(-1===r?a+t<=2?(s=2,u=2-a-t):(s=4,u=4-a-t):-2===r?a+t<=3?(s=3,u=3-a-t):(s=5,u=5-a-t):a+t+l<=1?(s=1,u=1-a-t-l):(s=3,u=3-a-t-l)):4===i?"C"===n||"Si"===n||"Ge"===n?(s=4,u=4-a-t-l):"Sn"!==n&&"Pb"!==n||(t+a+l<=2?(s=2,u=2-a-t-l):(s=4,u=4-a-t-l)):5===i?"N"===n||"P"===n?1===r?(s=4,u=4-a-t):2===r?(s=3,u=3-a-t):"N"===n||a+t+l<=3?(s=3,u=3-a-t-l):(s=5,u=5-a-t-l):"Bi"!==n&&"Sb"!==n&&"As"!==n||(1===r?a+t<=2&&"As"!==n?(s=2,u=2-a-t):(s=4,u=4-a-t):2===r?(s=3,u=3-a-t):a+t<=3?(s=3,u=3-a-t-l):(s=5,u=5-a-t-l)):6===i?"O"===n?r>=1?(s=3,u=3-a-t):(s=2,u=2-a-t-l):"S"===n||"Se"===n||"Po"===n?1===r?t<=3?(s=3,u=3-a-t):(s=5,u=5-a-t):t+a+l<=2?(s=2,u=2-a-t-l):t+a+l<=4?(s=4,u=4-a-t-l):(s=6,u=6-a-t-l):"Te"===n&&(-1===r?t<=2&&(s=2,u=2-a-t-l):0!==r&&2!==r||(t<=2?(s=2,u=2-a-t-l):t<=4?(s=4,u=4-a-t-l):0===r&&t<=6?(s=6,u=6-a-t-l):u=-1)):7===i?"F"===n?(s=1,u=1-a-t-l):"Cl"!==n&&"Br"!==n&&"I"!==n&&"At"!==n||(1===r?t<=2?(s=2,u=2-a-t):(3===t||5===t||t>=7)&&(u=-1):0===r&&(t<=1?(s=1,u=1-a-t):2===t||4===t||6===t?1===a?(s=t,u=0):u=-1:t>7&&(u=-1))):8===i&&(t+a+l===0?s=1:u=-1),this.valence=s,this.implicitH=u,!(this.implicitH<0)||(this.valence=t,this.implicitH=0,this.badConn=!0,!1)},o.prototype.calcValenceMinusHyd=function(t){var e=this,r=e.charge,n=e.label,o=p.default.map[n];if(null===o&&console.assert("Element "+n+" unknown"),o<0)return this.implicitH=0,null;var i=p.default[o].group,a=c(e.radical);if(3===i){if(("B"===n||"Al"===n||"Ga"===n||"In"===n)&&-1===r&&a+t<=4)return a+t}else if(5===i){if("N"===n||"P"===n){if(1===r)return a+t;if(2===r)return a+t}else if("Sb"===n||"Bi"===n||"As"===n){if(1===r)return a+t;if(2===r)return a+t}}else if(6===i){if("O"===n){if(r>=1)return a+t}else if(("S"===n||"Se"===n||"Po"===n)&&1===r)return a+t}else if(7===i&&("Cl"===n||"Br"===n||"I"===n||"At"===n)&&1===r)return a+t;return a+t+Math.abs(r)},r.default=o},{"../../util/pile":683,"../../util/vec2":686,"../element":520,"./atomlist":535}],535:[function(t,e,r){"use strict";function n(t){console.assert(t&&"notList"in t&&"ids"in t,"'notList' and 'ids' must be specified!"),this.notList=t.notList,this.ids=t.ids}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../element"),i=function(t){return t&&t.__esModule?t:{default:t}}(o);n.prototype.labelList=function(){for(var t=[],e=0;e<this.ids.length;++e)t.push(i.default[this.ids[e]].label);return t},n.prototype.label=function(){var t="["+this.labelList().join(",")+"]";return this.notList&&(t="!"+t),t},n.prototype.equals=function(t){return this.notList==t.notList&&(this.ids||[]).sort().toString()===(t.ids||[]).sort().toString()},r.default=n},{"../element":520}],536:[function(t,e,r){"use strict";function n(t){console.assert(t&&"begin"in t&&"end"in t&&"type"in t,"'begin', 'end' and 'type' properties must be specified!"),this.begin=t.begin,this.end=t.end,this.type=t.type,this.xxx=t.xxx||"",this.stereo=n.PATTERN.STEREO.NONE,this.topology=n.PATTERN.TOPOLOGY.EITHER,this.reactingCenterStatus=0,this.hb1=null,this.hb2=null,this.len=0,this.sb=0,this.sa=0,this.angle=0,t.stereo&&(this.stereo=t.stereo),t.topology&&(this.topology=t.topology),t.reactingCenterStatus&&(this.reactingCenterStatus=t.reactingCenterStatus),this.center=new i.default}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../../util/vec2"),i=function(t){return t&&t.__esModule?t:{default:t}}(o);n.PATTERN={TYPE:{SINGLE:1,DOUBLE:2,TRIPLE:3,AROMATIC:4,SINGLE_OR_DOUBLE:5,SINGLE_OR_AROMATIC:6,DOUBLE_OR_AROMATIC:7,ANY:8},STEREO:{NONE:0,UP:1,EITHER:4,DOWN:6,CIS_TRANS:3},TOPOLOGY:{EITHER:0,RING:1,CHAIN:2},REACTING_CENTER:{NOT_CENTER:-1,UNMARKED:0,CENTER:1,UNCHANGED:2,MADE_OR_BROKEN:4,ORDER_CHANGED:8,MADE_OR_BROKEN_AND_CHANGED:12}},n.attrlist={type:n.PATTERN.TYPE.SINGLE,stereo:n.PATTERN.STEREO.NONE,topology:n.PATTERN.TOPOLOGY.EITHER,reactingCenterStatus:n.PATTERN.REACTING_CENTER.UNMARKED},n.getAttrHash=function(t){var e={};for(var r in n.attrlist)void 0!==t[r]&&(e[r]=t[r]);return e},n.attrGetDefault=function(t){return t in n.attrlist?n.attrlist[t]:console.error("Attribute unknown")},n.prototype.hasRxnProps=function(){return!!this.reactingCenterStatus},n.prototype.getCenter=function(t){var e=t.atoms.get(this.begin).pp,r=t.atoms.get(this.end).pp;return i.default.lc2(e,.5,r,.5)},n.prototype.getDir=function(t){var e=t.atoms.get(this.begin).pp;return t.atoms.get(this.end).pp.sub(e).normalized()},n.prototype.clone=function(t){var e=new n(this);return t&&(e.begin=t.get(e.begin),e.end=t.get(e.end)),e},r.default=n},{"../../util/vec2":686}],537:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function c(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function o(){this.atoms=new p.default,this.bonds=new p.default,this.sgroups=new p.default,this.halfBonds=new p.default,this.loops=new p.default,this.isChiral=!1,this.isReaction=!1,this.rxnArrows=new p.default,this.rxnPluses=new p.default,this.frags=new p.default,this.rgroups=new p.default,this.name="",this.sGroupForest=new R.default(this)}function i(t,e,r){console.assert(3===arguments.length,"Invalid parameter number!"),this.begin=t,this.end=e,this.bid=r,this.dir=new v.default,this.norm=new v.default,this.ang=0,this.p=new v.default,this.loop=-1,this.contra=-1,this.next=-1,this.leftSin=0,this.leftCos=0,this.leftNeighbor=0,this.rightSin=0,this.rightCos=0,this.rightNeighbor=0}function f(t,r,e){var n=this;this.hbs=t,this.dblBonds=0,this.aromatic=!0,this.convex=e||!1,t.forEach(function(t){var e=r.bonds.get(r.halfBonds.get(t).bid);e.type!==j.default.PATTERN.TYPE.AROMATIC&&(n.aromatic=!1),e.type===j.default.PATTERN.TYPE.DOUBLE&&n.dblBonds++})}function a(t){t=t||{},this.pp=t.pp?new v.default(t.pp):new v.default}function s(t){t=t||{},this.pp=t.pp?new v.default(t.pp):new v.default}function u(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return!1;return t.push(e),!0}Object.defineProperty(r,"__esModule",{value:!0}),r.RxnArrow=r.RxnPlus=r.RGroup=r.SGroup=r.Bond=r.AtomList=r.Atom=void 0;var l=function(){function r(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=t("../../util/pool"),p=n(d),h=t("../../util/pile"),m=n(h),g=t("../../util/vec2"),v=n(g),y=t("../../util/box2abs"),b=n(y),_=t("../element"),x=n(_),w=t("./atom"),S=n(w),O=t("./atomlist"),A=n(O),E=t("./bond"),j=n(E),P=t("./sgroup"),T=n(P),C=t("./rgroup"),k=n(C),M=t("./sgforest"),R=n(M);o.prototype.hasRxnProps=function(){return this.atoms.find(function(t,e){return e.hasRxnProps()})||this.bonds.find(function(t,e){return e.hasRxnProps()})},o.prototype.hasRxnArrow=function(){return this.rxnArrows.size>0},o.prototype.isBlank=function(){return 0===this.atoms.size&&0===this.rxnArrows.size&&0===this.rxnPluses.size&&!this.isChiral},o.prototype.clone=function(t,e,r,n){return this.mergeInto(new o,t,e,r,!1,n)},o.prototype.getScaffold=function(){var e=this,n=new m.default;return this.atoms.forEach(function(t,e){n.add(e)}),this.rgroups.forEach(function(t){t.frags.forEach(function(t,r){e.atoms.forEach(function(t,e){t.fragment===r&&n.delete(e)})})}),this.clone(n)},o.prototype.getFragmentIds=function(r){var n=new m.default;return this.atoms.forEach(function(t,e){t.fragment===r&&n.add(e)}),n},o.prototype.getFragment=function(t){return this.clone(this.getFragmentIds(t))},o.prototype.mergeInto=function(o,r,n,t,i,a){var s=this;r=r||new m.default(this.atoms.keys()),n=n||new m.default(this.bonds.keys()),a=a||new Map,n=n.filter(function(t){var e=s.bonds.get(t);return r.has(e.begin)&&r.has(e.end)});var u=new m.default;this.atoms.forEach(function(t,e){r.has(e)&&u.add(t.fragment)});var l=new Map;this.frags.forEach(function(t,e){u.has(e)&&l.set(e,o.frags.add(Object.assign({},t)))});var c=[];this.rgroups.forEach(function(t,e){var r=i;if(r||(t.frags.forEach(function(t,e){c.push(e),u.has(e)&&(r=!0)}),r)){var n=o.rgroups.get(e);n?t.frags.forEach(function(t,e){c.push(e),u.has(e)&&n.frags.add(l.get(e))}):o.rgroups.set(e,t.clone(l))}}),this.atoms.forEach(function(t,e){r.has(e)&&-1===c.indexOf(t.fragment)&&a.set(e,o.atoms.add(t.clone(l)))}),this.atoms.forEach(function(t,e){r.has(e)&&-1!==c.indexOf(t.fragment)&&a.set(e,o.atoms.add(t.clone(l)))});var f=new Map;return this.bonds.forEach(function(t,e){n.has(e)&&f.set(e,o.bonds.add(t.clone(a)))}),this.sgroups.forEach(function(t){if(!t.atoms.some(function(t){return!r.has(t)})){t=T.default.clone(t,a);var e=o.sgroups.add(t);t.id=e,t.atoms.forEach(function(t){o.atoms.get(t).sgs.add(e)}),"DAT"===t.type?o.sGroupForest.insert(t.id,-1,[]):o.sGroupForest.insert(t.id)}}),o.isChiral=o.isChiral||this.isChiral,t||(o.isReaction=this.isReaction,this.rxnArrows.forEach(function(t){o.rxnArrows.add(t.clone())}),this.rxnPluses.forEach(function(t){o.rxnPluses.add(t.clone())})),o},o.prototype.findBondId=function(r,n){return this.bonds.find(function(t,e){return e.begin===r&&e.end===n||e.begin===n&&e.end===r})},o.prototype.initNeighbors=function(){var n=this;this.atoms.forEach(function(t){t.neighbors=[]}),this.bonds.forEach(function(t){var e=n.atoms.get(t.begin),r=n.atoms.get(t.end);e.neighbors.push(t.hb1),r.neighbors.push(t.hb2)})},o.prototype.bondInitHalfBonds=function(t,e){e=e||this.bonds.get(t),e.hb1=2*t,e.hb2=2*t+1,this.halfBonds.set(e.hb1,new i(e.begin,e.end,t)),this.halfBonds.set(e.hb2,new i(e.end,e.begin,t));var r=this.halfBonds.get(e.hb1),n=this.halfBonds.get(e.hb2);r.contra=e.hb2,n.contra=e.hb1},o.prototype.halfBondUpdate=function(t){var e=this.halfBonds.get(t),r=this.atoms.get(e.begin).pp,n=this.atoms.get(e.end).pp,o=v.default.diff(n,r).normalized();e.dir=v.default.dist(n,r)>1e-4?o:new v.default(1,0),e.norm=e.dir.turnLeft(),e.ang=e.dir.oxAngle(),e.loop<0&&(e.loop=-1)},o.prototype.initHalfBonds=function(){var r=this;this.halfBonds.clear(),this.bonds.forEach(function(t,e){r.bondInitHalfBonds(e,t)})},o.prototype.setHbNext=function(t,e){this.halfBonds.get(this.halfBonds.get(t).contra).next=e},o.prototype.halfBondSetAngle=function(t,e){var r=this.halfBonds.get(t),n=this.halfBonds.get(e);n.rightCos=v.default.dot(n.dir,r.dir),r.leftCos=v.default.dot(n.dir,r.dir),n.rightSin=v.default.cross(n.dir,r.dir),r.leftSin=v.default.cross(n.dir,r.dir),r.leftNeighbor=e,n.rightNeighbor=t},o.prototype.atomAddNeighbor=function(t){for(var e=this.halfBonds.get(t),r=this.atoms.get(e.begin),n=0;n<r.neighbors.length&&!(this.halfBonds.get(r.neighbors[n]).ang>e.ang);++n);r.neighbors.splice(n,0,t);var o=r.neighbors[(n+1)%r.neighbors.length],i=r.neighbors[(n+r.neighbors.length-1)%r.neighbors.length];this.setHbNext(i,t),this.setHbNext(t,o),this.halfBondSetAngle(t,i),this.halfBondSetAngle(o,t)},o.prototype.atomSortNeighbors=function(t){var n=this,o=this.atoms.get(t),r=this.halfBonds;o.neighbors.sort(function(t,e){return r.get(t).ang-r.get(e).ang}).forEach(function(t,e){var r=o.neighbors[(e+1)%o.neighbors.length];n.halfBonds.get(n.halfBonds.get(t).contra).next=r,n.halfBondSetAngle(r,t)})},o.prototype.sortNeighbors=function(t){var r=this;t?t.forEach(function(t){r.atomSortNeighbors(t)}):this.atoms.forEach(function(t,e){r.atomSortNeighbors(e)})},o.prototype.atomUpdateHalfBonds=function(t){var e=this;this.atoms.get(t).neighbors.forEach(function(t){e.halfBondUpdate(t),e.halfBondUpdate(e.halfBonds.get(t).contra)})},o.prototype.updateHalfBonds=function(t){var r=this;t?t.forEach(function(t){r.atomUpdateHalfBonds(t)}):this.atoms.forEach(function(t,e){r.atomUpdateHalfBonds(e)})},o.prototype.sGroupsRecalcCrossBonds=function(){var a=this;this.sgroups.forEach(function(t){t.xBonds=[],t.neiAtoms=[]}),this.bonds.forEach(function(r,n){var o=a.atoms.get(r.begin),i=a.atoms.get(r.end);o.sgs.forEach(function(t){if(!i.sgs.has(t)){var e=a.sgroups.get(t);e.xBonds.push(n),u(e.neiAtoms,r.end)}}),i.sgs.forEach(function(t){if(!o.sgs.has(t)){var e=a.sgroups.get(t);e.xBonds.push(n),u(e.neiAtoms,r.begin)}})})},o.prototype.sGroupDelete=function(e){var r=this;this.sgroups.get(e).atoms.forEach(function(t){r.atoms.get(t).sgs.delete(e)}),this.sGroupForest.remove(e),this.sgroups.delete(e)},o.prototype.atomSetPos=function(t,e){this.atoms.get(t).pp=e},o.prototype.rxnPlusSetPos=function(t,e){this.rxnPluses.get(t).pp=e},o.prototype.rxnArrowSetPos=function(t,e){this.rxnArrows.get(t).pp=e},o.prototype.getCoordBoundingBox=function(r){function n(t){e?(e.min=v.default.min(e.min,t),e.max=v.default.max(e.max,t)):e={min:t,max:t}}var e=null,o=!r||0===r.size;return this.atoms.forEach(function(t,e){(o||r.has(e))&&n(t.pp)}),o&&(this.rxnPluses.forEach(function(t){n(t.pp)}),this.rxnArrows.forEach(function(t){n(t.pp)})),!e&&o&&(e={min:new v.default(0,0),max:new v.default(1,1)}),e},o.prototype.getCoordBoundingBoxObj=function(){function e(t){r?(r.min=v.default.min(r.min,t),r.max=v.default.max(r.max,t)):r={min:new v.default(t),max:new v.default(t)}}var r=null;return this.atoms.forEach(function(t){e(t.pp)}),r},o.prototype.getBondLengthData=function(){var e=this,r=0,n=0;return this.bonds.forEach(function(t){r+=v.default.dist(e.atoms.get(t.begin).pp,e.atoms.get(t.end).pp),n++}),{cnt:n,totalLength:r}},o.prototype.getAvgBondLength=function(){var t=this.getBondLengthData();return t.cnt>0?t.totalLength/t.cnt:-1},o.prototype.getAvgClosestAtomDistance=function(){var t,e,r,n=0,o=0,i=this.atoms.keys();for(e=0;e<i.length;++e){for(t=-1,r=0;r<i.length;++r)r!=e&&(o=v.default.dist(this.atoms.get(i[r]).pp,this.atoms.get(i[e]).pp),(t<0||t>o)&&(t=o));n+=t}return i.length>0?n/i.length:-1},o.prototype.checkBondExists=function(r,n){return void 0!==this.bonds.find(function(t,e){return e.begin===r&&e.end===n||e.end===r&&e.begin===n})},o.prototype.findConnectedComponent=function(t){for(var r=this,n=[t],o=new m.default;n.length>0;){var e=n.pop();o.add(e);this.atoms.get(e).neighbors.forEach(function(t){var e=r.halfBonds.get(t).end;o.has(e)||n.push(e)})}return o},o.prototype.findConnectedComponents=function(n){var o=this;this.halfBonds.size||(this.initHalfBonds(),this.initNeighbors(),this.updateHalfBonds(Array.from(this.atoms.keys())),this.sortNeighbors(Array.from(this.atoms.keys())));var i=new m.default,a=[];return this.atoms.forEach(function(t,e){if((n||t.fragment<0)&&!i.has(e)){var r=o.findConnectedComponent(e);a.push(r),i=i.union(r)}}),a},o.prototype.markFragment=function(t){var e=this,r={},n=this.frags.add(r);t.forEach(function(t){e.atoms.get(t).fragment=n})},o.prototype.markFragments=function(){var e=this;this.findConnectedComponents().forEach(function(t){e.markFragment(t)})},o.prototype.scale=function(e){1!==e&&(this.atoms.forEach(function(t){t.pp=t.pp.scaled(e)}),this.rxnPluses.forEach(function(t){t.pp=t.pp.scaled(e)}),this.rxnArrows.forEach(function(t){t.pp=t.pp.scaled(e)}),this.sgroups.forEach(function(t){t.pp=t.pp?t.pp.scaled(e):null}))},o.prototype.rescale=function(){var t=this.getAvgBondLength();t<0&&!this.isReaction&&(t=this.getAvgClosestAtomDistance()),t<.001&&(t=1);var e=1/t;this.scale(e)},o.prototype.loopHasSelfIntersections=function(t){for(var e=0;e<t.length;++e)for(var r=this.halfBonds.get(t[e]),n=this.atoms.get(r.begin).pp,o=this.atoms.get(r.end).pp,i=new m.default([r.begin,r.end]),a=e+2;a<t.length;++a){var s=this.halfBonds.get(t[a]);if(!i.has(s.begin)&&!i.has(s.end)){var u=this.atoms.get(s.begin).pp,l=this.atoms.get(s.end).pp;if(b.default.segmentIntersection(n,o,u,l))return!0}}return!1},o.prototype.partitionLoop=function(t){for(var e=[],r=!0;r;){var n={};r=!1;for(var o=0;o<t.length;++o){var i=t[o],a=this.halfBonds.get(i).begin,s=this.halfBonds.get(i).end;if(s in n){var u=n[s],l=t.slice(u,o+1);e.push(l),o<t.length&&t.splice(u,o-u+1),r=!0;break}n[a]=o}r||e.push(t)}return e},o.prototype.halfBondAngle=function(t,e){var r=this.halfBonds.get(t),n=this.halfBonds.get(e);return Math.atan2(v.default.cross(r.dir,n.dir),v.default.dot(r.dir,n.dir))},o.prototype.loopIsConvex=function(t){var n=this;return t.every(function(t,e,r){return n.halfBondAngle(t,r[(e+1)%r.length])<=0})},o.prototype.loopIsInner=function(t){var a=this,s=2*Math.PI;return t.forEach(function(t,e,r){var n=r[(e+1)%r.length],o=a.halfBonds.get(n),i=a.halfBondAngle(t,n);s+=o.contra===t?Math.PI:i}),Math.abs(s)<Math.PI},o.prototype.findLoops=function(){var n=this,o=[],i=new m.default,a=void 0,s=void 0,u=void 0,l=void 0;return this.halfBonds.forEach(function(t,e){if(-1===t.loop)for(a=e,s=0,u=[];s<=n.halfBonds.size;a=n.halfBonds.get(a).next,++s){if(s>0&&a===e){var r=n.partitionLoop(u);r.forEach(function(t){n.loopIsInner(t)&&!n.loopHasSelfIntersections(t)?(l=Math.min.apply(Math,c(t)),n.loops.set(l,new f(t,n,n.loopIsConvex(t)))):l=-2,t.forEach(function(t){n.halfBonds.get(t).loop=l,i.add(n.halfBonds.get(t).bid)}),l>=0&&o.push(l)});break}u.push(a)}}),{newLoops:o,bondsToMark:Array.from(i)}},o.prototype.prepareLoopStructure=function(){this.initHalfBonds(),this.initNeighbors(),this.updateHalfBonds(Array.from(this.atoms.keys())),this.sortNeighbors(Array.from(this.atoms.keys())),this.findLoops()},o.prototype.atomAddToSGroup=function(t,e){T.default.addAtom(this.sgroups.get(t),e),this.atoms.get(e).sgs.add(t)},o.prototype.calcConn=function(t){for(var e=0,r=0;r<t.neighbors.length;++r){var n=this.halfBonds.get(t.neighbors[r]);switch(this.bonds.get(n.bid).type){case j.default.PATTERN.TYPE.SINGLE:e+=1;break;case j.default.PATTERN.TYPE.DOUBLE:e+=2;break;case j.default.PATTERN.TYPE.TRIPLE:e+=3;break;case j.default.PATTERN.TYPE.AROMATIC:return 1===t.neighbors.length?[-1,!0]:[t.neighbors.length,!0];default:return[-1,!1]}}return[e,!1]},o.prototype.calcImplicitHydrogen=function(t){var e=this.atoms.get(t),r=this.calcConn(e),n=l(r,2),o=n[0],i=n[1],a=o;if(e.badConn=!1,i)if("C"===e.label&&0===e.charge){if(3===o)return void(e.implicitH=-(0,w.radicalElectrons)(e.radical));if(2===o)return void(e.implicitH=1-(0,w.radicalElectrons)(e.radical))}else{if("O"===e.label&&0===e.charge||"N"===e.label&&0===e.charge&&3===o||"N"===e.label&&1===e.charge&&3===o||"S"===e.label&&0===e.charge&&3===o)return void(e.implicitH=0);e.hasImplicitH||a++}if(a<0||e.isQuery())return void(e.implicitH=0);if(e.explicitValence>=0){var s=x.default.map[e.label];e.implicitH=null!==s?e.explicitValence-e.calcValenceMinusHyd(a):0,e.implicitH<0&&(e.implicitH=0,e.badConn=!0)}else e.calcValence(a)},o.prototype.setImplicitHydrogen=function(t){var r=this;this.sgroups.forEach(function(t){"MRV_IMPLICIT_H"===t.data.fieldName&&(r.atoms.get(t.atoms[0]).hasImplicitH=!0)}),t?t.forEach(function(t){r.calcImplicitHydrogen(t)}):this.atoms.forEach(function(t,e){r.calcImplicitHydrogen(e)})},o.prototype.getComponents=function(){var o=this,t=this.findConnectedComponents(!0),i=[],e=null;this.rxnArrows.forEach(function(t){e=t.pp.x}),this.rxnPluses.forEach(function(t){i.push(t.pp.x)}),null!==e&&i.push(e),i.sort(function(t,e){return t-e});var a=[];t.forEach(function(t){for(var e=o.getCoordBoundingBox(t),r=v.default.lc2(e.min,.5,e.max,.5),n=0;r.x>i[n];)++n;a[n]=a[n]||new m.default,a[n]=a[n].union(t)});var r=[],n=[],s=[];return a.forEach(function(t){if(!t)return void r.push("");1===o.defineRxnFragmentTypeForAtomset(t,e)?n.push(t):s.push(t)}),{reactants:n,products:s}},o.prototype.defineRxnFragmentTypeForAtomset=function(t,e){var r=this.getCoordBoundingBox(t);return v.default.lc2(r.min,.5,r.max,.5).x<e?1:2},o.prototype.getBondFragment=function(t){var e=this.bonds.get(t).begin;return this.atoms.get(e).fragment},a.prototype.clone=function(){return new a(this)},s.prototype.clone=function(){return new s(this)},r.default=o,r.Atom=S.default,r.AtomList=A.default,r.Bond=j.default,r.SGroup=T.default,r.RGroup=k.default,r.RxnPlus=a,r.RxnArrow=s},{"../../util/box2abs":682,"../../util/pile":683,"../../util/pool":684,"../../util/vec2":686,"../element":520,"./atom":534,"./atomlist":535,"./bond":536,"./rgroup":538,"./sgforest":539,"./sgroup":540}],538:[function(t,e,r){"use strict";function n(t){t=t||{},this.frags=new i.default,this.resth=t.resth||!1,this.range=t.range||"",this.ifthen=t.ifthen||0}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../../util/pile"),i=function(t){return t&&t.__esModule?t:{default:t}}(o);n.prototype.getAttrs=function(){return{resth:this.resth,range:this.range,ifthen:this.ifthen}},n.findRGroupByFragment=function(t,r){return t.find(function(t,e){return e.frags.has(r)})},n.prototype.clone=function(e){var r=new n(this);return this.frags.forEach(function(t){r.frags.add(e?e.get(t):t)}),r},r.default=n},{"../../util/pile":683}],539:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.parent=new a.default,this.children=new a.default,this.children.set(-1,[]),this.molecule=t}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/pool"),a=n(i),s=t("../../util/pile"),u=n(s);o.prototype.getSGroupsBFS=function(){for(var t=[],e=-1,r=[].slice.call(this.children.get(-1));r.length>0;)e=r.shift(),r=r.concat(this.children.get(e)),t.push(e);return t},o.prototype.getAtomSets=function(){var r=new Map;return this.molecule.sgroups.forEach(function(t,e){r.set(e,new u.default(t.atoms))}),r},o.prototype.getAtomSetRelations=function(t,r){var e=this,n=new Map,o=new Map,i=this.getAtomSets();i.delete(t),i.forEach(function(t,e){o.set(e,t.isSuperset(r)),n.set(e,r.isSuperset(t)&&!t.equals(r))});var a=Array.from(i.keys()).filter(function(t){return!!o.get(t)&&e.children.get(t).findIndex(function(t){return o.get(t)})<0});return{children:Array.from(i.keys()).filter(function(t){return n.get(t)&&!n.get(e.parent.get(t))}),parent:0===a.length?-1:a[0]}},o.prototype.getPathToRoot=function(t){for(var e=[],r=t;r>=0;r=this.parent.get(r))console.assert(e.indexOf(r)<0,"SGroupForest: loop detected"),e.push(r);return e},o.prototype.validate=function(){var s=this,u=this.getAtomSets();this.molecule.sgroups.forEach(function(t,e){s.getPathToRoot(e)});var l=!0;return this.parent.forEach(function(t,e){t>=0&&!u.get(t).isSuperset(u.get(e))&&(l=!1)}),this.children.forEach(function(t){for(var e=0;e<t.length;++e)for(var r=e+1;r<t.length;++r){var n=t[e],o=t[r],i=s.molecule.sgroups.get(n),a=s.molecule.sgroups.get(o);0!==u.get(n).intersection(u.get(o)).size&&"DAT"!==i.type&&"DAT"!==a.type&&(l=!1)}}),l},o.prototype.insert=function(n,t,e){var o=this;console.assert(!this.parent.has(n),"sgid already present in the forest"),console.assert(!this.children.has(n),"sgid already present in the forest"),console.assert(this.validate(),"s-group forest invalid");var r=new u.default(this.molecule.sgroups.get(n).atoms);if(!t||!e){var i=this.getAtomSetRelations(n,r);t=i.parent,e=i.children}return e.forEach(function(t){var e=o.children.get(o.parent.get(t)),r=e.indexOf(t);console.assert(r>=0&&e.indexOf(t,r+1)<0,"Assertion failed"),e.splice(r,1),o.parent.set(t,n)}),this.children.set(n,e),this.parent.set(n,t),this.children.get(t).push(n),console.assert(this.validate(),"s-group forest invalid"),{parent:t,children:e}},o.prototype.remove=function(t){var e=this;console.assert(this.parent.has(t),"sgid is not in the forest"),console.assert(this.children.has(t),"sgid is not in the forest"),console.assert(this.validate(),"s-group forest invalid");var r=this.parent.get(t);this.children.get(t).forEach(function(t){e.parent.set(t,r),e.children.get(r).push(t)});var n=this.children.get(r),o=n.indexOf(t);console.assert(o>=0&&n.indexOf(t,o+1)<0,"Assertion failed"),n.splice(o,1),this.children.delete(t),this.parent.delete(t),console.assert(this.validate(),"s-group forest invalid")},r.default=o},{"../../util/pile":683,"../../util/pool":684}],540:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){console.assert(t&&t in o.TYPES,"Invalid or unsupported s-group type"),this.type=t,this.id=-1,this.label=-1,this.bracketBox=null,this.bracketDir=new d.default(1,0),this.areas=[],this.highlight=!1,this.highlighting=null,this.selected=!1,this.selectionPlate=null,this.atoms=[],this.patoms=[],this.bonds=[],this.xBonds=[],this.neiAtoms=[],this.pp=null,this.data={mul:1,connectivity:"ht",name:"",subscript:"n",attached:!1,absolute:!0,showUnits:!1,nCharsToDisplay:-1,tagChar:"",daspPos:1,fieldType:"F",fieldName:"",fieldValue:"",units:"",query:"",queryOp:""}}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/box2abs"),c=n(i),a=t("../../util/vec2"),d=n(a),s=t("../../util/pile"),m=n(s),u=t("./atom"),g=n(u),l=t("./bond"),v=n(l);o.TYPES={MUL:1,SRU:2,SUP:3,DAT:4,GEN:5},o.prototype.getAttr=function(t){return this.data[t]},o.prototype.getAttrs=function(){var e=this,r={};return Object.keys(this.data).forEach(function(t){r[t]=e.data[t]}),r},o.prototype.setAttr=function(t,e){var r=this.data[t];return this.data[t]=e,r},o.prototype.checkAttr=function(t,e){return this.data[t]==e},o.filterAtoms=function(t,e){for(var r=[],n=0;n<t.length;++n){var o=t[n];"number"!=typeof e[o]?r.push(o):e[o]>=0?r.push(e[o]):r.push(-1)}return r},o.removeNegative=function(t){for(var e=[],r=0;r<t.length;++r)t[r]>=0&&e.push(t[r]);return e},o.filter=function(t,e,r){e.atoms=o.removeNegative(o.filterAtoms(e.atoms,r))},o.clone=function(e,r){var n=new o(e.type);return Object.keys(e.data).forEach(function(t){n.data[t]=e.data[t]}),n.atoms=e.atoms.map(function(t){return r.get(t)}),n.pp=e.pp,n.bracketBox=e.bracketBox,n.patoms=null,n.bonds=null,n.allAtoms=e.allAtoms,n},o.addAtom=function(t,e){t.atoms.push(e)},o.removeAtom=function(t,e){for(var r=0;r<t.atoms.length;++r)if(t.atoms[r]===e)return void t.atoms.splice(r,1);console.error("The atom is not found in the given s-group")},o.getCrossBonds=function(r,n,t,o){t.bonds.forEach(function(t,e){o.has(t.begin)&&o.has(t.end)?null!==r&&r.push(e):(o.has(t.begin)||o.has(t.end))&&null!==n&&n.push(e)})},o.bracketPos=function(t,i,e){var r=t.atoms;if(e&&2===e.length){var n=i.bonds.get(e[0]).getCenter(i),o=i.bonds.get(e[1]).getCenter(i);t.bracketDir=d.default.diff(o,n).normalized()}else t.bracketDir=new d.default(1,0);var a=t.bracketDir,s=null,u=[];r.forEach(function(t){var e=i.atoms.get(t),r=new d.default(e.pp),n=new d.default(.05*3,.05*3),o=new c.default(r,r).extend(n,n);u.push(o)}),u.forEach(function(t){var o=null;[t.p0.x,t.p1.x].forEach(function(n){[t.p0.y,t.p1.y].forEach(function(t){var e=new d.default(n,t),r=new d.default(d.default.dot(e,a),d.default.dot(e,a.rotateSC(1,0)));o=null===o?new c.default(r,r):o.include(r)})}),s=null===s?o:c.default.union(s,o)});var l=new d.default(.2,.4);null!==s&&(s=s.extend(l,l)),t.bracketBox=s},o.getBracketParameters=function(a,s,o,i,u,l){function c(t,e,r,n){this.c=t,this.d=e,this.n=e.rotateSC(1,0),this.w=r,this.h=n}var f=[];return s.length<2?function(){u=u||new d.default(1,0),l=l||u.rotateSC(1,0);var t=Math.min(.25,.3*i.sz().x),e=d.default.lc2(u,i.p0.x,l,.5*(i.p0.y+i.p1.y)),r=d.default.lc2(u,i.p1.x,l,.5*(i.p0.y+i.p1.y)),n=i.sz().y;f.push(new c(e,u.negated(),t,n),new c(r,u,t,n))}():2===s.length?function(){var t=a.bonds.get(s[0]),e=a.bonds.get(s[1]),r=t.getCenter(a),n=e.getCenter(a),o=d.default.diff(n,r).normalized(),i=o.negated();f.push(new c(r.addScaled(i,0),i,.25,1.5),new c(n.addScaled(o,0),o,.25,1.5))}():function(){for(var t=0;t<s.length;++t){var e=a.bonds.get(s[t]),r=e.getCenter(a),n=o.has(e.begin)?e.getDir(a):e.getDir(a).negated();f.push(new c(r,n,.2,1))}}(),f},o.getObjBBox=function(t,e){console.assert(0!=t.length,"Atom list is empty");for(var r=e.atoms.get(t[0]).pp,n=new c.default(r,r),o=1;o<t.length;++o){var i=t[o],a=e.atoms.get(i),s=a.pp;n=n.include(s)}return n},o.getAtoms=function(t,e){if(!e.allAtoms)return e.atoms;var r=[];return t.atoms.forEach(function(t,e){r.push(e)}),r},o.getBonds=function(t,e){var r=o.getAtoms(t,e),n=[];return t.bonds.forEach(function(t,e){r.indexOf(t.begin)>=0&&r.indexOf(t.end)>=0&&n.push(e)}),n},o.prepareMulForSaving=function(n,o){n.atoms.sort(function(t,e){return t-e}),n.atomSet=new m.default(n.atoms),n.parentAtomSet=new m.default(n.atomSet);var r=[],i=[];if(o.bonds.forEach(function(t,e){n.parentAtomSet.has(t.begin)&&n.parentAtomSet.has(t.end)?r.push(e):(n.parentAtomSet.has(t.begin)||n.parentAtomSet.has(t.end))&&i.push(e)}),0!==i.length&&2!==i.length)throw Error("Unsupported cross-bonds number");var t=-1,e=-1,a=null;if(2===i.length){var s=o.bonds.get(i[0]);t=n.parentAtomSet.has(s.begin)?s.begin:s.end;var u=o.bonds.get(i[1]);e=n.parentAtomSet.has(u.begin)?u.begin:u.end,a=u}for(var l=null,c=e,f=[],d=0;d<n.data.mul-1;d++)if(l={},n.atoms.forEach(function(t){var e=o.atoms.get(t),r=o.atoms.add(new g.default(e));f.push(r),n.atomSet.add(r),l[t]=r}),r.forEach(function(t){var e=o.bonds.get(t),r=new v.default(e);r.begin=l[r.begin],r.end=l[r.end],o.bonds.add(r)}),null!==a){var p=new v.default(a);p.begin=c,p.end=l[t],o.bonds.add(p),c=l[e]}if(c>=0){var h=o.bonds.get(i[1]);h.begin===e?h.begin=c:h.end=c}n.bonds=i,f.forEach(function(e){o.sGroupForest.getPathToRoot(n.id).reverse().forEach(function(t){o.atomAddToSGroup(t,e)})})},o.getMassCentre=function(t,e){for(var r=new d.default,n=0;n<e.length;++n)r=r.addScaled(t.atoms.get(e[n]).pp,1/e.length);return r},r.default=o},{"../../util/box2abs":682,"../../util/pile":683,"../../util/vec2":686,"./atom":534,"./bond":536}],541:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(s,u,l,c,f){var t=u.molecule,e=s.molecule,d=e.getBondFragment(l),p=y(e,d),h=null,m=null,g=new w.default;return a(p.frag)&&a(t)?Promise.all([c.aromatizeStruct.dispatch(p.frag).then(function(t){return _.default.parse(t.struct)}),c.aromatizeStruct.dispatch(t).then(function(t){return _.default.parse(t.struct)})]).then(function(t){var e=b(t,2),r=e[0],n=e[1],o=v(s,r,p.bondMap),i={bid:u.bid,molecule:n},a=f(s,i,l);return m=a[1],g=a[0].mergeWith(o),h=y(s.molecule,d),c.dearomatizeStruct.dispatch(h.frag).then(function(t){return _.default.parse(t.struct)})}).then(function(t){t.bonds.forEach(function(t){if(t.type===x.Bond.PATTERN.TYPE.AROMATIC)throw Error("Bad dearomatize")});var e=i(s,t,h.bondMap);return g=e.mergeWith(g),[g,m]}).catch(function(t){return console.info(t.message),g.perform(s),f(s,u,l)}):(g=f(s,u,l),Promise.resolve(g))}function v(r,t,n){var o=new w.default;return t.bonds.forEach(function(t,e){t.type===x.Bond.PATTERN.TYPE.AROMATIC&&o.addOp(new l.default.BondAttr(n.get(e),"type",x.Bond.PATTERN.TYPE.AROMATIC).perform(r))}),o}function i(r,t,n){var o=new w.default;return t.bonds.forEach(function(t,e){o.addOp(new l.default.BondAttr(n.get(e),"type",t.type).perform(r))}),o}function a(t){0===t.loops.size&&t.prepareLoopStructure();var e=t.loops.find(function(t,e){return e.aromatic});return 0!==t.loops.size&&!e&&void 0!==t.loops.find(function(t,e){return e.dblBonds===e.hbs.length/2})}function y(r,t){var e=r.getFragmentIds(t),n=Array.from(e),o=r.clone(e),i=new Map;return o.bonds.forEach(function(t,e){i.set(e,r.findBondId(n[t.begin],n[t.end]))}),{frag:o,bondMap:i}}Object.defineProperty(r,"__esModule",{value:!0});var b=function(){function r(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.fromAromaticTemplateOnBond=o;var s=t("../../chem/molfile"),_=n(s),x=t("../../chem/struct"),u=t("../shared/op"),l=n(u),c=t("../shared/action"),w=n(c)},{"../../chem/molfile":523,"../../chem/struct":537,"../shared/action":557,"../shared/op":560}],542:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r){r=Object.assign({},r);var n=new g.default;return r.fragment=n.addOp((new h.default.FragmentAdd).perform(t)).frid,n.addOp(new h.default.AtomAdd(r,e).perform(t)),n}function i(e,t){var r=new g.default,n=[],o=e.molecule.atoms.get(t).fragment;return(0,v.atomGetNeighbors)(e,t).forEach(function(t){r.addOp(new h.default.BondDelete(t.bid)),1===(0,v.atomGetDegree)(e,t.aid)&&((0,y.removeAtomFromSgroupIfNeeded)(r,e,t.aid)&&n.push(t.aid),r.addOp(new h.default.AtomDelete(t.aid)))}),(0,y.removeAtomFromSgroupIfNeeded)(r,e,t)&&n.push(t),r.addOp(new h.default.AtomDelete(t)),(0,y.removeSgroupIfNeeded)(r,e,n),r=r.perform(e),r.mergeWith((0,_.fromFragmentSplit)(e,o)),r}function a(t,e,n,o){var i=new g.default;return(Array.isArray(e)?e:[e]).forEach(function(r){Object.keys(d.Atom.attrlist).forEach(function(t){if(("attpnt"!==t||t in n)&&(t in n||o)){var e=t in n?n[t]:d.Atom.attrGetDefault(t);i.addOp(new h.default.AtomAttr(r,t,e))}}),!o&&"label"in n&&null!==n.label&&"L#"!==n.label&&!n.atomList&&i.addOp(new h.default.AtomAttr(r,"atomList",null))}),i.perform(t)}function s(a,t,s){if(t===s)return new g.default;var e=new g.default;l(e,a,t,s);var u=new g.default;(0,v.atomGetNeighbors)(a,t).forEach(function(t){var e=a.molecule.bonds.get(t.bid);if(s===e.begin||s===e.end)return void u.addOp(new h.default.BondDelete(t.bid));var r=e.begin===t.aid?t.aid:s,n=e.begin===t.aid?s:t.aid,o=a.molecule.findBondId(r,n);if(null===o)u.addOp(new h.default.BondAdd(r,n,e));else{var i=d.Bond.getAttrHash(e);Object.keys(i).forEach(function(t){u.addOp(new h.default.BondAttr(o,t,i[t]))})}u.addOp(new h.default.BondDelete(t.bid))});var r=d.Atom.getAttrHash(a.molecule.atoms.get(t));return 1===(0,v.atomGetDegree)(a,t)&&"*"===r.label&&(r.label="C"),Object.keys(r).forEach(function(t){u.addOp(new h.default.AtomAttr(s,t,r[t]))}),(0,y.removeAtomFromSgroupIfNeeded)(u,a,t)&&(0,y.removeSgroupIfNeeded)(u,a,[t]),u.addOp(new h.default.AtomDelete(t)),u.perform(a).mergeWith(e)}function l(r,n,t,e){var o=(0,v.atomGetAttr)(n,t,"fragment"),i=(0,v.atomGetAttr)(n,e,"fragment");if(i!==o&&"number"==typeof i){var a=n.molecule,s=d.RGroup.findRGroupByFragment(a.rgroups,i);void 0!==s&&r.mergeWith((0,b.fromRGroupFragment)(n,null,i)).mergeWith((0,b.fromUpdateIfThen)(n,0,s));var u=a.getFragmentIds(o);a.atoms.forEach(function(t,e){t.fragment===i&&r.addOp(new h.default.AtomAttr(e,"fragment",o).perform(n))}),c(r,n,u,e),r.addOp(new h.default.FragmentDelete(i).perform(n))}}function c(n,o,i,t){(0,v.atomGetSGroups)(o,t).forEach(function(e){var t=o.molecule.sgroups.get(e),r=["Atom","Bond","Group"];"DAT"===t.type&&r.includes(t.data.context)||(0,f.default)(t.atoms,i).forEach(function(t){return n.addOp(new h.default.SGroupAtomAdd(e,t).perform(o))})})}Object.defineProperty(r,"__esModule",{value:!0});var u=t("lodash/fp/without"),f=n(u);r.fromAtomAddition=o,r.fromAtomDeletion=i,r.fromAtomsAttrs=a,r.fromAtomMerge=s,r.mergeFragmentsIfNeeded=l,r.mergeSgroups=c;var d=t("../../chem/struct"),p=t("../shared/op"),h=n(p),m=t("../shared/action"),g=n(m),v=t("./utils"),y=t("./sgroup"),b=t("./rgroup"),_=t("./fragment")},{"../../chem/struct":537,"../shared/action":557,"../shared/op":560,"./fragment":548,"./rgroup":551,"./sgroup":553,"./utils":555,"lodash/fp/without":437}],543:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r=new l.default;return r.addOp(new s.default.CanvasLoad(e)),r.perform(t)}function i(t){var e=new l.default;return e.addOp(new s.default.AlignDescriptors(t)),e.perform(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.fromNewCanvas=o,r.fromDescriptorsAlign=i;var a=t("../shared/op"),s=n(a),u=t("../shared/action"),l=n(u)},{"../shared/action":557,"../shared/op":560}],544:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r,n,o,i){if(void 0===n){var a=(0,y.atomForNewBond)(t,r);n=a.atom,o=a.pos}var s=new v.default,u=null;"number"!=typeof r?"number"==typeof n&&(u=(0,y.atomGetAttr)(t,n,"fragment")):(u=(0,y.atomGetAttr)(t,r,"fragment"),"number"==typeof n&&(0,b.mergeFragmentsIfNeeded)(s,t,r,n)),null==u&&(u=s.addOp((new p.default.FragmentAdd).perform(t)).frid),"number"!=typeof r?(r.fragment=u,r=s.addOp(new p.default.AtomAdd(r,o).perform(t)).data.aid,"number"==typeof n&&(0,b.mergeSgroups)(s,t,[r],n),o=i):"*"===(0,y.atomGetAttr)(t,r,"label")&&s.addOp(new p.default.AtomAttr(r,"label","C").perform(t)),"number"!=typeof n?(n.fragment=u,n=s.addOp(new p.default.AtomAdd(n,o).perform(t)).data.aid,"number"==typeof r&&(0,b.mergeSgroups)(s,t,[n],r)):"*"===(0,y.atomGetAttr)(t,n,"label")&&s.addOp(new p.default.AtomAttr(n,"label","C").perform(t));var l=s.addOp(new p.default.BondAdd(r,n,e).perform(t)).data.bid;return s.operations.reverse(),[s,r,n,l]}function i(t,e){var r=new v.default,n=t.molecule.bonds.get(e),o=t.molecule.atoms.get(n.begin).fragment,i=[];return r.addOp(new p.default.BondDelete(e)),1===(0,y.atomGetDegree)(t,n.begin)&&((0,_.removeAtomFromSgroupIfNeeded)(r,t,n.begin)&&i.push(n.begin),r.addOp(new p.default.AtomDelete(n.begin))),1===(0,y.atomGetDegree)(t,n.end)&&((0,_.removeAtomFromSgroupIfNeeded)(r,t,n.end)&&i.push(n.end),r.addOp(new p.default.AtomDelete(n.end))),(0,_.removeSgroupIfNeeded)(r,t,i),r=r.perform(t),r.mergeWith((0,x.fromFragmentSplit)(t,o)),r}function s(t,e,n,o){var i=new v.default;return(Array.isArray(e)?e:[e]).forEach(function(r){Object.keys(f.Bond.attrlist).forEach(function(t){if(t in n||o){var e=t in n?n[t]:f.Bond.attrGetDefault(t);i.addOp(new p.default.BondAttr(r,t,e))}})}),i.perform(t)}function a(r,t){var i=r.molecule,a=new Map,n=new v.default;return t.forEach(function(t,e){var r=i.bonds.get(e),n=i.bonds.get(t),o=m.default.mergeBondsParams(i,r,i,n);o.merged&&(a.set(r.begin,o.cross?n.end:n.begin),a.set(r.end,o.cross?n.begin:n.end))}),a.forEach(function(t,e){n=(0,b.fromAtomMerge)(r,e,t).mergeWith(n)}),n}function u(t,e){var r=t.molecule.bonds.get(e),n=new v.default;return n.addOp(new p.default.BondDelete(e)),n.addOp(new p.default.BondAdd(r.end,r.begin,r)).data.bid=e,n.perform(t)}function l(t,e,r,n){if(n.stereo!==f.Bond.PATTERN.STEREO.NONE&&n.type===f.Bond.PATTERN.TYPE.SINGLE&&r.type===n.type&&r.stereo===n.stereo)return u(t,e);var o=w.includes(n.type)?w:null;n.stereo===f.Bond.PATTERN.STEREO.NONE&&n.type===f.Bond.PATTERN.TYPE.SINGLE&&r.stereo===f.Bond.PATTERN.STEREO.NONE&&o&&(n.type=o[(o.indexOf(r.type)+1)%o.length]);var i=c(t.molecule,r,n),a=i?u(t,e):new v.default;return s(t,e,n).mergeWith(a)}function c(t,e,r){return r.type===f.Bond.PATTERN.TYPE.SINGLE&&e.stereo===f.Bond.PATTERN.STEREO.NONE&&r.stereo!==f.Bond.PATTERN.STEREO.NONE&&t.atoms.get(e.begin).neighbors.length<t.atoms.get(e.end).neighbors.length}Object.defineProperty(r,"__esModule",{value:!0}),r.fromBondAddition=o,r.fromBondDeletion=i,r.fromBondsAttrs=s,r.fromBondsMerge=a,r.bondChangingAction=l;var f=t("../../chem/struct"),d=t("../shared/op"),p=n(d),h=t("../shared/utils"),m=n(h),g=t("../shared/action"),v=n(g),y=t("./utils"),b=t("./atom"),_=t("./sgroup"),x=t("./fragment"),w=[f.Bond.PATTERN.TYPE.SINGLE,f.Bond.PATTERN.TYPE.DOUBLE,f.Bond.PATTERN.TYPE.TRIPLE]},{"../../chem/struct":537,"../shared/action":557,"../shared/op":560,"../shared/utils":561,"./atom":542,"./fragment":548,"./sgroup":553,"./utils":555}],545:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r,n,o){var i=Math.cos(Math.PI/6),a=Math.sin(Math.PI/6),s=new g.default,u=null!==o?(0,v.atomGetAttr)(t,o,"fragment"):s.addOp((new m.default.FragmentAdd).perform(t)).frid,l={atoms:[],bonds:[]},c=null!==o?o:s.addOp(new m.default.AtomAdd({label:"C",fragment:u},e).perform(t)).data.aid;l.atoms.push(c),s.operations.reverse();for(var f=0;f<n;f++){var d=new h.default(i*(f+1),1&f?0:a).rotate(r).add(e),p=(0,y.fromBondAddition)(t,{},c,{},d);s=p[0].mergeWith(s),c=p[2],l.bonds.push(p[3]),l.atoms.push(c)}return[s,l]}Object.defineProperty(r,"__esModule",{value:!0}),r.fromChain=o;var i=t("../../util/vec2"),h=n(i),a=t("../shared/op"),m=n(a),s=t("../shared/action"),g=n(s),v=t("./utils"),y=t("./bond")},{"../../util/vec2":686,"../shared/action":557,"../shared/op":560,"./bond":544,"./utils":555}],546:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r=new f.default,n=t.molecule;if(t.chiralFlags.size<1){if(!e){var o=n.getCoordBoundingBox(),i=n.isBlank()?o.min.y+1:o.min.y-1;e=new s.default(o.max.x,i)}r.addOp(new l.default.ChiralFlagAdd(e).perform(t))}return r}function i(t){var e=new f.default;return e.addOp(new l.default.ChiralFlagDelete),e.perform(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.fromChiralFlagAddition=o,r.fromChiralFlagDeletion=i;var a=t("../../util/vec2"),s=n(a),u=t("../shared/op"),l=n(u),c=t("../shared/action"),f=n(c)},{"../../util/vec2":686,"../shared/action":557,"../shared/op":560}],547:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(r,t){var n=new l.default;if(!t)return n;var o=new Set;return t.atoms.forEach(function(t,e){o.has(t)||o.has(e)||(n=(0,p.fromAtomMerge)(r,e,t).mergeWith(n),o.add(t).add(e))}),n=(0,d.fromBondsMerge)(r,t.bonds).mergeWith(n)}function i(t,e){var r=t.render.ctab.molecule,n=e||{atoms:Array.from(r.atoms.keys()),bonds:Array.from(r.bonds.keys())};return s(r,t.findMerge(n,["atoms","bonds"]))}function a(t){if(!t)return null;var e={atoms:Array.from(t.atoms.values()),bonds:Array.from(t.bonds.values())};return{map:"merge",id:+Date.now(),items:e}}function s(o,t){var i={atoms:new Map(t.atoms),bonds:new Map(t.bonds)};return t.bonds.forEach(function(t,e){var r=o.bonds.get(e),n=o.bonds.get(t);f.default.mergeBondsParams(o,r,o,n).merged?(i.atoms.delete(r.begin),i.atoms.delete(r.end)):i.bonds.delete(e)}),0===i.atoms.size&&0===i.bonds.size?null:i}Object.defineProperty(r,"__esModule",{value:!0}),r.fromItemsFuse=o,r.getItemsToFuse=i,r.getHoverToFuse=a;var u=t("../shared/action"),l=n(u),c=t("../shared/utils"),f=n(c),d=t("./bond"),p=t("./atom")},{"../shared/action":557,"../shared/utils":561,"./atom":542,"./bond":544}],548:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(e,t,r){r=new l.default(r);var n=new g.default,o=e.molecule,i=new f.default,a=new f.default;if(t.atoms){var s=new f.default(t.atoms),u=[];if(e.bonds.forEach(function(r,t){return s.has(r.b.begin)&&s.has(r.b.end)?(u.push(t),void["hb1","hb2"].forEach(function(t){var e=o.halfBonds.get(r.b[t]).loop;e>=0&&i.add(e)})):s.has(r.b.begin)?void a.add(r.b.begin):void(s.has(r.b.end)&&a.add(r.b.end))}),u.forEach(function(t){n.addOp(new h.default.BondMove(t,r))}),i.forEach(function(t){e.reloops.get(t)&&e.reloops.get(t).visel&&n.addOp(new h.default.LoopMove(t,r))}),t.atoms.forEach(function(t){n.addOp(new h.default.AtomMove(t,r,!a.has(t)))}),t.sgroupData&&0===t.sgroupData.length){(0,v.getRelSgroupsBySelection)(e,t.atoms).forEach(function(t){n.addOp(new h.default.SGroupDataMove(t.id,r))})}}return t.rxnArrows&&t.rxnArrows.forEach(function(t){n.addOp(new h.default.RxnArrowMove(t,r,!0))}),t.rxnPluses&&t.rxnPluses.forEach(function(t){n.addOp(new h.default.RxnPlusMove(t,r,!0))}),t.sgroupData&&t.sgroupData.forEach(function(t){n.addOp(new h.default.SGroupDataMove(t,r))}),t.chiralFlags&&o.isChiral&&t.chiralFlags.forEach(function(){n.addOp(new h.default.ChiralFlagMove(r))}),n.perform(e)}function s(e,t,r,n){for(var o=new g.default,i=[t],a=new f.default(i);i.length>0;){var s=i.shift();o.addOp(new h.default.AtomAttr(s,"fragment",n).perform(e)),(0,v.atomGetNeighbors)(e,s).forEach(function(t){e.molecule.atoms.get(t.aid).fragment!==r||a.has(t.aid)||(a.add(t.aid),i.push(t.aid))})}return o}function u(n,o){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=new g.default,a=d.RGroup.findRGroupByFragment(n.molecule.rgroups,o);return n.molecule.atoms.forEach(function(t,e){if(t.fragment===o){var r=i.addOp((new h.default.FragmentAdd).perform(n)).frid;i.mergeWith(s(n,e,o,r)),a&&i.mergeWith((0,b.fromRGroupFragment)(n,a,r))}}),-1!==o&&(i.mergeWith((0,b.fromRGroupFragment)(n,0,o)),i.addOp(new h.default.FragmentDelete(o).perform(n)),i.mergeWith((0,b.fromUpdateIfThen)(n,0,a,t))),n.molecule.isChiral&&0===n.molecule.frags.size&&i.addOp((new h.default.ChiralFlagDelete).perform(n)),i}function i(n,o){console.assert(!!o);var i=new g.default,a=[],s=[];o={atoms:o.atoms||[],bonds:o.bonds||[],rxnPluses:o.rxnPluses||[],rxnArrows:o.rxnArrows||[],sgroupData:o.sgroupData||[],chiralFlags:o.chiralFlags||[]};var r=new g.default;n.molecule.sgroups.forEach(function(t,e){(o.sgroupData.includes(e)||new f.default(o.atoms).isSuperset(new f.default(t.atoms)))&&r.mergeWith((0,y.fromSgroupDeletion)(n,e))}),o.atoms.forEach(function(t){(0,v.atomGetNeighbors)(n,t).forEach(function(t){-1===o.bonds.indexOf(t.bid)&&(o.bonds=o.bonds.concat([t.bid]))})}),o.bonds.forEach(function(t){i.addOp(new h.default.BondDelete(t));var e=n.molecule.bonds.get(t),r=n.molecule.atoms.get(e.begin).fragment;s.indexOf(r)<0&&s.push(r),-1===o.atoms.indexOf(e.begin)&&1===(0,v.atomGetDegree)(n,e.begin)&&((0,y.removeAtomFromSgroupIfNeeded)(i,n,e.begin)&&a.push(e.begin),i.addOp(new h.default.AtomDelete(e.begin))),-1===o.atoms.indexOf(e.end)&&1===(0,v.atomGetDegree)(n,e.end)&&((0,y.removeAtomFromSgroupIfNeeded)(i,n,e.end)&&a.push(e.end),i.addOp(new h.default.AtomDelete(e.end)))}),o.atoms.forEach(function(t){var e=n.molecule.atoms.get(t).fragment;s.indexOf(e)<0&&s.push(e),(0,y.removeAtomFromSgroupIfNeeded)(i,n,t)&&a.push(t),i.addOp(new h.default.AtomDelete(t))}),(0,y.removeSgroupIfNeeded)(i,n,a),o.rxnArrows.forEach(function(t){i.addOp(new h.default.RxnArrowDelete(t))}),o.rxnPluses.forEach(function(t){i.addOp(new h.default.RxnPlusDelete(t))}),o.chiralFlags.forEach(function(t){i.addOp(new h.default.ChiralFlagDelete(t))}),i=i.perform(n);for(var t=s.map(function(t){return d.RGroup.findRGroupByFragment(n.molecule.rgroups,t)});s.length>0;)i.mergeWith(u(n,s.pop(),t));return i.mergeWith(r),i}Object.defineProperty(r,"__esModule",{value:!0}),r.fromMultipleMove=o,r.fromFragmentSplit=u,r.fromFragmentDeletion=i;var a=t("../../util/vec2"),l=n(a),c=t("../../util/pile"),f=n(c),d=t("../../chem/struct"),p=t("../shared/op"),h=n(p),m=t("../shared/action"),g=n(m),v=t("./utils"),y=t("./sgroup"),b=t("./rgroup")},{"../../chem/struct":537,"../../util/pile":683,"../../util/vec2":686,"../shared/action":557,"../shared/op":560,"./rgroup":551,"./sgroup":553,"./utils":555}],549:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(o,i,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=p(i),n=h.default.diff(a,u),l=new g.default,c=new Map,f=new Map,d={atoms:[],bonds:[]};if(i.atoms.forEach(function(t,e){f.has(t.fragment)||f.set(t.fragment,l.addOp((new m.default.FragmentAdd).perform(o)).frid);var r=Object.assign(t.clone(),{fragment:f.get(t.fragment)}),n=new m.default.AtomAdd(r,h.default.diff(t.pp,u).rotate(s).add(a)).perform(o);l.addOp(n),c.set(e,n.data.aid),d.atoms.push(n.data.aid)}),i.bonds.forEach(function(t){var e=new m.default.BondAdd(c.get(t.begin),c.get(t.end),t).perform(o);l.addOp(e),d.bonds.push(e.data.bid)}),i.sgroups.forEach(function(t){var e=o.molecule.sgroups.newId(),r=t.atoms.map(function(t){return c.get(t)});(0,b.fromSgroupAddition)(o,t.type,r,t.data,e,t.pp?t.pp.add(n):null).operations.reverse().forEach(function(t){l.addOp(t)})}),o.rxnArrows.size<1&&i.rxnArrows.forEach(function(t){l.addOp(new m.default.RxnArrowAdd(t.pp.add(n)).perform(o))}),i.rxnPluses.forEach(function(t){l.addOp(new m.default.RxnPlusAdd(t.pp.add(n)).perform(o))}),i.isChiral){var t=i.getCoordBoundingBox(),e=new h.default(t.max.x,t.min.y-1);l.mergeWith((0,v.fromChiralFlagAddition)(o,e.add(n)))}return i.rgroups.forEach(function(t,r){t.frags.forEach(function(t,e){l.addOp(new m.default.RGroupFragment(r,f.get(e)).perform(o))});var e=i.rgroups.get(r).ifthen,n=i.rgroups.get(e)?e:0;l.mergeWith((0,y.fromRGroupAttrs)(o,r,t.getAttrs())).mergeWith((0,y.fromUpdateIfThen)(o,n,t.ifthen))}),l.operations.reverse(),[l,d]}function p(t){if(t.atoms.size>0){var e=1e50,r=e,n=-e,o=-r;return t.atoms.forEach(function(t){e=Math.min(e,t.pp.x),r=Math.min(r,t.pp.y),n=Math.max(n,t.pp.x),o=Math.max(o,t.pp.y)}),new h.default((e+n)/2,(r+o)/2)}return t.rxnArrows.size>0?t.rxnArrows.get(0).pp:t.rxnPluses.size>0?t.rxnPluses.get(0).pp:t.isChiral?new h.default(1,-1):null}Object.defineProperty(r,"__esModule",{value:!0}),r.fromPaste=o;var i=t("../../util/vec2"),h=n(i),a=t("../shared/op"),m=n(a),s=t("../shared/action"),g=n(s),v=t("./chiral-flag"),y=t("./rgroup"),b=t("./sgroup")},{"../../util/vec2":686,"../shared/action":557,"../shared/op":560,"./chiral-flag":546,"./rgroup":551,"./sgroup":553}],550:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r=new f.default;return t.molecule.rxnArrows.size<1&&r.addOp(new l.default.RxnArrowAdd(e).perform(t)),r}function i(t,e){var r=new f.default;return r.addOp(new l.default.RxnArrowDelete(e)),r.perform(t)}function a(t,e){var r=new f.default;return r.addOp(new l.default.RxnPlusAdd(e).perform(t)),r}function s(t,e){var r=new f.default;return r.addOp(new l.default.RxnPlusDelete(e)),r.perform(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.fromArrowAddition=o,r.fromArrowDeletion=i,r.fromPlusAddition=a,r.fromPlusDeletion=s;var u=t("../shared/op"),l=n(u),c=t("../shared/action"),f=n(c)},{"../shared/action":557,"../shared/op":560}],551:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r){var n=new c.default;return Object.keys(r).forEach(function(t){n.addOp(new u.default.RGroupAttr(e,t,r[t]))}),n.perform(t)}function i(t,e,r){var n=new c.default;return n.addOp(new u.default.RGroupFragment(e,r)),n.perform(t)}function a(t,e,r,n){var o=new c.default;return t.molecule.rgroups.get(r)||o.addOp(new u.default.UpdateIfThen(e,r,n)),o.perform(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.fromRGroupAttrs=o,r.fromRGroupFragment=i,r.fromUpdateIfThen=a;var s=t("../shared/op"),u=n(s),l=t("../shared/action"),c=n(l)},{"../shared/action":557,"../shared/op":560}],552:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function c(o,i,a,s){var u=o.molecule,l=new b.default;if(i||(i=(0,_.structSelection)(u)),!i.atoms)return l.perform(o);var c=i.atoms.reduce(function(t,e){var r=u.atoms.get(e);return t[r.fragment]||(t[r.fragment]=[]),t[r.fragment].push(e),t},{});return Object.keys(c).find(function(t){return t=parseInt(t,10),!u.getFragmentIds(t).equals(new h.default(c[t]))})?l:(Object.keys(c).forEach(function(t){var e=new h.default(c[t]),r=u.getCoordBoundingBox(e),n=s||new p.default((r.max.x+r.min.x)/2,(r.max.y+r.min.y)/2);if(e.forEach(function(t){var e=u.atoms.get(t),r=f(e,n,a);l.addOp(new g.default.AtomMove(t,r))}),!i.sgroupData){(0,_.getRelSgroupsBySelection)(o,Array.from(e)).forEach(function(t){var e=f(t,n,a);l.addOp(new g.default.SGroupDataMove(t.id,e))})}}),i.bonds&&i.bonds.forEach(function(t){var e=u.bonds.get(t);if(e.type===m.Bond.PATTERN.TYPE.SINGLE)return e.stereo===m.Bond.PATTERN.STEREO.UP?void l.addOp(new g.default.BondAttr(t,"stereo",m.Bond.PATTERN.STEREO.DOWN)):void(e.stereo===m.Bond.PATTERN.STEREO.DOWN&&l.addOp(new g.default.BondAttr(t,"stereo",m.Bond.PATTERN.STEREO.UP)))}),l.perform(o))}function f(t,e,r){var n=new p.default;return"horizontal"===r?n.x=e.x>t.pp.x?2*(e.x-t.pp.x):-2*(t.pp.x-e.x):n.y=e.y>t.pp.y?2*(e.y-t.pp.y):-2*(t.pp.y-e.y),n}function d(r,t,n,o){var i=r.molecule,a=new b.default;if(t||(t=(0,_.structSelection)(i)),t.atoms&&(t.atoms.forEach(function(t){var e=i.atoms.get(t);a.addOp(new g.default.AtomMove(t,s(e.pp,n,o)))}),!t.sgroupData)){(0,_.getRelSgroupsBySelection)(r,t.atoms).forEach(function(t){a.addOp(new g.default.SGroupDataMove(t.id,s(t.pp,n,o)))})}return t.rxnArrows&&t.rxnArrows.forEach(function(t){var e=i.rxnArrows.get(t);a.addOp(new g.default.RxnArrowMove(t,s(e.pp,n,o)))}),t.rxnPluses&&t.rxnPluses.forEach(function(t){var e=i.rxnPluses.get(t);a.addOp(new g.default.RxnPlusMove(t,s(e.pp,n,o)))}),t.sgroupData&&t.sgroupData.forEach(function(t){var e=i.sgroups.get(t);a.addOp(new g.default.SGroupDataMove(t,s(e.pp,n,o)))}),t.chiralFlags&&t.chiralFlags.forEach(function(t){var e=r.chiralFlags.get(t);a.addOp(new g.default.ChiralFlagMove(s(e.pp,n,o)))}),a.perform(r)}function o(t,e,r){var n=t.molecule,o=n.bonds.get(e),i=n.atoms.get(o.begin),a=n.atoms.get(o.end),s=i.pp.add(a.pp).scaled(.5),u=v.default.calcAngle(i.pp,a.pp),l=(0,_.getFragmentAtoms)(n,i.fragment);return u="horizontal"===r?-u:Math.PI/2-u,0===u||Math.abs(u)===Math.PI?c(t,{atoms:l},r,s):d(t,{atoms:l},s,u)}function s(t,e,r){var n=t.sub(e);return n=n.rotate(r),n.add_(e),n.sub(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.fromFlip=c,r.fromRotate=d,r.fromBondAlign=o;var i=t("../../util/vec2"),p=n(i),a=t("../../util/pile"),h=n(a),m=t("../../chem/struct"),u=t("../shared/op"),g=n(u),l=t("../shared/utils"),v=n(l),y=t("../shared/action"),b=n(y),_=t("./utils")},{"../../chem/struct":537,"../../util/pile":683,"../../util/vec2":686,"../shared/action":557,"../shared/op":560,"../shared/utils":561,"./utils":555}],553:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(n,o,i,a){var t=a.fieldValue;return"string"==typeof t||"DAT"!==o?c(n,o,i,a,n.molecule.sgroups.newId()):t.reduce(function(t,e){var r=Object.assign({},a);return r.fieldValue=e,t.mergeWith(c(n,o,i,r,n.molecule.sgroups.newId()))},new E.default)}function u(t,e,r){var n=new E.default;return Object.keys(r).forEach(function(t){n.addOp(new O.default.SGroupAttr(e,t,r[t]))}),n.perform(t)}function l(e,r){var n=new E.default;return Object.keys(r).forEach(function(t){n.addOp(new O.default.SGroupAttr(e,t,r[t]))}),n}function o(e,r){var n=new E.default,t=e.molecule,o=e.sgroups.get(r).item;"SRU"===o.type&&(t.sGroupsRecalcCrossBonds(),o.neiAtoms.forEach(function(t){"*"===(0,P.atomGetAttr)(e,t,"label")&&n.addOp(new O.default.AtomAttr(t,"label","C"))}));var i=t.sgroups.get(r),a=_.SGroup.getAtoms(t,i),s=i.getAttrs();return n.addOp(new O.default.SGroupRemoveFromHierarchy(r)),a.forEach(function(t){n.addOp(new O.default.SGroupAtomRemove(r,t))}),n.addOp(new O.default.SGroupDelete(r)),n=n.perform(e),n.mergeWith(l(r,s)),n}function c(r,t,e,n,o,i){var a=new E.default;if(o=o-0===o?o:r.molecule.sgroups.newId(),a.addOp(new O.default.SGroupCreate(o,t,i)),e.forEach(function(t){a.addOp(new O.default.SGroupAtomAdd(o,t))}),a.addOp("DAT"!==t?new O.default.SGroupAddToHierarchy(o):new O.default.SGroupAddToHierarchy(o,-1,[])),a=a.perform(r),"SRU"===t){r.molecule.sGroupsRecalcCrossBonds();var s=new E.default;r.sgroups.get(o).item.neiAtoms.forEach(function(t){var e=r.atoms.get(t).a.isPlainCarbon();1===(0,P.atomGetDegree)(r,t)&&e&&s.addOp(new O.default.AtomAttr(t,"label","*"))}),s=s.perform(r),s.mergeWith(a),a=s}return u(r,o,n).mergeWith(a)}function i(t,e,r,n,o){if(t===j.SgContexts.Bond)return p(e,r,n,o);var i=v(e.molecule,o.bonds),a=(0,b.default)(n.concat(i));return t===j.SgContexts.Fragment?d(e,r,a,Array.from(e.atoms.keys())):t===j.SgContexts.Multifragment?h(e,r,a):t===j.SgContexts.Group?d(e,r,a,a):t===j.SgContexts.Atom?f(e,r,a):{action:s(e,r.type,n,r.attrs)}}function f(r,n,t){return t.reduce(function(t,e){return t.action=t.action.mergeWith(s(r,n.type,[e],n.attrs)),t},{action:new E.default,selection:{atoms:t,bonds:[]}})}function d(o,i,t,a){var e=new w.default(t.map(function(t){return o.atoms.get(t).a.fragment}));return Array.from(e).reduce(function(t,n){var e=a.reduce(function(t,e){var r=o.atoms.get(e).a;return n===r.fragment&&t.push(e),t},[]),r=g(o.molecule,e);return t.action=t.action.mergeWith(s(o,i.type,e,i.attrs)),t.selection.atoms=t.selection.atoms.concat(e),t.selection.bonds=t.selection.bonds.concat(r),t},{action:new E.default,selection:{atoms:[],bonds:[]}})}function p(n,o,t,e){var i=n.molecule,r=g(i,t);return e.bonds&&(r=(0,b.default)(r.concat(e.bonds))),r.reduce(function(t,e){var r=i.bonds.get(e);return t.action=t.action.mergeWith(s(n,o.type,[r.begin,r.end],o.attrs)),t.selection.bonds.push(e),t},{action:new E.default,selection:{atoms:t,bonds:[]}})}function h(t,e,r){var n=g(t.molecule,r);return{action:s(t,e.type,r,e.attrs),selection:{atoms:r,bonds:n}}}function a(e,t,r){var n=(0,P.atomGetSGroups)(t,r);return n.length>0&&(n.forEach(function(t){e.addOp(new O.default.SGroupAtomRemove(t,r))}),!0)}function m(o,i,t){var a=i.molecule,e=new Map;t.forEach(function(t){(0,P.atomGetSGroups)(i,t).forEach(function(t){e.set(t,e.has(t)?e.get(t)+1:1)})}),e.forEach(function(t,e){var r=i.sgroups.get(e).item;if(_.SGroup.getAtoms(i.molecule,r).length===t){var n=a.sgroups.get(e);o.mergeWith(l(e,n.getAttrs())),o.addOp(new O.default.SGroupRemoveFromHierarchy(e)),o.addOp(new O.default.SGroupDelete(e))}})}function g(r,t){var n=new w.default(t);return Array.from(r.bonds.keys()).filter(function(t){var e=r.bonds.get(t);return n.has(e.begin)&&n.has(e.end)})}function v(n,t){return t=t||[],t.reduce(function(t,e){var r=n.bonds.get(e);return t=t.concat([r.begin,r.end])},[])}Object.defineProperty(r,"__esModule",{value:!0});var y=t("lodash/uniq"),b=n(y);r.fromSeveralSgroupAddition=s,r.fromSgroupAttrs=u,r.sGroupAttributeAction=l,r.fromSgroupDeletion=o,r.fromSgroupAddition=c,r.fromSgroupAction=i,r.removeAtomFromSgroupIfNeeded=a,r.removeSgroupIfNeeded=m;var _=t("../../chem/struct"),x=t("../../util/pile"),w=n(x),S=t("../shared/op"),O=n(S),A=t("../shared/action"),E=n(A),j=t("../shared/constants"),P=t("./utils")},{"../../chem/struct":537,"../../util/pile":683,"../shared/action":557,"../shared/constants":559,"../shared/op":560,"./utils":555,"lodash/uniq":479}],554:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r,n){return(0,h.fromPaste)(t,e.molecule,r,n)}function g(t,e,r){var n=new _.default,o=(0,S.atomGetAttr)(t,e,"fragment"),i=null;if(null===r){var a=(0,S.atomForNewBond)(t,e),s=(0,A.fromBondAddition)(t,{type:1},e,a.atom,a.pos.get_xy0());n=s[0],n.operations.reverse(),i=s[2]}else{var u=new b.default.AtomAdd({label:"C",fragment:o},new v.default(1,0).rotate(r).add(t.molecule.atoms.get(e).pp).get_xy0()).perform(t);n.addOp(u),n.addOp(new b.default.BondAdd(e,u.data.aid,{type:1}).perform(t)),i=u.data.aid}return{action:n,aid1:i}}function i(i,a,t,e,r){var s=new _.default,n=a.molecule,o=i.molecule,u=o.atoms.get(t),l=t,c=null;if(r){var f=g(i,t,e);s=f.action,l=f.aid1,u=o.atoms.get(l),c=x.default.calcAngle(o.atoms.get(t).pp,u.pp)-a.angle0}else null===e&&(e=x.default.calcAngle(u.pp,(0,S.atomForNewBond)(i,t).pos)),c=e-a.angle0;var d=new Map,p=n.atoms.get(a.aid).pp,h=(0,S.atomGetAttr)(i,t,"fragment"),m={atoms:[],bonds:[]};return n.atoms.forEach(function(t,e){var r=y.Atom.getAttrHash(t);if(r.fragment=h,e===a.aid)s.mergeWith((0,O.fromAtomsAttrs)(i,l,r,!0)),d.set(e,l),m.atoms.push(l);else{var n=v.default.diff(t.pp,p).rotate(c).add(u.pp),o=new b.default.AtomAdd(r,n.get_xy0()).perform(i);s.addOp(o),d.set(e,o.data.aid),m.atoms.push(o.data.aid)}}),(0,O.mergeSgroups)(s,i,m.atoms,t),n.bonds.forEach(function(t){var e=new b.default.BondAdd(d.get(t.begin),d.get(t.end),t).perform(i);s.addOp(e),m.bonds.push(e.data.bid)}),s.operations.reverse(),[s,m]}function a(t,e,r,n,o,i){if(!i)return s(t,e,r,o);var a=function(t,e,r){return s(t,e,r,o)};return(0,p.fromAromaticTemplateOnBond)(t,e,r,n,a)}function s(a,t,e,r){var s=new _.default,n=t.molecule,u=a.molecule,l=u.bonds.get(e),c=n.bonds.get(t.bid),f=n.atoms.get(r?c.end:c.begin),d=new Map([[c.begin,r?l.end:l.begin],[c.end,r?l.begin:l.end]]),o={begin:r?c.end:c.begin,end:r?c.begin:c.end},i=x.default.mergeBondsParams(u,l,n,o),p=i.angle,h=i.scale,m=u.getBondFragment(e),g={atoms:[],bonds:[]};return n.atoms.forEach(function(t,e){var r=y.Atom.getAttrHash(t);if(r.fragment=m,e===c.begin||e===c.end)return void s.mergeWith((0,O.fromAtomsAttrs)(a,d.get(e),r,!0));var n=v.default.diff(t.pp,f.pp).rotate(p).scaled(h).add(u.atoms.get(l.begin).pp),o=w.default.atom(a,n,null,.1);if(null===o){var i=new b.default.AtomAdd(r,n).perform(a);s.addOp(i),d.set(e,i.data.aid),g.atoms.push(i.data.aid)}else d.set(e,o.id),s.mergeWith((0,O.fromAtomsAttrs)(a,d.get(e),r,!0))}),(0,O.mergeSgroups)(s,a,g.atoms,l.begin),n.bonds.forEach(function(t){var e=u.findBondId(d.get(t.begin),d.get(t.end));if(null===e){var r=new b.default.BondAdd(d.get(t.begin),d.get(t.end),t).perform(a);s.addOp(r),g.bonds.push(r.data.bid)}else s.mergeWith((0,A.fromBondsAttrs)(a,e,c,!0))}),s.operations.reverse(),[s,g]}Object.defineProperty(r,"__esModule",{value:!0}),r.fromTemplateOnCanvas=o,r.fromTemplateOnAtom=i,r.fromTemplateOnBondAction=a;var u=t("../../util/vec2"),v=n(u),y=t("../../chem/struct"),l=t("../shared/op"),b=n(l),c=t("../shared/action"),_=n(c),f=t("../shared/utils"),x=n(f),d=t("../shared/closest"),w=n(d),S=t("./utils"),O=t("./atom"),A=t("./bond"),p=t("./aromatic-fusing"),h=t("./paste")},{"../../chem/struct":537,"../../util/vec2":686,"../shared/action":557,"../shared/closest":558,"../shared/op":560,"../shared/utils":561,"./aromatic-fusing":541,"./atom":542,"./bond":544,"./paste":549,"./utils":555}],555:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r){return t.molecule.atoms.get(e)[r]}function m(t,e){return t.atoms.get(e).a.neighbors.length}function g(r,t){return r.atoms.get(t).a.neighbors.map(function(t){var e=r.molecule.halfBonds.get(t);return{aid:e.end,bid:e.bid}})}function i(t,e){return Array.from(t.atoms.get(e).a.sgs)}function v(t,e){return t.molecule.atoms.get(e).pp}function a(r){return["atoms","bonds","frags","sgroups","rgroups","rxnArrows","rxnPluses"].reduce(function(t,e){return t[e]=Array.from(r[e].keys()),t},{})}function s(e,r){return Array.from(e.atoms.keys()).filter(function(t){return e.atoms.get(t).fragment===r})}function u(o,t){var r=[],n=v(o,t);g(o,t).forEach(function(t){var e=v(o,t.aid);y.default.dist(n,e)<.1||r.push({id:t.aid,v:y.default.diff(e,n)})}),r.sort(function(t,e){return Math.atan2(t.v.y,t.v.x)-Math.atan2(e.v.y,e.v.x)});var e,i,a=0,s=0;for(e=0;e<r.length;e++)i=y.default.angle(r[e].v,r[(e+1)%r.length].v),i<0&&(i+=2*Math.PI),i>s&&(a=e,s=i);var u=new y.default(1,0);if(r.length>0){if(1===r.length){s=-4*Math.PI/3;var l=g(o,t)[0];if(m(o,l.aid)>1){var c=[],f=v(o,l.aid),d=y.default.diff(n,f),p=Math.atan2(d.y,d.x);g(o,l.aid).forEach(function(t){var e=v(o,t.aid);if(!(t.bid===l.bid||y.default.dist(f,e)<.1)){var r=y.default.diff(e,f),n=Math.atan2(r.y,r.x)-p;n<0&&(n+=2*Math.PI),c.push(n)}}),c.sort(function(t,e){return t-e}),c[0]<=1.01*Math.PI&&c[c.length-1]<=1.01*Math.PI&&(s*=-1)}}i=s/2+Math.atan2(r[a].v.y,r[a].v.x),u=u.rotate(i)}u.add_(n);var h=b.default.atom(o,u,null,.1);return h=null===h?{label:"C"}:h.id,{atom:h,pos:u}}function l(t,r){return t.molecule.sgroups.filter(function(t,e){return!e.data.attached&&!e.data.absolute&&0===(0,f.default)(e.atoms,r).length})}Object.defineProperty(r,"__esModule",{value:!0});var c=t("lodash/difference"),f=n(c);r.atomGetAttr=o,r.atomGetDegree=m,r.atomGetNeighbors=g,r.atomGetSGroups=i,r.atomGetPos=v,r.structSelection=a,r.getFragmentAtoms=s,r.atomForNewBond=u,r.getRelSgroupsBySelection=l;var d=t("../../util/vec2"),y=n(d),p=t("../shared/closest"),b=n(p)},{"../../util/vec2":686,"../shared/closest":558,"lodash/difference":406}],556:[function(E,t,j){(function(o){"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e){this.render=new v.default(t,Object.assign({scale:S},e)),this._selection=null,this._tool=null,this.historyStack=[],this.historyPtr=0,this.event={message:new l.default.Subscription,elementEdit:new l.default.PipelineSubscription,bondEdit:new l.default.PipelineSubscription,rgroupEdit:new l.default.PipelineSubscription,sgroupEdit:new l.default.PipelineSubscription,sdataEdit:new l.default.PipelineSubscription,quickEdit:new l.default.PipelineSubscription,attachEdit:new l.default.PipelineSubscription,change:new l.default.PipelineSubscription,selectionChange:new l.default.PipelineSubscription,aromatizeStruct:new l.default.PipelineSubscription,dearomatizeStruct:new l.default.PipelineSubscription},r(this,t)}function i(t){return t.which&&3===t.which||t.button&&2===t.button}function r(n,e){["click","dblclick","mousedown","mousemove","mouseup","mouseleave"].forEach(function(r){n.event[r]=new l.default.DOMSubscription;var t=n.event[r];e.addEventListener(r,t.dispatch.bind(t)),t.add(function(t){if("mouseup"!==r&&"mouseleave"!==r&&(i(t)||!t.target||"DIV"===t.target.nodeName))return n.hover(null),!0;var e=n.tool();return n.lastEvent=t,e&&r in e&&e[r](t),!0},-1)})}function n(t,e){console.assert(e,"Reference point not specified"),t.render.setScrollOffset(0,0)}function a(t,e){var r=t.getVBoxObj(e||{});return f.default.lc2(r.p0,.5,r.p1,.5)}function s(t){var e=0,r=0;do{e+=t.offsetTop||0,r+=t.offsetLeft||0,t=t.offsetParent}while(t);return new f.default(r,e)}Object.defineProperty(j,"__esModule",{value:!0});var u=E("subscription"),l=t(u),c=E("../util/vec2"),f=t(c),d=E("../util/pile"),p=t(d),h=E("../chem/struct"),m=t(h),g=E("../render"),v=t(g),y=E("./actions/basic"),b=E("./shared/closest"),_=t(b),x=E("./tool"),w=t(x),S=40,O=["atoms","bonds","frags","sgroups","sgroupData","rgroups","rxnArrows","rxnPluses","chiralFlags"];e.prototype.tool=function(t,e){if(arguments.length>0){this._tool&&this._tool.cancel&&this._tool.cancel();var r=w.default[t](this,e);if(!r)return null;this._tool=r}return this._tool},e.prototype.struct=function(t){return arguments.length>0&&(this.selection(null),this.update((0,y.fromNewCanvas)(this.render.ctab,t||new m.default)),n(this,a(this.render.ctab))),this.render.ctab.molecule},e.prototype.options=function(t){if(arguments.length>0){var e=this.render.ctab.molecule,r=this.render.options.zoom;this.render.clientArea.innerHTML="",this.render=new v.default(this.render.clientArea,Object.assign({scale:S},t)),this.render.setMolecule(e),this.render.setZoom(r),this.render.update()}return this.render.options},e.prototype.zoom=function(t){return arguments.length>0&&(this.render.setZoom(t),n(this,a(this.render.ctab,this.selection())),this.render.update()),this.render.options.zoom},e.prototype.selection=function(e){var r=this.render.ctab;if(arguments.length>0){if(this._selection=null,"all"===e&&(e=O.reduce(function(t,e){return t[e]=Array.from(r[e].keys()),t},{})),"descriptors"===e&&(r=this.render.ctab,e={sgroupData:Array.from(r.sgroupData.keys())}),e){var n={};Object.keys(e).forEach(function(t){e[t].length>0&&(n[t]=e[t].slice())}),0!==Object.keys(n).length&&(this._selection=n)}this.render.ctab.setSelection(this._selection),this.event.selectionChange.dispatch(this._selection),this.render.update()}return this._selection},e.prototype.hover=function(t,e){var r=e||this._tool;"ci"in r&&(!t||r.ci.map!==t.map||r.ci.id!==t.id)&&(this.highlight(r.ci,!1),delete r.ci),t&&this.highlight(t,!0)&&(r.ci=t)};var A=["atoms","bonds","rxnArrows","rxnPluses","chiralFlags","frags","merge","rgroups","sgroups","sgroupData"];e.prototype.highlight=function(t,r){if(-1===A.indexOf(t.map))return!1;var n=this.render,o=null;if("merge"===t.map)return Object.keys(t.items).forEach(function(e){t.items[e].forEach(function(t){(o=n.ctab[e].get(t))&&o.setHighlight(r,n)})}),!0;if(!(o=n.ctab[t.map].get(t.id)))return!0;if("sgroups"===t.map&&"DAT"===o.item.type||"sgroupData"===t.map){var e=n.ctab.sgroups.get(t.id),i=n.ctab.sgroupData.get(t.id);e&&e.setHighlight(r,n),i&&i.setHighlight(r,n)}else o.setHighlight(r,n);return!0},e.prototype.update=function(t,e){!0===t?this.render.update(!0):(e||t.isDummy()||(this.historyStack.splice(this.historyPtr,33,t),this.historyStack.length>32&&this.historyStack.shift(),this.historyPtr=this.historyStack.length,this.event.change.dispatch(t)),this.render.update())},e.prototype.historySize=function(){return{undo:this.historyPtr,redo:this.historyStack.length-this.historyPtr}},e.prototype.undo=function(){if(0===this.historyPtr)throw new Error("Undo stack is empty");if(this.tool()&&this.tool().cancel&&this.tool().cancel(),this.selection(null),this._tool instanceof w.default.paste)return void this.event.change.dispatch();this.historyPtr--;var t=this.historyStack[this.historyPtr].perform(this.render.ctab);this.historyStack[this.historyPtr]=t,this.event.change.dispatch(t),this.render.update()},e.prototype.redo=function(){if(this.historyPtr===this.historyStack.length)throw new Error("Redo stack is empty");if(this.tool()&&this.tool().cancel&&this.tool().cancel(),this.selection(null),this._tool instanceof w.default.paste)return void this.event.change.dispatch();var t=this.historyStack[this.historyPtr].perform(this.render.ctab);this.historyStack[this.historyPtr]=t,this.historyPtr++,this.event.change.dispatch(t),this.render.update()},e.prototype.on=function(t,e){this.event[t].add(e)},e.prototype.findItem=function(t,e,r){var n=o._ui_editor?new f.default(this.render.page2obj(t)):new f.default(t.pageX,t.pageY).sub(s(this.render.clientArea));return _.default.item(this.render.ctab,n,e,r,this.render.options)},e.prototype.findMerge=function(t,e){return _.default.merge(this.render.ctab,t,e,this.render.options)},e.prototype.explicitSelected=function(){var r=this.selection()||{},n=O.reduce(function(t,e){return t[e]=r[e]?r[e].slice():[],t},{}),o=this.render.ctab.molecule;return n.bonds&&n.bonds.forEach(function(t){var e=o.bonds.get(t);n.atoms=n.atoms||[],n.atoms.indexOf(e.begin)<0&&n.atoms.push(e.begin),n.atoms.indexOf(e.end)<0&&n.atoms.push(e.end)}),n.atoms&&n.bonds&&o.bonds.forEach(function(t,e){!n.bonds.indexOf(e)<0&&n.atoms.indexOf(t.begin)>=0&&n.atoms.indexOf(t.end)>=0&&(n.bonds=n.bonds||[],n.bonds.push(e))}),n},e.prototype.structSelected=function(){var t=this.render.ctab.molecule,r=this.explicitSelected(),n=t.clone(new p.default(r.atoms),new p.default(r.bonds),!0);return t.rxnArrows.forEach(function(t,e){-1!==r.rxnArrows.indexOf(e)&&n.rxnArrows.add(t.clone())}),t.rxnPluses.forEach(function(t,e){-1!==r.rxnPluses.indexOf(e)&&n.rxnPluses.add(t.clone())}),n.isChiral=t.isChiral,n.isReaction=t.isReaction&&(n.rxnArrows.size||n.rxnPluses.size),n},e.prototype.alignDescriptors=function(){this.selection(null);var t=(0,y.fromDescriptorsAlign)(this.render.ctab);this.update(t),this.render.update(!0)},j.default=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../chem/struct":537,"../render":586,"../util/pile":683,"../util/vec2":686,"./actions/basic":543,"./shared/closest":558,"./tool":572,subscription:510}],557:[function(t,e,r){"use strict";function n(){this.operations=[]}Object.defineProperty(r,"__esModule",{value:!0}),n.prototype.addOp=function(t,e){return e&&t.isDummy(e)||this.operations.push(t),t},n.prototype.mergeWith=function(t){return this.operations=this.operations.concat(t.operations),this},n.prototype.perform=function(e){var r=new n;return this.operations.forEach(function(t){r.addOp(t.perform(e))}),r.operations.reverse(),r},n.prototype.isDummy=function(e){return void 0===this.operations.find(function(t){return!e||!t.isDummy(e)})},r.default=n},{}],558:[function(t,e,r){"use strict";function l(t,n,e,o){var i=null,r=g,a=e&&"atoms"===e.map?e.id:null;return o=o||r,o=Math.min(o,r),t.atoms.forEach(function(t,e){if(e!==a){var r=m.default.dist(n,t.a.pp);r<o&&(i=e,o=r)}}),null!==i?{id:i,dist:o}:null}function c(u,l,t,c,e){var f=null,a=null,r=.8*g,d=t&&"bonds"===t.map?t.id:null;c=c||r,c=Math.min(c,r);var s=c;return u.bonds.forEach(function(t,e){if(e!==d){var r=u.atoms.get(t.b.begin).a.pp,n=u.atoms.get(t.b.end).a.pp,o=m.default.lc2(r,.5,n,.5),i=m.default.dist(l,o);i<s&&(s=i,a=e)}}),u.bonds.forEach(function(t,e){if(e!==d){var r=u.molecule.halfBonds.get(t.b.hb1),n=r.dir,o=r.norm,i=u.atoms.get(t.b.begin).a.pp,a=u.atoms.get(t.b.end).a.pp;if(m.default.dot(l.sub(i),n)*m.default.dot(l.sub(a),n)<0){var s=Math.abs(m.default.dot(l.sub(i),o));s<c&&(f=e,c=s)}}}),null!==a?{id:a,dist:s}:null!==f&&c>g*e?{id:f,dist:c}:null}function n(t,o){var i,a=null;return t.chiralFlags.forEach(function(t,e){var r=t.pp;if(!(Math.abs(o.x-r.x)>=1)){var n=Math.abs(o.y-r.y);n<.3&&(!a||n<i)&&(i=n,a={id:e,dist:i})}}),a}function o(t,i){var a=null,s=null;return t.sgroupData.forEach(function(t,e){if("DAT"!==t.sgroup.type)throw new Error("Data group expected");if("MRV_IMPLICIT_H"!==t.sgroup.data.fieldName){var r=t.sgroup.dataArea,n=r.p0.y<i.y&&r.p1.y>i.y&&r.p0.x<i.x&&r.p1.x>i.x,o=Math.min(Math.abs(r.p0.x-i.x),Math.abs(r.p1.x-i.x));n&&(null===s||o<a)&&(s={id:e,dist:o},a=o)}}),s}function i(t,e,r,n,o){n=Math.min(n||g,g);var i=t.molecule,a=l(t,e,r,n);if(a)return{id:i.atoms.get(a.id).fragment,dist:a.dist};var s=c(t,e,r,n,o);if(s){var u=i.bonds.get(s.id).begin;return{id:i.atoms.get(u).fragment,dist:s.dist}}return null}function a(t,n,o,i){i=Math.min(i||g,g);var a=null;return t.rgroups.forEach(function(t,e){if(e!==o&&t.labelBox&&t.labelBox.contains(n,.5)){var r=m.default.dist(t.labelBox.centre(),n);(!a||r<i)&&(i=r,a={id:e,dist:i})}}),a}function s(t,o){var i=null,a=null;return t.rxnArrows.forEach(function(t,e){var r=t.item.pp;if(!(Math.abs(o.x-r.x)>=1)){var n=Math.abs(o.y-r.y);n<.3&&(!a||n<i)&&(i=n,a={id:e,dist:i})}}),a}function u(t,o){var i=null,a=null;return t.rxnPluses.forEach(function(t,e){var r=t.item.pp,n=Math.max(Math.abs(o.x-r.x),Math.abs(o.y-r.y));n<.3&&(!a||n<i)&&(i=n,a={id:e,dist:i})}),a}function f(t,i){var a=null,s=g;return t.molecule.sgroups.forEach(function(t,n){var e=t.bracketDir,r=e.rotateSC(1,0),o=new m.default(m.default.dot(i,e),m.default.dot(i,r));t.areas.forEach(function(t){var e=t.p0.y<o.y&&t.p1.y>o.y&&t.p0.x<o.x&&t.p1.x>o.x,r=Math.min(Math.abs(t.p0.x-o.x),Math.abs(t.p1.x-o.x));e&&(null===a||r<s)&&(a=n,s=r)})}),null!==a?{id:a,dist:s}:null}function d(o,i,t,a,s){return t=t||Object.keys(v),t.reduce(function(t,e){var r=t?t.dist:null,n=v[e](o,i,a,r,s);return null!==n&&(null===t||n.dist<t.dist)?{map:e,id:n.id,dist:n.dist}:t},null)}function p(i,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["atoms","bonds"],s=arguments[3],u={atoms:new Map,bonds:new Map},r=i.molecule;a.atoms.forEach(function(t){u.atoms.set(t,r.atoms.get(t).pp)}),a.bonds.forEach(function(t){var e=r.bonds.get(t);u.bonds.set(t,m.default.lc2(r.atoms.get(e.begin).pp,.5,r.atoms.get(e.end).pp,.5))});var e={};return t.forEach(function(o){e[o]=Array.from(u[o].keys()).reduce(function(t,e){var r={map:o,id:e},n=v[o](i,u[o].get(e),r,null,s);return n&&!a[o].includes(n.id)&&t.set(e,n.id),t},new Map)}),e}Object.defineProperty(r,"__esModule",{value:!0});var h=t("../../util/vec2"),m=function(t){return t&&t.__esModule?t:{default:t}}(h),g=.4,v={atoms:l,bonds:c,chiralFlags:n,sgroupData:o,sgroups:f,rxnArrows:s,rxnPluses:u,frags:i,rgroups:a};r.default={atom:l,item:d,merge:p}},{"../../util/vec2":686}],559:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.SgContexts={Fragment:"Fragment",Multifragment:"Multifragment",Bond:"Bond",Atom:"Atom",Group:"Group"}},{}],560:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function o(){this.type="OpBase",this.execute=function(){throw new Error("Operation.execute() is not implemented")},this.invert=function(){throw new Error("Operation.invert() is not implemented")},this.perform=function(t){return this.execute(t),this._inverted||(this._inverted=this.invert(),this._inverted._inverted=this),this._inverted},this.isDummy=function(t){return!!this._isDummy&&this._isDummy(t)}}function a(t,e){this.data={atom:t,pos:e,aid:null},this.execute=function(t){var e=this,r=t.molecule,n={};this.data.atom&&Object.keys(this.data.atom).forEach(function(t){n[t]=e.data.atom[t]}),n.label=n.label||"C","number"!=typeof this.data.aid?this.data.aid=r.atoms.add(new Z.Atom(n)):r.atoms.set(this.data.aid,new Z.Atom(n));var o=new Q.ReAtom(r.atoms.get(this.data.aid));o.component=t.connectedComponents.add(new X.default([this.data.aid])),t.atoms.set(this.data.aid,o),t.markAtom(this.data.aid,1),r.atomSetPos(this.data.aid,new q.default(this.data.pos));var i=r.rxnArrows.get(0);if(i){r.atoms.get(this.data.aid).rxnFragmentType=r.defineRxnFragmentTypeForAtomset(new X.default([this.data.aid]),i.pp.x)}},this.invert=function(){var t=new s;return t.data=this.data,t}}function s(t){this.data={aid:t,atom:null,pos:null},this.execute=function(t){var e=t.molecule;this.data.atom||(this.data.atom=e.atoms.get(this.data.aid),this.data.pos=this.data.atom.pp);var r=t.atoms.get(this.data.aid),n=t.connectedComponents.get(r.component);n.delete(this.data.aid),0===n.size&&t.connectedComponents.delete(r.component),t.clearVisel(r.visel),t.atoms.delete(this.data.aid),t.markItemRemoved(),e.atoms.delete(this.data.aid)},this.invert=function(){var t=new a;return t.data=this.data,t}}function u(t,e,r){this.data={aid:t,attribute:e,value:r},this.data2=null,this.execute=function(t){var e=t.molecule.atoms.get(this.data.aid);this.data2||(this.data2={aid:this.data.aid,attribute:this.data.attribute,value:e[this.data.attribute]}),e[this.data.attribute]=this.data.value,z(t,this.data.aid)},this._isDummy=function(t){return t.molecule.atoms.get(this.data.aid)[this.data.attribute]===this.data.value},this.invert=function(){var t=new u;return t.data=this.data2,t.data2=this.data,t}}function l(t,e,r){this.data={aid:t,d:e,noinvalidate:r},this.execute=function(t){var e=t.molecule,r=this.data.aid,n=this.data.d;e.atoms.get(r).pp.add_(n),t.atoms.get(r).visel.translate(K.default.obj2scaled(n,t.render.options)),this.data.d=n.negated(),this.data.noinvalidate||z(t,r,1)},this._isDummy=function(){return 0===this.data.d.x&&0===this.data.d.y},this.invert=function(){var t=new l;return t.data=this.data,t}}function c(t,e){this.data={bid:t,d:e},this.execute=function(t){t.bonds.get(this.data.bid).visel.translate(K.default.obj2scaled(this.data.d,t.render.options)),this.data.d=this.data.d.negated()},this.invert=function(){var t=new c;return t.data=this.data,t}}function f(t,e){this.data={id:t,d:e},this.execute=function(t){t.reloops.get(this.data.id)&&t.reloops.get(this.data.id).visel&&t.reloops.get(this.data.id).visel.translate(K.default.obj2scaled(this.data.d,t.render.options)),this.data.d=this.data.d.negated()},this.invert=function(){var t=new f;return t.data=this.data,t}}function d(t,e){this.type="OpSGroupAtomAdd",this.data={sgid:t,aid:e},this.execute=function(t){var e=t.molecule,r=this.data.aid,n=this.data.sgid,o=e.atoms.get(r);if(e.sgroups.get(n).atoms.indexOf(r)>=0)throw new Error("The same atom cannot be added to an S-group more than once");if(!o)throw new Error("OpSGroupAtomAdd: Atom "+r+" not found");e.atomAddToSGroup(n,r),z(t,r)},this.invert=function(){var t=new p;return t.data=this.data,t}}function p(t,e){this.type="OpSGroupAtomRemove",this.data={sgid:t,aid:e},this.execute=function(t){var e=this.data.aid,r=this.data.sgid,n=t.molecule,o=n.atoms.get(e),i=n.sgroups.get(r);Z.SGroup.removeAtom(i,e),o.sgs.delete(r),z(t,e)},this.invert=function(){var t=new d;return t.data=this.data,t}}function h(t,e,r){this.type="OpSGroupAttr",this.data={sgid:t,attr:e,value:r},this.execute=function(t){var e=t.molecule,r=this.data.sgid,n=e.sgroups.get(r);"DAT"===n.type&&t.sgroupData.has(r)&&(t.clearVisel(t.sgroupData.get(r).visel),t.sgroupData.delete(r)),this.data.value=n.setAttr(this.data.attr,this.data.value)},this.invert=function(){var t=new h;return t.data=this.data,t}}function m(t,e,r){this.type="OpSGroupCreate",this.data={sgid:t,type:e,pp:r},this.execute=function(t){var e=t.molecule,r=new Z.SGroup(this.data.type),n=this.data.sgid;r.id=n,e.sgroups.set(n,r),this.data.pp&&(e.sgroups.get(n).pp=new q.default(this.data.pp)),t.sgroups.set(n,new Q.ReSGroup(e.sgroups.get(n))),this.data.sgid=n},this.invert=function(){var t=new g;return t.data=this.data,t}}function g(t){this.type="OpSGroupDelete",this.data={sgid:t},this.execute=function(t){var e=t.molecule,r=this.data.sgid,n=t.sgroups.get(r);if(this.data.type=n.item.type,this.data.pp=n.item.pp,"DAT"===n.item.type&&t.sgroupData.has(r)&&(t.clearVisel(t.sgroupData.get(r).visel),t.sgroupData.delete(r)),t.clearVisel(n.visel),0!==n.item.atoms.length)throw new Error("S-Group not empty!");t.sgroups.delete(r),e.sgroups.delete(r)},this.invert=function(){var t=new m;return t.data=this.data,t}}function v(t,o,i){this.type="OpSGroupAddToHierarchy",this.data={sgid:t,parent:o,children:i},this.execute=function(t){var e=t.molecule,r=this.data.sgid,n=e.sGroupForest.insert(r,o,i);this.data.parent=n.parent,this.data.children=n.children},this.invert=function(){var t=new y;return t.data=this.data,t}}function y(t){this.type="OpSGroupRemoveFromHierarchy",this.data={sgid:t},this.execute=function(t){var e=t.molecule,r=this.data.sgid;this.data.parent=e.sGroupForest.parent.get(r),this.data.children=e.sGroupForest.children.get(r),e.sGroupForest.remove(r)},this.invert=function(){var t=new v;return t.data=this.data,t}}function b(t,e,r){this.data={bond:r,begin:t,end:e,bid:null},this.execute=function(t){var e=this,r=t.molecule;if(this.data.begin===this.data.end)throw new Error("Distinct atoms expected");if(J.debug&&this.molecule.checkBondExists(this.data.begin,this.data.end))throw new Error("Bond already exists");z(t,this.data.begin,1),z(t,this.data.end,1);var n={};this.data.bond&&Object.keys(this.data.bond).forEach(function(t){n[t]=e.data.bond[t]}),n.type=n.type||Z.Bond.PATTERN.TYPE.SINGLE,n.begin=this.data.begin,n.end=this.data.end,"number"!=typeof this.data.bid?this.data.bid=r.bonds.add(new Z.Bond(n)):r.bonds.set(this.data.bid,new Z.Bond(n)),r.bondInitHalfBonds(this.data.bid),r.atomAddNeighbor(r.bonds.get(this.data.bid).hb1),r.atomAddNeighbor(r.bonds.get(this.data.bid).hb2),t.bonds.set(this.data.bid,new Q.ReBond(r.bonds.get(this.data.bid))),t.markBond(this.data.bid,1)},this.invert=function(){var t=new _;return t.data=this.data,t}}function _(t){this.data={bid:t,bond:null,begin:null,end:null},this.execute=function(r){var a=r.molecule;this.data.bond||(this.data.bond=a.bonds.get(this.data.bid),this.data.begin=this.data.bond.begin,this.data.end=this.data.bond.end),W(r,this.data.bid);var t=r.bonds.get(this.data.bid);[t.b.hb1,t.b.hb2].forEach(function(t){var e=r.molecule.halfBonds.get(t);e.loop>=0&&r.loopRemove(e.loop)},r),r.clearVisel(t.visel),r.bonds.delete(this.data.bid),r.markItemRemoved();var e=a.bonds.get(this.data.bid);[e.hb1,e.hb2].forEach(function(t){var e=a.halfBonds.get(t),r=a.atoms.get(e.begin),n=r.neighbors.indexOf(t),o=(n+r.neighbors.length-1)%r.neighbors.length,i=(n+1)%r.neighbors.length;a.setHbNext(r.neighbors[o],r.neighbors[i]),r.neighbors.splice(n,1)}),a.halfBonds.delete(e.hb1),a.halfBonds.delete(e.hb2),a.bonds.delete(this.data.bid)},this.invert=function(){var t=new b;return t.data=this.data,t}}function x(t,e,r){this.data={bid:t,attribute:e,value:r},this.data2=null,this.execute=function(t){var e=t.molecule.bonds.get(this.data.bid);this.data2||(this.data2={bid:this.data.bid,attribute:this.data.attribute,value:e[this.data.attribute]}),e[this.data.attribute]=this.data.value,W(t,this.data.bid),"type"===this.data.attribute&&H(t,this.data.bid)},this._isDummy=function(t){return t.molecule.bonds.get(this.data.bid)[this.data.attribute]===this.data.value},this.invert=function(){var t=new x;return t.data=this.data2,t.data2=this.data,t}}function w(t){this.frid=void 0===t?null:t,this.execute=function(t){var e=t.molecule,r={};null===this.frid?this.frid=e.frags.add(r):e.frags.set(this.frid,r),t.frags.set(this.frid,new Q.ReFrag(r))},this.invert=function(){return new S(this.frid)}}function S(t){this.frid=t,this.execute=function(t){var e=t.molecule;U(t,"frags",this.frid,1),t.frags.delete(this.frid),e.frags.delete(this.frid)},this.invert=function(){return new w(this.frid)}}function O(t,e,r){this.data={rgid:t,attribute:e,value:r},this.data2=null,this.execute=function(t){var e=t.molecule.rgroups.get(this.data.rgid);this.data2||(this.data2={rgid:this.data.rgid,attribute:this.data.attribute,value:e[this.data.attribute]}),e[this.data.attribute]=this.data.value,U(t,"rgroups",this.data.rgid)},this._isDummy=function(t){return t.molecule.rgroups.get(this.data.rgid)[this.data.attribute]===this.data.value},this.invert=function(){var t=new O;return t.data=this.data2,t.data2=this.data,t}}function A(t,e,r){this.type="OpAddOrDeleteRGFragment",this.rgid_new=t,this.rg_new=r,this.rgid_old=null,this.rg_old=null,this.frid=e,this.execute=function(t){var e=t.molecule;if(this.rgid_old=this.rgid_old||Z.RGroup.findRGroupByFragment(e.rgroups,this.frid),this.rg_old=this.rgid_old?e.rgroups.get(this.rgid_old):null,this.rg_old&&(this.rg_old.frags.delete(this.frid),t.clearVisel(t.rgroups.get(this.rgid_old).visel),0===this.rg_old.frags.size?(t.rgroups.delete(this.rgid_old),e.rgroups.delete(this.rgid_old),t.markItemRemoved()):t.markItem("rgroups",this.rgid_old,1)),this.rgid_new){var r=e.rgroups.get(this.rgid_new);r?t.markItem("rgroups",this.rgid_new,1):(r=this.rg_new||new Z.RGroup,e.rgroups.set(this.rgid_new,r),t.rgroups.set(this.rgid_new,new Q.ReRGroup(r))),r.frags.add(this.frid)}},this.invert=function(){return new A(this.rgid_old,this.frid,this.rg_old)}}function E(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.type="OpUpdateIfThenValues",this.rgid_new=t,this.rgid_old=e,this.ifThenHistory=new Map,this.execute=function(t){var r=this,n=t.molecule;n.rgroups.forEach(function(t,e){t.ifthen!==r.rgid_old||o.includes(e)||(t.ifthen=r.rgid_new,r.ifThenHistory.set(e,r.rgid_old),n.rgroups.set(e,t))})},this.invert=function(){return new j(this.rgid_new,this.rgid_old,this.ifThenHistory)}}function j(t,e,r){this.type="OpRestoreIfThenValues",this.rgid_new=t,this.rgid_old=e,this.ifThenHistory=r||new Map,this.execute=function(t){var n=t.molecule;this.ifThenHistory.forEach(function(t,e){var r=n.rgroups.get(e);r.ifthen=t,n.rgroups.set(e,r)})},this.invert=function(){return new E(this.rgid_old,this.rgid_new)}}function P(t){this.data={pos:t,arid:null},this.execute=function(t){var e=t.molecule;"number"!=typeof this.data.arid?this.data.arid=e.rxnArrows.add(new Z.RxnArrow):e.rxnArrows.set(this.data.arid,new Z.RxnArrow),t.rxnArrows.set(this.data.arid,new Q.ReRxnArrow(e.rxnArrows.get(this.data.arid))),e.rxnArrowSetPos(this.data.arid,new q.default(this.data.pos));var r=e.getComponents(),n=r.reactants,o=r.products;n=n.reduce(function(t,e){return t.concat.apply(t,i(e))},[]),o=o.reduce(function(t,e){return t.concat.apply(t,i(e))},[]),n.forEach(function(t){e.atoms.get(t).rxnFragmentType=1}),o.forEach(function(t){e.atoms.get(t).rxnFragmentType=2}),U(t,"rxnArrows",this.data.arid,1)},this.invert=function(){var t=new T;return t.data=this.data,t}}function T(t){this.data={arid:t,pos:null},this.execute=function(t){var e=t.molecule;this.data.pos||(this.data.pos=e.rxnArrows.get(this.data.arid).pp),t.markItemRemoved(),t.clearVisel(t.rxnArrows.get(this.data.arid).visel),t.rxnArrows.delete(this.data.arid),e.rxnArrows.delete(this.data.arid),e.atoms.forEach(function(t){t.rxnFragmentType=-1})},this.invert=function(){var t=new P;return t.data=this.data,t}}function C(t,e,r){this.data={id:t,d:e,noinvalidate:r},this.execute=function(t){var e=t.molecule,r=this.data.id,n=this.data.d;e.rxnArrows.get(r).pp.add_(n),t.rxnArrows.get(r).visel.translate(K.default.obj2scaled(n,t.render.options)),this.data.d=n.negated(),this.data.noinvalidate||U(t,"rxnArrows",r,1)},this.invert=function(){var t=new C;return t.data=this.data,t}}function k(t){this.data={plid:null,pos:t},this.execute=function(t){var e=t.molecule;"number"!=typeof this.data.plid?this.data.plid=e.rxnPluses.add(new Z.RxnPlus):e.rxnPluses.set(this.data.plid,new Z.RxnPlus),t.rxnPluses.set(this.data.plid,new Q.ReRxnPlus(e.rxnPluses.get(this.data.plid))),e.rxnPlusSetPos(this.data.plid,new q.default(this.data.pos)),U(t,"rxnPluses",this.data.plid,1)},this.invert=function(){var t=new M;return t.data=this.data,t}}function M(t){this.data={plid:t,pos:null},this.execute=function(t){var e=t.molecule;this.data.pos||(this.data.pos=e.rxnPluses.get(this.data.plid).pp),t.markItemRemoved(),t.clearVisel(t.rxnPluses.get(this.data.plid).visel),t.rxnPluses.delete(this.data.plid),e.rxnPluses.delete(this.data.plid)},this.invert=function(){var t=new k;return t.data=this.data,t}}function R(t,e,r){this.data={id:t,d:e,noinvalidate:r},this.execute=function(t){var e=t.molecule,r=this.data.id,n=this.data.d;e.rxnPluses.get(r).pp.add_(n),t.rxnPluses.get(r).visel.translate(K.default.obj2scaled(n,t.render.options)),this.data.d=n.negated(),this.data.noinvalidate||U(t,"rxnPluses",r,1)},this.invert=function(){var t=new R;return t.data=this.data,t}}function N(t,e){this.data={id:t,d:e},this.execute=function(t){t.molecule.sgroups.get(this.data.id).pp.add_(this.data.d),this.data.d=this.data.d.negated(),U(t,"sgroupData",this.data.id,1)},this.invert=function(){var t=new N;return t.data=this.data,t}}function B(t){this.data={struct:t},this.execute=function(t){var e=t.molecule;t.clearVisels(),t.render.setMolecule(this.data.struct),this.data.struct=e},this.invert=function(){var t=new B;return t.data=this.data,t}}function I(r){this.data={pos:r},this.execute=function(t){var e=t.molecule;t.chiralFlags.size>0&&(t.clearVisel(t.chiralFlags.get(0).visel),t.chiralFlags.delete(0)),t.chiralFlags.set(0,new Q.ReChiralFlag(r)),e.isChiral=!0,U(t,"chiralFlags",0,1)},this.invert=function(){var t=new L;return t.data=this.data,t}}function L(){this.data={pos:null},this.execute=function(t){var e=t.molecule;if(t.chiralFlags.size<1)throw new Error("Cannot remove chiral flag");t.clearVisel(t.chiralFlags.get(0).visel),this.data.pos=t.chiralFlags.get(0).pp,t.chiralFlags.delete(0),e.isChiral=!1},this.invert=function(){var t=new I(this.data.pos);return t.data=this.data,t}}function D(t){this.data={d:t},this.execute=function(t){t.chiralFlags.get(0).pp.add_(this.data.d),this.data.d=this.data.d.negated(),U(t,"chiralFlags",0,1)},this.invert=function(){var t=new D;return t.data=this.data,t}}function F(){this.type="OpAlignDescriptors",this.history={},this.execute=function(e){var r=this,t=Array.from(e.molecule.sgroups.values()).reverse(),n=e.molecule.getCoordBoundingBoxObj(),o=new q.default(n.max.x,n.min.y).add(new q.default(2,-1));t.forEach(function(t){r.history[t.id]=new q.default(t.pp),o=o.add(new q.default(0,.5)),t.pp=o,e.molecule.sgroups.set(t.id,t),U(e,"sgroupData",t.id,1)})},this.invert=function(){return new G(this.history)}}function G(t){this.type="OpRestoreDescriptorsPosition",this.history=t,this.execute=function(e){var r=this;Array.from(e.molecule.sgroups.values()).forEach(function(t){t.pp=r.history[t.id],e.molecule.sgroups.set(t.id,t),U(e,"sgroupData",t.id,1)})},this.invert=function(){return new F}}function z(r,t,n){var e=r.atoms.get(t);r.markAtom(t,n?1:0);var o=r.molecule.halfBonds;e.a.neighbors.forEach(function(t){if(o.has(t)){var e=o.get(t);r.markBond(e.bid,1),r.markAtom(e.end,0),n&&H(r,e.bid)}})}function H(t,e){var r=t.bonds.get(e),n=t.molecule.halfBonds.get(r.b.hb1).loop,o=t.molecule.halfBonds.get(r.b.hb2).loop;n>=0&&t.loopRemove(n),o>=0&&t.loopRemove(o)}function W(t,e){var r=t.bonds.get(e);H(t,e),z(t,r.b.begin,0),z(t,r.b.end,0)}function U(t,e,r,n){"atoms"===e?z(t,r,n):"bonds"===e?(W(t,r),n>0&&H(t,r)):t.markItem(e,r,n)}Object.defineProperty(r,"__esModule",{value:!0});var V=t("../../util/vec2"),q=n(V),Y=t("../../util/scale"),K=n(Y),$=t("../../util/pile"),X=n($),Z=t("../../chem/struct"),Q=t("../../render/restruct"),J={debug:!1,logcnt:0,logmouse:!1,hl:!1};J.logMethod=function(){},a.prototype=new o,s.prototype=new o,u.prototype=new o,l.prototype=new o,c.prototype=new o,f.prototype=new o,d.prototype=new o,p.prototype=new o,h.prototype=new o,m.prototype=new o,g.prototype=new o,v.prototype=new o,y.prototype=new o,b.prototype=new o,_.prototype=new o,x.prototype=new o,w.prototype=new o,S.prototype=new o,O.prototype=new o,A.prototype=new o,E.prototype=new o,j.prototype=new o,P.prototype=new o,T.prototype=new o,C.prototype=new o,k.prototype=new o,M.prototype=new o,R.prototype=new o,N.prototype=new o,B.prototype=new o,I.prototype=new o,L.prototype=new o,D.prototype=new o,F.prototype=new o,G.prototype=new o,r.default={AtomAdd:a,AtomDelete:s,AtomAttr:u,AtomMove:l,BondMove:c,LoopMove:f,SGroupAtomAdd:d,SGroupAtomRemove:p,SGroupAttr:h,SGroupCreate:m,SGroupDelete:g,SGroupAddToHierarchy:v,SGroupRemoveFromHierarchy:y,BondAdd:b,BondDelete:_,BondAttr:x,FragmentAdd:w,FragmentDelete:S,RGroupAttr:O,RGroupFragment:A,RxnArrowAdd:P,RxnArrowDelete:T,RxnArrowMove:C,RxnPlusAdd:k,RxnPlusDelete:M,RxnPlusMove:R,SGroupDataMove:N,CanvasLoad:B,ChiralFlagAdd:I,ChiralFlagDelete:L,ChiralFlagMove:D,UpdateIfThen:E,AlignDescriptors:F}},{"../../chem/struct":537,"../../render/restruct":588,"../../util/pile":683,"../../util/scale":685,"../../util/vec2":686}],561:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){c=Math.PI/180*t}function f(t,e){var r=h.default.diff(e,t);return Math.atan2(r.y,r.x)}function i(t,e){return e&&(t=f(t,e)),Math.round(t/c)*c}function a(t,e,r){var n=new h.default(1,0).rotate(r?f(t,e):i(t,e));return n.add_(t),n}function d(t){var e=Math.round(t/Math.PI*180);return e>180?e-=360:e<=-180&&(e+=360),e}function s(t,e,r,n){var o=t.atoms.get(e.begin),i=r.atoms.get(n.begin),a=t.atoms.get(e.end),s=r.atoms.get(n.end),u=f(o.pp,a.pp)-f(i.pp,s.pp),l=Math.abs(d(u)%180),c=h.default.dist(o.pp,a.pp)/h.default.dist(i.pp,s.pp);return{merged:!(0,p.default)(l,m,180-m)&&(0,p.default)(c,1-g,1+g),angle:u,scale:c,cross:Math.abs(d(u))>90}}Object.defineProperty(r,"__esModule",{value:!0});var u=t("lodash/inRange"),p=n(u),l=t("../../util/vec2"),h=n(l),c=Math.PI/12,m=10,g=.2;r.default={calcAngle:f,fracAngle:i,calcNewAtomPos:a,degrees:d,setFracAngle:o,mergeBondsParams:s}},{"../../util/vec2":686,"lodash/inRange":442}],562:[function(t,e,r){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.editor=t,this.editor.selection(null)}Object.defineProperty(r,"__esModule",{value:!0});var a=t("../actions/atom");n.prototype.mousemove=function(t){this.editor.hover(this.editor.findItem(t,["atoms"]))},n.prototype.click=function(t){var r=this.editor,e=r.render.ctab.molecule,n=r.findItem(t,["atoms"]);if(n&&"atoms"===n.map){this.editor.hover(null);var o=e.atoms.get(n.id),i=r.event.elementEdit.dispatch({attpnt:o.attpnt});return Promise.resolve(i).then(function(t){if(o.attpnt!==t.attpnt){var e=(0,a.fromAtomsAttrs)(r.render.ctab,n.id,t);r.update(e)}}).catch(function(){return null}),!0}return!0},r.default=n},{"../actions/atom":542}],563:[function(t,e,r){"use strict";function n(t,e){if(!(this instanceof n)){if(!t.selection()||!t.selection().atoms)return new n(t,e);var r=(0,l.fromAtomsAttrs)(t.render.ctab,t.selection().atoms,e,!0);return t.update(r),t.selection(null),null}this.editor=t,this.atomProps=e,this.bondProps={type:1,stereo:s.Bond.PATTERN.STEREO.NONE}}function o(e,r){var n=e.dragCtx,o=e.editor,i=n.item&&n.item.id,a=void 0!==i&&null!==i?r.ctab.molecule.atoms.get(i):new s.Atom({label:""});n.timeout=setTimeout(function(){delete e.dragCtx,o.selection(null);var t=o.event.quickEdit.dispatch(a);Promise.resolve(t).then(function(t){var e=i?(0,l.fromAtomsAttrs)(r.ctab,i,t):(0,l.fromAtomAddition)(r.ctab,n.xy0,t);o.update(e)}).catch(function(){return null})},750),n.stopTapping=function(){n.timeout&&(clearTimeout(n.timeout),delete e.dragCtx.timeout)}}Object.defineProperty(r,"__esModule",{value:!0}),r.atomLongtapEvent=o;var s=t("../../chem/struct"),i=t("../shared/utils"),u=function(t){return t&&t.__esModule?t:{default:t}}(i),l=t("../actions/atom"),c=t("../actions/bond");n.prototype.mousedown=function(t){this.editor.hover(null),this.editor.selection(null);var e=this.editor.findItem(t,["atoms"]);e?"atoms"===e.map&&(this.dragCtx={item:e}):this.dragCtx={}},n.prototype.mousemove=function(t){var e=this.editor.render;if(!this.dragCtx||!this.dragCtx.item)return void this.editor.hover(this.editor.findItem(t,["atoms"]));var r=this.dragCtx,n=this.editor.findItem(t,["atoms"]);if(n&&"atoms"===n.map&&n.id===r.item.id)return void this.editor.hover(this.editor.findItem(t,["atoms"]));var o=e.ctab.molecule.atoms.get(r.item.id),i=u.default.calcAngle(o.pp,e.page2obj(t));t.ctrlKey||(i=u.default.fracAngle(i));var a=u.default.degrees(i);this.editor.event.message.dispatch({info:a+"º"});var s=u.default.calcNewAtomPos(o.pp,e.page2obj(t),t.ctrlKey);r.action&&r.action.perform(e.ctab),r.action=(0,c.fromBondAddition)(e.ctab,this.bondProps,r.item.id,Object.assign({},this.atomProps),s,s)[0],this.editor.update(r.action,!0)},n.prototype.mouseup=function(t){if(this.dragCtx){var e=this.dragCtx,r=this.editor.render;this.editor.update(e.action||(e.item?(0,l.fromAtomsAttrs)(r.ctab,e.item.id,this.atomProps,!0):(0,l.fromAtomAddition)(r.ctab,r.page2obj(t),this.atomProps))),delete this.dragCtx}this.editor.event.message.dispatch({info:!1})},r.default=n},{"../../chem/struct":537,"../actions/atom":542,"../actions/bond":544,"../shared/utils":561}],564:[function(t,e,r){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.attach=e||{atomid:0,bondid:0},this.editor=t,this.editor.selection({atoms:[this.attach.atomid],bonds:[this.attach.bondid]})}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../../chem/element"),i=function(t){return t&&t.__esModule?t:{default:t}}(o);n.prototype.mousemove=function(t){var e=this.editor.render,r=this.editor.findItem(t,["atoms","bonds"]),n=e.ctab.molecule;return r&&("atoms"===r.map&&i.default.map[n.atoms.get(r.id).label]||"bonds"===r.map)?this.editor.hover(r):this.editor.hover(null),!0},n.prototype.click=function(t){var e=this.editor,r=e.render,n=r.ctab.molecule,o=e.findItem(t,["atoms","bonds"]);return o&&("atoms"===o.map&&i.default.map[n.atoms.get(o.id).label]||"bonds"===o.map)&&("atoms"===o.map?this.attach.atomid=o.id:this.attach.bondid=o.id,this.editor.selection({atoms:[this.attach.atomid],bonds:[this.attach.bondid]}),this.editor.event.attachEdit.dispatch(this.attach)),!0},r.default=n},{"../../chem/element":520}],565:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(this instanceof o)){if(!t.selection()||!t.selection().bonds)return new o(t,e);var r=(0,g.fromBondsAttrs)(t.render.ctab,t.selection().bonds,e);return t.update(r),t.selection(null),null}this.editor=t,this.atomProps={label:"C"},this.bondProps=e}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/vec2"),h=n(i),l=t("../../chem/struct"),a=t("../shared/utils"),m=n(a),g=t("../actions/bond");o.prototype.mousedown=function(t){var e=this.editor.render;return this.editor.hover(null),this.editor.selection(null),this.dragCtx={xy0:e.page2obj(t),item:this.editor.findItem(t,["atoms","bonds"])},this.dragCtx.item||delete this.dragCtx.item,!0},o.prototype.mousemove=function(t){var e=this.editor,r=e.render;if("dragCtx"in this){var n=this.dragCtx,o=r.page2obj(t),i=m.default.calcAngle(n.xy0,o);t.ctrlKey||(i=m.default.fracAngle(i));var a=m.default.degrees(i);if(this.editor.event.message.dispatch({info:a+"º"}),!("item"in n)||"atoms"===n.item.map){"action"in n&&n.action.perform(r.ctab);var s=void 0,u=void 0,l=void 0,c=void 0;"item"in n&&"atoms"===n.item.map?(s=n.item.id,u=e.findItem(t,["atoms"],n.item)):(s=this.atomProps,l=n.xy0,u=e.findItem(t,["atoms"]));var f=Number.MAX_VALUE;if(u&&"atoms"===u.map)u=u.id;else{u=this.atomProps;var d=r.page2obj(t);if(f=h.default.dist(n.xy0,d),l)c=m.default.calcNewAtomPos(l,d,t.ctrlKey);else{var p=r.ctab.molecule.atoms.get(s);l=m.default.calcNewAtomPos(p.pp.get_xy0(),d,t.ctrlKey)}}return f>.3?n.action=(0,g.fromBondAddition)(r.ctab,this.bondProps,s,u,l,c)[0]:delete n.action,this.editor.update(n.action,!0),!0}}return this.editor.hover(this.editor.findItem(t,["atoms","bonds"])),!0},o.prototype.mouseup=function(t){if("dragCtx"in this){var e=this.dragCtx,r=this.editor.render,n=r.ctab.molecule;if("action"in e)this.editor.update(e.action);else if("item"in e){if("atoms"===e.item.map)this.editor.update((0,g.fromBondAddition)(r.ctab,this.bondProps,e.item.id)[0]);else if("bonds"===e.item.map){var o=Object.assign({},this.bondProps),i=n.bonds.get(e.item.id);this.editor.update((0,g.bondChangingAction)(r.ctab,e.item.id,i,o))}}else{var a=r.page2obj(t),s=new h.default(.5,0).rotate(this.bondProps.type===l.Bond.PATTERN.TYPE.SINGLE?-Math.PI/6:0),u=(0,g.fromBondAddition)(r.ctab,this.bondProps,{label:"C"},{label:"C"},h.default.diff(a,s),h.default.sum(a,s));this.editor.update(u[0])}delete this.dragCtx}return this.editor.event.message.dispatch({info:!1}),!0},r.default=o},{"../../chem/struct":537,"../../util/vec2":686,"../actions/bond":544,"../shared/utils":561}],566:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(!(this instanceof o))return new o(t);this.editor=t,this.editor.selection(null)}Object.defineProperty(r,"__esModule",{value:!0});var p=function(){function r(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=t("../../util/vec2"),h=n(i),a=t("../../chem/struct"),s=t("../shared/utils"),m=n(s),u=t("./atom"),l=t("../actions/bond"),g=t("../actions/chain"),v=t("../actions/closely-fusing");o.prototype.mousedown=function(t){var e=this.editor.render,r=this.editor.findItem(t,["atoms","bonds"]);return this.editor.hover(null),this.dragCtx={xy0:e.page2obj(t),item:r},r&&"atoms"===r.map&&(this.editor.selection({atoms:[r.id]}),(0,u.atomLongtapEvent)(this,e)),this.dragCtx.item||delete this.dragCtx.item,!0},o.prototype.mousemove=function(t){var e=this.editor,r=e.render.ctab,n=this.dragCtx;if(e.hover(this.editor.findItem(t,["atoms","bonds"])),!n)return!0;if(n&&n.stopTapping&&n.stopTapping(),e.selection(null),!n.item||"atoms"===n.item.map){n.action&&n.action.perform(r);var o=r.molecule.atoms,i=n.item?o.get(n.item.id).pp:n.xy0,a=e.render.page2obj(t),s=Math.ceil(h.default.diff(a,i).length()),u=t.ctrlKey?m.default.calcAngle(i,a):m.default.fracAngle(i,a),l=(0,g.fromChain)(r,i,u,s,n.item?n.item.id:null),c=p(l,2),f=c[0],d=c[1];return e.event.message.dispatch({info:s+" sectors"}),n.action=f,e.update(n.action,!0),n.mergeItems=(0,v.getItemsToFuse)(e,d),e.hover((0,v.getHoverToFuse)(n.mergeItems)),!0}return!0},o.prototype.mouseup=function(){var t=this.dragCtx;if(!t)return!0;delete this.dragCtx;var e=this.editor,r=e.render.ctab,n=r.molecule;if(t.stopTapping&&t.stopTapping(),!t.action&&t.item&&"bonds"===t.item.map){var o=n.bonds.get(t.item.id);t.action=(0,l.bondChangingAction)(r,t.item.id,o,{type:a.Bond.PATTERN.TYPE.SINGLE,stereo:a.Bond.PATTERN.STEREO.NONE})}else t.action=t.action?(0,v.fromItemsFuse)(r,t.mergeItems).mergeWith(t.action):(0,v.fromItemsFuse)(r,t.mergeItems);return e.selection(null),e.hover(null),t.action&&e.update(t.action),e.event.message.dispatch({info:!1}),!0},o.prototype.cancel=o.prototype.mouseup,o.prototype.mouseleave=o.prototype.mouseup,r.default=o},{"../../chem/struct":537,"../../util/vec2":686,"../actions/bond":544,"../actions/chain":545,"../actions/closely-fusing":547,"../shared/utils":561,"./atom":563}],567:[function(t,e,r){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.editor=t,this.editor.selection(null),this.charge=e}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../../chem/element"),i=function(t){return t&&t.__esModule?t:{default:t}}(o),a=t("../actions/atom");n.prototype.mousemove=function(t){var e=this.editor.render,r=this.editor.findItem(t,["atoms"]),n=e.ctab.molecule;return r&&"atoms"===r.map&&i.default.map[n.atoms.get(r.id).label]?this.editor.hover(r):this.editor.hover(null),!0},n.prototype.click=function(t){var e=this.editor,r=e.render,n=r.ctab.molecule,o=e.findItem(t,["atoms"]);return o&&"atoms"===o.map&&i.default.map[n.atoms.get(o.id).label]&&(this.editor.hover(null),this.editor.update((0,a.fromAtomsAttrs)(r.ctab,o.id,{charge:n.atoms.get(o.id).charge+this.charge}))),!0},r.default=n},{"../../chem/element":520,"../actions/atom":542}],568:[function(t,e,r){"use strict";function n(t){if(!(this instanceof n)){this.editor=t;var e=this.editor.render,r=null;r=!1===e.ctab.molecule.isChiral?(0,o.fromChiralFlagAddition)(e.ctab):(0,o.fromChiralFlagDeletion)(e.ctab),this.editor.update(r)}}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../actions/chiral-flag");r.default=n},{"../actions/chiral-flag":546}],569:[function(t,e,r){"use strict";function n(t,e){if(!(this instanceof n)){if(!t.selection())return new n(t,e);var r=(0,a.fromFragmentDeletion)(t.render.ctab,t.selection());return t.update(r),t.selection(null),null}this.editor=t,this.maps=["atoms","bonds","rxnArrows","rxnPluses","sgroups","sgroupData","chiralFlags"],this.lassoHelper=new i.default(e||0,t)}Object.defineProperty(r,"__esModule",{value:!0});var o=t("./helper/lasso"),i=function(t){return t&&t.__esModule?t:{default:t}}(o),a=t("../actions/fragment"),s=t("../actions/atom"),u=t("../actions/bond"),l=t("../actions/reaction"),c=t("../actions/sgroup"),f=t("../actions/chiral-flag");n.prototype.mousedown=function(t){this.editor.findItem(t,this.maps)||this.lassoHelper.begin(t)},n.prototype.mousemove=function(t){this.lassoHelper.running()?this.editor.selection(this.lassoHelper.addPoint(t)):this.editor.hover(this.editor.findItem(t,this.maps))},n.prototype.mouseup=function(t){var e=this.editor.render;this.lassoHelper.running()&&(this.editor.update((0,a.fromFragmentDeletion)(e.ctab,this.lassoHelper.end(t))),this.editor.selection(null))},n.prototype.click=function(t){var e=this.editor.render.ctab,r=this.editor.findItem(t,this.maps);if(r){if(this.editor.hover(null),"atoms"===r.map)this.editor.update((0,s.fromAtomDeletion)(e,r.id));else if("bonds"===r.map)this.editor.update((0,u.fromBondDeletion)(e,r.id));else if("sgroups"===r.map||"sgroupData"===r.map)this.editor.update((0,c.fromSgroupDeletion)(e,r.id));else if("rxnArrows"===r.map)this.editor.update((0,l.fromArrowDeletion)(e,r.id));else if("rxnPluses"===r.map)this.editor.update((0,l.fromPlusDeletion)(e,r.id));else{if("chiralFlags"!==r.map)return void console.error("EraserTool: unable to delete the object "+r.map+"["+r.id+"]");this.editor.update((0,f.fromChiralFlagDeletion)(e))}this.editor.selection(null)}},n.prototype.mouseleave=n.prototype.mouseup,n.prototype.cancel=function(){this.lassoHelper.running()&&this.lassoHelper.end(),this.editor.selection(null)},r.default=n},{"../actions/atom":542,"../actions/bond":544,"../actions/chiral-flag":546,"../actions/fragment":548,"../actions/reaction":550,"../actions/sgroup":553,"./helper/lasso":570}],570:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r){this.mode=t,this.fragment=r,this.editor=e}Object.defineProperty(r,"__esModule",{value:!0});var i=t("./locate"),a=n(i),s=t("../../../render/draw"),u=n(s),l=t("../../../util/scale"),c=n(l);o.prototype.getSelection=function(){var t=this.editor.render;if(0===this.mode)return a.default.inPolygon(t.ctab,this.points);if(1===this.mode)return a.default.inRectangle(t.ctab,this.points[0],this.points[1]);throw new Error("Selector mode unknown")},o.prototype.begin=function(t){var e=this.editor.render;this.points=[e.page2obj(t)],1===this.mode&&this.points.push(this.points[0])},o.prototype.running=function(){return!!this.points},o.prototype.addPoint=function(t){if(!this.points)return null;var e=this.editor.render;return 0===this.mode?this.points.push(e.page2obj(t)):1===this.mode&&(this.points=[this.points[0],e.page2obj(t)]),this.update(),this.getSelection()},o.prototype.update=function(){if(this.selection&&(this.selection.remove(),this.selection=null),this.points&&this.points.length>1){var e=this.editor.render,t=this.points.map(function(t){return c.default.obj2scaled(t,e.options).add(e.options.offset)});this.selection=0===this.mode?u.default.selectionPolygon(e.paper,t,e.options):u.default.selectionRectangle(e.paper,t[0],t[1],e.options)}},o.prototype.end=function(){var t=this.getSelection();return this.points=null,this.update(null),t},r.default=o},{"../../../render/draw":585,"../../../util/scale":685,"./locate":571}],571:[function(t,e,r){"use strict";function n(n,t,e){var o=[],r=[],i=Math.min(t.x,e.x),a=Math.max(t.x,e.x),s=Math.min(t.y,e.y),u=Math.max(t.y,e.y);n.bonds.forEach(function(t,e){var r=g.default.lc2(n.atoms.get(t.b.begin).a.pp,.5,n.atoms.get(t.b.end).a.pp,.5);r.x>i&&r.x<a&&r.y>s&&r.y<u&&o.push(e)}),n.atoms.forEach(function(t,e){t.a.pp.x>i&&t.a.pp.x<a&&t.a.pp.y>s&&t.a.pp.y<u&&r.push(e)});var l=[],c=[];n.rxnArrows.forEach(function(t,e){t.item.pp.x>i&&t.item.pp.x<a&&t.item.pp.y>s&&t.item.pp.y<u&&l.push(e)}),n.rxnPluses.forEach(function(t,e){t.item.pp.x>i&&t.item.pp.x<a&&t.item.pp.y>s&&t.item.pp.y<u&&c.push(e)});var f=[];n.chiralFlags.forEach(function(t,e){t.pp.x>i&&t.pp.x<a&&t.pp.y>s&&t.pp.y<u&&f.push(e)});var d=[];return n.sgroupData.forEach(function(t,e){t.sgroup.pp.x>i&&t.sgroup.pp.x<a&&t.sgroup.pp.y>s&&t.sgroup.pp.y<u&&d.push(e)}),{atoms:r,bonds:o,rxnArrows:l,rxnPluses:c,chiralFlags:f,sgroupData:d}}function o(n,t){for(var o=[],r=[],i=[],e=0;e<t.length;++e)i[e]=new g.default(t[e].x,t[e].y);n.bonds.forEach(function(t,e){var r=g.default.lc2(n.atoms.get(t.b.begin).a.pp,.5,n.atoms.get(t.b.end).a.pp,.5);c(i,r)&&o.push(e)}),n.atoms.forEach(function(t,e){c(i,t.a.pp)&&r.push(e)});var a=[],s=[];n.rxnArrows.forEach(function(t,e){c(i,t.item.pp)&&a.push(e)}),n.rxnPluses.forEach(function(t,e){c(i,t.item.pp)&&s.push(e)});var u=[];n.chiralFlags.forEach(function(t,e){c(i,t.pp)&&u.push(e)});var l=[];return n.sgroupData.forEach(function(t,e){c(i,t.sgroup.pp)&&l.push(e)}),{atoms:r,bonds:o,rxnArrows:a,rxnPluses:s,chiralFlags:u,sgroupData:l}}function c(t,e){for(var r=new g.default(0,1),n=r.rotate(Math.PI/2),o=g.default.diff(t[t.length-1],e),i=g.default.dot(n,o),a=g.default.dot(r,o),s=null,u=0,l=!1,c=!1,f=0;f<t.length;++f){var d=g.default.diff(t[f],e),p=g.default.diff(d,o),h=g.default.dot(n,d),m=g.default.dot(r,d);l=!1,h*i<0&&(m*a>-1e-5?a>-1e-5&&(l=!0):(Math.abs(i)*Math.abs(m)-Math.abs(h)*Math.abs(a))*m>0&&(l=!0)),l&&c&&g.default.dot(p,n)*g.default.dot(s,n)>=0&&(l=!1),l&&u++,o=d,i=h,a=m,s=p,c=l}return u%2!=0}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../../util/vec2"),g=function(t){return t&&t.__esModule?t:{default:t}}(i);r.default={inRectangle:n,inPolygon:o}},{"../../../util/vec2":686}],572:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var o=t("./rgroupatom"),i=n(o),a=t("./select"),s=n(a),u=t("./sgroup"),l=n(u),c=t("./eraser"),f=n(c),d=t("./atom"),p=n(d),h=t("./bond"),m=n(h),g=t("./chain"),v=n(g),y=t("./chiral-flag"),b=n(y),_=t("./template"),x=n(_),w=t("./charge"),S=n(w),O=t("./rgroupfragment"),A=n(O),E=t("./apoint"),j=n(E),P=t("./attach"),T=n(P),C=t("./reactionarrow"),k=n(C),M=t("./reactionplus"),R=n(M),N=t("./reactionmap"),B=n(N),I=t("./reactionunmap"),L=n(I),D=t("./paste"),F=n(D),G=t("./rotate"),z=n(G);r.default={rgroupatom:i.default,select:s.default,sgroup:l.default,eraser:f.default,atom:p.default,bond:m.default,chain:v.default,chiralFlag:b.default,template:x.default,charge:S.default,rgroupfragment:A.default,apoint:j.default,attach:T.default,reactionarrow:k.default,reactionplus:R.default,reactionmap:B.default,reactionunmap:L.default,paste:F.default,rotate:z.default}},{"./apoint":562,"./atom":563,"./attach":564,"./bond":565,"./chain":566,"./charge":567,"./chiral-flag":568,"./eraser":569,"./paste":573,"./reactionarrow":574,"./reactionmap":575,"./reactionplus":576,"./reactionunmap":577,"./rgroupatom":578,"./rgroupfragment":579,"./rotate":580,"./select":581,"./sgroup":582,"./template":583}],573:[function(t,e,r){"use strict";function u(t,e){if(!(this instanceof u))return new u(t,e);this.editor=t,this.editor.selection(null),this.struct=e;var r=t.render,n=t.lastEvent?r.page2obj(t.lastEvent):null,o=(0,c.fromPaste)(r.ctab,this.struct,n),i=l(o,2),a=i[0],s=i[1];this.action=a,this.editor.update(this.action,!0),this.mergeItems=(0,f.getItemsToFuse)(this.editor,s),this.editor.hover((0,f.getHoverToFuse)(this.mergeItems),this)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function r(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=t("../actions/paste"),f=t("../actions/closely-fusing");u.prototype.mousemove=function(t){var e=this.editor.render;this.action&&this.action.perform(e.ctab);var r=(0,c.fromPaste)(e.ctab,this.struct,e.page2obj(t)),n=l(r,2),o=n[0],i=n[1];this.action=o,this.editor.update(this.action,!0),this.mergeItems=(0,f.getItemsToFuse)(this.editor,i),this.editor.hover((0,f.getHoverToFuse)(this.mergeItems))},u.prototype.mouseup=function(){var t=this.editor,e=t.render.ctab;if(t.selection(null),this.action=this.action?(0,f.fromItemsFuse)(e,this.mergeItems).mergeWith(this.action):(0,f.fromItemsFuse)(e,this.mergeItems),t.hover(null),this.action){var r=this.action;delete this.action,this.editor.update(r)}},u.prototype.cancel=function(){var t=this.editor.render;this.editor.hover(null),this.action&&(this.action.perform(t.ctab),delete this.action,t.update())},u.prototype.mouseleave=u.prototype.cancel,r.default=u},{"../actions/closely-fusing":547,"../actions/paste":549}],574:[function(t,e,r){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.editor=t,this.editor.selection(null)}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../shared/action"),i=function(t){return t&&t.__esModule?t:{default:t}}(o),a=t("../actions/reaction"),s=t("../actions/fragment");n.prototype.mousedown=function(t){var e=this.editor.render,r=this.editor.findItem(t,["rxnArrows"]);r&&"rxnArrows"===r.map&&(this.editor.hover(null),this.editor.selection({rxnArrows:[r.id]}),this.dragCtx={xy0:e.page2obj(t),action:new i.default})},n.prototype.mousemove=function(t){var e=this.editor.render;"dragCtx"in this?(this.dragCtx.action&&this.dragCtx.action.perform(e.ctab),this.dragCtx.action=(0,s.fromMultipleMove)(e.ctab,this.editor.selection()||{},e.page2obj(t).sub(this.dragCtx.xy0)),this.editor.update(this.dragCtx.action,!0)):this.editor.hover(this.editor.findItem(t,["rxnArrows"]))},n.prototype.mouseup=function(){this.dragCtx&&(this.editor.update(this.dragCtx.action),delete this.dragCtx)},n.prototype.click=function(t){var e=this.editor.render;e.ctab.molecule.rxnArrows.size<1&&this.editor.update((0,a.fromArrowAddition)(e.ctab,e.page2obj(t)))},r.default=n},{"../actions/fragment":548,"../actions/reaction":550,"../shared/action":557}],575:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(!(this instanceof o))return new o(t);this.editor=t,this.editor.selection(null)}function f(t,e,r){for(var n,o,i=0;(!n||!o)&&i<t.reactants.length;i++){var a=Array.from(t.reactants[i]);!n&&a.indexOf(e)>=0&&(n="r"),!o&&a.indexOf(r)>=0&&(o="r")}for(var s=0;(!n||!o)&&s<t.products.length;s++){var u=Array.from(t.products[s]);!n&&u.indexOf(e)>=0&&(n="p"),!o&&u.indexOf(r)>=0&&(o="p")}return n&&o&&n!==o}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/scale"),a=n(i),s=t("../shared/action"),d=n(s),u=t("../../render/draw"),l=n(u),p=t("../actions/atom");o.prototype.mousedown=function(t){var e=this.editor.render;this.rcs=e.ctab.molecule.getComponents();var r=this.editor.findItem(t,["atoms"]);r&&"atoms"===r.map&&(this.editor.hover(null),this.dragCtx={item:r,xy0:e.page2obj(t)})},o.prototype.mousemove=function(t){var e=this.editor.render;if("dragCtx"in this){var r=this.editor.findItem(t,["atoms"],this.dragCtx.item),n=e.ctab.molecule.atoms;r&&"atoms"===r.map&&f(this.rcs,this.dragCtx.item.id,r.id)?(this.editor.hover(r),this.updateLine(n.get(this.dragCtx.item.id).pp,n.get(r.id).pp)):(this.editor.hover(null),this.updateLine(n.get(this.dragCtx.item.id).pp,e.page2obj(t)))}else this.editor.hover(this.editor.findItem(t,["atoms"]))},o.prototype.updateLine=function(t,e){if(this.line&&(this.line.remove(),this.line=null),t&&e){var r=this.editor.render;this.line=l.default.selectionLine(r.paper,a.default.obj2scaled(t,r.options).add(r.options.offset),a.default.obj2scaled(e,r.options).add(r.options.offset),r.options)}},o.prototype.mouseup=function(t){var r=this;if("dragCtx"in this){var n=this.editor.render,e=this.editor.findItem(t,["atoms"],this.dragCtx.item);if(e&&"atoms"===e.map&&f(this.rcs,this.dragCtx.item.id,e.id)){var o=new d.default,i=n.ctab.molecule.atoms,a=i.get(this.dragCtx.item.id),s=i.get(e.id),u=a.aam,l=s.aam;if(!u||u!==l){if((u&&u!==l||!u&&l)&&i.forEach(function(t,e){e!==r.dragCtx.item.id&&(u&&t.aam===u||l&&t.aam===l)&&o.mergeWith((0,p.fromAtomsAttrs)(n.ctab,e,{aam:0}))}),u)o.mergeWith((0,p.fromAtomsAttrs)(n.ctab,e.id,{aam:u}));else{var c=0;i.forEach(function(t){c=Math.max(c,t.aam||0)}),o.mergeWith((0,p.fromAtomsAttrs)(n.ctab,this.dragCtx.item.id,{aam:c+1})),o.mergeWith((0,p.fromAtomsAttrs)(n.ctab,e.id,{aam:c+1}))}this.editor.update(o)}}this.updateLine(null),delete this.dragCtx}this.editor.hover(null)},r.default=o},{"../../render/draw":585,"../../util/scale":685,"../actions/atom":542,"../shared/action":557}],576:[function(t,e,r){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.editor=t,this.editor.selection(null)}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../actions/reaction"),i=t("../actions/fragment");n.prototype.mousedown=function(t){var e=this.editor.render,r=this.editor.findItem(t,["rxnPluses"]);r&&"rxnPluses"===r.map&&(this.editor.hover(null),this.editor.selection({rxnPluses:[r.id]}),this.dragCtx={xy0:e.page2obj(t)})},n.prototype.mousemove=function(t){var e=this.editor.render;"dragCtx"in this?(this.dragCtx.action&&this.dragCtx.action.perform(e.ctab),this.dragCtx.action=(0,i.fromMultipleMove)(e.ctab,this.editor.selection()||{},e.page2obj(t).sub(this.dragCtx.xy0)),this.editor.update(this.dragCtx.action,!0)):this.editor.hover(this.editor.findItem(t,["rxnPluses"]))},n.prototype.mouseup=function(){this.dragCtx&&(this.editor.update(this.dragCtx.action),delete this.dragCtx)},n.prototype.click=function(t){var e=this.editor.render;this.editor.update((0,o.fromPlusAddition)(e.ctab,e.page2obj(t)))},r.default=n},{"../actions/fragment":548,"../actions/reaction":550}],577:[function(t,e,r){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.editor=t,this.editor.selection(null)}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../shared/action"),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s=t("../actions/atom");n.prototype.mousemove=function(t){var e=this.editor.findItem(t,["atoms"]);e&&"atoms"===e.map?this.editor.hover(this.editor.render.ctab.molecule.atoms.get(e.id).aam?e:null):this.editor.hover(null)},n.prototype.mouseup=function(t){var r=this,e=this.editor.findItem(t,["atoms"]),n=this.editor.render.ctab.molecule.atoms;if(e&&"atoms"===e.map&&n.get(e.id).aam){var o=new a.default,i=n.get(e.id).aam;n.forEach(function(t,e){t.aam===i&&o.mergeWith((0,s.fromAtomsAttrs)(r.editor.render.ctab,e,{aam:0}))}),this.editor.update(o)}this.editor.hover(null)},r.default=n},{"../actions/atom":542,"../shared/action":557}],578:[function(t,e,r){"use strict";function n(t){if(!(this instanceof n))return t.selection(null),new n(t);this.editor=t}function o(e,r,n){var t=e.render.ctab.molecule,o=r||0===r?t.atoms.get(r):null,i=o?o.rglabel:0,a=o?o.label:"R#",s=e.event.elementEdit.dispatch({label:"R#",rglabel:i,fragId:o?o.fragment:null});Promise.resolve(s).then(function(t){t=Object.assign({},u.Atom.attrlist,t),!r&&0!==r&&t.rglabel?e.update((0,l.fromAtomAddition)(e.render.ctab,n,t)):i!==t.rglabel&&(t.aam=o.aam,t.attpnt=o.attpnt,t.rglabel||"R#"===a||(t.label=a),e.update((0,l.fromAtomsAttrs)(e.render.ctab,r,t)))}).catch(function(){return null})}Object.defineProperty(r,"__esModule",{value:!0});var u=t("../../chem/struct"),l=t("../actions/atom");n.prototype.mousemove=function(t){this.editor.hover(this.editor.findItem(t,["atoms"]))},n.prototype.click=function(t){var e=this.editor.render,r=this.editor.findItem(t,["atoms"]);return r?"atoms"!==r.map||(this.editor.hover(null),o(this.editor,r.id),!0):(this.editor.hover(null),o(this.editor,null,e.page2obj(t)),!0)},r.default=n},{"../../chem/struct":537,"../actions/atom":542}],579:[function(t,e,r){"use strict";function n(t){if(!(this instanceof n))return t.selection(null),new n(t);this.editor=t}Object.defineProperty(r,"__esModule",{value:!0});var s=t("../../chem/struct"),u=t("../actions/rgroup");n.prototype.mousemove=function(t){this.editor.hover(this.editor.findItem(t,["frags","rgroups"]))},n.prototype.click=function(t){var o=this.editor,e=o.render.ctab.molecule,i=o.findItem(t,["frags","rgroups"]);if(!i)return!0;this.editor.hover(null);var r="rgroups"===i.map?i.id:s.RGroup.findRGroupByFragment(e.rgroups,i.id),n=Object.assign({label:r},"frags"===i.map?{fragId:i.id}:e.rgroups.get(i.id)),a=o.event.rgroupEdit.dispatch(n);return Promise.resolve(a).then(function(t){var e=o.render.ctab,r=null;if("rgroups"!==i.map){var n=s.RGroup.findRGroupByFragment(e.molecule.rgroups,i.id);r=(0,u.fromRGroupFragment)(e,t.label,i.id).mergeWith((0,u.fromUpdateIfThen)(e,t.label,n))}else r=(0,u.fromRGroupAttrs)(e,i.id,t);o.update(r)}).catch(function(){return null}),!0},n.prototype.cancel=function(){this.editor.hover(null)},r.default=n},{"../../chem/struct":537,"../actions/rgroup":551}],580:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(this instanceof a)){if(!e)return new a(t);var r=t.render.ctab,n=t.selection(),o=n&&n.bonds&&1===Object.keys(n).length&&1===n.bonds.length,i=o?(0,l.fromBondAlign)(r,n.bonds[0],e):(0,l.fromFlip)(r,n,e);return t.update(i),null}this.editor=t,t.selection()&&t.selection().atoms||this.editor.selection(null)}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../../util/vec2"),s=n(o),i=t("../shared/utils"),u=n(i),l=t("../actions/rotate"),c=t("../actions/closely-fusing");a.prototype.mousedown=function(t){var e=new s.default,n=this.editor.selection(),r=this.editor.render,o=r.ctab.molecule;if(n&&n.atoms){console.assert(n.atoms.length>0);var i=null,a=!1;n.atoms.forEach(function(r){var t=o.atoms.get(r);e.add_(t.pp),a||t.neighbors.find(function(t){var e=o.halfBonds.get(t);if(-1===n.atoms.indexOf(e.end)){if(e.loop>=0){if(!o.atoms.get(r).neighbors.find(function(t){var e=o.halfBonds.get(t);return e.loop>=0&&-1!==n.atoms.indexOf(e.end)}))return a=!0,!0}if(null==i)i=r;else if(i!==r)return a=!0,!0}return!1})}),e=a||null===i?e.scaled(1/n.atoms.length):o.atoms.get(i).pp}else o.atoms.forEach(function(t){e.add_(t.pp)}),e=e.scaled(1/o.atoms.size);return this.dragCtx={xy0:e,angle1:u.default.calcAngle(e,r.page2obj(t))},!0},a.prototype.mousemove=function(t){if(!this.dragCtx)return!0;var e=this.editor.render,r=this.dragCtx,n=e.page2obj(t),o=u.default.calcAngle(r.xy0,n)-r.angle1;t.ctrlKey||(o=u.default.fracAngle(o));var i=u.default.degrees(o);if("angle"in r&&r.angle===i)return!0;"action"in r&&r.action.perform(e.ctab),r.angle=i,r.action=(0,l.fromRotate)(e.ctab,this.editor.selection(),r.xy0,o),this.editor.event.message.dispatch({info:i+"º"});var a=this.editor.explicitSelected();return r.mergeItems=(0,c.getItemsToFuse)(this.editor,a),this.editor.hover((0,c.getHoverToFuse)(r.mergeItems)),this.editor.update(r.action,!0),!0},a.prototype.mouseup=function(){if(!this.dragCtx)return!0;var t=this.dragCtx,e=this.editor.render.ctab,r=t.action?(0,c.fromItemsFuse)(e,t.mergeItems).mergeWith(t.action):(0,c.fromItemsFuse)(e,t.mergeItems);return delete this.dragCtx,this.editor.update(r),this.editor.hover(null),t.mergeItems&&this.editor.selection(null),this.editor.event.message.dispatch({info:!1}),!0},a.prototype.cancel=a.prototype.mouseup,a.prototype.mouseleave=a.prototype.mouseup,r.default=a},{"../../util/vec2":686,"../actions/closely-fusing":547,"../actions/rotate":552,"../shared/utils":561}],581:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(this instanceof o))return new o(t,e);this.editor=t,this.lassoHelper=new l.default("lasso"===e?0:1,t,"fragment"===e)}function f(t){var e={};return e[t.map]=[t.id],e}function p(e,r,n){return r&&Object.keys(r).forEach(function(t){e[t]?e[t]=i(e[t],r[t],n):e[t]=r[t].slice()}),e}function d(t,e){return t&&t[e.map]&&t[e.map].includes(e.id)}function i(r,t,n){return t.reduce(function(t,e){return n?r=(0,s.default)(r,[e]):r.includes(e)||r.push(e),r},[])}Object.defineProperty(r,"__esModule",{value:!0});var a=t("lodash/fp/xor"),s=n(a),h=t("../../chem/struct"),u=t("./helper/lasso"),l=n(u),c=t("./sgroup"),m=t("./atom"),g=t("../actions/fragment"),v=t("../actions/atom"),y=t("../actions/bond"),b=t("../actions/closely-fusing"),_=t("../shared/utils"),x=n(_);o.prototype.mousedown=function(t){var e=this.editor.render,r=e.ctab,n=r.molecule;this.editor.hover(null);var o=this.lassoHelper.fragment||t.ctrlKey,i=this.editor.findItem(t,o?["frags","sgroups","sgroupData","rgroups","rxnArrows","rxnPluses","chiralFlags"]:["atoms","bonds","sgroups","sgroupData","rgroups","rxnArrows","rxnPluses","chiralFlags"]);if(this.dragCtx={item:i,xy0:e.page2obj(t)},i&&"atoms"!==i.map||(0,m.atomLongtapEvent)(this,e),!i)return delete this.dragCtx.item,this.lassoHelper.fragment||this.lassoHelper.begin(t),!0;var a=f(i),s=this.editor.selection();if("frags"===i.map){var u=r.frags.get(i.id);a={atoms:u.fragGetAtoms(r,i.id),bonds:u.fragGetBonds(r,i.id)}}else if("sgroups"===i.map){var l=r.sgroups.get(i.id).item;a={atoms:h.SGroup.getAtoms(n,l),bonds:h.SGroup.getBonds(n,l)}}else if("rgroups"===i.map){var c=r.rgroups.get(i.id);a={atoms:c.getAtoms(e),bonds:c.getBonds(e)}}else if("sgroupData"===i.map&&d(s,i))return!0;return t.shiftKey?this.editor.selection(p(a,s,!0)):this.editor.selection(d(s,i)?s:a),!0},o.prototype.mousemove=function(t){var e=this.editor,r=e.render,n=e.render.ctab,o=this.dragCtx;if(o&&o.stopTapping&&o.stopTapping(),o&&o.item){var i=n.molecule.atoms,a=e.selection();if("atoms"===o.item.map&&1===i.get(o.item.id).neighbors.length&&1===a.atoms.length&&!a.bonds){var s=r.page2obj(t),u=x.default.calcAngle(o.xy0,s),l=x.default.degrees(u);this.editor.event.message.dispatch({info:l+"º"})}o.action&&(o.action.perform(n),e.update(o.action,!0));var c=e.explicitSelected();return o.action=(0,g.fromMultipleMove)(n,c,e.render.page2obj(t).sub(o.xy0)),o.mergeItems=(0,b.getItemsToFuse)(e,c),e.hover((0,b.getHoverToFuse)(o.mergeItems)),e.update(o.action,!0),!0}if(this.lassoHelper.running()){var f=this.lassoHelper.addPoint(t);return e.selection(t.shiftKey?p(f,e.selection(),!1):f),!0}var d=this.lassoHelper.fragment||t.ctrlKey?["frags","sgroups","sgroupData","rgroups","rxnArrows","rxnPluses","chiralFlags"]:["atoms","bonds","sgroups","sgroupData","rgroups","rxnArrows","rxnPluses","chiralFlags"];return e.hover(e.findItem(t,d)),!0},o.prototype.mouseup=function(t){var e=this.editor,r=e.render.ctab,n=this.dragCtx;if(n&&n.stopTapping&&n.stopTapping(),n&&n.item)n.action=n.action?(0,b.fromItemsFuse)(r,n.mergeItems).mergeWith(n.action):(0,b.fromItemsFuse)(r,n.mergeItems),e.hover(null),n.mergeItems&&e.selection(null),0!==n.action.operations.length&&e.update(n.action),delete this.dragCtx;else if(this.lassoHelper.running()){var o=this.lassoHelper.end();e.selection(t.shiftKey?p(o,e.selection()):o)}else this.lassoHelper.fragment&&(t.shiftKey||e.selection(null));return this.editor.event.message.dispatch({info:!1}),!0},o.prototype.dblclick=function(t){var e=this.editor,r=this.editor.render,n=this.editor.findItem(t,["atoms","bonds","sgroups","sgroupData"]);if(!n)return!0;var o=r.ctab.molecule;if("atoms"===n.map){this.editor.selection(f(n));var i=o.atoms.get(n.id),a=e.event.elementEdit.dispatch(i);Promise.resolve(a).then(function(t){e.update((0,v.fromAtomsAttrs)(r.ctab,n.id,t))}).catch(function(){return null})}else if("bonds"===n.map){this.editor.selection(f(n));var s=r.ctab.bonds.get(n.id).b,u=e.event.bondEdit.dispatch(s);Promise.resolve(u).then(function(t){e.update((0,y.fromBondsAttrs)(r.ctab,n.id,t))}).catch(function(){return null})}else"sgroups"!==n.map&&"sgroupData"!==n.map||(this.editor.selection(f(n)),(0,c.sgroupDialog)(this.editor,n.id));return!0},o.prototype.cancel=function(){if(this.dragCtx&&this.dragCtx.stopTapping&&this.dragCtx.stopTapping(),this.dragCtx&&this.dragCtx.action){var t=this.dragCtx.action;this.editor.update(t)}this.lassoHelper.running()&&this.editor.selection(this.lassoHelper.end()),delete this.dragCtx,this.editor.hover(null)},o.prototype.mouseleave=o.prototype.cancel,r.default=o},{"../../chem/struct":537,"../actions/atom":542,"../actions/bond":544,"../actions/closely-fusing":547,"../actions/fragment":548,"../shared/utils":561,"./atom":563,"./helper/lasso":570,"./sgroup":582,"lodash/fp/xor":438}],582:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(this instanceof a)){var r=t.selection()||{};if(!r.atoms&&!r.bonds)return new a(t,e);var n=t.render.ctab.molecule.sgroups,o=t.selection().atoms,i=n.find(function(t,e){return(0,m.default)(e.atoms,o)});return s(t,void 0!==i?i:null,e),null}this.editor=t,this.type=e,this.lassoHelper=new x.default(1,t),this.editor.selection(null)}function s(n,o,t){var i=n.render.ctab,a=i.molecule,s=n.selection()||{},u=null!==o?a.sgroups.get(o):null,e=u?u.type:t,r="DAT"===e?"sdataEdit":"sgroupEdit";if(!s.atoms&&!s.bonds&&!u)return void console.info("There is no selection or sgroup");var l=null;u?(l=u.getAttrs(),l.context=f(i,u.atoms)):l={context:d(i,s)};var c=n.event[r].dispatch({type:e,attrs:l});Promise.resolve(c).then(function(t){if("DAT"!==t.type&&h(a,s.atoms||[]))n.event.message.dispatch({error:"Partial S-group overlapping is not allowed."});else{if(!(u||"DAT"===t.type||s.atoms&&0!==s.atoms.length))return;if(u&&u.getAttrs().context===t.attrs.context){var e=(0,w.fromSeveralSgroupAddition)(i,t.type,u.atoms,t.attrs).mergeWith((0,w.fromSgroupDeletion)(i,o));return n.update(e),void n.selection(s)}var r=p(o,n,t,s);n.update(r.action),n.selection(r.selection)}}).catch(function(){return null})}function f(t,e){var r=t.molecule;if(1===e.length)return g.SgContexts.Atom;if(c(t,e))return g.SgContexts.Multifragment;if(l(t,e))return g.SgContexts.Fragment;var n=new y.default(e);return u(Array.from(r.bonds.values()).filter(function(t){return n.has(t.begin)&&n.has(t.end)}))?g.SgContexts.Group:g.SgContexts.Bond}function d(t,e){var r=t.molecule;if(e.atoms&&!e.bonds)return g.SgContexts.Atom;var n=e.bonds.map(function(t){return r.bonds.get(t)});if(!u(n))return g.SgContexts.Bond;e.atoms=e.atoms||[];var o=new y.default(e.atoms),i=n.every(function(t){return o.has(t.begin)&&o.has(t.end)});return l(t,e.atoms)&&i?g.SgContexts.Fragment:c(t,e.atoms)?g.SgContexts.Multifragment:g.SgContexts.Group}function p(t,e,r,n){var o=e.render.ctab,i=o.molecule.sgroups.get(t),a=i&&i.atoms||n.atoms||[],s=r.attrs.context,u=(0,w.fromSgroupAction)(s,o,r,a,n);return u.selection=u.selection||n,null!==t&&void 0!==t&&(u.action=u.action.mergeWith((0,w.fromSgroupDeletion)(o,t))),e.selection(u.selection),u}function u(t){if(0===t.length)return!0;for(var e=0;e<t.length;++e)for(var r=t[e],n=0;n<t.length;++n)if(e!==n){var o=t[n];if(r.end===o.begin||r.end===o.end)return!0}return!1}function l(t,e){return 1===o(t,e)}function c(t,e){return o(t,e)>1}function o(t,e){var r=new y.default(e);return Array.from(t.connectedComponents.values()).reduce(function(t,e){return t+(r.isSuperset(e)?1:0)},0)}function h(n,o){var t=o.reduce(function(t,e){var r=n.atoms.get(e);return t.union(r.sgs)},new y.default);return Array.from(t).some(function(t){var e=n.sgroups.get(t);if("DAT"===e.type)return!1;var r=b.SGroup.getAtoms(n,e);return r.length<o.length?r.findIndex(function(t){return-1===o.indexOf(t)})>=0:o.findIndex(function(t){return-1===r.indexOf(t)})>=0})}Object.defineProperty(r,"__esModule",{value:!0}),r.sgroupDialog=s;var i=t("lodash/fp/isEqual"),m=n(i),g=t("../shared/constants"),v=t("../../util/pile"),y=n(v),b=t("../../chem/struct"),_=t("./helper/lasso"),x=n(_),w=t("../actions/sgroup"),S=["atoms","bonds","sgroups","sgroupData"];a.prototype.mousedown=function(t){this.editor.findItem(t,S)||this.lassoHelper.begin(t)},a.prototype.mousemove=function(t){this.lassoHelper.running(t)?this.editor.selection(this.lassoHelper.addPoint(t)):this.editor.hover(this.editor.findItem(t,S))},a.prototype.mouseleave=function(t){this.lassoHelper.running(t)&&this.lassoHelper.end(t)},a.prototype.mouseup=function(t){var e=null,r=null;if(this.lassoHelper.running(t))r=this.lassoHelper.end(t);else{var n=this.editor.findItem(t,S);if(!n)return;if(this.editor.hover(null),"atoms"===n.map)r={atoms:[n.id]};else if("bonds"===n.map){var o=this.editor.render.ctab.bonds.get(n.id);r={atoms:[o.b.begin,o.b.end]}}else{if("sgroups"!==n.map&&"sgroupData"!==n.map)return;e=n.id}}(null!==e||r&&r.atoms)&&s(this.editor,e,this.type)},a.prototype.cancel=function(){this.lassoHelper.running()&&this.lassoHelper.end(),this.editor.selection(null)},r.default=a},{"../../chem/struct":537,"../../util/pile":683,"../actions/sgroup":553,"../shared/constants":559,"./helper/lasso":570,"lodash/fp/isEqual":428}],583:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(this instanceof a))return new a(t,e);this.editor=t,this.editor.selection(null),this.template={aid:parseInt(e.aid)||0,bid:parseInt(e.bid)||0};var r=e.struct;r.rescale();var n=new w.default;r.atoms.forEach(function(t){n.add_(t.pp)}),this.template.molecule=r,this.findItems=[],this.template.xy0=n.scaled(1/(r.atoms.size||1));var o=r.atoms.get(this.template.aid);o&&(this.template.angle0=S.default.calcAngle(o.pp,this.template.xy0),this.findItems.push("atoms"));var i=r.bonds.get(this.template.bid);i&&(this.template.sign=_(r,i,this.template.xy0),this.findItems.push("bonds"))}function _(t,e,r){var n=t.atoms.get(e.begin).pp,o=t.atoms.get(e.end).pp,i=w.default.cross(w.default.diff(n,o),w.default.diff(r,o));return i>0?1:i<0?-1:0}Object.defineProperty(r,"__esModule",{value:!0});var x=function(){function r(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=t("../../util/vec2"),w=n(o),i=t("../shared/utils"),S=n(i),O=t("../actions/template"),A=t("../actions/closely-fusing");a.prototype.mousedown=function(t){var e=this.editor,r=e.render.ctab;this.editor.hover(null),this.dragCtx={xy0:e.render.page2obj(t),item:e.findItem(t,this.findItems)};var n=this.dragCtx,o=n.item;if(!o)return delete n.item,!0;if("bonds"===o.map){var i=r.molecule,a=new w.default,s=i.bonds.get(o.id),u=i.atoms.get(s.begin).fragment,l=i.getFragmentIds(u),c=0,f=i.halfBonds.get(s.hb1).loop;if(f<0&&(f=i.halfBonds.get(s.hb2).loop),f>=0){i.loops.get(f).hbs.forEach(function(t){a.add_(i.atoms.get(i.halfBonds.get(t).begin).pp),c++})}else l.forEach(function(t){a.add_(i.atoms.get(t).pp),c++});n.v0=a.scaled(1/c);var d=_(i,s,n.v0);n.sign1=d||1,n.sign2=this.template.sign}return!0},a.prototype.mousemove=function(t){var e=this.editor.render.ctab;if(!this.dragCtx)return this.editor.hover(this.editor.findItem(t,this.findItems)),!0;var r=this.dragCtx,n=r.item,o=null,i=this.editor.render.page2obj(t),a=e.molecule;if(n&&"bonds"===n.map){var s=a.bonds.get(n.id),u=_(a,s,i);if(r.sign1*this.template.sign>0&&(u=-u),u!==r.sign2||!r.action){r.action&&r.action.perform(e),r.sign2=u;var l=(0,O.fromTemplateOnBondAction)(e,this.template,n.id,this.editor.event,r.sign1*r.sign2>0,!1),c=x(l,2);h=c[0],m=c[1],r.action=h,this.editor.update(r.action,!0),r.mergeItems=(0,A.getItemsToFuse)(this.editor,m),this.editor.hover((0,A.getHoverToFuse)(r.mergeItems))}return!0}var f=null;n?"atoms"===n.map&&(o=a.atoms.get(n.id).pp,f=w.default.dist(o,i)>1):o=r.xy0;var d=S.default.calcAngle(o,i);t.ctrlKey||(d=S.default.fracAngle(d));var p=S.default.degrees(d);if(this.editor.event.message.dispatch({info:p+"º"}),r.hasOwnProperty("angle")&&r.angle===p&&(!r.hasOwnProperty("extra_bond")||r.extra_bond===f))return!0;r.action&&r.action.perform(e),r.angle=p;var h=null,m=void 0;if(n){if("atoms"===n.map){var g=(0,O.fromTemplateOnAtom)(e,this.template,n.id,d,f),v=x(g,2);h=v[0],m=v[1],r.extra_bond=f}}else{var y=(0,O.fromTemplateOnCanvas)(e,this.template,o,d),b=x(y,2);h=b[0],m=b[1]}return r.action=h,this.editor.update(r.action,!0),r.mergeItems=(0,A.getItemsToFuse)(this.editor,m),this.editor.hover((0,A.getHoverToFuse)(r.mergeItems)),!0},a.prototype.mouseup=function(t){var i=this,e=this.dragCtx;if(!e)return!0;delete this.dragCtx;var a=this.editor.render.ctab,r=a.molecule,n=e.item;if(e.action&&n&&"bonds"===n.map)return e.action.perform(a),(0,O.fromTemplateOnBondAction)(a,this.template,n.id,this.editor.event,e.sign1*e.sign2>0,!0).then(function(t){var e=x(t,2),r=e[0],n=e[1],o=(0,A.getItemsToFuse)(i.editor,n);r=(0,A.fromItemsFuse)(a,o).mergeWith(r),i.editor.update(r)}),!0;var o=void 0,s=null;if(!e.action)if(n){if("atoms"===n.map){var u=a.atoms.get(n.id).a.neighbors.length,l=void 0,c=void 0;if(u>1)l=null,c=!0;else if(1===u){var f=r.atoms.get(n.id),d=r.halfBonds.get(f.neighbors[0]).end,p=r.atoms.get(d);l=t.ctrlKey?S.default.calcAngle(p.pp,f.pp):S.default.fracAngle(S.default.calcAngle(p.pp,f.pp)),c=!1}else l=0,c=!1;var h=(0,O.fromTemplateOnAtom)(a,this.template,n.id,l,c),m=x(h,2);o=m[0],s=m[1],e.action=o}else if("bonds"===n.map)return(0,O.fromTemplateOnBondAction)(a,this.template,n.id,this.editor.event,e.sign1*e.sign2>0,!0).then(function(t){var e=x(t,2),r=e[0],n=e[1],o=(0,A.getItemsToFuse)(i.editor,n);r=(0,A.fromItemsFuse)(a,o).mergeWith(r),i.editor.update(r)}),!0}else{var g=(0,O.fromTemplateOnCanvas)(a,this.template,e.xy0,0),v=x(g,2);o=v[0],s=v[1],e.action=o}this.editor.selection(null),!e.mergeItems&&s&&(e.mergeItems=(0,A.getItemsToFuse)(this.editor,s)),e.action=e.action?(0,A.fromItemsFuse)(a,e.mergeItems).mergeWith(e.action):(0,A.fromItemsFuse)(a,e.mergeItems),this.editor.hover(null);var y=e.action;return y&&!y.isDummy()&&this.editor.update(y),this.editor.event.message.dispatch({info:!1}),!0},a.prototype.cancel=a.prototype.mouseup,a.prototype.mouseleave=a.prototype.mouseup,r.default=a},{"../../util/vec2":686,"../actions/closely-fusing":547,"../actions/template":554,"../shared/utils":561}],584:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var o=t("raphael"),i=n(o),a=t("./util/vec2"),s=n(a);i.default.el.translateAbs=function(t,e){this.delta=this.delta||new s.default,this.delta.x+=t-0,this.delta.y+=e-0,this.transform("t"+this.delta.x.toString()+","+this.delta.y.toString())},i.default.st.translateAbs=function(e,r){this.forEach(function(t){t.translateAbs(e,r)})},r.default=i.default},{"./util/vec2":686,raphael:497}],585:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r,n){return t.path("M{0},{1}L{2},{3}L{4},{5}M{2},{3}L{4},{6}",B(e.x),B(e.y),B(r.x),B(r.y),B(r.x-7),B(r.y-5),B(r.y+5)).attr(n.lineattr)}function i(t,e,r){var n=r.scale/5;return t.path("M{0},{4}L{0},{5}M{2},{1}L{3},{1}",B(e.x),B(e.y),B(e.x-n),B(e.x+n),B(e.y-n),B(e.y+n)).attr(r.lineattr)}function a(t,e,r,n){var o=e.p,i=r.p;return t.path(A(o,i)).attr(n.lineattr)}function s(t,e,r,n,o){return t.path("M{0},{1}L{2},{3}L{4},{5}Z",B(e.x),B(e.y),B(r.x),B(r.y),B(n.x),B(n.y)).attr(o.lineattr).attr({fill:"#000"})}function u(t,e,r,n,o,i){return t.path("M{0},{1}L{2},{3}L{4},{5}L{6},{7}Z",B(e.x),B(e.y),B(r.x),B(r.y),B(n.x),B(n.y),B(o.x),B(o.y)).attr(i.lineattr).attr({stroke:"#000",fill:"#000"})}function l(t,e,r,n,o){return t.set([e,t.path("M{0},{1}L{2},{3}",B(r.x),B(r.y),B(n.x),B(n.y)).attr(o.lineattr)])}function c(t,e,r,n,o,i){for(var a,s,u,l=e.p,c=e.norm,f=.7*i.stereoBond,d="",p=0;p<n;++p)u=l.addScaled(r,o*p),a=u.addScaled(c,f*(p+.5)/(n-.5)),s=u.addScaled(c,-f*(p+.5)/(n-.5)),d+=A(a,s);return t.path(d).attr(i.lineattr)}function f(t,e,r,n,o,i){for(var a=e.p,s=e.norm,u=.7*i.stereoBond,l="M"+B(a.x)+","+B(a.y),c=a,f=0;f<n;++f)c=a.addScaled(r,o*(f+.5)).addScaled(s,(1&f?-1:1)*u*(f+.5)/(n-.5)),l+="L"+B(c.x)+","+B(c.y);return t.path(l).attr(i.lineattr)}function d(t,e,r,n,o,i,a){return t.path(i?"M{0},{1}L{6},{7}M{4},{5}L{2},{3}":"M{0},{1}L{2},{3}M{4},{5}L{6},{7}",B(e.x),B(e.y),B(n.x),B(n.y),B(r.x),B(r.y),B(o.x),B(o.y)).attr(a.lineattr)}function p(t,e,r,n,o){for(var i,a=e.p,s=r.p,u=e.norm,l=o.bondSpace/2,c="",f=a,d=1;d<=n;++d)i=M.default.lc2(a,(n-d)/n,s,d/n),1&d?c+=A(f,i):(c+=A(f.addScaled(u,l),i.addScaled(u,l)),c+=A(f.addScaled(u,-l),i.addScaled(u,-l))),f=i;return t.path(c).attr(o.lineattr)}function h(t,e,r,n){var o=e.p,i=r.p,a=e.norm,s=o.addScaled(a,n.bondSpace),u=i.addScaled(a,n.bondSpace),l=o.addScaled(a,-n.bondSpace),c=i.addScaled(a,-n.bondSpace);return t.path(A(o,i)+A(s,u)+A(l,c)).attr(n.lineattr)}function m(t,e,r,n){var o=t.path(e[0]).attr(n.lineattr),i=t.path(e[1]).attr(n.lineattr);return void 0!==r&&null!==r&&(r>0?o:i).attr({"stroke-dasharray":"- "}),t.set([o,i])}function g(t,e,r,n){var o=e.p,i=r.p;return t.path(A(o,i)).attr(n.lineattr).attr({"stroke-dasharray":"- "})}function v(t,e,r){for(var n="",o=0;o<e.length/2;++o)n+=A(e[2*o],e[2*o+1]);return t.path(n).attr(r.lineattr)}function y(t,e,r,n){var o=t.text(e.x,e.y,r).attr({font:n.font,"font-size":n.fontszsub,fill:"#000"});return P(o,C.default.relBox(o.getBBox())),o}function b(t,e,r){var n=.9*r.lineWidth,o=n,i=2*n;return t.path("M{0},{1}L{2},{3}L{4},{5}",B(e.x-o),B(e.y+i),B(e.x),B(e.y),B(e.x+o),B(e.y+i)).attr({stroke:"#000","stroke-width":.7*r.lineWidth,"stroke-linecap":"square","stroke-linejoin":"miter"})}function _(t,e,r){return t.circle(B(e.x),B(e.y),r.lineWidth).attr({stroke:null,fill:"#000"})}function x(t,e,r,n,o,i,a){o=o||.25,i=i||1;var s=n.addScaled(r,-.5*i),u=n.addScaled(r,.5*i),l=s.addScaled(e,-o),c=u.addScaled(e,-o);return t.path("M{0},{1}L{2},{3}L{4},{5}L{6},{7}",B(l.x),B(l.y),B(s.x),B(s.y),B(u.x),B(u.y),B(c.x),B(c.y)).attr(a.sgroupBracketStyle)}function w(t,e,r,n){return t.rect(B(Math.min(e.x,r.x)),B(Math.min(e.y,r.y)),B(Math.abs(r.x-e.x)),B(Math.abs(r.y-e.y))).attr(n.lassoStyle)}function S(t,e,r){for(var n=e[e.length-1],o="M"+B(n.x)+","+B(n.y),i=0;i<e.length;++i)o+="L"+B(e[i].x)+","+B(e[i].y);return t.path(o).attr(r.lassoStyle)}function O(t,e,r,n){return t.path(A(e,r)).attr(n.lassoStyle)}function A(t,e){return"M"+B(t.x)+","+B(t.y)+"L"+B(e.x)+","+B(e.y)+"\t"}function E(t,e,r){for(var n=0,o=M.default.dist(t,e),i=M.default.diff(e,t).normalized(),a=!0,s="",u=0;n<o;){var l=r[u%r.length],c=n+Math.min(l,o-n);a&&(s+="M "+t.addScaled(i,n).coordStr()+" L "+t.addScaled(i,c).coordStr()),n+=l,a=!a,u++}return s}function j(t,e,r,n,o,i){return[i&&1&o?E(t,r,i):A(t,r),i&&2&o?E(e,n,i):A(e,n)]}function P(t,e){if(N.default.vml){console.assert(null,"Souldn't go here!");var r=.16*e.height;t.translateAbs(0,r),e.y+=r}}Object.defineProperty(r,"__esModule",{value:!0});var T=t("./util"),C=n(T),k=t("../util/vec2"),M=n(k),R=t("../raphael-ext"),N=n(R),B=C.default.tfx;r.default={recenterText:P,arrow:o,plus:i,aromaticBondPaths:j,bondSingle:a,bondSingleUp:s,bondSingleStereoBold:u,bondDoubleStereoBold:l,bondSingleDown:c,bondSingleEither:f,bondDouble:d,bondSingleOrDouble:p,bondTriple:h,bondAromatic:m,bondAny:g,reactingCenter:v,topologyMark:y,radicalCap:b,radicalBullet:_,bracket:x,selectionRectangle:w,selectionPolygon:S,selectionLine:O}},{"../raphael-ext":584,"../util/vec2":686,"./util":601}],586:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r=t.clientWidth-10,n=t.clientHeight-10;r=r>0?r:0,n=n>0?n:0,this.userOpts=e,this.clientArea=t,this.paper=new u.default(t,r,n),this.sz=y.default.ZERO,this.ctab=new m.default(new p.default,this),this.options=(0,_.default)(this.userOpts)}function i(t){var e=0,r=0;if(t.parentNode)do{e+=t.offsetTop||0,r+=t.offsetLeft||0,t=t.offsetParent}while(t);return{left:r,top:e}}function s(t,e,r,n,o){var i=e<0?-e:0,a=r<0?-r:0;return t.x<n&&(i+=n-t.x),t.y<o&&(a+=o-t.y),new y.default(i,a)}Object.defineProperty(r,"__esModule",{value:!0});var a=t("../raphael-ext"),u=n(a),l=t("../util/box2abs"),v=n(l),c=t("../util/vec2"),y=n(c),f=t("../util/scale"),b=n(f),d=t("../chem/struct"),p=n(d),h=t("./restruct"),m=n(h),g=t("./options"),_=n(g),x={debug:!1,logcnt:0,logmouse:!1,hl:!1};x.logMethod=function(){},o.prototype.view2obj=function(t,e){var r=this.scrollPos();return this.useOldZoom||(t=t.scaled(1/this.options.zoom),r=r.scaled(1/this.options.zoom)),t=e?t:t.add(r).sub(this.options.offset),b.default.scaled2obj(t,this.options)},o.prototype.obj2view=function(t,e){var r=b.default.obj2scaled(t,this.options);return r=e?r:r.add(this.options.offset).sub(this.scrollPos().scaled(1/this.options.zoom)),this.useOldZoom||(r=r.scaled(this.options.zoom)),r},o.prototype.scrollPos=function(){return new y.default(this.clientArea.scrollLeft,this.clientArea.scrollTop)},o.prototype.page2obj=function(t){var e=i(this.clientArea),r=new y.default(t.pageX-e.left,t.pageY-e.top);return this.view2obj(r)},o.prototype.setPaperSize=function(t){x.logMethod("setPaperSize"),this.sz=t,this.paper.setSize(t.x*this.options.zoom,t.y*this.options.zoom),this.setViewBox(this.options.zoom)},o.prototype.setOffset=function(t){x.logMethod("setOffset");var e=new y.default(t.x-this.options.offset.x,t.y-this.options.offset.y);this.clientArea.scrollLeft+=e.x,this.clientArea.scrollTop+=e.y,this.options.offset=t},o.prototype.setZoom=function(t){console.info("set zoom",t),this.options.zoom=t,this.paper.setSize(this.sz.x*t,this.sz.y*t),this.setViewBox(t)},o.prototype.setScrollOffset=function(t,e){var r=this.clientArea,n=r.clientWidth,o=r.clientHeight,i=s(this.sz.scaled(this.options.zoom),t,e,n+t,o+e).scaled(1/this.options.zoom);if(i.x>0||i.y>0){this.setPaperSize(this.sz.add(i));var a=new y.default(t<0?-t:0,e<0?-e:0).scaled(1/this.options.zoom);(a.x>0||a.y>0)&&(this.ctab.translate(a),this.setOffset(this.options.offset.add(a)))}r.scrollLeft=t,r.scrollTop=e,this.update(!1)},o.prototype.setScale=function(t){this.options.offset&&(this.options.offset=this.options.offset.scaled(1/t).scaled(t)),this.userOpts.scale*=t,this.options=null,this.update(!0)},o.prototype.setViewBox=function(t){this.useOldZoom?this.setScale(t):this.paper.canvas.setAttribute("viewBox","0 0 "+this.sz.x+" "+this.sz.y)},o.prototype.setMolecule=function(t){x.logMethod("setMolecule"),this.paper.clear(),this.ctab=new m.default(t,this),this.options.offset=new y.default,this.update(!1)},o.prototype.update=function(t,e){e=e||new y.default(this.clientArea.clientWidth||100,this.clientArea.clientHeight||100);var r=this.ctab.update(t);if(this.ctab.setSelection(),r){var n=this.options.scale,o=this.ctab.getVBoxObj().transform(b.default.obj2scaled,this.options).translate(this.options.offset||new y.default);if(this.options.autoScale){var i=o.sz(),a=this.options.autoScaleMargin,s=new y.default(a,a),u=e;if(u.x<2*a+1||u.y<2*a+1)throw new Error("View box too small for the given margin");var l=Math.max(i.x/(u.x-2*a),i.y/(u.y-2*a));this.options.maxBondLength/l>1&&(l=1);var c=i.add(s.scaled(2*l));this.paper.setViewBox(o.pos().x-a*l-(u.x*l-c.x)/2,o.pos().y-a*l-(u.y*l-c.y)/2,u.x*l,u.y*l)}else{var f=y.default.UNIT.scaled(n),d=o.sz().length()>0?o.extend(f,f):o,p=new v.default(this.scrollPos(),e.scaled(1/this.options.zoom).sub(y.default.UNIT.scaled(20))),h=v.default.union(p,d);this.oldCb||(this.oldCb=new v.default);var m=h.sz().floor(),g=this.oldCb.p0.sub(h.p0).ceil();this.oldBb=o,this.sz&&m.x==this.sz.x&&m.y==this.sz.y||this.setPaperSize(m),this.options.offset=this.options.offset||new y.default,0==g.x&&0==g.y||(this.setOffset(this.options.offset.add(g)),this.ctab.translate(g))}}},r.default=o},{"../chem/struct":537,"../raphael-ext":584,"../util/box2abs":682,"../util/scale":685,"../util/vec2":686,"./options":587,"./restruct":588}],587:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=t.scale||100;t.rotationStep&&a.default.setFracAngle(t.rotationStep);var r=Math.ceil(e/6*1.9),n=Math.ceil(.7*r),o={showAtomIds:!1,showBondIds:!1,showHalfBondIds:!1,showLoopIds:!1,hideChiralFlag:!1,showValenceWarnings:!0,autoScale:!1,autoScaleMargin:0,maxBondLength:0,atomColoring:!0,hideImplicitHydrogen:!1,hideTerminalLabels:!1,carbonExplicitly:!1,showCharge:!0,showHydrogenLabels:"on",showValence:!0,aromaticCircle:!0,scale:e,zoom:1,offset:new u.default,lineWidth:e/20,bondSpace:t.doubleBondWidth||e/7,stereoBond:t.stereoBondWidth||e/7,subFontSize:n,font:"30px Arial",fontsz:r,fontszsub:n,fontRLabel:1.2*r,fontRLogic:.7*r,lineattr:{stroke:"#000","stroke-width":t.bondThickness||e/20,"stroke-linecap":"round","stroke-linejoin":"round"},selectionStyle:{fill:"#7f7",stroke:"none"},highlightStyle:{stroke:"#0c0","stroke-width":.6*e/20},sgroupBracketStyle:{stroke:"darkgray","stroke-width":.5*e/20},lassoStyle:{stroke:"gray","stroke-width":"1px"},atomSelectionPlateRadius:1.2*r};return Object.assign({},o,t)}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../editor/shared/utils"),a=n(i),s=t("../util/vec2"),u=n(s);r.default=o},{"../editor/shared/utils":561,"../util/vec2":686}],588:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var r=this;if(this.render=e,this.atoms=new f.default,this.bonds=new f.default,this.reloops=new f.default,this.rxnPluses=new f.default,this.rxnArrows=new f.default,this.frags=new f.default,this.rgroups=new f.default,this.sgroups=new f.default,this.sgroupData=new f.default,this.chiralFlags=new f.default,this.molecule=t||new b.default,this.initialized=!1,this.layers=[],this.initLayers(),this.connectedComponents=new f.default,this.ccFragmentType=new f.default,this.clearMarks(),this.structChanged=!1,t.atoms.forEach(function(t,e){r.atoms.set(e,new x.default(t))}),t.bonds.forEach(function(t,e){r.bonds.set(e,new S.default(t))}),t.loops.forEach(function(t,e){r.reloops.set(e,new F.default(t))}),t.rxnPluses.forEach(function(t,e){r.rxnPluses.set(e,new A.default(t))}),t.rxnArrows.forEach(function(t,e){r.rxnArrows.set(e,new j.default(t))}),t.frags.forEach(function(t,e){r.frags.set(e,new T.default(t))}),t.rgroups.forEach(function(t,e){r.rgroups.set(e,new k.default(t))}),t.sgroups.forEach(function(t,e){r.sgroups.set(e,new L.default(t)),"DAT"!==t.type||t.data.attached||r.sgroupData.set(e,new R.default(t))}),t.isChiral){var n=t.getCoordBoundingBox();this.chiralFlags.set(0,new B.default(new m.default(n.max.x,n.min.y-1)))}}function i(e){return!e||!Object.keys(s.maps).some(function(t){return e[t]&&e[t].length>0})}function o(t,e){if("set"==t.type)for(var r=0;r<t.length;++r)o(t[r],e);else void 0!==t.attrs&&("font-size"in t.attrs?t.attr("font-size",t.attrs["font-size"]*e):"stroke-width"in t.attrs&&t.attr("stroke-width",t.attrs["stroke-width"]*e)),t.scale(e,e,0,0)}function a(t,e){for(var r=0;r<t.paths.length;++r)o(t.paths[r],e)}Object.defineProperty(r,"__esModule",{value:!0}),r.ReSGroup=r.ReChiralFlag=r.ReRGroup=r.ReFrag=r.ReRxnArrow=r.ReRxnPlus=r.ReBond=r.ReAtom=void 0;var u=t("../../util/box2abs"),l=n(u),c=t("../../util/pool"),f=n(c),d=t("../../util/pile"),p=n(d),h=t("../../util/vec2"),m=n(h),g=t("../util"),v=n(g),y=t("../../chem/struct"),b=n(y),_=t("./reatom"),x=n(_),w=t("./rebond"),S=n(w),O=t("./rerxnplus"),A=n(O),E=t("./rerxnarrow"),j=n(E),P=t("./refrag"),T=n(P),C=t("./rergroup"),k=n(C),M=t("./redatasgroupdata"),R=n(M),N=t("./rechiralflag"),B=n(N),I=t("./resgroup"),L=n(I),D=t("./reloop"),F=n(D),G={background:0,selectionPlate:1,highlighting:2,warnings:3,data:4,indices:5};s.prototype.connectedComponentRemoveAtom=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e=e||this.atoms.get(t),!(e.component<0)){var r=this.connectedComponents.get(e.component);r.delete(t),r.size<1&&this.connectedComponents.delete(e.component),e.component=-1}},s.prototype.clearConnectedComponents=function(){this.connectedComponents.clear(),this.atoms.forEach(function(t){t.component=-1})},s.prototype.getConnectedComponent=function(t,e){for(var r=this,n=Array.isArray(t)?Array.from(t):[t],o=new p.default;n.length>0;){var i=n.pop();o.add(i);var a=this.atoms.get(i);a.component>=0&&e.add(a.component),a.a.neighbors.forEach(function(t){var e=r.molecule.halfBonds.get(t).end;o.has(e)||n.push(e)})}return o},s.prototype.addConnectedComponent=function(t){var r=this,n=this.connectedComponents.add(t),e=new p.default,o=this.getConnectedComponent(Array.from(t),e);e.delete(n);var i=-1;return o.forEach(function(t){var e=r.atoms.get(t);e.component=n,-1!==e.a.rxnFragmentType&&(i=e.a.rxnFragmentType)}),this.ccFragmentType.set(n,i),n},s.prototype.removeConnectedComponent=function(t){var e=this;return this.connectedComponents.get(t).forEach(function(t){e.atoms.get(t).component=-1}),this.connectedComponents.delete(t)},s.prototype.assignConnectedComponents=function(){var o=this;this.atoms.forEach(function(t,e){if(!(t.component>=0)){var r=new p.default,n=o.getConnectedComponent(e,r);r.forEach(function(t){o.removeConnectedComponent(t)}),o.addConnectedComponent(n)}})},s.prototype.initLayers=function(){for(var t in G)this.layers[G[t]]=this.render.paper.rect(0,0,10,10).attr({class:t+"Layer",fill:"#000",opacity:"0.0"}).toFront()},s.prototype.addReObjectPath=function(t,e,r,n,o){if(r&&this.layers[G[t]].node.parentNode){var i=this.render.options.offset,a=o?l.default.fromRelBox(v.default.relBox(r.getBBox())):null,s=n&&a?a.translate(n.negated()):null;null!==i&&(r.translateAbs(i.x,i.y),a=a?a.translate(i):null),e.add(r,a,s),r.insertBefore(this.layers[G[t]])}},s.prototype.clearMarks=function(){var e=this;Object.keys(s.maps).forEach(function(t){e[t+"Changed"]=new Map}),this.structChanged=!1},s.prototype.markItemRemoved=function(){this.structChanged=!0},s.prototype.markBond=function(t,e){this.markItem("bonds",t,e)},s.prototype.markAtom=function(t,e){this.markItem("atoms",t,e)},s.prototype.markItem=function(t,e,r){var n=this[t+"Changed"],o=n.has(e)?Math.max(r,n.get(e)):r;n.set(e,o),this[t].has(e)&&this.clearVisel(this[t].get(e).visel)},s.prototype.clearVisel=function(t){t.paths.forEach(function(t){t.remove()}),t.clear()},s.prototype.eachItem=function(e){var r=this;Object.keys(s.maps).forEach(function(t){r[t].forEach(e)})},s.prototype.getVBoxObj=function(e){var n=this;e=e||{},i(e)&&Object.keys(s.maps).forEach(function(t){e[t]=Array.from(n[t].keys())});var o=null;return Object.keys(s.maps).forEach(function(r){e[r]&&e[r].forEach(function(t){var e=n[r].get(t).getVBoxObj(n.render);e&&(o=o?l.default.union(o,e):e.clone())})}),o=o||new l.default(0,0,0,0)},s.prototype.translate=function(e){this.eachItem(function(t){return t.visel.translate(e)})},s.prototype.scale=function(e){this.eachItem(function(t){return a(t.visel,e)})},s.prototype.clearVisels=function(){var e=this;this.eachItem(function(t){return e.clearVisel(t.visel)})},s.prototype.update=function(t){var o=this;t=t||!this.initialized,Object.keys(s.maps).forEach(function(r){var n=o[r+"Changed"];t?o[r].forEach(function(t,e){return n.set(e,1)}):n.forEach(function(t,e){o[r].has(e)||n.delete(e)})}),this.atomsChanged.forEach(function(t,e){return o.connectedComponentRemoveAtom(e)}),this.frags.filter(function(t,e){return!e.calcBBox(o.render.ctab,t,o.render)}).forEach(function(t,e){o.clearVisel(t.visel),o.frags.delete(e),o.molecule.frags.delete(e)}),Object.keys(s.maps).forEach(function(r){var n=o[r+"Changed"];n.forEach(function(t,e){o.clearVisel(o[r].get(e).visel),o.structChanged|=n.get(e)>0})}),this.sgroups.forEach(function(t){o.clearVisel(t.visel),t.highlighting=null,t.selectionPlate=null}),this.frags.forEach(function(t){o.clearVisel(t.visel)}),this.rgroups.forEach(function(t){o.clearVisel(t.visel)}),t&&(this.clearConnectedComponents(),this.molecule.initHalfBonds(),this.molecule.initNeighbors());var e=Array.from(this.atomsChanged.keys());this.molecule.updateHalfBonds(e),this.molecule.sortNeighbors(e),this.assignConnectedComponents(),this.initialized=!0,this.verifyLoops();var r=t||this.structChanged;return r&&this.updateLoops(),this.setImplicitHydrogen(),this.showLabels(),this.showBonds(),r&&this.showLoops(),this.showReactionSymbols(),this.showSGroups(),this.showFragments(),this.showRGroups(),this.showChiralFlags(),this.clearMarks(),!0},s.prototype.updateLoops=function(){var e=this;this.reloops.forEach(function(t){e.clearVisel(t.visel)});var t=this.molecule.findLoops();t.bondsToMark.forEach(function(t){e.markBond(t,1)}),t.newLoops.forEach(function(t){e.reloops.set(t,new F.default(e.molecule.loops.get(t)))})},s.prototype.showLoops=function(){var r=this,n=this.render.options;this.reloops.forEach(function(t,e){t.show(r,e,n)})},s.prototype.showReactionSymbols=function(){var r=this,n=this.render.options;this.rxnArrowsChanged.forEach(function(t,e){r.rxnArrows.get(e).show(r,e,n)}),this.rxnPlusesChanged.forEach(function(t,e){r.rxnPluses.get(e).show(r,e,n)})},s.prototype.showSGroups=function(){var e=this,r=this.render.options;this.molecule.sGroupForest.getSGroupsBFS().reverse().forEach(function(t){e.sgroups.get(t).show(e,t,r)})},s.prototype.showFragments=function(){var n=this;this.frags.forEach(function(t,e){var r=t.draw(n.render,e);r&&n.addReObjectPath("data",t.visel,r,null,!0)})},s.prototype.showRGroups=function(){var r=this,n=this.render.options;this.rgroups.forEach(function(t,e){t.show(r,e,n)})},s.prototype.setImplicitHydrogen=function(){this.molecule.setImplicitHydrogen(Array.from(this.atomsChanged.keys()))},s.prototype.loopRemove=function(t){var r=this;if(this.reloops.has(t)){var e=this.reloops.get(t);this.clearVisel(e.visel);var n=[];e.loop.hbs.forEach(function(t){if(r.molecule.halfBonds.has(t)){var e=r.molecule.halfBonds.get(t);e.loop=-1,r.markBond(e.bid,1),r.markAtom(e.begin,1),n.push(e.bid)}}),this.reloops.delete(t),this.molecule.loops.delete(t)}},s.prototype.verifyLoops=function(){var r=this;this.reloops.forEach(function(t,e){t.isValid(r.molecule,e)||r.loopRemove(e)})},s.prototype.showLabels=function(){var r=this,n=this.render.options;this.atomsChanged.forEach(function(t,e){r.atoms.get(e).show(r,e,n)})},s.prototype.showChiralFlags=function(){var r=this,n=this.render.options;!0!==this.render.options.hideChiralFlag&&this.chiralFlagsChanged.forEach(function(t,e){r.chiralFlags.get(e).show(r,e,n)})},s.prototype.showBonds=function(){var r=this,n=this.render.options;this.bondsChanged.forEach(function(t,e){r.bonds.get(e).show(r,e,n)})},s.prototype.setSelection=function(o){var i=this,a=0===arguments.length;Object.keys(s.maps).forEach(function(n){s.maps[n].isSelectable()&&i[n].forEach(function(t,e){var r=a?t.selected:o&&o[n]&&o[n].indexOf(e)>-1;i.showItemSelection(t,r)})})},s.prototype.showItemSelection=function(t,e){var r=null!==t.selectionPlate&&!t.selectionPlate.removed;if(t.selected=e,t instanceof R.default&&(t.sgroup.selected=e),e){if(!r){var n=this.render,o=n.options,i=n.paper;t.selectionPlate=t.makeSelectionPlate(this,i,o),this.addReObjectPath("selectionPlate",t.visel,t.selectionPlate)}t.selectionPlate&&t.selectionPlate.show()}else r&&t.selectionPlate&&t.selectionPlate.hide()},s.maps={atoms:x.default,bonds:S.default,rxnPluses:A.default,rxnArrows:j.default,frags:T.default,rgroups:k.default,sgroupData:R.default,chiralFlags:B.default,sgroups:L.default,reloops:F.default},r.default=s,r.ReAtom=x.default,r.ReBond=S.default,r.ReRxnPlus=A.default,r.ReRxnArrow=j.default,r.ReFrag=T.default,r.ReRGroup=k.default,r.ReChiralFlag=B.default,r.ReSGroup=L.default},{"../../chem/struct":537,"../../util/box2abs":682,"../../util/pile":683,"../../util/pool":684,"../../util/vec2":686,"../util":601,"./reatom":589,"./rebond":590,"./rechiralflag":591,"./redatasgroupdata":592,"./refrag":593,"./reloop":594,"./rergroup":596,"./rerxnarrow":597,"./rerxnplus":598,"./resgroup":599}],589:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.init("atom"),this.a=t,this.showLabel=!1,this.hydrogenOnTheLeft=!1,this.color="#000000",this.component=-1}function T(t,e,r){var n="off"!==e.showHydrogenLabels&&"Hetero"!==e.showHydrogenLabels;if(0===r.a.neighbors.length||r.a.neighbors.length<2&&n||e.carbonExplicitly||r.a.alias||0!==r.a.isotope||0!==r.a.radical||0!==r.a.charge||r.a.explicitValence>=0||null!==r.a.atomList||null!==r.a.rglabel||r.a.badConn&&e.showValenceWarnings||"c"!==r.a.label.toLowerCase())return!0;if(2===r.a.neighbors.length){var o=r.a.neighbors[0],i=r.a.neighbors[1],a=t.molecule.halfBonds.get(o),s=t.molecule.halfBonds.get(i),u=t.bonds.get(a.bid),l=t.bonds.get(s.bid);if(u.b.type===l.b.type&&u.b.stereo===h.Bond.PATTERN.STEREO.NONE&&l.b.stereo===h.Bond.PATTERN.STEREO.NONE&&Math.abs(_.default.cross(a.dir,s.dir))<.2)return!0}return!1}function C(t,e){return"on"===t||"Terminal"===t&&e.a.neighbors.length<2||"Hetero"===t&&"c"!==e.label.text.toLowerCase()||"Terminal and Hetero"===t&&(e.a.neighbors.length<2||"c"!==e.label.text.toLowerCase())}function k(r,t){if(0===t.a.neighbors.length){var e=Y.default.map[t.a.label];return!e||Y.default[e].leftH}var n=1,o=1,i=0,a=0;return t.a.neighbors.forEach(function(t){var e=r.halfBonds.get(t).dir;e.x<=0?(n=Math.min(n,Math.abs(e.y)),i++):(o=Math.min(o,Math.abs(e.y)),a++)}),n<.51||o<.51?o<n:a>i}function M(t,e,r,n){var o={};if(o.text=a(t.a),""===o.text&&(o="R#"),o.text===t.a.label){var i=Y.default.map[o.text];n.atomColoring&&i&&(t.color=K.sketchingColors[o.text]||"#000")}return o.path=e.text(r.x,r.y,o.text).attr({font:n.font,"font-size":n.fontsz,fill:t.color,"font-style":t.a.pseudo?"italic":""}),o.rbb=X.default.relBox(o.path.getBBox()),$.default.recenterText(o.path,o.rbb),null!==t.a.atomList&&W(o.path,o.rbb,(t.hydrogenOnTheLeft?-1:1)*(o.rbb.width-o.rbb.height)/2,0),t.label=o,o}function a(t){if(null!==t.atomList)return t.atomList.label();if(t.pseudo)return t.pseudo;if(t.alias)return t.alias;if("R#"===t.label&&null!==t.rglabel){for(var e="",r=0;r<32;r++)t.rglabel&1<<r&&(e+="R"+(r+1).toString());return e}return t.label}function R(t,e,r,n){var o=q.default.obj2scaled(t.a.pp,e.options),i=e.options,a=.5*i.lineWidth,s={};return s.text=(r+1).toString(),s.path=e.paper.text(o.x,o.y,s.text).attr({font:i.font,"font-size":i.fontszsub,fill:t.color}),s.rbb=X.default.relBox(s.path.getBBox()),$.default.recenterText(s.path,s.rbb),W(s.path,s.rbb,n+.5*s.rbb.width+a,.2*t.label.rbb.height),s}function N(t,e){var r,n=q.default.obj2scaled(t.a.pp,e.options),o=e.options,i=e.paper,a={};switch(t.a.radical){case 1:a.path=i.set(),r=1.6*o.lineWidth,a.path.push($.default.radicalBullet(i,n.add(new _.default(-r,0)),o),$.default.radicalBullet(i,n.add(new _.default(r,0)),o)),a.path.attr("fill",t.color);break;case 2:a.path=i.set(),a.path.push($.default.radicalBullet(i,n,o)),a.path.attr("fill",t.color);break;case 3:a.path=i.set(),r=1.6*o.lineWidth,a.path.push($.default.radicalCap(i,n.add(new _.default(-r,0)),o),$.default.radicalCap(i,n.add(new _.default(r,0)),o)),a.path.attr("stroke",t.color)}a.rbb=X.default.relBox(a.path.getBBox());var s=-.5*(t.label.rbb.height+a.rbb.height);return 3===t.a.radical&&(s-=o.lineWidth/2),W(a.path,a.rbb,0,s),a}function B(t,e,r){var n=q.default.obj2scaled(t.a.pp,e.options),o=e.options,i=.5*o.lineWidth,a={};return a.text=t.a.isotope.toString(),a.path=e.paper.text(n.x,n.y,a.text).attr({font:o.font,"font-size":o.fontszsub,fill:t.color}),a.rbb=X.default.relBox(a.path.getBBox()),$.default.recenterText(a.path,a.rbb),W(a.path,a.rbb,r-.5*a.rbb.width-i,-.3*t.label.rbb.height),a}function I(t,e,r){var n=q.default.obj2scaled(t.a.pp,e.options),o=e.options,i=.5*o.lineWidth,a={};a.text="";var s=Math.abs(t.a.charge);return 1!=s&&(a.text=s.toString()),t.a.charge<0?a.text+="–":a.text+="+",a.path=e.paper.text(n.x,n.y,a.text).attr({font:o.font,"font-size":o.fontszsub,fill:t.color}),a.rbb=X.default.relBox(a.path.getBBox()),$.default.recenterText(a.path,a.rbb),W(a.path,a.rbb,r+.5*a.rbb.width+i,-.3*t.label.rbb.height),a}function L(t,e,r){var n={0:"0",1:"I",2:"II",3:"III",4:"IV",5:"V",6:"VI",7:"VII",8:"VIII",9:"IX",10:"X",11:"XI",12:"XII",13:"XIII",14:"XIV"},o=q.default.obj2scaled(t.a.pp,e.options),i=e.options,a=.5*i.lineWidth,s={};if(s.text=n[t.a.explicitValence],!s.text)throw new Error("invalid valence "+t.a.explicitValence.toString());return s.text="("+s.text+")",s.path=e.paper.text(o.x,o.y,s.text).attr({font:i.font,"font-size":i.fontszsub,fill:t.color}),s.rbb=X.default.relBox(s.path.getBBox()),$.default.recenterText(s.path,s.rbb),W(s.path,s.rbb,r+.5*s.rbb.width+a,-.3*t.label.rbb.height),s}function D(t,e,r,n){var o=n.hydroIndex,i=t.hydrogenOnTheLeft,a=q.default.obj2scaled(t.a.pp,e.options),s=e.options,u=.5*s.lineWidth,l=n.hydrogen;return l.text="H",l.path=e.paper.text(a.x,a.y,l.text).attr({font:s.font,"font-size":s.fontsz,fill:t.color}),l.rbb=X.default.relBox(l.path.getBBox()),$.default.recenterText(l.path,l.rbb),i||(W(l.path,l.rbb,n.rightMargin+.5*l.rbb.width+u,0),n.rightMargin+=l.rbb.width+u),r>1&&(o={},o.text=r.toString(),o.path=e.paper.text(a.x,a.y,o.text).attr({font:s.font,"font-size":s.fontszsub,fill:t.color}),o.rbb=X.default.relBox(o.path.getBBox()),$.default.recenterText(o.path,o.rbb),i||(W(o.path,o.rbb,n.rightMargin+.5*o.rbb.width+u,.2*t.label.rbb.height),n.rightMargin+=o.rbb.width+u)),i&&(null!=o&&(W(o.path,o.rbb,n.leftMargin-.5*o.rbb.width-u,.2*t.label.rbb.height),n.leftMargin-=o.rbb.width+u),W(l.path,l.rbb,n.leftMargin-.5*l.rbb.width-u,0),n.leftMargin-=l.rbb.width+u),Object.assign(n,{hydrogen:l,hydroIndex:o})}function F(t,e,r,n){var o=q.default.obj2scaled(t.a.pp,e.options),i=.5*e.options.lineWidth,a=X.default.tfx,s={},u=o.y+t.label.rbb.height/2+i;return s.path=e.paper.path("M{0},{1}L{2},{3}",a(o.x+r),a(u),a(o.x+n),a(u)).attr(e.options.lineattr).attr({stroke:"#F00"}),s.rbb=X.default.relBox(s.path.getBBox()),s}function G(t,e,r,n){var o,i,a=q.default.obj2scaled(t.a.pp,e.options),s=e.options,u=X.default.tfx;for(o=0;o<4;++o){var l="";if(t.a.attpnt&1<<o){for(l.length>0&&(l+=" "),l+="∗",i=0;i<(0==o?0:o+1);++i)l+="'";var c=new _.default(a),f=a.addScaled(r,.7*s.scale),d=e.paper.text(f.x,f.y,l).attr({font:s.font,"font-size":s.fontsz,fill:t.color}),p=X.default.relBox(d.getBBox());$.default.recenterText(d,p);var h=r.negated();f=f.addScaled(h,X.default.shiftRayBox(f,h,V.default.fromRelBox(p))+s.lineWidth/2),c=b(t,c,r,s.lineWidth);var m=r.rotateSC(1,0),g=f.addScaled(m,.05*s.scale).addScaled(h,.09*s.scale),v=f.addScaled(m,-.05*s.scale).addScaled(h,.09*s.scale),y=e.paper.set();y.push(d,e.paper.path("M{0},{1}L{2},{3}M{4},{5}L{2},{3}L{6},{7}",u(c.x),u(c.y),u(f.x),u(f.y),u(g.x),u(g.y),u(v.x),u(v.y)).attr(e.options.lineattr).attr({"stroke-width":s.lineWidth/2})),n("indices",t.visel,y,a),r=r.rotate(Math.PI/6)}}}function z(t){var e="";if(t.a.aam>0&&(e+=t.a.aam),t.a.invRet>0)if(e.length>0&&(e+=","),1==t.a.invRet)e+="Inv";else{if(2!=t.a.invRet)throw new Error("Invalid value for the invert/retain flag");e+="Ret"}if(t.a.exactChangeFlag>0){if(e.length>0&&(e+=","),1!=t.a.exactChangeFlag)throw new Error("Invalid value for the exact change flag");e+="ext"}return e}function H(t){var e="";if(0!=t.a.ringBondCount)if(t.a.ringBondCount>0)e+="rb"+t.a.ringBondCount.toString();else if(-1==t.a.ringBondCount)e+="rb0";else{if(-2!=t.a.ringBondCount)throw new Error("Ring bond count invalid");e+="rb*"}if(0!=t.a.substitutionCount)if(e.length>0&&(e+=","),t.a.substitutionCount>0)e+="s"+t.a.substitutionCount.toString();else if(-1==t.a.substitutionCount)e+="s0";else{if(-2!=t.a.substitutionCount)throw new Error("Substitution count invalid");e+="s*"}if(t.a.unsaturatedAtom>0){if(e.length>0&&(e+=","),1!=t.a.unsaturatedAtom)throw new Error("Unsaturated atom invalid value");e+="u"}return t.a.hCount>0&&(e.length>0&&(e+=","),e+="H"+(t.a.hCount-1).toString()),e}function W(t,e,r,n){t.translateAbs(r,n),e.x+=r,e.y+=n}function U(t,r){var n=[];t.a.neighbors.forEach(function(t){var e=r.halfBonds.get(t);n.push(e.ang)}),n=n.sort(function(t,e){return t-e});for(var e=[],o=0;o<n.length-1;++o)e.push(n[(o+1)%n.length]-n[o]);e.push(n[0]-n[n.length-1]+2*Math.PI);var i=0,a=-Math.PI/2;for(o=0;o<n.length;++o)e[o]>i&&(i=e[o],a=n[o]+e[o]/2);return new _.default(Math.cos(a),Math.sin(a))}function b(t,e,r,n){for(var o=0,i=t.visel,a=0;a<i.exts.length;++a){var s=i.exts[a].translate(e);o=Math.max(o,X.default.shiftRayBox(e,r,s))}return o>0&&(e=e.addScaled(r,o+n)),e}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/box2abs"),V=n(i),s=t("./reobject"),u=n(s),l=t("../../util/scale"),q=n(l),c=t("../../chem/element"),Y=n(c),K=t("../../chem/element-color"),f=t("../draw"),$=n(f),d=t("../util"),X=n(d),p=t("../../util/vec2"),_=n(p),h=t("../../chem/struct");o.prototype=new u.default,o.isSelectable=function(){return!0},o.prototype.getVBoxObj=function(t){return this.visel.boundingBox?u.default.prototype.getVBoxObj.call(this,t):new V.default(this.a.pp,this.a.pp)},o.prototype.drawHighlight=function(t){var e=this.makeHighlightPlate(t);return t.ctab.addReObjectPath("highlighting",this.visel,e),e},o.prototype.makeHighlightPlate=function(t){var e=t.paper,r=t.options,n=q.default.obj2scaled(this.a.pp,r);return e.circle(n.x,n.y,r.atomSelectionPlateRadius).attr(r.highlightStyle)},o.prototype.makeSelectionPlate=function(t,e,r){var n=q.default.obj2scaled(this.a.pp,t.render.options);return e.circle(n.x,n.y,r.atomSelectionPlateRadius).attr(r.selectionStyle)},o.prototype.show=function(t,e,r){var n=t.render,o=q.default.obj2scaled(this.a.pp,n.options);if(this.hydrogenOnTheLeft=k(t.molecule,this),this.showLabel=T(t,n.options,this),this.color="black",this.showLabel){var i=M(this,n.paper,o,r),a=.5*r.lineWidth,s=i.rbb.width/2,u=-i.rbb.width/2,l=Math.floor(this.a.implicitH),c="H"===i.text;t.addReObjectPath("data",this.visel,i.path,o,!0);var f=null;r.showAtomIds&&(f={},f.text=e.toString(),f.path=n.paper.text(o.x,o.y,f.text).attr({font:r.font,"font-size":r.fontszsub,fill:"#070"}),f.rbb=X.default.relBox(f.path.getBBox()),$.default.recenterText(f.path,f.rbb),t.addReObjectPath("indices",this.visel,f.path,o)),this.setHighlight(this.highlight,n)}if(this.showLabel&&!this.a.alias&&!this.a.pseudo){var d=null;if(c&&l>0&&(d=R(this,n,l,s),s+=d.rbb.width+a,t.addReObjectPath("data",this.visel,d.path,o,!0)),0!=this.a.radical){var p=N(this,n);t.addReObjectPath("data",this.visel,p.path,o,!0)}if(0!=this.a.isotope){var h=B(this,n,u);u-=h.rbb.width+a,t.addReObjectPath("data",this.visel,h.path,o,!0)}if(!c&&l>0&&C(r.showHydrogenLabels,this)){var m=D(this,n,l,{hydrogen:{},hydroIndex:d,rightMargin:s,leftMargin:u}),g=m.hydrogen;d=m.hydroIndex,s=m.rightMargin,u=m.leftMargin,t.addReObjectPath("data",this.visel,g.path,o,!0),null!=d&&t.addReObjectPath("data",this.visel,d.path,o,!0)}if(0!=this.a.charge&&r.showCharge){var v=I(this,n,s);s+=v.rbb.width+a,t.addReObjectPath("data",this.visel,v.path,o,!0)}if(this.a.explicitValence>=0&&r.showValence){var y=L(this,n,s);s+=y.rbb.width+a,t.addReObjectPath("data",this.visel,y.path,o,!0)}if(this.a.badConn&&r.showValenceWarnings){var b=F(this,n,u,s);t.addReObjectPath("warnings",this.visel,b.path,o,!0)}f&&W(f.path,f.rbb,-.5*i.rbb.width-.5*f.rbb.width-a,.3*i.rbb.height)}if(this.a.attpnt){G(this,n,U(this,t.molecule),t.addReObjectPath.bind(t))}var _=z(this),x=this.a.alias||this.a.pseudo?"":H(this);if(_=(x.length>0?x+"\n":"")+(_.length>0?"."+_+".":""),_.length>0){var w=Y.default.map[this.a.label],S=n.paper.text(o.x,o.y,_).attr({font:r.font,"font-size":r.fontszsub,fill:r.atomColoring&&w?K.sketchingColors[this.a.label]:"#000"}),O=X.default.relBox(S.getBBox());$.default.recenterText(S,O);for(var A=U(this,t.molecule),E=this.visel,j=3,P=0;P<E.exts.length;++P)j=Math.max(j,X.default.shiftRayBox(o,A,E.exts[P].translate(o)));j+=X.default.shiftRayBox(o,A.negated(),V.default.fromRelBox(O)),A=A.scaled(8+j),W(S,O,A.x,A.y),t.addReObjectPath("data",this.visel,S,o,!0)}},r.default=o},{"../../chem/element":520,"../../chem/element-color":519,"../../chem/struct":537,"../../util/box2abs":682,"../../util/scale":685,"../../util/vec2":686,"../draw":585,"../util":601,"./reobject":595}],590:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.init("bond"),this.b=t,this.doubleBondShift=0}function i(t,o,i,a){return t.neighbors.findIndex(function(t){var e=a.molecule.halfBonds.get(t),r=e.bid;if(r===o)return!1;var n=a.bonds.get(r);return n.b.type===C.Bond.PATTERN.TYPE.SINGLE&&n.b.stereo===C.Bond.PATTERN.STEREO.UP?n.b.end===e.begin||n.boldStereo&&i:!(n.b.type!==C.Bond.PATTERN.TYPE.DOUBLE||n.b.stereo!==C.Bond.PATTERN.STEREO.NONE||!i||!n.boldStereo)})}function l(n,t,o){var e=[t.b.begin,t.b.end].map(function(t){var e=o.molecule.atoms.get(t),r=i(e,n,!0,o);return r<0?-1:e.neighbors[r]});console.assert(2===e.length),t.neihbid1=o.atoms.get(t.b.begin).showLabel?-1:e[0],t.neihbid2=o.atoms.get(t.b.end).showLabel?-1:e[1]}function d(n,t,o){var e=[t.b.begin,t.b.end].map(function(t){var e=o.molecule.atoms.get(t),r=i(e,n,!1,o);return r<0?-1:e.neighbors[r]});console.assert(2===e.length),t.boldStereo=e[0]>=0&&e[1]>=0}function p(t,e,r,n){var o=null,i=t.render,a=t.molecule,s=!t.atoms.get(r.begin).showLabel,u=!t.atoms.get(n.begin).showLabel;switch(e.b.type){case C.Bond.PATTERN.TYPE.SINGLE:switch(e.b.stereo){case C.Bond.PATTERN.STEREO.UP:l(r.bid,e,t),o=e.boldStereo&&e.neihbid1>=0&&e.neihbid2>=0?m(i,r,n,e,a):c(i,r,n,e,a);break;case C.Bond.PATTERN.STEREO.DOWN:o=g(i,r,n);break;case C.Bond.PATTERN.STEREO.EITHER:o=v(i,r,n);break;default:o=M.default.bondSingle(i.paper,r,n,i.options)}break;case C.Bond.PATTERN.TYPE.DOUBLE:l(r.bid,e,t),o=e.b.stereo===C.Bond.PATTERN.STEREO.NONE&&e.boldStereo&&e.neihbid1>=0&&e.neihbid2>=0?f(i,r,n,e,a,s,u):y(i,r,n,e,s,u);break;case C.Bond.PATTERN.TYPE.TRIPLE:o=M.default.bondTriple(i.paper,r,n,i.options);break;case C.Bond.PATTERN.TYPE.AROMATIC:o=r.loop>=0&&a.loops.get(r.loop).aromatic||n.loop>=0&&a.loops.get(n.loop).aromatic?M.default.bondSingle(i.paper,r,n,i.options):x(i,r,n,e,s,u);break;case C.Bond.PATTERN.TYPE.SINGLE_OR_DOUBLE:o=_(i,r,n);break;case C.Bond.PATTERN.TYPE.SINGLE_OR_AROMATIC:case C.Bond.PATTERN.TYPE.DOUBLE_OR_AROMATIC:o=x(i,r,n,e,s,u);break;case C.Bond.PATTERN.TYPE.ANY:o=M.default.bondAny(i.paper,r,n,i.options);break;default:throw new Error("Bond type "+e.b.type+" not supported")}return o}function c(t,e,r,n,o){var i=e.p,a=r.p,s=e.norm,u=t.options,l=.7*u.stereoBond,c=a.addScaled(s,l),f=a.addScaled(s,-l);if(n.neihbid2>=0){var d=h(r,n.neihbid2,u.stereoBond,o);c=d[0],f=d[1]}return M.default.bondSingleUp(t.paper,i,c,f,u)}function m(t,e,r,n,o){var i=t.options,a=h(e,n.neihbid1,i.stereoBond,o),s=h(r,n.neihbid2,i.stereoBond,o),u=a[0],l=a[1],c=s[0],f=s[1];return M.default.bondSingleStereoBold(t.paper,u,l,c,f,i)}function f(t,e,r,n,o,i,a){var s=e.p,u=r.p,l=e.norm,c=n.doubleBondShift,f=1.5*t.options.stereoBond,d=s.addScaled(l,f*c),p=u.addScaled(l,f*c);c>0?(i&&(d=d.addScaled(e.dir,f*b(e.rightCos,e.rightSin))),a&&(p=p.addScaled(e.dir,-f*b(r.leftCos,r.leftSin)))):c<0&&(i&&(d=d.addScaled(e.dir,f*b(e.leftCos,e.leftSin))),a&&(p=p.addScaled(e.dir,-f*b(r.rightCos,r.rightSin))));var h=m(t,e,r,n,o);return M.default.bondDoubleStereoBold(t.paper,h,d,p,t.options)}function b(t,e){return e<0||Math.abs(t)>.9?0:e/(1-t)}function h(t,e,r,n){var o=n.halfBonds.get(e),i=N.default.dot(t.dir,o.dir),a=N.default.cross(t.dir,o.dir),s=Math.sqrt(.5*(1-i)),u=o.dir.rotateSC((a>=0?-1:1)*s,Math.sqrt(.5*(1+i))),l=t.p.addScaled(u,.7*r/(s+.3)),c=t.p.addScaled(u.negated(),.7*r/(s+.3));return a>0?[l,c]:[c,l]}function g(t,e,r){var n=e.p,o=r.p,i=t.options,a=o.sub(n),s=a.length()+.2;a=a.normalized();var u=1.2*i.lineWidth,l=Math.max(Math.floor((s-i.lineWidth)/(i.lineWidth+u)),0)+2,c=s/(l-1);return M.default.bondSingleDown(t.paper,e,a,l,c,i)}function v(t,e,r){var n=e.p,o=r.p,i=t.options,a=o.sub(n),s=a.length();a=a.normalized();var u=.6*i.lineWidth,l=Math.max(Math.floor((s-i.lineWidth)/(i.lineWidth+u)),0)+2,c=s/(l-.5);return M.default.bondSingleEither(t.paper,e,a,l,c,i)}function y(t,e,r,n,o,i){var a=n.b.stereo===C.Bond.PATTERN.STEREO.CIS_TRANS,s=e.p,u=r.p,l=e.norm,c=a?0:n.doubleBondShift,f=t.options,d=f.bondSpace/2,p=d+c*d,h=c*d-d,m=s.addScaled(l,p),g=u.addScaled(l,p),v=s.addScaled(l,h),y=u.addScaled(l,h);return c>0?(o&&(m=m.addScaled(e.dir,f.bondSpace*b(e.rightCos,e.rightSin))),i&&(g=g.addScaled(e.dir,-f.bondSpace*b(r.leftCos,r.leftSin)))):c<0&&(o&&(v=v.addScaled(e.dir,f.bondSpace*b(e.leftCos,e.leftSin))),i&&(y=y.addScaled(e.dir,-f.bondSpace*b(r.rightCos,r.rightSin)))),M.default.bondDouble(t.paper,m,v,g,y,a,f)}function _(t,e,r){var n=e.p,o=r.p,i=t.options,a=(N.default.dist(n,o)/(i.bondSpace+i.lineWidth)).toFixed()-0;return 1&a||(a+=1),M.default.bondSingleOrDouble(t.paper,e,r,a,i)}function x(t,e,r,n,o,i){var a=[.125,.125,.005,.125],s=null,u=null,l=t.options,c=n.doubleBondShift;n.b.type===C.Bond.PATTERN.TYPE.SINGLE_OR_AROMATIC&&(s=c>0?1:2,u=a.map(function(t){return t*l.scale})),n.b.type===C.Bond.PATTERN.TYPE.DOUBLE_OR_AROMATIC&&(s=3,u=a.map(function(t){return t*l.scale}));var f=w(e,r,c,o,i,l.bondSpace,s,u);return M.default.bondAromatic(t.paper,f,c,l)}function w(t,e,r,n,o,i,a,s){var u=t.p,l=e.p,c=t.norm,f=i/2,d=f+r*f,p=r*f-f,h=u.addScaled(c,d),m=l.addScaled(c,d),g=u.addScaled(c,p),v=l.addScaled(c,p);return r>0?(n&&(h=h.addScaled(t.dir,i*b(t.rightCos,t.rightSin))),o&&(m=m.addScaled(t.dir,-i*b(e.leftCos,e.leftSin)))):r<0&&(n&&(g=g.addScaled(t.dir,i*b(t.leftCos,t.leftSin))),o&&(v=v.addScaled(t.dir,-i*b(e.rightCos,e.rightSin)))),M.default.aromaticBondPaths(h,g,m,v,a,s)}function S(t,e,r,n){var o=r.p,i=n.p,a=i.add(o).scaled(.5),s=i.sub(o).normalized(),u=s.rotateSC(1,0),l=[],c=t.options.lineWidth,f=t.options.bondSpace/2,d=c,p=2*c,h=1.5*f,m=1.5*f,g=3*f;switch(e.b.reactingCenterStatus){case C.Bond.PATTERN.REACTING_CENTER.NOT_CENTER:l.push(a.addScaled(u,g).addScaled(s,.2*g)),l.push(a.addScaled(u,-g).addScaled(s,-.2*g)),l.push(a.addScaled(u,g).addScaled(s,-.2*g)),l.push(a.addScaled(u,-g).addScaled(s,.2*g));break;case C.Bond.PATTERN.REACTING_CENTER.CENTER:l.push(a.addScaled(u,g).addScaled(s,.2*g).addScaled(s,d)),l.push(a.addScaled(u,-g).addScaled(s,-.2*g).addScaled(s,d)),l.push(a.addScaled(u,g).addScaled(s,.2*g).addScaled(s,-d)),l.push(a.addScaled(u,-g).addScaled(s,-.2*g).addScaled(s,-d)),l.push(a.addScaled(s,h).addScaled(u,m)),l.push(a.addScaled(s,-h).addScaled(u,m)),l.push(a.addScaled(s,h).addScaled(u,-m)),l.push(a.addScaled(s,-h).addScaled(u,-m));break;case C.Bond.PATTERN.REACTING_CENTER.MADE_OR_BROKEN:l.push(a.addScaled(u,g).addScaled(s,p)),l.push(a.addScaled(u,-g).addScaled(s,p)),l.push(a.addScaled(u,g).addScaled(s,-p)),l.push(a.addScaled(u,-g).addScaled(s,-p));break;case C.Bond.PATTERN.REACTING_CENTER.ORDER_CHANGED:l.push(a.addScaled(u,g)),l.push(a.addScaled(u,-g));break;case C.Bond.PATTERN.REACTING_CENTER.MADE_OR_BROKEN_AND_CHANGED:l.push(a.addScaled(u,g).addScaled(s,p)),l.push(a.addScaled(u,-g).addScaled(s,p)),l.push(a.addScaled(u,g).addScaled(s,-p)),l.push(a.addScaled(u,-g).addScaled(s,-p)),l.push(a.addScaled(u,g)),l.push(a.addScaled(u,-g));break;default:return null}return M.default.reactingCenter(t.paper,l,t.options)}function O(t,e,r,n){var o=t.options,i=null;if(e.b.topology===C.Bond.PATTERN.TOPOLOGY.RING)i="rng";else{if(e.b.topology!==C.Bond.PATTERN.TOPOLOGY.CHAIN)return null;i="chn"}var a=r.p,s=n.p,u=s.add(a).scaled(.5),l=s.sub(a).normalized(),c=l.rotateSC(1,0),f=o.lineWidth;e.doubleBondShift>0?c=c.scaled(-e.doubleBondShift):0==e.doubleBondShift&&(f+=o.bondSpace/2);var d=new N.default(2,1).scaled(o.bondSpace);e.b.type==C.Bond.PATTERN.TYPE.TRIPLE&&(f+=o.bondSpace);var p=u.add(new N.default(c.x*(d.x+f),c.y*(d.y+f)));return M.default.topologyMark(t.paper,p,i,o)}function A(t,e,r,n,o,i,a,s){var u=N.default.lc(r.p,i,n.p,a,s,o),l=e.text(u.x,u.y,t.toString()),c=I.default.relBox(l.getBBox());return M.default.recenterText(l,c),l}function E(t,e){var r,n;if(r=e.halfBonds.get(t.b.hb1).loop,n=e.halfBonds.get(t.b.hb2).loop,r>=0&&n>=0){var o=e.loops.get(r).dblBonds,i=e.loops.get(n).dblBonds,a=e.loops.get(r).hbs.length,s=e.loops.get(n).hbs.length;t.doubleBondShift=u(a,s,o,i)}else t.doubleBondShift=r>=0?-1:n>=0?1:T(e,t)}function j(t,e,r){var n=e.render,o=e.atoms.get(t.b.begin),i=e.atoms.get(t.b.end),a=D.default.obj2scaled(o.a.pp,n.options),s=D.default.obj2scaled(i.a.pp,n.options),u=e.molecule.halfBonds.get(t.b.hb1),l=e.molecule.halfBonds.get(t.b.hb2);u.p=P(o,a,u.dir,2*r.lineWidth),l.p=P(i,s,l.dir,2*r.lineWidth),t.b.center=N.default.lc2(o.a.pp,.5,i.a.pp,.5),t.b.len=N.default.dist(a,s),t.b.sb=5*r.lineWidth,t.b.sa=Math.max(t.b.sb,t.b.len/2-2*r.lineWidth),t.b.angle=180*Math.atan2(u.dir.y,u.dir.x)/Math.PI}function P(t,e,r,n){for(var o=0,i=t.visel,a=0;a<i.exts.length;++a){var s=i.exts[a].translate(e);o=Math.max(o,I.default.shiftRayBox(e,r,s))}return o>0&&(e=e.addScaled(r,o+n)),e}function u(t,e,r,n){return 6==t&&6!=e&&(r>1||1==n)?-1:6==e&&6!=t&&(n>1||1==r)?1:e*r>t*n?-1:e*r<t*n?1:e>t?-1:1}function T(t,e){var r=t.halfBonds.get(e.b.hb1),n=t.halfBonds.get(e.b.hb2),o=(r.leftSin>.3?1:0)+(n.rightSin>.3?1:0),i=(n.leftSin>.3?1:0)+(r.rightSin>.3?1:0);return o>i?-1:o<i?1:(r.leftSin>.3?1:0)+(r.rightSin>.3?1:0)==1?1:0}Object.defineProperty(r,"__esModule",{value:!0});var a=t("./reobject"),s=n(a),C=t("../../chem/struct"),k=t("../draw"),M=n(k),R=t("../../util/vec2"),N=n(R),B=t("../util"),I=n(B),L=t("../../util/scale"),D=n(L);o.prototype=new s.default,o.isSelectable=function(){return!0},o.prototype.drawHighlight=function(t){var e=this.makeHighlightPlate(t);return t.ctab.addReObjectPath("highlighting",this.visel,e),e},o.prototype.makeHighlightPlate=function(t){var e=t.options;j(this,t.ctab,e);var r=D.default.obj2scaled(this.b.center,e);return t.paper.circle(r.x,r.y,.8*e.atomSelectionPlateRadius).attr(e.highlightStyle)},o.prototype.makeSelectionPlate=function(t,e,r){j(this,t,r);var n=D.default.obj2scaled(this.b.center,r);return e.circle(n.x,n.y,.8*r.atomSelectionPlateRadius).attr(r.selectionStyle)},o.prototype.show=function(t,e,r){var n=t.render,o=t.molecule,i=n.paper,a=o.halfBonds.get(this.b.hb1),s=o.halfBonds.get(this.b.hb2);d(e,this,t),j(this,t,r),E(this,o),this.path=p(t,this,a,s),this.rbb=I.default.relBox(this.path.getBBox()),t.addReObjectPath("data",this.visel,this.path,null,!0);var u={};u.path=S(n,this,a,s),u.path&&(u.rbb=I.default.relBox(u.path.getBBox()),t.addReObjectPath("data",this.visel,u.path,null,!0));var l={};l.path=O(n,this,a,s),l.path&&(l.rbb=I.default.relBox(l.path.getBBox()),t.addReObjectPath("data",this.visel,l.path,null,!0)),this.setHighlight(this.highlight,n);var c=null,f=.6*r.subFontSize;r.showBondIds&&(c=A(e,i,a,s,f,.5,.5,a.norm),t.addReObjectPath("indices",this.visel,c)),r.showHalfBondIds&&(c=A(this.b.hb1,i,a,s,f,.8,.2,a.norm),t.addReObjectPath("indices",this.visel,c),c=A(this.b.hb2,i,a,s,f,.2,.8,s.norm),t.addReObjectPath("indices",this.visel,c)),r.showLoopIds&&!r.showBondIds&&(c=A(a.loop,i,a,s,f,.5,.5,s.norm),t.addReObjectPath("indices",this.visel,c),c=A(s.loop,i,a,s,f,.5,.5,a.norm),t.addReObjectPath("indices",this.visel,c))},r.default=o},{"../../chem/struct":537,"../../util/scale":685,"../../util/vec2":686,"../draw":585,"../util":601,"./reobject":595}],591:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.init("chiralFlag"),this.pp=t}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/box2abs"),a=n(i),s=t("../../util/scale"),u=n(s),l=t("./reobject"),c=n(l);o.prototype=new c.default,o.isSelectable=function(){return!0},o.prototype.highlightPath=function(t){var e=a.default.fromRelBox(this.path.getBBox()),r=e.p1.sub(e.p0),n=e.p0.sub(t.options.offset);return t.paper.rect(n.x,n.y,r.x,r.y)},o.prototype.drawHighlight=function(t){if(!this.path)return null;var e=this.highlightPath(t).attr(t.options.highlightStyle);return t.ctab.addReObjectPath("highlighting",this.visel,e),e},o.prototype.makeSelectionPlate=function(t,e,r){return this.path?this.highlightPath(t.render).attr(r.selectionStyle):null},o.prototype.show=function(t,e,r){var n=t.render;if(!(t.chiralFlagsChanged[e]<=0)){var o=n.paper,i=u.default.obj2scaled(this.pp,r);this.path=o.text(i.x,i.y,"Chiral").attr({font:r.font,"font-size":r.fontsz,fill:"#000"}),n.ctab.addReObjectPath("data",this.visel,this.path,null,!0)}},r.default=o},{"../../util/box2abs":682,"../../util/scale":685,"./reobject":595}],592:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.init("sgroupData"),this.sgroup=t}Object.defineProperty(r,"__esModule",{value:!0});var i=t("./reobject"),a=n(i),s=t("../../util/scale"),u=n(s);o.prototype=new a.default,o.isSelectable=function(){return!0},o.prototype.highlightPath=function(t){var e=this.sgroup.dataArea,r=u.default.obj2scaled(e.p0,t.options),n=u.default.obj2scaled(e.p1,t.options).sub(r);return t.paper.rect(r.x,r.y,n.x,n.y)},o.prototype.drawHighlight=function(t){var e=this.highlightPath(t).attr(t.options.highlightStyle);return t.ctab.addReObjectPath("highlighting",this.visel,e),e},o.prototype.makeSelectionPlate=function(t,e,r){return this.highlightPath(t.render).attr(r.selectionStyle)},r.default=o},{"../../util/scale":685,"./reobject":595}],593:[function(f,t,d){(function(a){"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t){this.init("frag"),this.item=t}Object.defineProperty(d,"__esModule",{value:!0});var r=f("../../util/box2abs"),s=t(r),n=f("../../util/vec2"),u=t(n),o=f("./reobject"),i=t(o),l=f("../../util/scale"),c=t(l);e.prototype=new i.default,e.isSelectable=function(){return!1},e.prototype.fragGetAtoms=function(e,r){return Array.from(e.atoms.keys()).filter(function(t){return e.atoms.get(t).a.fragment===r})},e.prototype.fragGetBonds=function(o,i){return Array.from(o.bonds.keys()).filter(function(t){var e=o.bonds.get(t).b,r=o.atoms.get(e.begin).a.fragment,n=o.atoms.get(e.end).a.fragment;return r===i&&n===i})},e.prototype.calcBBox=function(t,n,o){var i;return t.atoms.forEach(function(t){if(t.a.fragment===n){var e=t.visel.boundingBox;if(e)o||(o=a._ui_editor.render),e=e.translate((o.options.offset||new u.default).negated()).transform(c.default.scaled2obj,o.options);else{e=new s.default(t.a.pp,t.a.pp);var r=new u.default(.05*3,.05*3);e=e.extend(r,r)}i=i?s.default.union(i,e):e}}),i},e.prototype._draw=function(t,e,r){var n=this.calcBBox(t.ctab,e,t);if(n){var o=c.default.obj2scaled(new u.default(n.p0.x,n.p0.y),t.options),i=c.default.obj2scaled(new u.default(n.p1.x,n.p1.y),t.options);return t.paper.rect(o.x,o.y,i.x-o.x,i.y-o.y,0).attr(r)}return console.assert(null,"Empty fragment")},e.prototype.draw=function(t){return null},e.prototype.drawHighlight=function(t){},e.prototype.setHighlight=function(e,r){var n=r.ctab.frags.keyOf(this);if(!n&&0!==n)return void console.warn("Fragment does not belong to the render");n=parseInt(n,10),r.ctab.atoms.forEach(function(t){t.a.fragment===n&&t.setHighlight(e,r)}),r.ctab.bonds.forEach(function(t){r.ctab.atoms.get(t.b.begin).a.fragment===n&&t.setHighlight(e,r)})},d.default=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../util/box2abs":682,"../../util/scale":685,"../../util/vec2":686,"./reobject":595}],594:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.loop=t,this.visel=new s.default("loop"),this.centre=new _.default,this.radius=new _.default}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/vec2"),_=n(i),a=t("./visel"),s=n(a),u=t("./reobject"),l=n(u),c=t("../../util/scale"),x=n(c),f=t("../util"),d=n(f),w=t("../../chem/struct"),S=d.default.tfx;o.prototype=new l.default,o.isSelectable=function(){return!1},o.prototype.show=function(a,t,s){var u=this,e=a.render,r=e.paper,l=a.molecule,o=this.loop;this.centre=new _.default,o.hbs.forEach(function(t){var e=l.halfBonds.get(t),r=a.bonds.get(e.bid),n=x.default.obj2scaled(a.atoms.get(e.begin).a.pp,s);r.b.type!==w.Bond.PATTERN.TYPE.AROMATIC&&(o.aromatic=!1),u.centre.add_(n)}),o.convex=!0;for(var n=0;n<this.loop.hbs.length;++n){var i=l.halfBonds.get(o.hbs[n]),c=l.halfBonds.get(o.hbs[(n+1)%o.hbs.length]),f=Math.atan2(_.default.cross(i.dir,c.dir),_.default.dot(i.dir,c.dir));f>0&&(o.convex=!1)}if(this.centre=this.centre.scaled(1/o.hbs.length),this.radius=-1,o.hbs.forEach(function(t){var e=l.halfBonds.get(t),r=x.default.obj2scaled(a.atoms.get(e.begin).a.pp,s),n=x.default.obj2scaled(a.atoms.get(e.end).a.pp,s),o=_.default.diff(n,r).rotateSC(1,0).normalized(),i=_.default.dot(_.default.diff(r,u.centre),o);u.radius=u.radius<0?i:Math.min(u.radius,i)}),this.radius*=.7,o.aromatic){var d=null;if(o.convex&&s.aromaticCircle)d=r.circle(this.centre.x,this.centre.y,this.radius).attr({stroke:"#000","stroke-width":s.lineattr["stroke-width"]});else{var p="";for(n=0;n<o.hbs.length;++n){i=l.halfBonds.get(o.hbs[n]),c=l.halfBonds.get(o.hbs[(n+1)%o.hbs.length]),f=Math.atan2(_.default.cross(i.dir,c.dir),_.default.dot(i.dir,c.dir));var h=(Math.PI-f)/2,m=c.dir.rotate(h),g=x.default.obj2scaled(a.atoms.get(c.begin).a.pp,s),v=Math.sin(h);Math.abs(v)<.1&&(v=.1*v/Math.abs(v));var y=s.bondSpace/v,b=g.addScaled(m,-y);p+=0===n?"M":"L",p+=S(b.x)+","+S(b.y)}p+="Z",d=r.path(p).attr({stroke:"#000","stroke-width":s.lineattr["stroke-width"],"stroke-dasharray":"- "})}a.addReObjectPath("data",this.visel,d,null,!0)}},o.prototype.isValid=function(t,e){var r=t.halfBonds;return this.loop.hbs.every(function(t){return r.has(t)&&r.get(t).loop===e})},r.default=o},{"../../chem/struct":537,"../../util/scale":685,"../../util/vec2":686,"../util":601,"./reobject":595,"./visel":600}],595:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(){}Object.defineProperty(r,"__esModule",{value:!0});var i=t("./visel"),a=n(i),s=t("../../util/scale"),u=n(s);o.prototype.init=function(t){this.visel=new a.default(t),this.highlight=!1,this.highlighting=null,this.selected=!1,this.selectionPlate=null},o.prototype.getVBoxObj=function(t){var e=this.visel.boundingBox;return null===e?null:(t.options.offset&&(e=e.translate(t.options.offset.negated())),e.transform(u.default.scaled2obj,t.options))},o.prototype.setHighlight=function(t,e){if(t){var r="highlighting"in this&&null!==this.highlighting;if(r)if("set"===this.highlighting.type){if(!this.highlighting[0])return;r=!this.highlighting[0].removed}else r=!this.highlighting.removed;r?this.highlighting.show():(e.paper.setStart(),this.drawHighlight(e),this.highlighting=e.paper.setFinish())}else this.highlighting&&this.highlighting.hide();this.highlight=t},o.prototype.drawHighlight=function(){console.assert("ReObject.drawHighlight is not overridden")},o.prototype.makeSelectionPlate=function(){console.assert(null,"ReObject.makeSelectionPlate is not overridden")},r.default=o},{"../../util/scale":685,"./visel":600}],596:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.init("rgroup"),this.labelBox=null,this.item=t}function v(t,e,r,n){n=x.default.obj2scaled(n||new l.default(1,0),e.options);var o=Math.min(.25,.3*r.sz().x),i=r.p1.y-r.p0.y,a=.5*(r.p1.y+r.p0.y),s=c.default.bracket(e.paper,n.negated(),n.negated().rotateSC(1,0),x.default.obj2scaled(new l.default(r.p0.x,a),e.options),o,i,e.options),u=c.default.bracket(e.paper,n,n.rotateSC(1,0),x.default.obj2scaled(new l.default(r.p1.x,a),e.options),o,i,e.options);return t.push(s,u)}function y(t,e){var r=e.ifthen>0?"IF ":"",n=e.range.startsWith(">")||e.range.startsWith("<")||e.range.startsWith("="),o=null;o=e.range.length>0?n?e.range:"="+e.range:">0";var i=e.resth?" (RestH)":"",a=e.ifthen>0?"\nTHEN R"+e.ifthen.toString():"";return r+"R"+t.toString()+o+i+a}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/box2abs"),b=n(i),a=t("../../util/vec2"),l=n(a),s=t("../util"),_=n(s),u=t("../draw"),c=n(u),f=t("../../util/scale"),x=n(f),d=t("./reobject"),p=n(d),h=new l.default(.05*3,.05*3);o.prototype=new p.default,o.isSelectable=function(){return!1},o.prototype.getAtoms=function(e){var r=[];return this.item.frags.forEach(function(t){r=r.concat(e.ctab.frags.get(t).fragGetAtoms(e.ctab,t))}),r},o.prototype.getBonds=function(e){var r=[];return this.item.frags.forEach(function(t){r=r.concat(e.ctab.frags.get(t).fragGetBonds(e.ctab,t))}),r},o.prototype.calcBBox=function(r){var n=null;return this.item.frags.forEach(function(t){var e=r.ctab.frags.get(t).calcBBox(r.ctab,t,r);e&&(n=n?b.default.union(n,e):e)}),n&&(n=n.extend(h,h)),n},o.prototype.draw=function(t,e){var r=this.calcBBox(t);if(!r)return console.error("Abnormal situation, empty fragments must be destroyed by tools"),{};var n={data:[]},o=x.default.obj2scaled(r.p0,e),i=x.default.obj2scaled(r.p1,e),a=t.paper.set();v(a,t,r),n.data.push(a);var s=t.ctab.rgroups.keyOf(this),u=t.paper.set(),l=t.paper.text(o.x,(o.y+i.y)/2,"R"+s+"=").attr({font:e.font,"font-size":e.fontRLabel,fill:"black"}),c=_.default.relBox(l.getBBox());l.translateAbs(-c.width/2-e.lineWidth,0),u.push(l);for(var f={font:e.font,"font-size":e.fontRLogic,fill:"black"},d=[y(s,this.item)],p=c.height/2+e.lineWidth/2,h=0;h<d.length;++h){var m=t.paper.text(o.x,(o.y+i.y)/2,d[h]).attr(f),g=_.default.relBox(m.getBBox());p+=g.height/2,m.translateAbs(-g.width/2-6*e.lineWidth,p),p+=g.height/2+e.lineWidth/2,n.data.push(m),u.push(m)}return n.data.push(l),this.labelBox=b.default.fromRelBox(u.getBBox()).transform(x.default.scaled2obj,t.options),n},o.prototype._draw=function(t,e,r){var n=this.getVBoxObj(t).extend(h,h);if(!n)return null;var o=x.default.obj2scaled(n.p0,t.options),i=x.default.obj2scaled(n.p1,t.options);return t.paper.rect(o.x,o.y,i.x-o.x,i.y-o.y,0).attr(r)},o.prototype.drawHighlight=function(r){var t=r.ctab.rgroups.keyOf(this);if(!t)return console.error("Abnormal situation, fragment does not belong to the render"),null;var e=this._draw(r,t,r.options.highlightStyle);return r.ctab.addReObjectPath("highlighting",this.visel,e),this.item.frags.forEach(function(t,e){r.ctab.frags.get(e).drawHighlight(r)}),e},o.prototype.show=function(e,t,r){var n=this,o=this.draw(e.render,r);Object.keys(o).forEach(function(t){for(;o[t].length>0;)e.addReObjectPath(t,n.visel,o[t].shift(),null,!0)})},r.default=o},{"../../util/box2abs":682,"../../util/scale":685,"../../util/vec2":686,"../draw":585,"../util":601,"./reobject":595}],597:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.init("rxnArrow"),this.item=t}Object.defineProperty(r,"__esModule",{value:!0});var i=t("./reobject"),a=n(i),s=t("../../util/box2abs"),u=n(s),l=t("../../util/vec2"),c=n(l),f=t("../draw"),d=n(f),p=t("../util"),h=n(p),m=t("../../util/scale"),g=n(m);o.prototype=new a.default,o.isSelectable=function(){return!0},o.prototype.highlightPath=function(t){var e=g.default.obj2scaled(this.item.pp,t.options),r=t.options.scale;return t.paper.rect(e.x-r,e.y-r/4,2*r,r/2,r/8)},o.prototype.drawHighlight=function(t){var e=this.highlightPath(t).attr(t.options.highlightStyle);return t.ctab.addReObjectPath("highlighting",this.visel,e),e},o.prototype.makeSelectionPlate=function(t,e,r){return this.highlightPath(t.render).attr(r.selectionStyle)},o.prototype.show=function(t,e,r){var n=t.render,o=g.default.obj2scaled(this.item.pp,r),i=d.default.arrow(n.paper,new c.default(o.x-r.scale,o.y),new c.default(o.x+r.scale,o.y),r),a=r.offset;null!=a&&i.translateAbs(a.x,a.y),this.visel.add(i,u.default.fromRelBox(h.default.relBox(i.getBBox())))},r.default=o},{"../../util/box2abs":682,"../../util/scale":685,"../../util/vec2":686,"../draw":585,"../util":601,"./reobject":595}],598:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.init("rxnPlus"),this.item=t}Object.defineProperty(r,"__esModule",{value:!0});var i=t("./reobject"),a=n(i),s=t("../../util/box2abs"),u=n(s),l=t("../draw"),c=n(l),f=t("../util"),d=n(f),p=t("../../util/scale"),h=n(p);o.prototype=new a.default,o.isSelectable=function(){return!0},o.prototype.highlightPath=function(t){var e=h.default.obj2scaled(this.item.pp,t.options),r=t.options.scale;return t.paper.rect(e.x-r/4,e.y-r/4,r/2,r/2,r/8)},o.prototype.drawHighlight=function(t){var e=this.highlightPath(t).attr(t.options.highlightStyle);return t.ctab.addReObjectPath("highlighting",this.visel,e),e},o.prototype.makeSelectionPlate=function(t,e,r){return this.highlightPath(t.render).attr(r.selectionStyle)},o.prototype.show=function(t,e,r){var n=t.render,o=h.default.obj2scaled(this.item.pp,r),i=c.default.plus(n.paper,o,r),a=r.offset;null!=a&&i.translateAbs(a.x,a.y),this.visel.add(i,u.default.fromRelBox(d.default.relBox(i.getBBox())))},r.default=o},{"../../util/box2abs":682,"../../util/scale":685,"../draw":585,"../util":601,"./reobject":595}],599:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.init("sgroup"),this.item=t}function c(a,s,t,e,r,n,o,i,u,l){function c(t,e){var r=S.default.obj2scaled(g.c.addScaled(g.n,e*g.h),s.options),n=s.paper.text(r.x,r.y,t).attr({font:s.options.font,"font-size":s.options.fontszsub});l&&n.attr(l);var o=y.default.fromRelBox(x.default.relBox(n.getBBox())),i=Math.max(x.default.shiftRayBox(r,g.d.negated(),o),3)+2;n.translateAbs(i*g.d.x,i*g.d.y),a.push(n)}for(var f=v(s.ctab.molecule,e,r,n,o,s,t.id),d=-1,p=0;p<f.length;++p){var h=f[p],m=E.default.bracket(s.paper,S.default.obj2scaled(h.d,s.options),S.default.obj2scaled(h.n,s.options),S.default.obj2scaled(h.c,s.options),h.w,h.h,s.options);a.push(m),(d<0||f[d].d.x<h.d.x||f[d].d.x==h.d.x&&f[d].d.y>h.d.y)&&(d=p)}var g=f[d];i&&c(i,.5),u&&c(u,-.5)}function p(t,e,r,n){var o=t.text(e.x,e.y,r.data.fieldValue).attr({font:n.font,"font-size":n.fontsz}),i=o.getBBox(),a=t.rect(i.x-1,i.y-1,i.width+2,i.height+2,3,3);a=r.selected?a.attr(n.selectionStyle):a.attr({fill:"#fff",stroke:"#fff"});var s=t.set();return s.push(a,o.toFront()),s}function f(t,e){return d(e,t.render,t.molecule),e.areas=e.bracketBox?[e.bracketBox]:[],null===e.pp&&(e.pp=i(t,e)),e.data.attached?u(t,e):s(t,e)}function i(t,e){for(var r=e.bracketBox.p1.add(new _.default(.5,.5)),n=Array.from(t.molecule.sgroups.values()),o=0;o<t.molecule.sgroups.size&&a(n,r);++o)r=r.add(new _.default(0,.5));return r}function a(t,n){return t.some(function(t){if(!t.pp)return!1;var e=t.pp.add(new _.default(.5,.5)),r=n.add(new _.default(.5,.5));return y.default.segmentIntersection(t.pp,e,n,r)})}function s(t,e){var r=t.render,n=r.options,o=r.paper,i=o.set(),a=e.pp.scaled(n.scale),s=p(o,a,e,n),u=x.default.relBox(s.getBBox());s.translateAbs(.5*u.width,-.5*u.height),i.push(s);var l=y.default.fromRelBox(x.default.relBox(s.getBBox()));return e.dataArea=l.transform(S.default.scaled2obj,r.options),t.sgroupData.has(e.id)||t.sgroupData.set(e.id,new P.default(e)),i}function u(s,u){var l=s.render,c=l.options,f=l.paper,d=f.set();return O.SGroup.getAtoms(s,u).forEach(function(t){var e=s.atoms.get(t),r=S.default.obj2scaled(e.a.pp,c),n=e.visel.boundingBox;null!==n&&(r.x=Math.max(r.x,n.p1.x)),r.x+=c.lineWidth;var o=p(f,r,u,c),i=x.default.relBox(o.getBBox());o.translateAbs(.5*i.width,-.3*i.height),d.push(o);var a=y.default.fromRelBox(x.default.relBox(o.getBBox()));a=a.transform(S.default.scaled2obj,l.options),u.areas.push(a)}),d}function d(t,i,a,e){var r=t.atoms;if(e&&2===e.length){var n=a.bonds.get(e[0]).getCenter(a),o=a.bonds.get(e[1]).getCenter(a);t.bracketDir=_.default.diff(o,n).normalized()}else t.bracketDir=new _.default(1,0);var s=t.bracketDir,u=null,l=[];r.forEach(function(t){var e=a.atoms.get(t),r=i?i.ctab.atoms.get(t).visel.boundingBox:null;if(r)r=r.translate((i.options.offset||new _.default).negated()).transform(S.default.scaled2obj,i.options);else{var n=new _.default(e.pp),o=new _.default(.05*3,.05*3);r=new y.default(n,n).extend(o,o)}l.push(r)}),a.sGroupForest.children.get(t.id).forEach(function(t){var e=i.ctab.sgroups.get(t).visel.boundingBox;e=e.translate((i.options.offset||new _.default).negated()).transform(S.default.scaled2obj,i.options),l.push(e)}),l.forEach(function(t){var o=null;[t.p0.x,t.p1.x].forEach(function(n){[t.p0.y,t.p1.y].forEach(function(t){var e=new _.default(n,t),r=new _.default(_.default.dot(e,s),_.default.dot(e,s.rotateSC(1,0)));o=null===o?new y.default(r,r):o.include(r)})}),u=null===u?o:y.default.union(u,o)});var c=new _.default(.2,.4);null!==u&&(u=u.extend(c,c)),t.bracketBox=u}function v(h,m,o,i,a,g,v){function y(t,e,r,n){this.c=t,this.d=e,this.n=e.rotateSC(1,0),this.w=r,this.h=n}var b=[],s=a.rotateSC(1,0);return m.length<2?function(){a=a||new _.default(1,0),s=s||a.rotateSC(1,0);var t=Math.min(.25,.3*i.sz().x),e=_.default.lc2(a,i.p0.x,s,.5*(i.p0.y+i.p1.y)),r=_.default.lc2(a,i.p1.x,s,.5*(i.p0.y+i.p1.y)),n=i.sz().y;b.push(new y(e,a.negated(),t,n),new y(r,a,t,n))}():2===m.length?function(){var t=h.bonds.get(m[0]),e=h.bonds.get(m[1]),r=t.getCenter(h),n=e.getCenter(h),o=-1,i=-1,a=-1,s=-1,u=_.default.centre(r,n),l=_.default.diff(n,r).normalized(),c=l.negated(),f=l.rotateSC(1,0),d=f.negated();h.sGroupForest.children.get(v).forEach(function(t){var e=g.ctab.sgroups.get(t).visel.boundingBox;e=e.translate((g.options.offset||new _.default).negated()).transform(S.default.scaled2obj,g.options),o=Math.max(o,x.default.shiftRayBox(r,c,e)),i=Math.max(i,x.default.shiftRayBox(n,l,e)),a=Math.max(a,x.default.shiftRayBox(u,f,e)),s=Math.max(s,x.default.shiftRayBox(u,d,e))},this),o=Math.max(o+.2,0),i=Math.max(i+.2,0),a=Math.max(Math.max(a,s)+.1,0);var p=1.5+a;b.push(new y(r.addScaled(c,o),c,.25,p),new y(n.addScaled(l,i),l,.25,p))}():function(){for(var t=0;t<m.length;++t){var e=h.bonds.get(m[t]),r=e.getCenter(h),n=o.has(e.begin)?e.getDir(h):e.getDir(h).negated();b.push(new y(r,n,.2,1))}}(),b}Object.defineProperty(r,"__esModule",{value:!0});var l=t("../../util/box2abs"),y=n(l),h=t("../../util/vec2"),_=n(h),m=t("../../util/pile"),g=n(m),b=t("../util"),x=n(b),w=t("../../util/scale"),S=n(w),O=t("../../chem/struct"),A=t("../draw"),E=n(A),j=t("./redatasgroupdata"),P=n(j),T=t("./reobject"),C=n(T),k=x.default.tfx;o.prototype=new C.default,o.isSelectable=function(){return!1},o.prototype.draw=function(t,e){var r=t.render,n=r.paper.set(),o=[],i=[],a=new g.default(e.atoms);O.SGroup.getCrossBonds(o,i,t.molecule,a),d(e,r,t.molecule,i);var s=e.bracketBox,u=e.bracketDir;switch(e.areas=[s],e.type){case"MUL":c(n,r,e,i,a,s,u,e.data.mul);break;case"SRU":var l=e.data.connectivity||"eu";"ht"==l&&(l="");c(n,r,e,i,a,s,u,e.data.subscript||"n",l);break;case"SUP":c(n,r,e,i,a,s,u,e.data.name,null,{"font-style":"italic"});break;case"GEN":c(n,r,e,i,a,s,u);break;case"DAT":n=f(t,e)}return n},o.prototype.drawHighlight=function(e){var t=e.options,r=e.paper,n=this.item,o=n.bracketBox.transform(S.default.obj2scaled,t),i=t.lineWidth,a=new _.default(4*i,6*i);o=o.extend(a,a);var s=n.bracketDir,u=s.rotateSC(1,0),l=_.default.lc2(s,o.p0.x,u,o.p0.y),c=_.default.lc2(s,o.p0.x,u,o.p1.y),f=_.default.lc2(s,o.p1.x,u,o.p0.y),d=_.default.lc2(s,o.p1.x,u,o.p1.y),p=r.set();n.highlighting=r.path("M{0},{1}L{2},{3}L{4},{5}L{6},{7}L{0},{1}",k(l.x),k(l.y),k(c.x),k(c.y),k(d.x),k(d.y),k(f.x),k(f.y)).attr(t.highlightStyle),p.push(n.highlighting),O.SGroup.getAtoms(e.ctab.molecule,n).forEach(function(t){p.push(e.ctab.atoms.get(t).makeHighlightPlate(e))},this),O.SGroup.getBonds(e.ctab.molecule,n).forEach(function(t){p.push(e.ctab.bonds.get(t).makeHighlightPlate(e))},this),e.ctab.addReObjectPath("highlighting",this.visel,p)},o.prototype.show=function(t){var e=t.render,r=this.item;if("MRV_IMPLICIT_H"!==r.data.fieldName){var n=e.ctab,o=this.draw(n,r);t.addReObjectPath("data",this.visel,o,null,!0),this.setHighlight(this.highlight,e)}},r.default=o},{"../../chem/struct":537,"../../util/box2abs":682,"../../util/pile":683,"../../util/scale":685,"../../util/vec2":686,"../draw":585,"../util":601,"./redatasgroupdata":592,"./reobject":595}],600:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){this.type=t,this.paths=[],this.boxes=[],this.boundingBox=null}Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../util/box2abs"),a=n(i),s=t("../../util/vec2"),u=n(s);o.prototype.add=function(t,e,r){this.paths.push(t),e&&(this.boxes.push(e),this.boundingBox=null==this.boundingBox?e:a.default.union(this.boundingBox,e)),r&&this.exts.push(r)},o.prototype.clear=function(){this.paths=[],this.boxes=[],this.exts=[],this.boundingBox=null},o.prototype.translate=function(t,e){if(arguments.length>2)throw new Error("One vector or two scalar arguments expected");if(void 0===e)this.translate(t.x,t.y);else{for(var r=new u.default(t,e),n=0;n<this.paths.length;++n)this.paths[n].translateAbs(t,e);for(var o=0;o<this.boxes.length;++o)this.boxes[o]=this.boxes[o].translate(r);null!==this.boundingBox&&(this.boundingBox=this.boundingBox.translate(r))}},r.default=o},{"../../util/box2abs":682,"../../util/vec2":686}],601:[function(t,e,r){"use strict";function n(t){return parseFloat(t).toFixed(8)}function o(t){return{x:t.x,y:t.y,width:t.width,height:t.height}}function i(e,r,t){console.assert(!!e),console.assert(!!r),console.assert(!!t);var n=[t.p0,new d.default(t.p1.x,t.p0.y),t.p1,new d.default(t.p0.x,t.p1.y)],o=n.map(function(t){return t.sub(e)});r=r.normalized();for(var i=o.map(function(t){return d.default.cross(t,r)}),a=o.map(function(t){return d.default.dot(t,r)}),s=-1,u=-1,l=0;l<4;++l)i[l]>0?(s<0||a[s]<a[l])&&(s=l):(u<0||a[u]<a[l])&&(u=l);if(u<0||s<0)return 0;var c=a[s]>a[u]?u:s,f=a[s]>a[u]?s:u;return a[c]+Math.abs(i[c])*(a[f]-a[c])/(Math.abs(i[c])+Math.abs(i[f]))}Object.defineProperty(r,"__esModule",{value:!0});var a=t("../util/vec2"),d=function(t){return t&&t.__esModule?t:{default:t}}(a);r.default={tfx:n,relBox:o,shiftRayBox:i}},{"../util/vec2":686}],602:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(r.basic=["H","C","N","O","S","P","F","Cl","Br","I"],r.atomCuts={H:"h",C:"c",N:"n",O:"o",S:"s",P:"p",F:"f",Cl:"Shift+c",Br:"Shift+b",I:"i",A:"a"});r.default=Object.keys(n).reduce(function(t,e){return t["atom-"+e.toLowerCase()]={title:"Atom "+e,shortcut:n[e],action:{tool:"atom",opts:{label:e}}},t},{})},{}],603:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../../chem/molfile"),o=function(t){return t&&t.__esModule?t:{default:t}}(n);r.default={"force-update":{shortcut:"Ctrl+Shift+r",action:function(t){t.update(!0)}},"qs-serialize":{shortcut:"Alt+Shift+r",action:function(t){var e=o.default.stringify(t.struct()),r="mol="+encodeURIComponent(e).replace(/%20/g,"+"),n=document.location.search;document.location.search=n?-1===n.search("mol=")?n+"&"+r:n.replace(/mol=[^&$]*/,r):"?"+r}}}},{"../../chem/molfile":523}],604:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=t.selection();return e&&(Object.keys(e).length>1||!e.sgroupData)}function i(t){alert("此操作无法通过菜单执行.\n请使用快捷键 "+t+".")}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},s=t("./tools"),u=n(s),l=t("./atoms"),c=n(l),f=t("./zoom"),d=n(f),p=t("./server"),h=n(p),m=t("./debug"),g=n(m),v=t("./templates"),y=n(v),b=t("../component/cliparea");r.default=a({new:{shortcut:"Mod+Delete",title:"清空画布",action:{thunk:function(t,e){var r=e().editor;r.struct().isBlank()||r.struct(null),t({type:"ACTION",action:u.default["select-lasso"].action})}}},open:{shortcut:"Mod+o",title:"打开",action:{dialog:"open"}},save:{shortcut:"Mod+s",title:"另存为",action:{dialog:"save"}},undo:{shortcut:"Mod+z",title:"撤销",action:function(t){t.undo()},disabled:function(t){return 0===t.historySize().undo}},redo:{shortcut:["Mod+Shift+z","Mod+y"],title:"恢复",action:function(t){t.redo()},disabled:function(t){return 0===t.historySize().redo}},cut:{shortcut:"Mod+x",title:"剪切",action:function(){(0,b.exec)("cut")||i("剪切")},disabled:function(t){return!o(t)}},copy:{shortcut:"Mod+c",title:"复制",action:function(){(0,b.exec)("copy")||i("复制")},disabled:function(t){return!o(t)}},paste:{shortcut:"Mod+v",title:"粘贴",action:function(){(0,b.exec)("paste")||i("粘贴")},selected:function(t){var e=t.actions;return e&&e.active&&"paste"===e.active.tool}},settings:{title:"Settings",action:{dialog:"settings"}},help:{shortcut:["?","&","Shift+/"],title:"Help",action:{dialog:"help"}},about:{title:"About",action:{dialog:"about"}},"reaction-automap":{title:"Reaction Auto-Mapping Tool",action:{dialog:"automap"},disabled:function(t,e,r){return!r.app.server||!t.struct().hasRxnArrow()}},"period-table":{title:"元素周期表",action:{dialog:"period-table"}},"select-all":{title:"Select All",shortcut:"Mod+a",action:{thunk:function(t,e){e().editor.selection("all");var r=e().toolbar.visibleTools.select;t({type:"ACTION",action:u.default[r].action})}}},"deselect-all":{title:"Deselect All",shortcut:"Mod+Shift+a",action:function(t){t.selection(null)}},"select-descriptors":{title:"Select descriptors",shortcut:"Mod+d",action:{thunk:function(t,e){var r=e().toolbar.visibleTools.select,n=e().editor;n.alignDescriptors(),n.selection("descriptors"),t({type:"ACTION",action:u.default[r].action})}}}},h.default,g.default,u.default,c.default,d.default,y.default)},{"../component/cliparea":615,"./atoms":602,"./debug":603,"./server":605,"./templates":606,"./tools":607,"./zoom":608}],605:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../state/server");r.default={layout:{shortcut:"Mod+l",title:"Layout",action:{thunk:(0,n.serverTransform)("layout")},disabled:function(t,e,r){return!r.app.server}},clean:{shortcut:"Mod+Shift+l",title:"Clean Up",action:{thunk:(0,n.serverTransform)("clean")},disabled:function(t,e,r){return!r.app.server}},arom:{title:"Aromatize",action:{thunk:(0,n.serverTransform)("aromatize")},disabled:function(t,e,r){return!r.app.server}},dearom:{title:"Dearomatize",action:{thunk:(0,n.serverTransform)("dearomatize")},disabled:function(t,e,r){return!r.app.server}},cip:{shortcut:"Mod+p",title:"Calculate CIP",action:{thunk:(0,n.serverTransform)("calculateCip")},disabled:function(t,e,r){return!r.app.server}},check:{title:"Check Structure",action:{dialog:"check"},disabled:function(t,e,r){return!r.app.server}},analyse:{title:"Calculated Values",action:{dialog:"analyse"},disabled:function(t,e,r){return!r.app.server}},recognize:{title:"Recognize Molecule",action:{dialog:"recognize"},disabled:function(t,e,r){return!r.app.server}},miew:{title:"3D Viewer",action:{dialog:"miew"},disabled:function(){return!window.Miew}}}},{"../state/server":676}],606:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../data/templates"),o=function(t){return t&&t.__esModule?t:{default:t}}(n),i={"template-lib":{shortcut:"Shift+t",title:"自定义模板",action:{dialog:"templates"},disabled:function(t,e,r){return!r.app.templates}}};r.default=o.default.reduce(function(t,e,r){return t["template-"+r]={title:""+e.name,shortcut:"t",action:{tool:"template",opts:{struct:e}}},t},i)},{"../data/templates":643}],607:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../data/schema/struct-schema"),o=t("../data/convert/structconv"),i={"select-lasso":{title:"套索选取",shortcut:"Escape",action:{tool:"select",opts:"lasso"}},"select-rectangle":{title:"矩形选取",shortcut:"Escape",action:{tool:"select",opts:"rectangle"}},"select-fragment":{title:"片段选取",shortcut:"Escape",action:{tool:"select",opts:"fragment"}},erase:{title:"清除",shortcut:["Delete","Backspace"],action:{tool:"eraser",opts:1}},chain:{title:"碳链",action:{tool:"chain"}},"chiral-flag":{title:"手性标识",action:{tool:"chiralFlag"},selected:function(t){return t.struct().isChiral}},"charge-plus":{shortcut:"5",title:"正电荷",action:{tool:"charge",opts:1}},"charge-minus":{shortcut:"5",title:"负电荷",action:{tool:"charge",opts:-1}},"transform-rotate":{shortcut:"Alt+r",title:"旋转工具",action:{tool:"rotate"}},"transform-flip-h":{shortcut:"Alt+h",title:"水平翻转",action:{tool:"rotate",opts:"horizontal"}},"transform-flip-v":{shortcut:"Alt+v",title:"垂直翻转",action:{tool:"rotate",opts:"vertical"}},sgroup:{shortcut:"Mod+g",title:"S-组",action:{tool:"sgroup"}},"sgroup-data":{shortcut:"Mod+g",title:"S-组数据",action:{tool:"sgroup",opts:"DAT"}},"reaction-arrow":{title:"反应箭头工具",action:{tool:"reactionarrow"}},"reaction-plus":{title:"反应加号工具",action:{tool:"reactionplus"}},"reaction-map":{title:"反应映射工具",action:{tool:"reactionmap"}},"reaction-unmap":{title:"反应解映射工具",action:{tool:"reactionunmap"}},"rgroup-label":{shortcut:"Mod+r",title:"R-Group Label Tool",action:{tool:"rgroupatom"}},"rgroup-fragment":{shortcut:["Mod+Shift+r","Mod+r"],title:"R-Group Fragment Tool",action:{tool:"rgroupfragment"}},"rgroup-attpoints":{shortcut:"Mod+r",title:"Attachment Point Tool",action:{tool:"apoint"}}},a={single:"1",double:"2",triple:"3",up:"1",down:"1",updown:"1",crossed:"2",any:"0",aromatic:"4"},s=n.bond.properties.type;r.default=s.enum.reduce(function(t,e,r){return t["bond-"+e]={title:s.enumNames[r]+"键",shortcut:a[e],action:{tool:"bond",opts:(0,o.toBondType)(e)}},t},i)},{"../data/convert/structconv":637,"../data/schema/struct-schema":642}],608:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0}),r.zoomList=void 0;var o=t("lodash/fp/findLastIndex"),i=n(o),a=t("lodash/fp/findIndex"),s=n(a),u=r.zoomList=[.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.7,2,2.5,3,3.5,4];r.default={zoom:{selected:function(t){return t.zoom()}},"zoom-out":{shortcut:["-","_","Shift+-"],title:"缩小",disabled:function(t){return t.zoom()<=u[0]},action:function(t){var e=t.zoom(),r=(0,s.default)(function(t){return t>=e},u);t.zoom(u[u[r]===e&&r>0?r-1:r])}},"zoom-in":{shortcut:["+","=","Shift+="],title:"放大",disabled:function(t){return u[u.length-1]<=t.zoom()},action:function(t){var e=t.zoom(),r=(0,i.default)(function(t){return t<=e},u);t.zoom(u[u[r]===e&&r<u.length-1?r+1:r])}}}},{"lodash/fp/findIndex":424,"lodash/fp/findLastIndex":425}],609:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var o=t("preact-redux"),i=t("../state/editor"),a=n(i),s=t("../component/structeditor"),u=n(s),l=(0,o.connect)(function(t){return{options:t.options.settings}},function(t){return t(a.default)})(u.default);r.default=l},{"../component/structeditor":626,"../state/editor":669,"preact-redux":484}],610:[function(t,e,r){"use strict";function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0}),r.AppCliparea=r.AppHidden=void 0;var o=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),c=t("preact"),i=t("preact-redux"),a=t("../component/cliparea"),s=function(t){return t&&t.__esModule?t:{default:t}}(a),f=t("../state/toolbar"),d=t("../state/hotkeys"),p=t("../state/templates");r.AppHidden=(0,i.connect)(null,function(e){return{onInitTmpls:function(t){return(0,p.initTmplLib)(e,"",t)}}})(function(t){function s(){var t,e,r,n;u(this,s);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=r=l(this,(t=s.__proto__||Object.getPrototypeOf(s)).call.apply(t,[this].concat(i))),r.render=function(){return(0,c.h)("div",{className:"cellar",ref:function(t){r.cacheEl=t}})},n=e,l(r,n)}return n(s,t),o(s,[{key:"componentDidMount",value:function(){this.props.onInitTmpls(this.cacheEl),(0,f.initIcons)(this.cacheEl)}}]),s}(c.Component)),r.AppCliparea=(0,i.connect)(null,function(t){return t(d.initClipboard)})(s.default)},{"../component/cliparea":615,"../state/hotkeys":670,"../state/templates":678,"../state/toolbar":680,preact:485,"preact-redux":484}],611:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t,e,r){var n=(0,b.default)(e,r);return n.dispatch((0,x.initKeydownListener)(t)),n.dispatch((0,w.initResize)()),(0,c.render)((0,c.h)(s.Provider,{store:n},(0,c.h)(S,null)),t),{load:function(t,e){return n.dispatch((0,y.load)(t,e))}}}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),c=t("preact"),s=t("preact-redux"),f=t("./hidden"),d=t("./editor"),p=n(d),h=t("./modal"),m=n(h),g=t("./toolbar"),v=n(g),y=t("../state"),b=n(y),_=t("../state/server"),x=t("../state/hotkeys"),w=t("../state/toolbar"),S=(0,s.connect)(null,{onAction:y.onAction,checkServer:_.checkServer})(function(t){function s(){var t,e,r,n;u(this,s);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=r=l(this,(t=s.__proto__||Object.getPrototypeOf(s)).call.apply(t,[this].concat(i))),r.render=function(t){return(0,c.h)("main",{role:"application"},(0,c.h)(f.AppHidden,null),(0,c.h)(p.default,{id:"canvas"}),(0,c.h)(v.default,t),(0,c.h)(f.AppCliparea,null),(0,c.h)(m.default,null))},n=e,l(r,n)}return o(s,t),a(s,[{key:"componentDidMount",value:function(){this.props.checkServer()}}]),s}(c.Component));r.default=i},{"../state":671,"../state/hotkeys":670,"../state/server":676,"../state/toolbar":680,"./editor":609,"./hidden":610,"./modal":612,"./toolbar":613,preact:485,"preact-redux":484}],612:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}Object.defineProperty(r,"__esModule",{value:!0});var i=t("lodash/fp/omit"),a=n(i),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},u=t("preact"),l=t("preact-redux"),c=t("../dialog"),f=n(c),d=function(t){return{modal:t.modal}},p=function(e){return{onOk:function(t){e({type:"MODAL_CLOSE"})},onCancel:function(){e({type:"MODAL_CLOSE"})}}},h=function(t,e){var r=t.modal&&t.modal.prop,n=r?(0,a.default)(["onResult","onCancel"],r):{};return s({modal:t.modal},n,{onOk:function(t){r&&r.onResult&&r.onResult(t),e.onOk(t)},onCancel:function(){r&&r.onCancel&&r.onCancel(),e.onCancel()}})},m=(0,l.connect)(d,p,h)(function(t){var e=t.modal,r=o(t,["modal"]);if(!e)return null;var n=f.default[e.name];if(!n)throw new Error("There is no modal window named "+e.name);return(0,u.h)("div",{className:"ket-overlay"},(0,u.h)(n,r))});r.default=m},{"../dialog":646,"lodash/fp/omit":429,preact:485,"preact-redux":484}],613:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=t.status,r=t.onAction,n=e.zoom&&e.zoom.selected;return(0,l.h)("select",{value:n,onChange:function(e){return r(function(t){return t.zoom(parseFloat(e.target.value))})}},S.zoomList.map(function(t){return(0,l.h)("option",{value:t},(100*t).toFixed()+"%")}))}function i(t,e){var n=e.active,o=e.onAction,i=n&&"atom"===n.tool;return(0,l.h)("menu",null,t.map(function(t){var e=p.default.map[t],r=w.basic.indexOf(t)>-1?(0,y.shortcutStr)(w.atomCuts[t]):null;return(0,l.h)("li",{className:(0,f.default)({selected:i&&n.opts.label===t})},(0,l.h)(m.default,{el:p.default[e],shortcut:r,onClick:function(){return o({tool:"atom",opts:{label:t}})}}))}))}function a(t){var r=t.active,n=t.onAction,o=(0,y.shortcutStr)(x.default["template-0"].shortcut),i=r&&"template"===r.tool;return(0,l.h)("menu",null,A.default.map(function(t,e){return(0,l.h)("li",{id:"template-"+e,className:(0,f.default)({selected:i&&r.opts.struct===t})},(0,l.h)("button",{title:t.name+" ("+o+")",onClick:function(){return n({tool:"template",opts:{struct:t}})}},(0,l.h)(v.default,{name:"template-"+e}),t.name))}))}Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},u=t("preact-redux"),l=t("preact"),c=t("classnames"),f=n(c),d=t("../../chem/element"),p=n(d),h=t("../component/view/atom"),m=n(h),g=t("../component/view/icon"),v=n(g),y=t("../component/actionmenu"),b=n(y),_=t("../action"),x=n(_),w=t("../action/atoms"),S=t("../action/zoom"),O=t("../data/templates"),A=n(O),E=[{id:"document",menu:["new","open","save"]},{id:"edit",menu:["undo","redo","cut","copy","paste"]},{id:"zoom",menu:["zoom-in","zoom-out",{id:"zoom-list",component:o}]},{id:"meta",menu:["about"]}],j=[{id:"select",menu:["select-lasso","select-rectangle","select-fragment"]},"erase",{id:"bond",menu:[{id:"bond-common",menu:["bond-single","bond-double","bond-triple"]},{id:"bond-stereo",menu:["bond-up","bond-down","bond-updown","bond-crossed"]},{id:"bond-query",menu:["bond-any","bond-aromatic","bond-singledouble","bond-singlearomatic","bond-doublearomatic"]}]},"chain",{id:"charge",menu:["charge-plus","charge-minus"]},{id:"transform",menu:["transform-rotate","transform-flip-h","transform-flip-v"]},"sgroup","sgroup-data",{id:"reaction",menu:["reaction-arrow","reaction-plus","reaction-automap","reaction-map","reaction-unmap"]},{id:"rgroup",menu:["rgroup-label","rgroup-fragment","rgroup-attpoints"]}],P=[{id:"template-common",component:a},"template-lib","chiral-flag"],T=[{id:"atom",component:function(t){return i(w.basic,t)}},{id:"freq-atoms",component:function(t){return i(t.freqAtoms,t)}},"period-table"],C=[{id:"mainmenu",menu:E},{id:"toolbox",menu:j},{id:"template",menu:P},{id:"elements",menu:T}];r.default=(0,u.connect)(function(t){return{active:t.actionState&&t.actionState.activeTool,status:t.actionState||{},freqAtoms:t.toolbar.freqAtoms,opened:t.toolbar.opened,visibleTools:t.toolbar.visibleTools}},{onOpen:function(t,e){return{type:"OPENED",data:{menuName:t,isSelected:e}}}})(function(t){return(0,l.h)(b.default,s({menu:C,role:"toolbar"},t))})},{"../../chem/element":520,"../action":604,"../action/atoms":602,"../action/zoom":608,"../component/actionmenu":614,"../component/view/atom":629,"../component/view/icon":630,"../data/templates":643,classnames:2,preact:485,"preact-redux":484}],614:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function u(t){return(Array.isArray(t)?t[0]:t).replace(/(\b[a-z]\b$|Mod|Escape|Delete)/g,function(t){return S[t]||t.toUpperCase()})}function l(t){var e=(0,b.hiddenAncestor)(t);return e&&e.classList.contains("opened")}function s(t,e,r,n){return"object"!==(void 0===e?"undefined":p(e))?(0,h.h)(o,d({},n,{name:e,action:t[e],status:r})):e.menu?(0,h.h)(i,d({},n,{name:e.id,menu:e.menu})):e.component(n)}function o(t){var e=this,r=t.name,n=t.action,o=t.status,i=void 0===o?{}:o,a=t.onAction,s=n.shortcut&&u(n.shortcut);return(0,h.h)("button",{disabled:i.disabled,onClick:function(t){i.selected&&!l(e.base)&&"chiralFlag"!==n.action.tool||(a(n.action),t.stopPropagation())},title:s?n.title+" ("+s+")":n.title},(0,h.h)(x.default,{name:r}),n.title,(0,h.h)("kbd",null,s))}function i(t){var e=t.name,r=t.menu,n=t.className,o=t.role,i=a(t,["name","menu","className","role"]);return(0,h.h)("menu",{className:n,role:o,style:c(e,r,i.visibleTools)},r.map(function(t){return(0,h.h)("li",{id:t.id||t,className:(0,g.default)(i.status[t])+" "+(t.id===i.opened?"opened":""),onClick:function(t){return f(t,i.onOpen)}},s(y.default,t,i.status[t],i),t.menu&&(0,h.h)(x.default,{name:"dropdown"}))}))}function c(t,e,r){if(!r[t])return{};var n=32,o=e.indexOf(r[t]);if(-1===o){var i=[];e.forEach(function(t){i=i.concat(t.menu)}),o=i.indexOf(r[t])}return-1!==o?{marginTop:-n*o+"px"}:{}}function f(t,e){var r=(0,b.hiddenAncestor)(t.currentTarget),n=t.currentTarget.classList.contains("selected");e(r&&r.id,n),t.stopPropagation()}Object.defineProperty(r,"__esModule",{value:!0});var d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};r.shortcutStr=u,r.showMenuOrButton=s;var h=t("preact"),m=t("classnames"),g=n(m),v=t("../action"),y=n(v),b=t("../state/toolbar"),_=t("./view/icon"),x=n(_),w=/Mac/.test(navigator.platform),S={Escape:"Esc",Delete:"Del",Mod:w?"⌘":"Ctrl"};r.default=i},{"../action":604,"../state/toolbar":680,"./view/icon":630,classnames:2,preact:485}],615:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t){return("INPUT"!==t.tagName||"button"!==t.type)&&["INPUT","SELECT","TEXTAREA","OPTION","LABEL"].includes(t.tagName)}function s(t){t.value=" ",t.focus(),t.select()}function u(e,r){if(!e&&p)p.setData("text",r["text/plain"]);else{var n=null;e.setData("text/plain",r["text/plain"]);try{Object.keys(r).forEach(function(t){n=t,e.setData(t,r[t])})}catch(e){console.info("Could not write exact type "+n)}}}function l(n,t){var e={};return!n&&p?e["text/plain"]=p.getData("text"):(e["text/plain"]=n.getData("text/plain"),e=t.reduce(function(t,e){var r=n.getData(e);return r&&(t[e]=r),t},e)),e}function c(t){var e=document.queryCommandSupported(t);if(e)try{e=document.execCommand(t)||window.ClipboardEvent||p}catch(t){e=!1}return e}Object.defineProperty(r,"__esModule",{value:!0}),r.actions=void 0;var f=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}();r.exec=c;var d=t("preact"),p=window.clipboardData,h=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),f(e,[{key:"componentDidMount",value:function(){var r=this,e=this.base;this.target=this.props.target||e.parentNode,this.listeners={mouseup:function(t){r.props.focused()&&!a(t.target)&&s(e)},mousedown:function(t){t.shiftKey&&!a(t.target)&&t.preventDefault()},copy:function(t){if(r.props.focused()&&r.props.onCopy){var e=r.props.onCopy();e&&u(t.clipboardData,e),t.preventDefault()}},cut:function(t){if(r.props.focused()&&r.props.onCut){var e=r.props.onCut();e&&u(t.clipboardData,e),t.preventDefault()}},paste:function(t){if(r.props.focused()&&r.props.onPaste){var e=l(t.clipboardData,r.props.formats);e&&r.props.onPaste(e),t.preventDefault()}}},Object.keys(this.listeners).forEach(function(t){r.target.addEventListener(t,r.listeners[t])})}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.listeners).forEach(function(t){e.target.removeEventListener(t,e.listeners[t])})}},{key:"render",value:function(){return(0,d.h)("textarea",{className:"cliparea",contentEditable:!0,autoFocus:!0})}}]),e}(d.Component);r.actions=["cut","copy","paste"];r.default=h},{preact:485}],616:[function(t,e,r){"use strict";function p(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},a=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),m=t("preact"),s=t("w3c-keyname"),u=function(t){return t&&t.__esModule?t:{default:t}}(s),l=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),a(e,[{key:"exit",value:function(t){var e=this.props,r=e.params,n=e.result,o=void 0===n?function(){return null}:n,i=e.valid,a=void 0===i?function(){return!!o()}:i,s="确定"===t?"onOk":"onCancel";r&&s in r&&("onOk"!==s||a())&&r[s](o())}},{key:"keyDown",value:function(t){var e=(0,u.default)(t),r=document.activeElement,n=r&&"TEXTAREA"===r.tagName;("Escape"===e||"Enter"===e&&!n)&&(this.exit("Enter"===e?"确定":"取消"),t.preventDefault()),t.stopPropagation()}},{key:"componentDidMount",value:function(){var t=this.base.querySelector(["input:not([type=checkbox]):not([type=button])","textarea","[contenteditable]","select"].join(","))||this.base.querySelector(["button.close"].join(","));console.assert(t,"No active buttons"),t.focus&&t.focus()}},{key:"componentWillUnmount",value:function(){(document.querySelector(".cliparea")||document.body).focus()}},{key:"render",value:function(){var e=this,t=this.props,r=t.children,n=t.title,o=t.params,i=void 0===o?{}:o,a=t.result,s=void 0===a?function(){return null}:a,u=t.valid,l=void 0===u?function(){return!!s()}:u,c=t.buttons,f=void 0===c?["取消","确定"]:c,d=p(t,["children","title","params","result","valid","buttons"]);return(0,m.h)("form",h({role:"dialog",onSubmit:function(t){return t.preventDefault()},onKeyDown:function(t){return e.keyDown(t)},tabIndex:"-1"},d),(0,m.h)("header",null,n,i.onCancel&&n&&(0,m.h)("button",{className:"close",onClick:function(){return e.exit("取消")}},"×")),r,(0,m.h)("footer",null,f.map(function(t){return"string"!=typeof t?t:(0,m.h)("input",{type:"button",value:t,disabled:"确定"===t&&!l(),onClick:function(){return e.exit(t)}})})))}}]),e}(m.Component);r.default=l},{preact:485,"w3c-keyname":516}],617:[function(t,e,r){"use strict";function u(t,e,r){return t?(0,i.default)(e,[r]):(0,i.default)(e,e.concat([r]))}function n(t){var r=t.value,n=t.onChange,o=t.schema,i=t.disabledIds,a=t.multiple,s=void 0;return(0,l.h)("ul",null,o.items.enum.map(function(t,e){return s=r.includes(t)?"selected":"",(0,l.h)("li",null,(0,l.h)("button",{disabled:i.includes(t),type:"button",className:s,onClick:function(){return n(u(a,r,t))}},o.items.enumNames[e]))}))}Object.defineProperty(r,"__esModule",{value:!0});var o=t("lodash/fp/xor"),i=function(t){return t&&t.__esModule?t:{default:t}}(o),l=t("preact");r.default=n},{"lodash/fp/xor":438,preact:485}],618:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),s=t("preact"),u=function(t){function r(t){n(this,r);var e=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e.state={suggestsHidden:!0},e.click=e.click.bind(e),e.blur=e.blur.bind(e),e.updateInput=e.updateInput.bind(e),e}return i(r,t),a(r,[{key:"updateInput",value:function(t){var e=t.target.value||t.target.textContent;this.setState({suggestsHidden:!0}),this.props.onChange(e)}},{key:"click",value:function(){this.setState({suggestsHidden:!1})}},{key:"blur",value:function(){this.setState({suggestsHidden:!0})}},{key:"render",value:function(t){var e=this,r=t.value,n=t.type,o=void 0===n?"text":n,i=t.schema,a=i.enumNames.filter(function(t){return t!==r}).map(function(t){return(0,s.h)("li",{onMouseDown:e.updateInput},t)});return(0,s.h)("div",null,(0,s.h)("input",{type:o,value:r,onClick:this.click,onBlur:this.blur,onInput:this.updateInput,autoComplete:"off"}),0!==a.length?(0,s.h)("ui",{className:"suggestList",style:"display: "+(this.state.suggestsHidden?"none":"block")},a):"")}}]),r}(s.Component);r.default=u},{preact:485}],619:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function g(t){var e=t.labelPos,r=t.title,n=t.children,o=m(t,["labelPos","title","children"]);return(0,x.h)("label",o,r&&"after"!==e?r+":":"",n,r&&"after"===e?r:"")}function a(t){var e=t.name,r=t.onChange,n=t.className,o=t.component,i=t.labelPos,a=m(t,["name","onChange","className","component","labelPos"]),s=this.context,u=s.schema,l=s.stateStore,c=a.schema||u.properties[e],f=l.field(e,r),d=f.dataError,p=m(f,["dataError"]),h=o?(0,x.h)(o,v({},p,a,{schema:c})):(0,x.h)(O.default,v({name:e,schema:c},p,a));return!1===i?h:(0,x.h)(g,{className:n,"data-error":d,title:a.title||c.title,labelPos:i},h)}function p(e,t){var r=t.customValid,n=t.serialize,o=void 0===n?{}:n,i=t.deserialize,a=void 0===i?{}:i,s=new _.default.Validator;return r&&(e=Object.assign({},e),e.properties=Object.keys(r).reduce(function(t,e){return s.customFormats[e]=r[e],t[e]=v({format:e},t[e]),t},e.properties)),{key:e.key||"",serialize:function(t){return s.validate(t,e,{rewrite:u.bind(null,o)})},deserialize:function(t){return s.validate(t,e,{rewrite:l.bind(null,a)})}}}function u(e,r,t){var n={};return"object"===(void 0===r?"undefined":c(r))&&t.properties?(Object.keys(t.properties).forEach(function(t){t in r&&(n[t]=r[e[t]]||r[t])}),n):void 0!==r?r:t.default}function l(t,e){return e}function i(t){return t.schema.invalidMessage?"function"==typeof t.schema.invalidMessage?t.schema.invalidMessage(t.instance):t.schema.invalidMessage:t.message}function h(t){var e={},r=void 0;return t.forEach(function(t){r=t.property.split(".")[1],e[r]||(e[r]=i(t))}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.SelectOneOf=r.Field=void 0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},y=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),b=t("jsonschema"),_=n(b),x=t("preact"),w=t("preact-redux"),S=t("./input"),O=n(S),A=t("../../state/modal/form"),E=function(t){function c(t){var e=t.onUpdate,r=t.schema,n=t.init,o=m(t,["onUpdate","schema","init"]);f(this,c);var i=d(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));if(i.schema=p(r,o),n){var a=i.schema.serialize(n),s=a.valid,u=a.errors,l=h(u);n=Object.assign({},n,{init:!0}),e(n,s,l)}return i}return o(c,t),y(c,[{key:"updateState",value:function(t){var e=this.schema.serialize(t),r=e.instance,n=e.valid,o=e.errors,i=h(o);this.props.onUpdate(r,n,i)}},{key:"getChildContext",value:function(){return{schema:this.props.schema,stateStore:this}}},{key:"field",value:function(r,n){var t=this.props,e=t.result,o=t.errors,i=e[r],a=this;return{dataError:o&&o[r]||!1,value:i,onChange:function(t){var e=Object.assign({},a.props.result,s({},r,t));a.updateState(e),n&&n(t)}}}},{key:"render",value:function(t){var e=t.result,r=(t.errors,t.init,t.children),n=t.schema,o=m(t,["result","errors","init","children","schema"]);return n.key&&n.key!==this.schema.key&&(this.schema=p(n,o),this.schema.serialize(e),this.updateState(e)),(0,x.h)("form",o,r)}}]),c}(x.Component);r.default=(0,w.connect)(null,function(n){return{onUpdate:function(t,e,r){n((0,A.updateFormState)({result:t,valid:e,errors:r}))}}})(E);var j=function(t){var e=t.title,r=t.name,n=t.schema,o=m(t,["title","name","schema"]),i={title:e,enum:[],enumNames:[]};return Object.keys(n).forEach(function(t){i.enum.push(t),i.enumNames.push(n[t].title||t)}),(0,x.h)(a,v({name:r,schema:i},o))};r.Field=a,r.SelectOneOf=j},{"../../state/modal/form":672,"./input":620,jsonschema:199,preact:485,"preact-redux":484}],620:[function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function u(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t){var e=(t.schema,t.value),r=t.onChange,n=t.type,o=void 0===n?"text":n,i=u(t,["schema","value","onChange","type"]);return(0,A.h)("input",O({type:o,value:e,onInput:r},i))}function l(t){var e=(t.schema,t.value),r=t.onChange,n=u(t,["schema","value","onChange"]);return(0,A.h)("textarea",O({value:e,onInput:r},n))}function c(t){var e=(t.schema,t.value),r=t.onChange,n=u(t,["schema","value","onChange"]);return(0,A.h)("input",O({type:"checkbox",checked:e,onClick:r},n))}function f(t){var e=t.schema,r=t.value,n=t.selected,o=t.onSelect,i=u(t,["schema","value","selected","onSelect"]);return(0,A.h)("select",O({onChange:o},i),p(e,function(t,e){return(0,A.h)("option",{selected:n(e,r),value:"object"!==(void 0===e?"undefined":S(e))&&e},t)}))}function d(t){var e=t.schema,r=t.value,n=t.selected,o=t.onSelect,i=t.type,a=void 0===i?"radio":i,s=u(t,["schema","value","selected","onSelect","type"]);return(0,A.h)("fieldset",{onClick:o,className:"radio"},p(e,function(t,e){return(0,A.h)("li",null,(0,A.h)("label",null,(0,A.h)("input",O({type:a,checked:n(e,r),value:"object"!==(void 0===e?"undefined":S(e))&&e},s)),t))}))}function p(n,o){var i=Array.isArray(n);if(!i&&n.items&&(n=n.items),"function"==typeof o)return(i?n:n.enum).map(function(t,e){var r=i?t.title:n.enumNames&&n.enumNames[e];return o(void 0!==r?r:t,void 0!==t.value?t.value:t)});if(!i)return n.enum[o];var t=n[o];return void 0!==t.value?t.value:t}function h(r,n,o){var t={};return n&&("number"!==n.type&&"integer"!==n.type||(t={type:"text"})),O({onChange:function(t){var e=r.val?r.val(t,n):t;o(e)}},t)}function m(r,n,o){return{selected:function(t,e){return e===t},onSelect:function(t){var e=r.val?r.val(t,n):t;void 0!==e&&o(e)}}}function g(o,i,a){return{multiple:!0,selected:function(t,e){return e&&e.indexOf(t)>=0},onSelect:function(t,e){if(o.val){var r=o.val(t,i);void 0!==r&&a(r)}else{var n=e?e.indexOf(t):-1;a(n<0?e?[t].concat(s(e)):[t]:[].concat(s(e.slice(0,n)),s(e.slice(n+1))))}}}}function v(t,e){var r=e.schema,n=e.multiple,o=e.onChange;return r&&(r.enum||r.items||Array.isArray(r))&&"string"!==r.type?n||"array"===r.type?g(t,r,o):m(t,r,o):h(t,r,o)}function y(t){var e=t.schema,r=t.type,n=t.multiple;return e&&(e.enum||e.items||Array.isArray(e))?n||"array"===e.type?"checkbox"===r?d:f:"radio"===r?d:f:"checkbox"===r||e&&"boolean"===e.type?c:"textarea"===r?l:o}function b(t,e){for(var r in t)if(!(r in e))return!0;for(var n in e)if(t[n]!==e[n])return!0;return!1}Object.defineProperty(r,"__esModule",{value:!0});var _=t("lodash/omit"),x=function(t){return t&&t.__esModule?t:{default:t}}(_),w=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},A=t("preact");o.val=function(t,e){var r=t.target,n="number"===r.type||"range"===r.type||e&&("number"===e.type||"integer"===e.type),o=n?r.value.replace(/,/g,"."):r.value;return n&&!isNaN(o-0)?o-0:o},l.val=function(t){return t.target.value},c.val=function(t){return t.stopPropagation(),!!t.target.checked},f.val=function(t,n){var e=t.target;return e.multiple?[].reduce.call(e.options,function(t,e,r){return e.selected?[p(n,r)].concat(s(t)):t},[]):p(n,e.selectedIndex)},d.val=function(t,n){var e=t.target;if("INPUT"!==t.target.tagName)return void t.stopPropagation();var r=e.parentNode.parentNode.parentNode,o=[].reduce.call(r.querySelectorAll("input"),function(t,e,r){return e.checked?[p(n,r)].concat(s(t)):t},[]);return"radio"===e.type?o[0]:o};var E=function(t){function o(t){var e=t.component,r=u(t,["component"]);i(this,o);var n=a(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,r));return n.component=e||y(r),n.ctrl=v(n.component,r),n}return n(o,t),w(o,[{key:"shouldComponentUpdate",value:function(t){var e=(t.children,t.onChange,t.style,u(t,["children","onChange","style"]));return b((0,x.default)(this.props,["children","onChange","style"]),e)}},{key:"render",value:function(){var t=this.props,e=(t.children,t.onChange,u(t,["children","onChange"]));return(0,A.h)(this.component,O({},this.ctrl,e))}}]),o}(A.Component);r.default=E},{"lodash/omit":464,preact:485}],621:[function(t,e,r){"use strict";function s(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e,r){return!t&&0!==t||isNaN(t)?null:"px"===r||"pt"===r?(t*h[e]/h[r]).toFixed()-0:(t*h[e]/h[r]).toFixed(3)-0}Object.defineProperty(r,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},l=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),c=t("preact"),f=t("./input"),d=function(t){return t&&t.__esModule?t:{default:t}}(f),p=function(t){function r(t){n(this,r);var e=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e.state={cust:t.value||t.schema.default,meas:"px"},e.calcValue=e.calcValue.bind(e),e.handleChange=e.handleChange.bind(e),e.handleMeasChange=e.handleMeasChange.bind(e),e}return i(r,t),l(r,[{key:"handleChange",value:function(t){var e=a(t,this.state.meas,"px");this.state.cust=t,this.props.onChange(e)}},{key:"handleMeasChange",value:function(e){this.setState(function(t){return{meas:e,cust:a(t.cust,t.meas,e)}})}},{key:"calcValue",value:function(){var e=this;this.setState(function(t){return{cust:a(e.props.value,"px",t.meas)}})}},{key:"render",value:function(){var t=this.state,e=t.meas,r=t.cust,n=this.props,o=n.schema,i=n.value,a=(n.onChange,s(n,["schema","value","onChange"]));return"px"===e&&r.toFixed()-0!==i&&this.setState({meas:"px",cust:i}),(0,c.h)("div",u({style:{display:"inline-flex"}},a),(0,c.h)(d.default,{schema:o,step:"px"===e||"pt"===e?"1":"0.001",style:{width:"75%"},value:r,onChange:this.handleChange,onBlur:this.calcValue}),(0,c.h)(d.default,{schema:{enum:["cm","px","pt","inch"]},style:{width:"25%"},value:e,onChange:this.handleMeasChange}))}}]),r}(c.Component),h={px:1,cm:37.795278,pt:1.333333,inch:96};r.default=p},{"./input":620,preact:485}],622:[function(t,e,r){"use strict";function o(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function n(t){var e=t.schema,r=o(t,["schema"]),n={title:e.title,enum:[!0,!1],enumNames:["on","off"]};return(0,a.h)(u.default,i({schema:n},r))}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},a=t("preact"),s=t("./input"),u=function(t){return t&&t.__esModule?t:{default:t}}(s);r.default=n},{"./input":620,preact:485}],623:[function(t,e,r){"use strict";function a(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function n(t){var r=t.schema,n=t.value,o=t.onSelect,i=t.splitIndexes,e=a(t,["schema","value","onSelect","splitIndexes"]);return(0,u.h)("ul",e,r.enum.map(function(t,e){return(0,u.h)("li",{onClick:function(){return o(t,e)},className:(t===n?"selected ":"")+(s(e,i)?"split":"")},r.enumNames?r.enumNames[e]:t)}))}function s(t,e){return t>0&&e&&e.includes(t)}Object.defineProperty(r,"__esModule",{value:!0});var u=t("preact");r.default=n},{preact:485}],624:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(){var t=v.map(function(t){return new h.default(t).check().then(function(){return t},function(){return null})});return Promise.all(t)}function l(t){return t.substring(t.indexOf("px ")+3)}Object.defineProperty(r,"__esModule",{value:!0});var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},f=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),d=t("preact"),p=t("font-face-observer"),h=n(p),m=t("./input"),g=n(m),v=["Arial","Arial Black","Comic Sans MS","Courier New","Georgia","Impact","Charcoal","Lucida Console","Monaco","Palatino Linotype","Book Antiqua","Palatino","Tahoma","Geneva","Times New Roman","Times","Verdana","Symbol","MS Serif","MS Sans Serif","New York","Droid Sans","Droid Serif","Droid Sans Mono","Roboto"],y=null,b=function(t){function r(t){i(this,r);var e=a(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e.state={availableFonts:[l(t.value)]},e.setAvailableFonts(),e}return s(r,t),f(r,[{key:"setAvailableFonts",value:function(){var e=this;y?this.setState({availableFonts:y}):u().then(function(t){y=t.filter(function(t){return null!==t}),e.setState({availableFonts:y})})}},{key:"render",value:function(){var t=o(this.props,[]),e={enum:[],enumNames:[]};return this.state.availableFonts.forEach(function(t){e.enum.push("30px "+t),e.enumNames.push(t)}),1!==e.enum.length?(0,d.h)(g.default,c({},t,{schema:e})):(0,d.h)("select",null,(0,d.h)("option",null,e.enumNames[0]))}}]),r}(d.Component);r.default=b},{"./input":620,"font-face-observer":195,preact:485}],625:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),s=t("preact"),u=t("preact-redux"),l=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),a(e,[{key:"componentWillReceiveProps",value:function(t,e){var r=this;!e.editor&&t.editor&&t.editor.event.message.add(function(t){t.info?(r.base.innerHTML=t.info,r.base.classList.add("visible")):r.base.classList.remove("visible")})}},{key:"render",value:function(){return(0,s.h)("div",{className:"measure-log"})}}]),e}(s.Component);r.default=(0,u.connect)(function(t){return{editor:t.editor}})(l)},{preact:485,"preact-redux":484}],626:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(r,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=n.struct,e=n.tool,i=n.toolOpts,a=n.options;t!==o.struct&&r.struct(t),e===o.tool&&i===o.toolOpts||r.tool(e,i),o.options&&a!==o.options&&r.options(a),Object.keys(r.event).forEach(function(t){var e="on"+(0,f.default)(t);n[e]!==o[e]&&(o[e]&&r.event[t].remove(o[e]),n[e]&&r.event[t].add(n[e]))})}function l(r,n){Object.keys(r.event).forEach(function(t){var e="on"+(0,f.default)(t);n[e]&&r.event[t].remove(n[e])})}Object.defineProperty(r,"__esModule",{value:!0});var c=t("lodash/fp/upperFirst"),f=n(c),d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},p=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),h=t("preact"),m=t("./measurelog"),g=n(m),v=t("../../editor"),y=n(v),b=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),p(e,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillReceiveProps",value:function(t){u(this.instance,t,this.props)}},{key:"componentDidMount",value:function(){console.assert(this.base,"No backing element"),this.instance=new y.default(this.base,d({},this.props.options)),u(this.instance,this.props),this.props.onInit&&this.props.onInit(this.instance)}},{key:"componentWillUnmount",value:function(){l(this.instance,this.props)}},{key:"render",value:function(){var t=this.props,e=t.Tag,r=void 0===e?"div":e,n=(t.struct,t.tool,t.toolOpts,t.options,o(t,["Tag","struct","tool","toolOpts","options"]));return(0,h.h)(r,d({onMouseDown:function(t){return t.preventDefault()}},n),(0,h.h)(g.default,null))}}]),e}(h.Component);r.default=b},{"../../editor":556,"./measurelog":625,"lodash/fp/upperFirst":436,preact:485}],627:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)if(e.prerender)t.innerHTML=e.prerender;else{console.info("render!",t.clientWidth,t.clientWidth);var n=new v.default(t,c({autoScale:!0},r));n.setMolecule(e),n.update()}}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},f=t("preact"),d=t("../../chem/struct"),p=n(d),h=t("../../chem/molfile"),m=n(h),g=t("../../render"),v=n(g),y=function(t){function r(t){o(this,r);var e=a(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));if(!(t.struct instanceof p.default))try{e.props.struct=m.default.parse(t.struct)}catch(t){alert("Could not parse structure\n"+t.message),e.props.struct=null}return e}return s(r,t),l(r,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentDidMount",value:function(){var t=this.base,e=this.props;u(t,e.struct,e.options)}},{key:"render",value:function(){var t=this.props,e=t.struct,r=t.Tag,n=void 0===r?"div":r,o=i(t,["struct","Tag"]);return(0,f.h)(n,o,e?null:"No molecule")}}]),r}(f.Component);r.default=y},{"../../chem/molfile":523,"../../chem/struct":537,"../../render":586,preact:485}],628:[function(t,e,r){"use strict";function a(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("lodash/fp/xor"),u=function(t){return t&&t.__esModule?t:{default:t}}(s),l=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),c=t("preact"),f=function(t){function r(t){n(this,r);var e=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e.state.active=t.active||[],e}return i(r,t),l(r,[{key:"onActive",value:function(t){var e=this.props.multiple;void 0===e||e?this.setState({active:(0,u.default)(this.state.active,[t])}):this.setState({active:[t]})}},{key:"render",value:function(){var r=this,t=this.props,n=t.children,e=t.captions,o=a(t,["children","captions"]),i=this.state.active;return(0,c.h)("ul",o,e.map(function(t,e){return(0,c.h)("li",{className:"ac_tab "+(i.includes(e)?"active":"hidden")},(0,c.h)("a",{onClick:function(){return r.onActive(e)}},t),n[e])}))}}]),r}(c.Component);r.default=f},{"lodash/fp/xor":438,preact:485}],629:[function(t,e,r){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function a(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function s(t){return[d.indexOf(t.type)>=0?t.type+" metal":t.type||"unknown-props",t.state||"unknown-state",t.origin]}function n(t){var e=t.el,r=t.shortcut,n=t.className,o=a(t,["el","shortcut","className"]);return(0,l.h)("button",u({title:r?e.title+" ("+r+")":e.title,className:[].concat(i(s(e)),[n]).join(" "),style:{color:f.sketchingColors[e.label]},value:c.default.map[e.label]},o),(0,l.h)("span",null,e.label))}Object.defineProperty(r,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},l=t("preact"),o=t("../../../chem/element"),c=function(t){return t&&t.__esModule?t:{default:t}}(o),f=t("../../../chem/element-color"),d=["alkali","alkaline-earth","transition","post-transition"];r.default=n},{"../../../chem/element":520,"../../../chem/element-color":519,preact:485}],630:[function(t,e,r){"use strict";function n(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t){var e=t.name,r=n(t,["name"]);return(0,i.h)("svg",r,(0,i.h)("use",{xlinkHref:"#icon-"+e}))}Object.defineProperty(r,"__esModule",{value:!0});var i=t("preact");r.default=o},{preact:485}],631:[function(r,t,p){(function(o){"use strict";function s(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(n){return new Promise(function(t,e){if(o.FileReader)t(u);else if(o.ActiveXObject)try{var r=new ActiveXObject("Scripting.FileSystemObject");t(function(t){return Promise.resolve(l(r,t))})}catch(t){e(t)}else n?t(n.then(function(){throw Error("Server doesn't still support echo method")})):e(new Error("Your browser does not support opening files locally"))})}function u(o){return new Promise(function(e,r){var n=new FileReader;n.onload=function(){var t=n.result;o.msClose&&o.msClose(),e(t)},n.onerror=function(t){r(t)},n.readAsText(o,"UTF-8")})}function l(t,e){var r=t.OpenTextFile(e.name,1),n=r.ReadAll();return r.Close(),n}Object.defineProperty(p,"__esModule",{value:!0});var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},f=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),d=r("preact"),t=function(t){function r(t){n(this,r);var e=i(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return t.server&&a(t.server).then(function(t){e.setState({opener:t})}),e}return e(r,t),f(r,[{key:"open",value:function(t){filesType=t.target.value.substring(t.target.value.lastIndexOf(".")+1);var e=t.target.files,r=function(){return null},n=this.props,o=n.onLoad,i=void 0===o?r:o,a=n.onError,s=void 0===a?r:a;this.state.opener&&e.length?this.state.opener(e[0]).then(i,s):e.length&&i(e[0]),t.target.value=null,t.preventDefault()}},{key:"render",value:function(){var e=this,t=this.props,r=t.children,n=t.type,o=(t.server,t.className),i=void 0===o?"open-button":o,a=s(t,["children","type","server","className"]);return(0,d.h)("button",c({onClick:function(){return e.btn.click()},className:i},a),(0,d.h)("input",{onChange:function(t){return e.open(t)},accept:n,type:"file",ref:function(t){e.btn=t}}),r)}}]),r}(d.Component);p.default=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{preact:485}],632:[function(a,t,u){(function(n){"use strict";function c(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function p(r){return new Promise(function(t,e){n.Blob&&o.default.saveAs?t(function(t,e,r){var n=new Blob([t],{type:r});o.default.saveAs(n,e)}):r?t(r.then(function(){throw Error("Server doesn't still support echo method")})):e(new Error("Your browser does not support opening files locally"))})}Object.defineProperty(u,"__esModule",{value:!0});var h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},r=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),s=a("preact"),t=a("filesaver.js"),o=function(t){return t&&t.__esModule?t:{default:t}}(t),i=function(t){function l(t){var e=t.filename,r=void 0===e?"unnamed":e,n=t.type,o=void 0===n?"text/plain":n,i=t.className,a=void 0===i?"":i,s=c(t,["filename","type","className"]);f(this,l);var u=d(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,h({filename:r,type:o,className:a},s)));return p(s.server).then(function(t){u.setState({saver:t})}),u}return e(l,t),r(l,[{key:"save",value:function(t){var e=function(){return null},r=this.props,n=r.filename,o=r.data,i=r.type,a=r.onSave,s=void 0===a?e:a,u=r.onError,l=void 0===u?e:u;if(this.state.saver&&o)try{this.state.saver(o,n,i),s()}catch(t){l(t)}t.preventDefault()}},{key:"render",value:function(){var e=this,t=this.props,r=t.children,n=(t.filename,t.data),o=t.className,i=void 0===o?"save-button":o,a=c(t,["children","filename","data","className"]);return(0,s.h)("button",h({onClick:function(t){return e.save(t)},className:this.state.saver&&n?i:"disabled "+i},a),r)}}]),l}(s.Component);u.default=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"filesaver.js":193,preact:485}],633:[function(t,e,r){"use strict";function n(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t){var e=n(t,[]);return(0,a.h)("div",i({className:"ket-spinner"},e))}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},a=t("preact");r.default=o},{preact:485}],634:[function(t,e,r){"use strict";function i(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),u=t("preact"),l=function(t){function r(t){n(this,r);var e=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e.state.tabIndex=t.tabIndex||0,e.props.changeTab(e.state.tabIndex),e}return a(r,t),s(r,[{key:"changeTab",value:function(t,e){this.setState({tabIndex:e}),this.props.changeTab&&this.props.changeTab(e)}},{key:"render",value:function(){var r=this,t=this.props,e=t.children,n=t.captions,o=i(t,["children","captions"]);return(0,u.h)("ul",o,(0,u.h)("li",{className:"tabs"},n.map(function(t,e){return(0,u.h)("a",{className:r.state.tabIndex===e?"active":"",onClick:function(t){return r.changeTab(t,e)}},t)})),(0,u.h)("li",{className:"tabs-content"},e[this.state.tabIndex]))}}]),r}(u.Component);r.default=l},{preact:485}],635:[function(t,e,r){"use strict";function v(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},a=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),b=t("preact"),s=function(t){function e(t){o(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.resize=function(t,e){var r=n.base.offsetHeight;n.state.height!==r&&n.setState({height:r}),e&&(n.setState({offset:0}),n.base.scrollTop=0)},n.handleScroll=function(){n.setState({offset:n.base.scrollTop}),n.props.sync&&n.forceUpdate()},n.state={offset:0,height:0},n}return n(e,t),a(e,[{key:"componentDidUpdate",value:function(t){var r=t.data,e=r.length===this.props.data.length&&this.props.data.every(function(t,e){return t===r[e]});this.resize(null,!e)}},{key:"componentDidMount",value:function(){this.resize(),addEventListener("resize",this.resize)}},{key:"componentWillUnmount",value:function(){removeEventListener("resize",this.resize)}},{key:"render",value:function(){var t=this.props,e=t.data,r=t.rowHeight,n=t.children,o=t.Tag,i=void 0===o?"div":o,a=t.overscanCount,s=void 0===a?1:a,u=(t.sync,v(t,["data","rowHeight","children","Tag","overscanCount","sync"])),l=this.state,c=l.offset,f=l.height,d=c/r||0,p=n[0],h=f/r||0;s&&(d=Math.max(0,d-d%s),h+=s);var m=d+1+h,g=e.slice(d,m);return(0,b.h)("div",y({onScroll:this.handleScroll},u),(0,b.h)("div",{style:"position:relative; overflow:hidden; width:100%; min-height:100%; height:"+e.length*r+"px;"},(0,b.h)(i,{style:"position:absolute; top:0; left:0; height:100%; width:100%; overflow:visible; top:"+d*r+"px;"},g.map(function(t,e){return p(t,d+e)}))))}}]),e}(b.Component);r.default=s},{preact:485}],636:[function(t,e,r){"use strict";function n(t){var e=t.split(/\+(?!$)/),r=e[e.length-1];"Space"===r&&(r=" ");for(var n=void 0,o=void 0,i=void 0,a=void 0,s=0;s<e.length-1;s++){var u=e[s];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))n=!0;else if(/^(c|ctrl|control)$/i.test(u))o=!0;else if(/^s(hift)?$/i.test(u))i=!0;else{if(!/^mod$/i.test(u))throw new Error("Unrecognized modifier name: "+u);p?a=!0:o=!0}}return n&&(r="Alt+"+r),o&&(r="Ctrl+"+r),a&&(r="Meta+"+r),i&&(r="Shift+"+r),r}function o(e){var r=Object.create(null);return Object.keys(e).forEach(function(t){r[n(t)]=e[t]}),r}function a(t,e,r){return e.altKey&&(t="Alt+"+t),e.ctrlKey&&(t="Ctrl+"+t),e.metaKey&&(t="Meta+"+t),!1!==r&&e.shiftKey&&(t="Shift+"+t),t}function s(t,e){return t.replace(/[а-я]/,d.default.base[e.keyCode]).replace(/[А-Я]/,d.default.shift[e.keyCode])}function i(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=s((0,d.default)(t),t),n=1===r.length&&" "!==r;return n&&!e?a(r,t,!n):a(d.default.base[t.keyCode],t,!0)}function u(t){return t instanceof KeyboardEvent?i.apply(void 0,arguments):"object"===(void 0===t?"undefined":c(t))?o(t):n(t)}function l(t,e){var r=s((0,d.default)(e),e);"Add"===r&&(r="+"),"Subtract"===r&&(r="-");var n=1===r.length&&" "!==r,o=t[a(r,e,!n)],i=void 0;return e.shiftKey&&n&&(i=d.default.base[e.keyCode])&&(o=t[a(i,e,!0)]||o),o}Object.defineProperty(r,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f=t("w3c-keyname"),d=function(t){return t&&t.__esModule?t:{default:t}}(f),p="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);u.lookup=l,r.default=u},{"w3c-keyname":516}],637:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t){return"R#"===t.label?S({type:"rlabel",values:p(t.rglabel)},t):"L#"===t.label?l(t):E.default.map[t.label]?s(t):!t.label&&"attpnt"in t?{ap:f(t.attpnt)}:t}function a(t){return"rlabel"===t.type?{label:t.values.length?"R#":"C",rglabel:0===t.values.length?null:h(t.values)}:"list"===t.type||"not-list"===t.type?c(t):!t.label&&"ap"in t?{attpnt:d(t.ap)}:E.default.map[(0,w.default)(t.label)]?u(t):"A"===t.label||"*"===t.label||"Q"===t.label||"X"===t.label||"R"===t.label?(t.pseudo=t.label,u(t)):t}function s(t){var e=t.alias||"",r=t.charge.toString();return{alias:e,label:t.label,charge:r,isotope:t.isotope,explicitValence:t.explicitValence,radical:t.radical,invRet:t.invRet,exactChangeFlag:!!t.exactChangeFlag,ringBondCount:t.ringBondCount,substitutionCount:t.substitutionCount,unsaturatedAtom:!!t.unsaturatedAtom,hCount:t.hCount}}function u(t){var e=P.atom.properties.charge.pattern,r=e.exec(t.charge),n=r?parseInt(r[1]+r[3]+r[2]):t.charge,o=Object.assign({},t,{label:(0,w.default)(t.label)});return void 0!==n&&(o.charge=n),o}function l(t){return{type:t.atomList.notList?"not-list":"list",values:t.atomList.ids.map(function(t){return E.default[t].label})}}function c(t){return{pseudo:null,label:"L#",atomList:new O.AtomList({notList:"not-list"===t.type,ids:t.values.map(function(t){return E.default.map[t]})})}}function f(t){return{primary:(1&(t||0))>0,secondary:(2&(t||0))>0}}function d(t){return(t.primary&&1)+(t.secondary&&2)}function p(t){var e=[],r=void 0,n=void 0;for(r=0;r<32;r++)t&1<<r&&(n=r+1,e.push(n));return e}function h(t){var e=0;return t.forEach(function(t){e|=1<<t-1}),e}function m(t){return{type:y(t.type,t.stereo),topology:t.topology||0,center:t.reactingCenterStatus||0}}function g(t){return S({topology:t.topology,reactingCenterStatus:t.center},v(t.type))}function v(t){return Object.assign({},T[t])}function y(t,e){for(var r in T)if(T[r].type===t&&T[r].stereo===e)return r;throw Error("No such bond caption")}function b(t){var e=t.type||"GEN",r=t.attrs,n=r.context,o=r.fieldName,i=r.fieldValue,a=r.absolute,s=r.attached;return t.attrs.radiobuttons=!1===a&&!1===s?"Relative":s?"Attached":"Absolute",j.sdataSchema[n][o]&&j.sdataSchema[n][o].properties.fieldValue.items&&(t.attrs.fieldValue=i.split("\n")),Object.assign({type:e},t.attrs)}function _(t){var e=t.type,r=t.radiobuttons,n=i(t,["type","radiobuttons"]),o=S({},n);switch(r){case"Absolute":o.absolute=!0,o.attached=!1;break;case"Attached":o.absolute=!1,o.attached=!0;break;case"Relative":o.absolute=!1,o.attached=!1}return o.fieldName&&(o.fieldName=o.fieldName.trim()),o.fieldValue&&(o.fieldValue="string"==typeof o.fieldValue?o.fieldValue.trim():o.fieldValue),{type:e,attrs:o}}Object.defineProperty(r,"__esModule",{value:!0});var x=t("lodash/fp/capitalize"),w=n(x),S=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};r.fromElement=o,r.toElement=a,r.fromBond=m,r.toBond=g,r.toBondType=v,r.fromSgroup=b,r.toSgroup=_;var O=t("../../../chem/struct/index"),A=t("../../../chem/element"),E=n(A),j=t("../schema/sdata-schema"),P=t("../schema/struct-schema"),T={single:{type:O.Bond.PATTERN.TYPE.SINGLE,stereo:O.Bond.PATTERN.STEREO.NONE},up:{type:O.Bond.PATTERN.TYPE.SINGLE,stereo:O.Bond.PATTERN.STEREO.UP},down:{type:O.Bond.PATTERN.TYPE.SINGLE,stereo:O.Bond.PATTERN.STEREO.DOWN},updown:{type:O.Bond.PATTERN.TYPE.SINGLE,stereo:O.Bond.PATTERN.STEREO.EITHER},double:{type:O.Bond.PATTERN.TYPE.DOUBLE,stereo:O.Bond.PATTERN.STEREO.NONE},crossed:{type:O.Bond.PATTERN.TYPE.DOUBLE,stereo:O.Bond.PATTERN.STEREO.CIS_TRANS},triple:{type:O.Bond.PATTERN.TYPE.TRIPLE,stereo:O.Bond.PATTERN.STEREO.NONE},aromatic:{type:O.Bond.PATTERN.TYPE.AROMATIC,stereo:O.Bond.PATTERN.STEREO.NONE},singledouble:{type:O.Bond.PATTERN.TYPE.SINGLE_OR_DOUBLE,stereo:O.Bond.PATTERN.STEREO.NONE},singlearomatic:{type:O.Bond.PATTERN.TYPE.SINGLE_OR_AROMATIC,stereo:O.Bond.PATTERN.STEREO.NONE},doublearomatic:{type:O.Bond.PATTERN.TYPE.DOUBLE_OR_AROMATIC,stereo:O.Bond.PATTERN.STEREO.NONE},any:{type:O.Bond.PATTERN.TYPE.ANY,stereo:O.Bond.PATTERN.STEREO.NONE}}},{"../../../chem/element":520,"../../../chem/struct/index":537,"../schema/sdata-schema":641,"../schema/struct-schema":642,"lodash/fp/capitalize":418}],638:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var r=t.trim();if(-1!==r.indexOf("$RXN"))return"rxn";var n=r.match(/^(M {2}END|\$END MOL)$/m);if(n){var o=n.index+n[0].length;if(o===r.length||-1!==r.slice(o,o+20).search(/^\$(MOL|END CTAB)$/m))return"mol"}return"<"===r[0]&&-1!==r.indexOf("<molecule")?"cml":"InChI"===r.slice(0,5)?"inchi":-1===r.indexOf("\n")?"smiles":e?null:"mol"}function o(n,o,i,a){return console.assert(d[o],"No such format"),new Promise(function(t){var e=l.default.stringify(n);if("mol"===o||"rxn"===o)t(e);else if("smiles"===o)t(f.default.stringify(n));else{var r=i.then(function(){return i.convert({struct:e,output_format:d[o].mime},a)}).catch(function(t){throw"Server is not compatible"===t.message?Error(d[o].name+" is not supported in standalone mode."):Error("Convert error!\n"+t.message)}).then(function(t){return t.struct});t(r)}})}function i(e,o,i,a){return new Promise(function(t){var r=s(e);if(console.assert(d[r],"No such format"),"mol"===r||"rxn"===r){t(l.default.parse(e,o))}else{var n=d[r].supportsCoords;t(i.then(function(){return n?i.convert({struct:e,output_format:d.mol.mime},a):i.layout({struct:e.trim(),output_format:d.mol.mime},a)}).catch(function(t){if("Server is not compatible"===t.message){var e="smiles"===r?d["smiles-ext"].name+" and opening of "+d.smiles.name:d[r].name;throw Error(e+" is not supported in standalone mode.")}throw Error("Convert error!\n"+t.message)}).then(function(t){var e=l.default.parse(t.struct);return n||e.rescale(),e}))}})}function a(t,e){if("inchi"===e||"smiles"===e){if(0!==t.rgroups.size)return"In "+d[e].name+" the structure will be saved without R-group fragments";t=t.clone();if(null!==t.atoms.find(function(t,e){return"R#"===e.label}))return"In "+d[e].name+" the structure will be saved without R-group members";if(null!==t.sgroups.find(function(t,e){return"MUL"!==e.type&&!/^INDIGO_.+_DESC$/i.test(e.data.fieldName)}))return"In "+d[e].name+" the structure will be saved without S-groups"}return null}Object.defineProperty(r,"__esModule",{value:!0}),r.map=void 0,r.guess=s,r.toString=o,r.fromString=i,r.couldBeSaved=a;var u=t("../../../chem/molfile"),l=n(u),c=t("../../../chem/smiles"),f=n(c),d=r.map={mol:{name:"MDL Molfile",mime:"chemical/x-mdl-molfile",ext:[".mol"],supportsCoords:!0},rxn:{name:"MDL Rxnfile",mime:"chemical/x-mdl-rxnfile",ext:[".rxn"],supportsCoords:!0},smiles:{name:"Daylight SMILES",mime:"chemical/x-daylight-smiles",ext:[".smi",".smiles"]},"smiles-ext":{name:"Extended SMILES",mime:"chemical/x-chemaxon-cxsmiles",ext:[".cxsmi",".cxsmiles"]},smarts:{name:"Daylight SMARTS",mime:"chemical/x-daylight-smarts",ext:[".smarts"]},inchi:{name:"InChI",mime:"chemical/x-inchi",ext:[".inchi"]},"inchi-aux":{name:"InChI AuxInfo",mime:"chemical/x-inchi-aux",ext:[".inchi"]},cml:{name:"CML",mime:"chemical/x-cml",ext:[".cml",".mrv"],supportsCoords:!0}}},{"../../../chem/molfile":523,"../../../chem/smiles":532}],639:[function(t,e,r){"use strict";function n(){return Object.keys(h.properties).reduce(function(t,e){return t[e]=h.properties[e].default,t},{})}function o(r){if("object"!==(void 0===r?"undefined":i(r))||null===r)return null;var t=new u.default.Validator,e=t.validate(r,h),n=e.errors,o=n.map(function(t){return t.property.split(".")[1]});return Object.keys(r).reduce(function(t,e){return h.properties[e]&&-1===o.indexOf(e)&&(t[e]=r[e]),t},{})}Object.defineProperty(r,"__esModule",{value:!0}),r.MIEW_OPTIONS=r.SERVER_OPTIONS=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};r.getDefaultOptions=n,r.validation=o;var s=t("jsonschema"),u=function(t){return t&&t.__esModule?t:{default:t}}(s),l={resetToSelect:{title:"Reset to Select Tool",enum:[!0,"paste",!1],enumNames:["on","After Paste","off"],default:"paste"},rotationStep:{title:"Rotation Step, º",type:"integer",minimum:1,maximum:90,default:15}},c={showValenceWarnings:{title:"Show valence warnings",type:"boolean",default:!0},atomColoring:{title:"Atom coloring",type:"boolean",default:!0},hideChiralFlag:{title:"Do not show the Chiral flag",type:"boolean",default:!1},font:{title:"Font",type:"string",default:"30px Arial"},fontsz:{title:"Font size",type:"integer",default:13,minimum:1,maximum:96},fontszsub:{title:"Sub font size",type:"integer",default:13,minimum:1,maximum:96},carbonExplicitly:{title:"Display carbon explicitly",type:"boolean",default:!1},showCharge:{title:"Display charge",type:"boolean",default:!0},showValence:{title:"Display valence",type:"boolean",default:!0},showHydrogenLabels:{title:"Show hydrogen labels",enum:["off","Hetero","Terminal","Terminal and Hetero","on"],default:"on"},aromaticCircle:{title:"Aromatic Bonds as circle",type:"boolean",default:!0},doubleBondWidth:{title:"Double bond width",type:"integer",default:6,minimum:1,maximum:96},bondThickness:{title:"Bond thickness",type:"integer",default:2,minimum:1,maximum:96},stereoBondWidth:{title:"Stereo (Wedge) bond width",type:"integer",default:6,minimum:1,maximum:96}},f={"smart-layout":{title:"Smart-layout",type:"boolean",default:!0},"ignore-stereochemistry-errors":{title:"Ignore stereochemistry errors",type:"boolean",default:!0},"mass-skip-error-on-pseudoatoms":{title:"Ignore pseudoatoms at mass",type:"boolean",default:!1},"gross-formula-add-rsites":{title:"Add Rsites at mass calculation",type:"boolean",default:!0},"gross-formula-add-isotopes":{title:"Add Isotopes at mass calculation",type:"boolean",default:!0}},d=(r.SERVER_OPTIONS=Object.keys(f),{showAtomIds:{title:"Show atom Ids",type:"boolean",default:!1},showBondIds:{title:"Show bonds Ids",type:"boolean",default:!1},showHalfBondIds:{title:"Show half bonds Ids",type:"boolean",default:!1},showLoopIds:{title:"Show loop Ids",type:"boolean",default:!1}}),p={miewMode:{title:"Display mode",enum:["LN","BS","LC"],enumNames:["Lines","Balls and Sticks","Licorice"],default:"LN"},miewTheme:{title:"Background color",enum:["light","dark"],enumNames:["Light","Dark"],default:"light"},miewAtomLabel:{title:"Label coloring",enum:["no","bright","blackAndWhite","black"],enumNames:["No","Bright","Black and White","Black"],default:"bright"}},h=(r.MIEW_OPTIONS=Object.keys(p),{title:"Settings",type:"object",required:[],properties:a({},l,c,f,d,p)});r.default=h},{jsonschema:199}],640:[function(t,e,r){"use strict";function o(t,e){var r=t.properties[e];return r.constant||r.enum[0]}function n(t,r){return console.assert(t.oneOf),t.oneOf.reduce(function(t,e){return t[o(e,r)]=e,t},{})}function i(t,e){var n=t.properties&&t.properties[e];return n?n.enum.map(function(t,e){var r=n.enumNames&&n.enumNames[e];return r?{title:r,value:t}:t}):t.oneOf.map(function(t){return t.title?{title:t.title,value:o(t,e)}:o(t,e)})}Object.defineProperty(r,"__esModule",{value:!0}),r.mapOf=n,r.selectListOf=i},{}],641:[function(t,e,r){"use strict";function n(t){return Object.keys(t)[0]}function o(t,e){return t||e?e?l[t][e]?l[t][e].properties.fieldValue.default:"":n(l[t]):n(l)}Object.defineProperty(r,"__esModule",{value:!0}),r.sdataSchema=r.sdataCustomSchema=void 0,r.getSdataDefault=o;var i=t("./schema-helper"),a={enum:["Absolute","Relative","Attached"],default:"Absolute"},s={title:"Context",enum:["Fragment","Multifragment","Bond","Atom","Group"],default:"Fragment"},u={Fragment:{title:"Fragment",type:"Object",oneOf:[{key:"FRG_STR",title:"MDLBG_FRAGMENT_STEREO",properties:{type:{enum:["DAT"]},fieldName:{title:"Field name",enum:["MDLBG_FRAGMENT_STEREO"],default:"MDLBG_FRAGMENT_STEREO"},fieldValue:{title:"Field value",type:"array",items:{enum:["abs","(+)-enantiomer","(-)-enantiomer","racemate","steric","rel","R(a)","S(a)","R(p)","S(p)"]},default:["abs"]},radiobuttons:a},required:["fieldName","fieldValue","radiobuttons"]},{key:"FRG_COEFF",title:"MDLBG_FRAGMENT_COEFFICIENT",properties:{type:{enum:["DAT"]},fieldName:{title:"Field name",enum:["MDLBG_FRAGMENT_COEFFICIENT"],default:"MDLBG_FRAGMENT_COEFFICIENT"},fieldValue:{title:"Field value",type:"string",default:"",minLength:1,invalidMessage:"Please, specify field name"},radiobuttons:a},required:["fieldName","fieldValue","radiobuttons"]},{key:"FRG_CHRG",title:"MDLBG_FRAGMENT_CHARGE",properties:{type:{enum:["DAT"]},fieldName:{title:"Field name",enum:["MDLBG_FRAGMENT_CHARGE"],default:"MDLBG_FRAGMENT_CHARGE"},fieldValue:{title:"Field value",type:"string",default:"",minLength:1,invalidMessage:"Please, specify field name"},radiobuttons:a},required:["fieldName","fieldValue","radiobuttons"]},{key:"FRG_RAD",title:"MDLBG_FRAGMENT_RADICALS",properties:{type:{enum:["DAT"]},fieldName:{title:"Field name",enum:["MDLBG_FRAGMENT_RADICALS"],default:"MDLBG_FRAGMENT_RADICALS"},fieldValue:{title:"Field value",type:"string",default:"",minLength:1,invalidMessage:"Please, specify field name"},radiobuttons:a},required:["fieldName","fieldValue","radiobuttons"]}]},Multifragment:{title:"Multifragment",type:"Object",oneOf:[{key:"MLT_FRG",title:"KETCHER_MULTIPLE_FRAGMENT",properties:{type:{enum:["DAT"]},fieldName:{title:"Field name",enum:["KETCHER_MULTIPLE_FRAGMENT"],default:"KETCHER_MULTIPLE_FRAGMENT"},fieldValue:{title:"Field value",type:"array",items:{enum:["aerosol","alloy","catenane","complex","composite","co-polymer","emulsion","host-guest complex","mixture","rotaxane","suspension"]},default:["aerosol"]},radiobuttons:a},required:["fieldName","fieldValue","radiobuttons"]}]},Bond:{title:"Bond",type:"Object",oneOf:[{key:"SB_STR",title:"MDLBG_STEREO_KEY",properties:{type:{enum:["DAT"]},fieldName:{title:"Field name",enum:["MDLBG_STEREO_KEY"],default:"MDLBG_STEREO_KEY"},fieldValue:{title:"Field value",type:"array",items:{enum:["erythro","threo","alpha","beta","endo","exo","anti","syn","ECL","STG"]},default:["erythro"]},radiobuttons:a},required:["fieldName","fieldValue","radiobuttons"]},{key:"SB_BND",title:"MDLBG_BOND_KEY",properties:{type:{enum:["DAT"]},fieldName:{title:"Field name",enum:["MDLBG_BOND_KEY"],default:"MDLBG_BOND_KEY"},fieldValue:{title:"Field value",type:"array",items:{enum:["Value=4"]},default:["Value=4"]},radiobuttons:a},required:["fieldName","fieldValue","radiobuttons"]}]},Atom:{title:"Atom",type:"Object",oneOf:[{key:"AT_STR",title:"MDLBG_STEREO_KEY",properties:{type:{enum:["DAT"]},fieldName:{title:"Field name",enum:["MDLBG_STEREO_KEY"],default:"MDLBG_STEREO_KEY"},fieldValue:{title:"Field value",type:"array",items:{enum:["RS","SR","P-3","P-3-PI","SP-4","SP-4-PI","T-4","T-4-PI","SP-5","SP-5-PI","TB-5","TB-5-PI","OC-6","TP-6","PB-7","CU-8","SA-8","DD-8","HB-9","TPS-9"]},default:["RS"]},radiobuttons:a},required:["fieldName","fieldValue","radiobuttons"]}]},Group:{title:"Group",type:"Object",oneOf:[{key:"GRP_STR",title:"MDLBG_STEREO_KEY",properties:{type:{enum:["DAT"]},fieldName:{title:"Field name",enum:["MDLBG_STEREO_KEY"],default:"MDLBG_STEREO_KEY"},fieldValue:{title:"Field value",type:"array",items:{enum:["cis","trans"]},default:["cis"]},radiobuttons:a},required:["fieldName","fieldValue","radiobuttons"]}]}},l=(r.sdataCustomSchema={key:"Custom",properties:{type:{enum:["DAT"]},context:{title:"Context",enum:["Fragment","Multifragment","Bond","Atom","Group"],default:"Fragment"},fieldName:{title:"Field name",type:"string",default:"",minLength:1,invalidMessage:"Please, specify field name"},fieldValue:{title:"Field value",type:"string",default:"",minLength:1,invalidMessage:"Please, specify field value"},radiobuttons:{enum:["Absolute","Relative","Attached"],default:"Absolute"}},required:["context","fieldName","fieldValue","radiobuttons"]},r.sdataSchema=Object.keys(u).reduce(function(e,r){return e[r]=(0,i.mapOf)(u[r],"fieldName"),Object.keys(e[r]).forEach(function(t){e[r][t].properties.context=s}),e},{}))},{"./schema-helper":640}],642:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.rgroupLogic=r.sgroupMap=r.bond=r.attachmentPoints=r.labelEdit=r.rgroupSchema=r.atom=void 0;var n=t("lodash/fp/range"),o=function(t){return t&&t.__esModule?t:{default:t}}(n),i=t("./schema-helper"),a=(r.atom={title:"Atom",type:"object",required:"label",properties:{label:{title:"Label",type:"string",maxLength:3,invalidMessage:"Wrong label"},alias:{title:"Alias",type:"string",invalidMessage:"Leading and trailing spaces are not allowed"},charge:{title:"Charge",type:"string",pattern:/^([+-]?)(\d{1,3}|1000)([+-]?)$/,maxLength:5,default:"0",invalidMessage:"Invalid charge value"},explicitValence:{title:"Valence",enum:[-1,0,1,2,3,4,5,6,7,8],enumNames:["","0","I","II","III","IV","V","VI","VII","VIII"],default:-1},isotope:{title:"Isotope",type:"integer",minimum:0,default:0,invalidMessage:"There must be integer"},radical:{title:"Radical",enum:[0,2,1,3],enumNames:["","Monoradical","Diradical (singlet)","Diradical (triplet)"],default:0},ringBondCount:{title:"Ring bond count",enum:[0,-2,-1,2,3,4],enumNames:["","As drawn","0","2","3","4"],default:0},hCount:{title:"H count",enum:[0,1,2,3,4,5],enumNames:["","0","1","2","3","4"],default:0},substitutionCount:{title:"Substitution count",enum:[0,-2,-1,1,2,3,4,5,6],enumNames:["","As drawn","0","1","2","3","4","5","6"],default:0},unsaturatedAtom:{title:"Unsaturated",type:"boolean",default:!1},invRet:{title:"Inversion",enum:[0,1,2],enumNames:["","Inverts","Retains"],default:0},exactChangeFlag:{title:"Exact change",type:"boolean",default:!1}}},r.rgroupSchema={title:"R-group",type:"object",properties:{values:{type:"array",items:{type:"string",enum:(0,o.default)(1,33),enumNames:(0,o.default)(1,33).map(function(t){return"R"+t})}}}},r.labelEdit={title:"Label Edit",type:"object",required:["label"],properties:{label:{title:"Atom",default:"",invalidMessage:"Wrong atom symbol"}}},r.attachmentPoints={title:"Attachment Points",type:"object",properties:{primary:{title:"Primary attachment point",type:"boolean"},secondary:{title:"Secondary attachment point",type:"boolean"}}},r.bond={title:"Bond",type:"object",required:["type"],properties:{type:{title:"Type",enum:["single","up","down","updown","double","crossed","triple","aromatic","any","singledouble","singlearomatic","doublearomatic"],enumNames:["单","黑体楔形","空心楔形","波浪","双","双顺式或反式","三","芳香族","任意","单键或双","单键或芳香族","双键或芳香族"],default:"single"},topology:{title:"Topology",enum:[0,1,2],enumNames:["Either","Ring","Chain"],default:0},center:{title:"Reacting Center",enum:[0,-1,1,2,4,8,12],enumNames:["Unmarked","Not center","Center","No change","Made/broken","Order changes","Made/broken and changes"],default:0}}},{title:"SGroup",type:"object",required:["type"],oneOf:[{key:"GEN",title:"Generic",properties:{type:{enum:["GEN"]}}},{key:"MUL",title:"Multiple group",type:"object",properties:{type:{enum:["MUL"]},mul:{title:"Repeat count",type:"integer",default:1,minimum:1,maximum:1e3,invalidMessage:"Value out of range: must be between 1 and 1000"}},required:["mul"]},{key:"SRU",title:"SRU polymer",properties:{type:{enum:["SRU"]},subscript:{title:"Polymer label",type:"string",default:"n",pattern:/^[a-zA-Z]$/,invalidMessage:"SRU subscript should consist of a single letter"},connectivity:{title:"Repeat Pattern",enum:["ht","hh","eu"],enumNames:["Head-to-tail","Head-to-head","Either unknown"],default:"ht"}},required:["subscript","connectivity"]},{key:"SUP",title:"Superatom",properties:{type:{enum:["SUP"]},name:{title:"Name",type:"string",default:"",minLength:1,invalidMessage:"Please, provide a name for the superatom"}},required:["name"]}]});r.sgroupMap=(0,i.mapOf)(a,"type"),r.rgroupLogic={title:"R-Group",type:"object",properties:{range:{title:"Occurrence",type:"string",maxLength:50,invalidMessage:"Wrong value"},resth:{title:"RestH",type:"boolean"},ifthen:{title:"Condition",type:"integer",minium:0}}}},{"./schema-helper":640,"lodash/fp/range":433}],643:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../../chem/molfile"),o=function(t){return t&&t.__esModule?t:{default:t}}(n);r.default=["苯\n  Ketcher 11161218352D 1   1.00000     0.00000     0\n\n  6  6  0     0  0            999 V2000\n    0.8660    2.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.7320    1.5000    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.7320    0.5000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.8660    0.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.0000    0.5000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.0000    1.5000    0.0000 C   0  0  0  0  0  0        0  0  0\n  1  2  1  0     0  0\n  2  3  2  0     0  0\n  3  4  1  0     0  0\n  4  5  2  0     0  0\n  5  6  1  0     0  0\n  6  1  2  0     0  0\nM  END\n","环戊二烯\n  Ketcher 11161218352D 1   1.00000     0.00000     0\n\n  5  5  0     0  0            999 V2000\n    0.0000    1.4257    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.8090    0.8379    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.5000   -0.1132    0.0000 C   0  0  0  0  0  0        0  0  0\n   -0.5000   -0.1132    0.0000 C   0  0  0  0  0  0        0  0  0\n   -0.8090    0.8379    0.0000 C   0  0  0  0  0  0        0  0  0\n  1  2  1  0     0  0\n  2  3  2  0     0  0\n  3  4  1  0     0  0\n  4  5  2  0     0  0\n  5  1  1  0     0  0\nM  END\n","环己烷\n  Ketcher 11161218352D 1   1.00000     0.00000     0\n\n  6  6  0     0  0            999 V2000\n    0.8660    2.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.7320    1.5000    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.7320    0.5000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.8660    0.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.0000    0.5000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.0000    1.5000    0.0000 C   0  0  0  0  0  0        0  0  0\n  1  2  1  0     0  0\n  2  3  1  0     0  0\n  3  4  1  0     0  0\n  4  5  1  0     0  0\n  5  6  1  0     0  0\n  6  1  1  0     0  0\nM  END\n","环戊烷\n  Ketcher 11161218352D 1   1.00000     0.00000     0\n\n  5  5  0     0  0            999 V2000\n    0.8090    1.5389    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.6180    0.9511    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.3090    0.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.3090    0.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.0000    0.9511    0.0000 C   0  0  0  0  0  0        0  0  0\n  1  2  1  0     0  0\n  2  3  1  0     0  0\n  3  4  1  0     0  0\n  4  5  1  0     0  0\n  5  1  1  0     0  0\nM  END\n","环丙烷\n  Ketcher 11161218352D 1   1.00000     0.00000     0\n\n  3  3  0     0  0            999 V2000\n   -3.2250   -0.2750    0.0000 C   0  0  0  0  0  0        0  0  0\n   -2.2250   -0.2750    0.0000 C   0  0  0  0  0  0        0  0  0\n   -2.7250    0.5910    0.0000 C   0  0  0  0  0  0        0  0  0\n  1  2  1  0     0  0\n  2  3  1  0     0  0\n  1  3  1  0     0  0\nM  END\n","环丁烷\n  Ketcher 11161218352D 1   1.00000     0.00000     0\n\n  4  4  0     0  0            999 V2000\n   -3.8250    1.5500    0.0000 C   0  0  0  0  0  0        0  0  0\n   -3.8250    0.5500    0.0000 C   0  0  0  0  0  0        0  0  0\n   -2.8250    1.5500    0.0000 C   0  0  0  0  0  0        0  0  0\n   -2.8250    0.5500    0.0000 C   0  0  0  0  0  0        0  0  0\n  1  2  1  0     0  0\n  1  3  1  0     0  0\n  3  4  1  0     0  0\n  4  2  1  0     0  0\nM  END\n","环庚烷\n  Ketcher 11161218352D 1   1.00000     0.00000     0\n\n  7  7  0     0  0            999 V2000\n    0.0000    1.6293    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.7835    2.2465    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.7559    2.0242    0.0000 C   0  0  0  0  0  0        0  0  0\n    2.1897    1.1289    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.0000    0.6228    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.7566    0.2224    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.7835    0.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n  6  7  1  0     0  0\n  5  7  1  0     0  0\n  1  5  1  0     0  0\n  4  6  1  0     0  0\n  3  4  1  0     0  0\n  2  3  1  0     0  0\n  1  2  1  0     0  0\nM  END\n","环辛烷\n  Ketcher 11161218352D 1   1.00000     0.00000     0\n\n  8  8  0     0  0            999 V2000\n    0.0000    0.7053    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.0000    1.7078    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.7053    2.4131    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.7056    0.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.7079    0.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    2.4133    0.7053    0.0000 C   0  0  0  0  0  0        0  0  0\n    2.4133    1.7078    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.7079    2.4131    0.0000 C   0  0  0  0  0  0        0  0  0\n  8  3  1  0     0  0\n  7  8  1  0     0  0\n  6  7  1  0     0  0\n  5  6  1  0     0  0\n  4  5  1  0     0  0\n  1  4  1  0     0  0\n  2  3  1  0     0  0\n  1  2  1  0     0  0\nM  END\n"].map(function(t){return o.default.parse(t)})},{"../../chem/molfile":523}],644:[function(t,e,r){"use strict";function s(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function l(t){var e=t.labels,r=t.caption,n=void 0===r?"":r,o=t.selected,i=t.onSelect,a=s(t,["labels","caption","selected","onSelect"]);return(0,f.h)("fieldset",a,e.map(function(t){return(0,f.h)("button",{onClick:function(){return i(t)},className:o(t)?"selected":""},t)}),n?(0,f.h)("legend",null,n):null)}function c(t){var e=t.gen,r=t.name,n=t.path,o=t.selected,i=t.onSelect,a=e[r],s=n?n+"/"+r:r,u=d[s];return u&&u.caption?(0,f.h)("fieldset",{className:r},(0,f.h)("legend",null,u.caption),a.labels?(0,f.h)(l,{labels:a.labels,selected:o,onSelect:i}):null,u.order.map(function(t){return(0,f.h)(c,{gen:a,name:t,path:s,selected:o,onSelect:i})})):(0,f.h)(l,{labels:a.labels,caption:u||r,className:r,selected:o,onSelect:i})}function n(t){var e=t.selected,r=t.onSelect,n=s(t,["selected","onSelect"]);return(0,f.h)("div",o({summary:"Generic Groups"},n),(0,f.h)("div",{className:"col"},(0,f.h)(c,{gen:a.default,name:"atom",selected:function(t){return e(t)},onSelect:function(t){return r(t)}}),(0,f.h)(c,{gen:a.default,name:"special",selected:function(t){return e(t)},onSelect:function(t){return r(t)}})),(0,f.h)("div",{className:"col"},(0,f.h)(c,{gen:a.default,name:"group",selected:function(t){return e(t)},onSelect:function(t){return r(t)}})))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},f=t("preact"),i=t("../../../chem/generics"),a=function(t){return t&&t.__esModule?t:{default:t}}(i),d={atom:{caption:"Atom Generics",order:["any","no-carbon","metal","halogen"]},group:{caption:"Group Generics",order:["acyclic","cyclic"]},special:{caption:"Special Nodes",order:[]},"group/acyclic":{caption:"Acyclic",order:["carbo","hetero"]},"group/cyclic":{caption:"Cyclic",order:["no-carbon","carbo","hetero"]},"group/acyclic/carbo":{caption:"Carbo",order:["alkynyl","alkyl","alkenyl"]},"group/acyclic/hetero":{caption:"Hetero",order:["alkoxy"]},"group/cyclic/carbo":{caption:"Carbo",order:["aryl","cycloalkyl","cycloalkenyl"]},"group/cyclic/hetero":{caption:"Hetero",order:["aryl"]},"atom/any":"any atom","atom/no-carbon":"except C or H","atom/metal":"any metal","atom/halogen":"any halogen","group/cyclic/no-carbon":"no carbon","group/cyclic/hetero/aryl":"hetero aryl"};r.default=n},{"../../../chem/generics":521,preact:485}],645:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function u(){return(0,_.h)("tr",null,(0,v.default)(0,19).map(function(t){return(0,_.h)("th",null,t||"")}))}function l(t){var e=t.value,r=t.onChange,n=s(t,["value","onChange"]);return(0,_.h)("fieldset",null,I.map(function(t){return(0,_.h)("label",null,(0,_.h)("input",b({type:"radio",value:t.value,checked:t.value===e,onClick:function(){return r(t.value)}},n)),t.title)}))}function c(t){var e=t.row,r=t.caption,n=t.refer,o=t.selected,i=t.onSelect,a=t.curEvents;return(0,_.h)("tr",null,(0,_.h)("th",null,r),e.map(function(t){return"number"!=typeof t?(0,_.h)("td",null,(0,_.h)(P.default,b({el:t,className:o(t.label)?"selected":"",onClick:function(){return i(t.label)}},a(t)))):n(t)?(0,_.h)("td",{className:"ref"},n(t)):(0,_.h)("td",{colSpan:t})}))}function f(t){var e=t.row,r=t.caption,n=t.selected,o=t.onSelect,i=t.curEvents;return(0,_.h)("tr",null,(0,_.h)("th",{colSpan:"3",className:"ref"},r),e.map(function(t){return(0,_.h)("td",null,(0,_.h)(P.default,b({el:t,className:n(t.label)?"selected":"",onClick:function(){return o(t.label)}},i(t))))}),(0,_.h)("td",null))}function d(t){var e=t.el,r=t.isInfo,n={color:O.sketchingColors[e.label]||"black","font-size":"1.2em"},o={color:O.sketchingColors[e.label]||"black","font-weight":"bold","font-size":"2em"};return(0,_.h)("div",{className:"ket-atom-info "+(r?"":"none")},(0,_.h)("div",{style:n},S.default.map[e.label]),(0,_.h)("span",{style:o},e.label),(0,_.h)("br",null),e.title,(0,_.h)("br",null),e.atomic_mass)}function p(t){var e=t.selection();if(e&&1===Object.keys(e).length&&e.atoms&&1===Object.keys(e.atoms).length){var r=t.struct(),n=r.atoms.get(e.atoms[0]);return b({},(0,R.fromElement)(n))}return{}}Object.defineProperty(r,"__esModule",{value:!0});var h=t("lodash/fp/xor"),m=n(h),g=t("lodash/fp/range"),v=n(g),y=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_=t("preact"),x=t("preact-redux"),w=t("../../../chem/element"),S=n(w),O=t("../../../chem/element-color"),A=t("../../component/dialog"),E=n(A),j=t("../../component/view/atom"),P=n(j),T=t("../../component/view/tabs"),C=n(T),k=t("./generic-groups"),M=n(k),R=t("../../data/convert/structconv"),N=t("../../state"),B=t("../../state/toolbar"),I=[{title:"Single",value:"atom"},{title:"List",value:"list"},{title:"Not List",value:"not-list"}],L={He:16,B:10,Al:10,Hf:1,Rf:1},D=function(t){return t.reduce(function(t,e){var r=t[e.period-1];return r?(L[e.label]&&r.push(L[e.label]),r.push(e)):t.push([e]),t},[])}(S.default.filter(function(t){return t&&"actinide"!==t.type&&"lanthanide"!==t.type})),F=S.default.filter(function(t){return t&&"lanthanide"===t.type}),G=S.default.filter(function(t){return t&&"actinide"===t.type}),z=function(t){function n(t){o(this,n);var e=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));e.curEvents=function(t){return{onMouseEnter:function(){return e.setState({cur:t,isInfo:!0})},onMouseLeave:function(){return e.setState({isInfo:!1})}}};var r=e.props.pseudo?"gen":null;return e.state={type:t.type||r||"atom",value:t.values||t.label||null,cur:S.default[2],isInfo:!1},e.firstType=!0,e.selected=e.selected.bind(e),e.onSelect=e.onSelect.bind(e),e}return a(n,t),y(n,[{key:"changeType",value:function(t){if(this.firstType)return void(this.firstType=!1);var e="list"===this.state.type||"not-list"===this.state.type;"list"!==t&&"not-list"!==t||!e?this.setState({type:t,value:"atom"===t||"gen"===t?null:[]}):this.setState({type:t})}},{key:"selected",value:function(t){var e=this.state,r=e.type,n=e.value;return"atom"===r||"gen"===r?n===t:n.includes(t)}},{key:"onSelect",value:function(t){var e=this.state,r=e.type,n=e.value;this.setState({value:"atom"===r||"gen"===r?t:(0,m.default)([t],n)})}},{key:"result",value:function(){var t=this.state,e=t.type,r=t.value;return"atom"===e?r?{label:r,pseudo:null}:null:"gen"===e?r?{type:e,label:r,pseudo:r}:null:r.length?{type:e,values:r}:null}},{key:"render",value:function(){var e=this,t=["Table","Extended"],r=this.state,n=r.type,o=r.value;return(0,_.h)(E.default,{title:"元素周期表",className:"elements-table",params:this.props,result:function(){return e.result()}},(0,_.h)(C.default,{className:"tabs",captions:t,tabIndex:"gen"!==n?0:1,changeTab:function(t){return e.changeType(0===t?"atom":"gen")}},(0,_.h)("div",{className:"period-table"},(0,_.h)(d,{el:this.state.cur,isInfo:this.state.isInfo}),(0,_.h)(H,{value:o,curEvents:this.curEvents,selected:this.selected,onSelect:this.onSelect}),(0,_.h)(l,{value:n,onChange:function(t){return e.changeType(t)}})),(0,_.h)(M.default,{className:"generic-groups",selected:this.selected,onSelect:this.onSelect})))}}]),n}(_.Component),H=function(t){function e(){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),y(e,[{key:"shouldComponentUpdate",value:function(t){return t.value!==this.props.value}},{key:"render",value:function(){var t=this.props,e=t.curEvents,r=t.selected,n=t.onSelect,o={curEvents:e,selected:r,onSelect:n};return(0,_.h)("table",{summary:"Periodic table of the chemical elements"},(0,_.h)(u,null),D.map(function(t,e){return(0,_.h)(c,b({row:t,caption:e+1,refer:function(t){return 1===t&&(5===e?"*":"**")}},o))}),(0,_.h)(f,b({row:F,caption:"*"},o)),(0,_.h)(f,b({row:G,caption:"**"},o)))}}]),e}(_.Component);r.default=(0,x.connect)(function(t,e){return e.values||e.label?{}:p(t.editor)},function(e,r){return{onOk:function(t){t.type&&"atom"!==t.type||e((0,B.addAtoms)(t.label)),e((0,N.onAction)({tool:"atom",opts:(0,R.toElement)(t)})),r.onOk(t)}}})(z)},{"../../../chem/element":520,"../../../chem/element-color":519,"../../component/dialog":616,"../../component/view/atom":629,"../../component/view/tabs":634,"../../data/convert/structconv":637,"../../state":671,"../../state/toolbar":680,"./generic-groups":644,"lodash/fp/range":433,"lodash/fp/xor":438,preact:485,"preact-redux":484}],646:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var o=t("./mainmenu/open"),i=n(o),a=t("./mainmenu/analyse"),s=n(a),u=t("./mainmenu/recognize"),l=n(u),c=t("./elements/period-table"),f=n(c),d=t("./toolbox/rgroup"),p=n(d),h=t("./template/template-attach"),m=n(h),g=t("./template/template-lib"),v=n(g),y=t("./mainmenu/about"),b=n(y),_=t("./mainmenu/help"),x=n(_),w=t("./mainmenu/miew"),S=n(w),O=t("./toolbox/atom"),A=n(O),E=t("./toolbox/attach"),j=n(E),P=t("./toolbox/automap"),T=n(P),C=t("./toolbox/bond"),k=n(C),M=t("./mainmenu/check"),R=n(M),N=t("./toolbox/labeledit"),B=n(N),I=t("./toolbox/rgroup-logic"),L=n(I),D=t("./mainmenu/save"),F=n(D),G=t("./mainmenu/options"),z=n(G),H=t("./toolbox/sgroup"),W=n(H),U=t("./toolbox/sdata"),V=n(U);r.default={open:i.default,analyse:s.default,recognize:l.default,"period-table":f.default,rgroup:p.default,attach:m.default,templates:v.default,about:b.default,help:x.default,miew:S.default,atomProps:A.default,attachmentPoints:j.default,automap:T.default,bondProps:k.default,check:R.default,labelEdit:B.default,rgroupLogic:L.default,save:F.default,settings:z.default,sgroup:W.default,sdata:V.default}},{"./elements/period-table":645,"./mainmenu/about":647,"./mainmenu/analyse":648,"./mainmenu/check":649,"./mainmenu/help":650,"./mainmenu/miew":651,"./mainmenu/open":652,"./mainmenu/options":653,"./mainmenu/recognize":654,"./mainmenu/save":655,"./template/template-attach":656,"./template/template-lib":657,"./toolbox/atom":658,"./toolbox/attach":659,"./toolbox/automap":660,"./toolbox/bond":661,"./toolbox/labeledit":662,"./toolbox/rgroup":664,"./toolbox/rgroup-logic":663,"./toolbox/sdata":665,"./toolbox/sgroup":666}],647:[function(t,e,r){"use strict";function n(t){return(0,i.h)(u.default,{title:"About",className:"about",params:t,buttons:["关闭"]},(0,i.h)("p",null,"Ketcher is a tool to draw molecular structures and chemical reactions."),(0,i.h)("p",null,"Ketcher Overview"),(0,i.h)("p",null,"Ketcher is a tool to draw molecular structures and chemical reactions. Ketcher operates in two modes, the Server mode with most functions available and the client mode with limited functions available."),(0,i.h)("p",{style:"height:10px"}," "),(0,i.h)("p",null,"* Copyright 2018 EPAM Systems"),(0,i.h)("p",null,"* Licensed under the Apache License, Version 2.0 (the 'License')"),(0,i.h)("p",null,"* you may not use this file except in compliance with the License."),(0,i.h)("p",null,"* You may obtain a copy of the License at"),(0,i.h)("p",null,"* http://www.apache.org/licenses/LICENSE-2.0"),(0,i.h)("p",null,"* Unless required by applicable law or agreed to in writing, software"),(0,i.h)("p",null,"* distributed under the License is distributed on an 'AS IS' BASIS,"),(0,i.h)("p",null,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."),(0,i.h)("p",null,"* See the License for the specific language governing permissions and"),(0,i.h)("p",null,"* limitations under the License."))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},i=t("preact"),a=t("preact-redux"),s=t("../../component/dialog"),u=function(t){return t&&t.__esModule?t:{default:t}}(s);r.default=(0,a.connect)(function(t){return o({},t.options.app)})(n)},{"../../component/dialog":616,preact:485,"preact-redux":484}],648:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){var e=t.value;return(0,g.h)("input",{type:"text",spellCheck:!1,value:e,onKeyDown:function(t){return f(t)}})}function l(t){return(0,g.h)("div",{className:"chem-input",spellCheck:"false",contentEditable:!0,onKeyDown:function(t){return f(t)}},t)}function c(t){var e=t.value;if(j.test(e))return l(e);for(var r=[],n=void 0,o=0;null!==(n=E.exec(e));)n[1].length>0&&r.push((0,g.h)("sup",null,n[1])),r.push(e.substring(o,n.index)+n[2]),n[3].length>0&&r.push((0,g.h)("sub",null,n[3])),o=n.index+n[0].length;return 0===o?r.push(e):r.push(e.substring(o,e.length)),l(r)}function f(t){var e=["Tab","ArrowLeft","ArrowRight","Home","End"],r=(0,b.default)(t);-1===e.indexOf(r)&&t.preventDefault()}function d(t,e){return"number"==typeof t?t.toFixed(e):t.replace(/[0-9]*\.[0-9]+/g,function(t){return(+t).toFixed(e)})}Object.defineProperty(r,"__esModule",{value:!0});var p=t("lodash/fp/range"),h=n(p),m=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),g=t("preact"),v=t("preact-redux"),y=t("w3c-keyname"),b=n(y),_=t("../../component/dialog"),x=n(_),w=t("../../component/form/input"),S=n(w),O=t("../../state/options"),A=t("../../state/server"),E=/\b(\d*)([A-Z][a-z]{0,3}#?)(\d*)\s*\b/g,j=/error:.*/g,P=function(t){function r(t){o(this,r);var e=a(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return t.onAnalyse().catch(t.onCancel),e}return s(r,t),m(r,[{key:"render",value:function(){var t=this.props,r=t.values,n=t.round,o=(t.onAnalyse,t.onChangeRound),e=i(t,["values","round","onAnalyse","onChangeRound"]);return(0,g.h)(x.default,{title:"Calculated Values",className:"analyse",buttons:["关闭"],params:e},(0,g.h)("ul",null,[{name:"Chemical Formula",key:"gross"},{name:"Molecular Weight",key:"molecular-weight",round:"roundWeight"},{name:"Exact Mass",key:"monoisotopic-mass",round:"roundMass"},{name:"Elemental Analysis",key:"mass-composition"}].map(function(e){return(0,g.h)("li",null,(0,g.h)("label",null,e.name,":"),"gross"===e.key?(0,g.h)(c,{value:r?r[e.key]:0}):(0,g.h)(u,{value:r?d(r[e.key],n[e.round]):0}),e.round?(0,g.h)(S.default,{schema:{enum:(0,h.default)(0,8),enumNames:(0,h.default)(0,8).map(function(t){return t+" decimal places"})},value:n[e.round],onChange:function(t){return o(e.round,t)}}):null)})))}}]),r}(g.Component);r.default=(0,v.connect)(function(t){return{values:t.options.analyse.values,round:{roundWeight:t.options.analyse.roundWeight,roundMass:t.options.analyse.roundMass}}},function(r){return{onAnalyse:function(){return r((0,A.analyse)())},onChangeRound:function(t,e){return r((0,O.changeRound)(t,e))}}})(P)},{"../../component/dialog":616,"../../component/form/input":620,"../../state/options":675,"../../state/server":676,"lodash/fp/range":433,preact:485,"preact-redux":484,"w3c-keyname":516}],649:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function l(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t){var e=b.properties.checkOptions.items;return e.enumNames[e.enum.indexOf(t)]}function i(t){var e=["Check","Settings"],r=t.formState,n=t.checkState,o=t.onCheck,i=l(t,["formState","checkState","onCheck"]),a=r.result,s=void 0===a?n:a,u=r.moleculeErrors;return(0,d.h)(p.default,{title:"Structure Check",className:"check",result:function(){return s},params:i},(0,d.h)(g.default,f({schema:b,init:n},r),(0,d.h)(h.default,{className:"tabs",captions:e,changeTab:function(t){return 0===t?o(s.checkOptions):null}},(0,d.h)(c,{moleculeErrors:u}),(0,d.h)(m.Field,{name:"checkOptions",multiple:!0,type:"checkbox",labelPos:!1}))))}function c(t){var e=t.moleculeErrors,r=Object.keys(e);return(0,d.h)("fieldset",t,0===r.length?(0,d.h)("dt",null,"No errors found"):r.map(function(t){return(0,d.h)("div",null,(0,d.h)("dt",null,o(t)," warning:"),(0,d.h)("dd",null,e[t]))}))}Object.defineProperty(r,"__esModule",{value:!0});var f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},d=t("preact"),a=t("preact-redux"),s=t("../../component/dialog"),p=n(s),u=t("../../component/view/tabs"),h=n(u),m=t("../../component/form/form"),g=n(m),v=t("../../state/server"),y=t("../../state/options"),b={title:"Check",type:"object",properties:{checkOptions:{type:"array",items:{type:"string",enum:["valence","radicals","pseudoatoms","stereo","query","overlapping_atoms","overlapping_bonds","rgroups","chiral","3d","chiral_flag"],enumNames:["Valence","Radical","Pseudoatom","Stereochemistry","Query","Overlapping Atoms","Overlapping Bonds","R-Groups","Chirality","3D Structure","Chiral flag"]}}}};r.default=(0,a.connect)(function(t){return{formState:t.modal.form,checkState:t.options.check}},function(e,r){return{onCheck:function(t){return e((0,v.check)(t)).catch(r.onCancel)},onOk:function(t){e((0,y.checkOpts)(t)),r.onOk(t)}}})(i)},{"../../component/dialog":616,"../../component/form/form":619,"../../component/view/tabs":634,"../../state/options":675,"../../state/server":676,preact:485,"preact-redux":484}],650:[function(t,e,r){"use strict";function n(t){return(0,o.h)(a.default,{title:"Help",className:"help",params:t,buttons:["关闭"]},(0,o.h)("iframe",{className:"help",src:"doc/help.html"}))}Object.defineProperty(r,"__esModule",{value:!0});var o=t("preact"),i=t("../../component/dialog"),a=function(t){return t&&t.__esModule?t:{default:t}}(i);r.default=n},{"../../component/dialog":616,preact:485}],651:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){var e={settings:{theme:t.miewTheme,autoPreset:!1,editing:!0,inversePanning:!0},reps:[{mode:t.miewMode}]},r=w(t);return r&&e.reps.push(r),e}Object.defineProperty(r,"__esModule",{value:!0});var l=t("lodash/fp/pick"),c=n(l),f=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),d=t("preact"),p=t("preact-redux"),h=t("../../component/dialog"),m=n(h),g=t("../../data/convert/structformat"),v=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(g),y=t("../../data/schema/options-schema"),b=t("../../state"),_={dark:"0x202020",light:"0xcccccc"},x={no:null,bright:{colorer:"EL"},blackAndWhite:{colorer:["UN",{color:16777215}],bg:"0x000"},black:{colorer:["UN",{color:0}]}},w=function(t){var e=t.miewAtomLabel;return null===x[e]?null:{colorer:x[e].colorer,selector:"not elem C",mode:["TX",{bg:x[e].bg||_[t.miewTheme],showBg:!0,template:"{{elem}}"}]}},S=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),f(e,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.struct,n=t.server,o=t.miewOpts,i=window.Miew;this.viewer=new i({container:this.miewContainer}),this.viewer.init()&&this.viewer.run(),v.toString(r,"cml",n).then(function(t){return e.viewer.load(t,{sourceType:"immediate",fileType:"cml"})}).then(function(){return e.viewer.setOptions(o)}).catch(function(t){return console.error(t.message)})}},{key:"exportCML",value:function(){var t=this.viewer.exportCML();this.props.onExportCML(t)}},{key:"render",value:function(){var e=this,t=this.props,r=(t.miewOpts,t.server,t.struct,o(t,["miewOpts","server","struct"]));return(0,d.h)(m.default,{title:"Miew",className:"miew",params:r,buttons:[(0,d.h)("div",{className:"warning"},"Stereocenters can be changed after the strong 3D rotation"),"关闭",(0,d.h)("button",{onClick:function(){return e.exportCML()}},"Apply")]},(0,d.h)("div",{ref:function(t){e.miewContainer=t},className:"miew-container",style:{width:"1024px",height:"600px",position:"relative"}}))}}]),e}(d.Component);r.default=(0,p.connect)(function(t){return{miewOpts:u((0,c.default)(y.MIEW_OPTIONS,t.options.settings)),server:t.options.app.server?t.server:null,struct:t.editor.struct()}},function(e,r){return{onExportCML:function(t){e((0,b.load)(t)),r.onOk()}}})(S)},{"../../component/dialog":616,"../../data/convert/structformat":638,"../../data/schema/options-schema":639,"../../state":671,"lodash/fp/pick":430,preact:485,"preact-redux":484}],652:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(){return Object.keys(d.map).reduce(function(t,e){return t.concat.apply(t,[d.map[e].mime].concat(o(d.map[e].ext)))},[]).join(",")}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),c=t("preact"),f=t("preact-redux"),d=t("../../data/convert/structformat"),p=t("../../component/dialog"),h=n(p),m=t("../../component/view/openbutton"),g=n(m),v=t("../../component/cliparea"),y=n(v),b=t("../../state"),_=function(t){function r(t){i(this,r);var e=a(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e.state={structStr:"",fragment:!1},e}return s(r,t),l(r,[{key:"result",value:function(){var t=this.state,e=t.structStr,r=t.fragment;return e?{structStr:e,fragment:r}:null}},{key:"changeStructStr",value:function(t){this.setState({structStr:t})}},{key:"changeFragment",value:function(t){this.setState({fragment:t.checked})}},{key:"render",value:function(){var e=this,t=this.state,r=t.structStr,n=t.fragment;return(0,c.h)(h.default,{title:"打开结构式",className:"open",result:function(){return e.result()},params:this.props,buttons:[(0,c.h)(g.default,{server:this.props.server,type:u(),onLoad:function(t){return e.changeStructStr(t)}},"导入文件"),"取消","确定"]},(0,c.h)("textarea",{value:r,onInput:function(t){return e.changeStructStr(t.target.value)}}),(0,c.h)("label",null,(0,c.h)("input",{type:"checkbox",checked:n,onClick:function(t){return e.changeFragment(t.target)}}),"作为片段加载并复制到剪贴板"),(0,c.h)(y.default,{focused:function(){return!0},onCopy:function(){return{"text/plain":r}}}))}}]),r}(c.Component);r.default=(0,f.connect)(function(t){return{server:t.server}},function(t,o){return{onOk:function(e){if(filesType==="smi"){var r=new XMLHttpRequest;r.open("GET","/api/structurals/smiles2mol?smilescode="+e.structStr,true);r.send();r.onreadystatechange=function(){if(r.readyState===4&&(r.status===200||r.status===304)){var t=JSON.parse(r.responseText);if(t.code===200){e.structStr=t.data.mol;n()}}}}else{n()}function n(){e.fragment&&(0,v.exec)("copy"),t((0,b.load)(e.structStr,{badHeaderRecover:!0,fragment:e.fragment})),o.onOk(e);setTimeout(function(){var t=document.getElementById("canvas"),e=t.firstChild,r=e.clientHeight,n=e.clientWidth;if(r>t.clientHeight){t.scrollTop=r}if(n>t.clientWidth){t.scrollLeft=n}},100)}}}})(_)},{"../../component/cliparea":615,"../../component/dialog":616,"../../component/view/openbutton":631,"../../data/convert/structformat":638,"../../state":671,preact:485,"preact-redux":484}],653:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function l(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t){var e=t.initState,r=t.formState,n=t.server,o=t.onOpenFile,i=t.onReset,a=t.appOpts,s=l(t,["initState","formState","server","onOpenFile","onReset","appOpts"]),u=["Rendering customization options","Atoms","Bonds","Server","3D Viewer","Options for debugging"];return(0,f.h)(v.default,{title:"Settings",className:"settings",result:function(){return r.result},valid:function(){return r.valid},params:s,buttons:[(0,f.h)(S.default,{server:n,onLoad:o},"导入文件"),(0,f.h)(x.default,{data:JSON.stringify(r.result),filename:"ketcher-settings"},"保存为文件"),(0,f.h)("button",{onClick:i},"Reset"),"取消","确定"]},(0,f.h)(m.default,c({schema:d.default,init:e},r),(0,f.h)(b.default,{className:"accordion",multiple:!1,captions:u,active:[0]},(0,f.h)("fieldset",{className:"render"},(0,f.h)(h.Field,{name:"resetToSelect"}),(0,f.h)(h.Field,{name:"rotationStep"}),(0,f.h)(h.Field,{name:"showValenceWarnings",component:T.default}),(0,f.h)(h.Field,{name:"atomColoring",component:T.default}),(0,f.h)(h.Field,{name:"hideChiralFlag",component:T.default}),(0,f.h)(h.Field,{name:"font",component:j.default}),(0,f.h)(h.Field,{name:"fontsz",component:A.default}),(0,f.h)(h.Field,{name:"fontszsub",component:A.default})),(0,f.h)("fieldset",{className:"atoms"},(0,f.h)(h.Field,{name:"carbonExplicitly",component:T.default}),(0,f.h)(h.Field,{name:"showCharge",component:T.default}),(0,f.h)(h.Field,{name:"showValence",component:T.default}),(0,f.h)(h.Field,{name:"showHydrogenLabels",component:T.default})),(0,f.h)("fieldset",{className:"bonds"},(0,f.h)(h.Field,{name:"aromaticCircle",component:T.default}),(0,f.h)(h.Field,{name:"doubleBondWidth",component:A.default}),(0,f.h)(h.Field,{name:"bondThickness",component:A.default}),(0,f.h)(h.Field,{name:"stereoBondWidth",component:A.default})),(0,f.h)("fieldset",{className:"server",disabled:!a.server},(0,f.h)(h.Field,{name:"smart-layout",component:T.default}),(0,f.h)(h.Field,{name:"ignore-stereochemistry-errors",component:T.default}),(0,f.h)(h.Field,{name:"mass-skip-error-on-pseudoatoms",component:T.default}),(0,f.h)(h.Field,{name:"gross-formula-add-rsites",component:T.default}),(0,f.h)(h.Field,{name:"gross-formula-add-isotopes",component:T.default})),(0,f.h)("fieldset",{className:"miew",disabled:!window.Miew},(0,f.h)(h.Field,{name:"miewMode"}),(0,f.h)(h.Field,{name:"miewTheme"}),(0,f.h)(h.Field,{name:"miewAtomLabel"})),(0,f.h)("fieldset",{className:"debug"},(0,f.h)(h.Field,{name:"showAtomIds",component:T.default}),(0,f.h)(h.Field,{name:"showBondIds",component:T.default}),(0,f.h)(h.Field,{name:"showHalfBondIds",component:T.default}),(0,f.h)(h.Field,{name:"showLoopIds",component:T.default}))),p.storage.isAvailable()?null:(0,f.h)("div",{className:"warning"},p.storage.warningMessage)))}Object.defineProperty(r,"__esModule",{value:!0});var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},f=t("preact"),i=t("preact-redux"),a=t("../../state/modal/form"),s=t("../../state/options"),u=t("../../data/schema/options-schema"),d=n(u),p=t("../../storage-ext"),h=t("../../component/form/form"),m=n(h),g=t("../../component/dialog"),v=n(g),y=t("../../component/view/accordion"),b=n(y),_=t("../../component/view/savebutton"),x=n(_),w=t("../../component/view/openbutton"),S=n(w),O=t("../../component/form/measure-input"),A=n(O),E=t("../../component/form/systemfonts"),j=n(E),P=t("../../component/form/select-checkbox"),T=n(P);r.default=(0,i.connect)(function(t){return{server:t.options.app.server?t.server:null,appOpts:t.options.app,initState:t.options.settings,formState:t.modal.form}},function(e,r){return{onOpenFile:function(t){try{e((0,a.updateFormState)({result:JSON.parse(t)}))}catch(t){console.info("Bad file")}},onReset:function(){return e((0,a.setDefaultSettings)())},onOk:function(t){e((0,s.saveSettings)(t)),r.onOk(t)}}})(o)},{"../../component/dialog":616,"../../component/form/form":619,"../../component/form/measure-input":621,"../../component/form/select-checkbox":622,"../../component/form/systemfonts":624,"../../component/view/accordion":628,"../../component/view/openbutton":631,"../../component/view/savebutton":632,"../../data/schema/options-schema":639,"../../state/modal/form":672,"../../state/options":675,"../../storage-ext":681,preact:485,"preact-redux":484}],654:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function p(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t){var e=t.file,r=t.structStr,n=t.fragment,o=t.version,i=t.imagoVersions,a=p(t,["file","structStr","fragment","version","imagoVersions"]),s=a.onRecognize,u=a.isFragment,l=a.onImage,c=a.onChangeImago,f=p(a,["onRecognize","isFragment","onImage","onChangeImago"]),d=function(){return!r||r instanceof Promise?null:{structStr:r,fragment:n}};return(0,g.h)(v.default,{title:"Import From Image",className:"recognize",params:f,result:function(){return d()},buttons:[(0,g.h)(x.default,{onLoad:l,type:"image/*"},"Choose file…"),(0,g.h)("span",{className:"open-filename"},e?e.name:null),e&&(0,g.h)("button",{onClick:function(){return s(e,o)},disabled:r&&"string"!=typeof r},"Recognize"),"取消","确定"]},(0,g.h)("label",{className:"change-version"},"Imago version:",(0,g.h)(y.default,{schema:{enum:i,enumNames:(0,m.default)(1,i.length+1).map(function(t){return"Version "+t})},value:o,onChange:function(t){return c(t)}})),(0,g.h)("div",{className:"picture"},e&&(0,g.h)("img",{alt:"",id:"pic",src:h(e)||"",onError:function(){l(null),alert("Error, it isn't a picture")}})),(0,g.h)("div",{className:"output"},r&&(r instanceof Promise||"string"!=typeof r?(0,g.h)(S.default,null):(0,g.h)(b.default,{className:"struct",struct:r}))),(0,g.h)("label",null,(0,g.h)(y.default,{type:"checkbox",value:n,onChange:function(t){return u(t)}}),"Load as a fragment"))}function h(t){if(!t)return null;var e=window.URL||window.webkitURL;return e?e.createObjectURL(t):"No preview"}Object.defineProperty(r,"__esModule",{value:!0});var i=t("lodash/fp/range"),m=n(i),g=t("preact"),a=t("preact-redux"),s=t("../../state/options"),u=t("../../state"),l=t("../../state/server"),c=t("../../component/dialog"),v=n(c),f=t("../../component/form/input"),y=n(f),d=t("../../component/structrender"),b=n(d),_=t("../../component/view/openbutton"),x=n(_),w=t("../../component/view/spin"),S=n(w);r.default=(0,a.connect)(function(t){return{imagoVersions:t.options.app.imagoVersions,file:t.options.recognize.file,structStr:t.options.recognize.structStr,fragment:t.options.recognize.fragment,version:t.options.recognize.version||t.options.app.imagoVersions[0]}},function(r,e){return{isFragment:function(t){return r((0,s.shouldFragment)(t))},onImage:function(t){return r((0,s.changeImage)(t))},onRecognize:function(t,e){return r((0,l.recognize)(t,e))},onChangeImago:function(t){return r((0,s.changeVersion)(t))},onOk:function(t){r((0,u.load)(t.structStr,{rescale:!0,fragment:t.fragment})),e.onOk(t)}}})(o)},{"../../component/dialog":616,"../../component/form/input":620,"../../component/structrender":627,"../../component/view/openbutton":631,"../../component/view/spin":633,"../../state":671,"../../state/options":675,"../../state/server":676,"lodash/fp/range":433,preact:485,"preact-redux":484}],655:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},s=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),l=t("preact"),c=t("preact-redux"),f=t("../../data/convert/structformat"),d=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(f),p=t("../../state/templates"),h=t("../../state/modal/form"),m=t("../../component/dialog"),g=n(m),v=t("../../component/form/form"),y=n(v),b=t("../../component/view/savebutton"),_=n(b),x={title:"Save",type:"object",properties:{filename:{title:"文件名",type:"string",maxLength:128,pattern:/^[^.<>:?"*|\/\\][^<>:?"*|\/\\]*$/,invalidMessage:function(t){return t?t.length>128?"文件名过长":"文件名不能包含字符: \\ / : * ? \" < > | 不能以'.'开头":"文件名不能为空"}},format:{title:"文件格式",enum:Object.keys(d.map),enumNames:Object.keys(d.map).map(function(t){return d.map[t].name})}}},w=function(t){function n(e){o(this,n);var t=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));t.isRxn=t.props.struct.hasRxnArrow();var r=[t.isRxn?"rxn":"mol","smiles"];return t.props.server&&r.push(),t.saveSchema=x,t.saveSchema.properties.format=Object.assign(t.saveSchema.properties.format,{enum:r,enumNames:r.map(function(t){return d.map[t].name})}),t.changeType(t.isRxn?"rxn":"mol").then(function(t){return t instanceof Error?e.onCancel():null}),t}return a(n,t),s(n,[{key:"changeType",value:function(t){var e=this,r=this.props,n=r.struct,o=r.server,i=r.options,a=r.formState;return d.toString(n,t,o,i).then(function(t){e.setState({structStr:t}),setTimeout(function(){return e.textarea.select()},10)},function(t){return alert(t.message),e.props.onResetForm(a),t})}},{key:"render",value:function(){var e=this,t=this.state.structStr,r=this.props.formState,n=r.result,o=n.filename,i=n.format,a=d.couldBeSaved(this.props.struct,i),s=this.props.struct.isBlank();return(0,l.h)(g.default,{title:"保存结构式",className:"save",params:this.props,buttons:[(0,l.h)(_.default,{data:t,filename:o+d.map[i].ext[0],type:i.mime,server:this.props.server,onSave:function(){return e.props.onOk()},disabled:!r.valid||s},"保存为文件"),(0,l.h)("button",{className:"save-tmpl",disabled:s,onClick:function(){return e.props.onTmplSave(e.props.struct)}},"保存为模板"),"关闭"]},(0,l.h)(y.default,u({schema:this.saveSchema,init:{filename:o,format:this.isRxn?"rxn":"mol"}},r),(0,l.h)(v.Field,{name:"filename"}),(0,l.h)(v.Field,{name:"format",onChange:function(t){return e.changeType(t)}})),(0,l.h)("textarea",{value:t,readOnly:!0,ref:function(t){e.textarea=t}}),a&&(0,l.h)("div",{className:"warning"},a))}}]),n}(l.Component);r.default=(0,c.connect)(function(t){return{server:t.options.app.server?t.server:null,struct:t.editor.struct(),options:t.options.getServerSettings(),formState:t.modal.form}},function(e){return{onTmplSave:function(t){return e((0,p.saveUserTmpl)(t))},onResetForm:function(t){return e((0,h.updateFormState)(t))}}})(w)},{"../../component/dialog":616,"../../component/form/form":619,"../../component/view/savebutton":632,"../../data/convert/structformat":638,"../../state/modal/form":672,"../../state/templates":678,preact:485,"preact-redux":484}],656:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function l(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){var e={struct:o(t.struct),props:{atomid:+t.props.atomid||0,bondid:+t.props.bondid||0}};return e.struct.name=t.struct.name,e}function o(t){var e=t.clone(),r=e.getCoordBoundingBox();return e.atoms.forEach(function(t){t.pp=t.pp.sub(r.min)}),e.sgroups.forEach(function(t){t.pp=t.pp?t.pp.sub(r.min):r.min}),e.rxnArrows.forEach(function(t){t.pp=t.pp.sub(r.min)}),e.rxnPluses.forEach(function(t){t.pp=t.pp.sub(r.min)}),e}function c(t){var e=t.getCoordBoundingBox(),r=220/Math.max(e.max.y-e.min.y,e.max.x-e.min.x);return r<35&&(r=35),r>60&&(r=60),r}Object.defineProperty(r,"__esModule",{value:!0});var f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},d=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),p=t("preact"),h=t("preact-redux"),m=t("../../component/dialog"),g=n(m),v=t("../../component/form/input"),y=n(v),b=t("../../component/structeditor"),_=n(b),x=t("../../storage-ext"),w=t("../../state/templates"),S={selectionStyle:{fill:"#47b3ec",stroke:"none"},highlightStyle:{stroke:"#1a7090","stroke-width":1.2}},O=function(t){function o(t){var e=t.onInit,r=l(t,["onInit"]);i(this,o);var n=a(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return n.tmpl=u(r.tmpl),e(n.tmpl.struct.name,n.tmpl.props),n.onResult=n.onResult.bind(n),n}return s(o,t),d(o,[{key:"onResult",value:function(){var t=this.props,e=t.name,r=t.atomid,n=t.bondid;return!e||e===this.tmpl.struct.name&&r===this.tmpl.props.atomid&&n===this.tmpl.props.bondid?null:{name:e,attach:{atomid:r,bondid:n}}}},{key:"render",value:function(){var t=this.props,e=t.name,r=t.atomid,n=t.bondid,o=t.onNameEdit,i=t.onAttachEdit,a=l(t,["name","atomid","bondid","onNameEdit","onAttachEdit"]),s=this.tmpl.struct,u=Object.assign(S,{scale:c(s)});return(0,p.h)(g.default,{title:"Template Edit",className:"attach",result:this.onResult,params:a},(0,p.h)("label",null,"Template name:",(0,p.h)(y.default,{value:e,onChange:o})),(0,p.h)("label",null,"Choose attachment atom and bond:"),(0,p.h)(_.default,{className:"editor",struct:s,onAttachEdit:i,tool:"attach",toolOpts:{atomid:r,bondid:n},options:u}),x.storage.isAvailable()?null:(0,p.h)("div",{className:"warning"},x.storage.warningMessage))}}]),o}(p.Component);r.default=(0,h.connect)(function(t){return f({},t.templates.attach)},function(r){return{onInit:function(t,e){return r((0,w.initAttach)(t,e))},onAttachEdit:function(t){return r((0,w.setAttachPoints)(t))},onNameEdit:function(t){return r((0,w.setTmplName)(t))}}})(O)},{"../../component/dialog":616,"../../component/form/input":620,"../../component/structeditor":626,"../../state/templates":678,"../../storage-ext":681,preact:485,"preact-redux":484}],657:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function s(t,e){return console.assert(t.props&&t.props.group,"No group"),t.struct.name||t.props.group+" template "+(e+1)}function l(t,e){return console.warn("partition",t),(0,S.default)(t)(e)}function c(t){return t.replace(K,function(t){return Y[t]})}function f(t,e){console.warn("Filter",e);var r=new RegExp((0,A.default)(c(e)),"i");return(0,x.default)((0,b.default)(function(t){return!e||r.test(c(t.struct.name))||r.test(c(t.props.group))}),(0,v.default)(function(t,e){return t[e.props.group]?t[e.props.group].push(e):t[e.props.group]=[e],t},{}))(t)}function d(t,e,r){return console.warn("Group",e),l(r,t[e])}function p(t){var e=t.tmpl,r=u(t,["tmpl"]);return e.props&&e.props.prerender?(0,T.h)("svg",r,(0,T.h)("use",{xlinkHref:e.props.prerender})):(0,T.h)(I.default,j({struct:e.struct,options:{autoScaleMargin:15}},r))}Object.defineProperty(r,"__esModule",{value:!0});var h=t("lodash/fp/omit"),m=n(h),g=t("lodash/fp/reduce"),v=n(g),y=t("lodash/fp/filter"),b=n(y),_=t("lodash/fp/flow"),x=n(_),w=t("lodash/fp/chunk"),S=n(w),O=t("lodash/fp/escapeRegExp"),A=n(O),E=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),j=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},P=t("reselect"),T=t("preact"),C=t("preact-redux"),k=t("../../../chem/sdf"),M=n(k),R=t("../../component/view/visibleview"),N=n(R),B=t("../../component/structrender"),I=n(B),L=t("../../component/dialog"),D=n(L),F=t("../../component/view/savebutton"),G=n(F),z=t("../../component/form/input"),H=n(z),W=t("../../component/form/select"),U=n(W),V=t("../../state/templates"),q=t("../../state"),Y={Alpha:"A",alpha:"α",Beta:"B",beta:"β",Gamma:"Г",gamma:"γ"},K=new RegExp("\\b"+Object.keys(Y).join("\\b|\\b")+"\\b","g"),$=(0,P.createSelector)(function(t){return t.lib},function(t){return t.filter},f),X=(0,P.createSelector)(function(t){return t.lib},function(t){return t.group},function(t){return t.COLS},d),Z=function(t){function e(){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),E(e,[{key:"select",value:function(t){t===this.props.selected?this.props.onOk(this.result()):this.props.onSelect(t)}},{key:"result",value:function(){var t=this.props.selected;return console.assert(!t||t.props,"Incorrect SDF parse"),t?{struct:t.struct,aid:parseInt(t.props.atomid)||null,bid:parseInt(t.props.bondid)||null}:null}},{key:"renderRow",value:function(t,r,n){var o=this;return(0,T.h)("div",{className:"tr",key:r},t.map(function(t,e){return(0,T.h)("div",{className:t===o.props.selected?"td selected":"td",title:c(s(t,r*n+e))},(0,T.h)(p,{tmpl:t,className:"struct",onClick:function(){return o.select(t)}}),(0,T.h)("button",{},""))}))}},{key:"render",value:function(){var r=this,t=this.props,e=t.filter,n=t.onFilter,o=t.onChangeGroup,i=u(t,["filter","onFilter","onChangeGroup"]),a=i.group,s=$(this.props);return a=s[a]?a:Object.keys(s)[0],(0,T.h)(D.default,{title:"模板收藏夹",className:"template-lib",params:(0,m.default)(["group"],i),result:function(){return r.result()},buttons:[(0,T.h)(G.default,{data:M.default.stringify(this.props.lib),filename:"ketcher-tmpls.sdf"},"Save To SDF…"),"取消","确定"]},(0,T.h)("label",null,"Filter:",(0,T.h)(H.default,{type:"search",value:e,onChange:function(t){return n(t)}})),(0,T.h)(H.default,{className:"groups",component:U.default,splitIndexes:[Object.keys(s).indexOf("User Templates")],value:a,onChange:function(t){return o(t)},schema:{enum:Object.keys(s),enumNames:Object.keys(s).map(function(t){return c(t)})}}),(0,T.h)(N.default,{data:X({lib:s,group:a,COLS:3}),rowHeight:120,className:"table"},function(t,e){return r.renderRow(t,e,3)}))}}]),e}(T.Component);r.default=(0,C.connect)(function(t){return j({},(0,m.default)(["attach"],t.templates))},function(e,r){return{onFilter:function(t){return e((0,V.changeFilter)(t))},onSelect:function(t){return e((0,V.selectTmpl)(t))},onChangeGroup:function(t){return e((0,V.changeGroup)(t))},onAttach:function(t){return e((0,V.editTmpl)(t))},onOk:function(t){e((0,q.onAction)({tool:"template",opts:t})),r.onOk(t)}}})(Z)},{"../../../chem/sdf":529,"../../component/dialog":616,"../../component/form/input":620,"../../component/form/select":623,"../../component/structrender":627,"../../component/view/savebutton":632,"../../component/view/visibleview":635,"../../state":671,"../../state/templates":678,"lodash/fp/chunk":419,"lodash/fp/escapeRegExp":422,"lodash/fp/filter":423,"lodash/fp/flow":426,"lodash/fp/omit":429,"lodash/fp/reduce":434,preact:485,"preact-redux":484,reselect:508}],658:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t,e){var r=e.stateStore,n=r.props.result;return(0,d.h)("label",null,"Number:",(0,d.h)("input",{className:"number",type:"text",readOnly:!0,value:_.default.map[(0,c.default)(n.label)]||""}))}function a(t){var e=t.formState,r=o(t,["formState"]);return(0,d.h)(y.default,{title:"Atom Properties",className:"atom-props",result:function(){return e.result},valid:function(){return e.valid},params:r},(0,d.h)(g.default,f({schema:h.atom,customValid:{label:function(t){return s(t)},charge:function(t){return u(t)}},init:r},e),(0,d.h)("fieldset",{className:"main"},(0,d.h)(m.Field,{name:"label"}),(0,d.h)(m.Field,{name:"alias"}),(0,d.h)(i,null),(0,d.h)(m.Field,{name:"charge",maxlength:"5"}),(0,d.h)(m.Field,{name:"explicitValence"}),(0,d.h)(m.Field,{name:"isotope"}),(0,d.h)(m.Field,{name:"radical"})),(0,d.h)("fieldset",{className:"query"},(0,d.h)("legend",null,"Query specific"),(0,d.h)(m.Field,{name:"ringBondCount"}),(0,d.h)(m.Field,{name:"hCount"}),(0,d.h)(m.Field,{name:"substitutionCount"}),(0,d.h)(m.Field,{name:"unsaturatedAtom"})),(0,d.h)("fieldset",{className:"reaction"},(0,d.h)("legend",null,"Reaction flags"),(0,d.h)(m.Field,{name:"invRet"}),(0,d.h)(m.Field,{name:"exactChangeFlag"}))))}function s(t){return t&&!!_.default.map[(0,c.default)(t)]}function u(t){var e=h.atom.properties.charge.pattern.exec(t);return!(null===e||""!==e[1]&&""!==e[3])}Object.defineProperty(r,"__esModule",{value:!0});var l=t("lodash/fp/capitalize"),c=n(l),f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},d=t("preact"),p=t("preact-redux"),h=t("../../data/schema/struct-schema"),m=t("../../component/form/form"),g=n(m),v=t("../../component/dialog"),y=n(v),b=t("../../../chem/element"),_=n(b);r.default=(0,p.connect)(function(t){return{formState:t.modal.form}})(a)},{"../../../chem/element":520,"../../component/dialog":616,"../../component/form/form":619,"../../data/schema/struct-schema":642,"lodash/fp/capitalize":418,preact:485,"preact-redux":484}],659:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t){var e=t.formState,r=o(t,["formState"]);return(0,s.h)(p.default,{title:"Attachment Points",className:"attach-points",result:function(){return e.result},valid:function(){return e.valid},params:r},(0,s.h)(f.default,a({schema:l.attachmentPoints,init:r},e),(0,s.h)(c.Field,{name:"primary"}),(0,s.h)(c.Field,{name:"secondary"})))}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},s=t("preact"),u=t("preact-redux"),l=t("../../data/schema/struct-schema"),c=t("../../component/form/form"),f=n(c),d=t("../../component/dialog"),p=n(d);r.default=(0,u.connect)(function(t){return{formState:t.modal.form}})(i)},{"../../component/dialog":616,"../../component/form/form":619,"../../data/schema/struct-schema":642,preact:485,"preact-redux":484}],660:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t){var e=t.formState,r=o(t,["formState"]);return(0,s.h)(d.default,{title:"Reaction Auto-Mapping",className:"automap",result:function(){return e.result},valid:function(){return e.valid},params:r},(0,s.h)(c.default,a({schema:h},e),(0,s.h)(l.Field,{name:"mode"})))}Object.defineProperty(r,"__esModule",{value:!0}),r.automapSchema=void 0;var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},s=t("preact"),u=t("preact-redux"),l=t("../../component/form/form"),c=n(l),f=t("../../component/dialog"),d=n(f),p=t("../../state/server"),h=r.automapSchema={title:"Reaction Auto-Mapping",type:"object",required:["mode"],properties:{mode:{title:"Mode",enum:["discard","keep","alter","clear"],enumNames:["Discard","Keep","Alter","Clear"],default:"discard"}}};r.default=(0,u.connect)(function(t){return{formState:t.modal.form}},function(e,r){return{onOk:function(t){e((0,p.automap)(t)),r.onOk(t)}}})(i)},{"../../component/dialog":616,"../../component/form/form":619,"../../state/server":676,preact:485,"preact-redux":484}],661:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function i(t){var e=t.formState,r=o(t,["formState"]);return(0,s.h)(p.default,{title:"Bond Properties",className:"bond",result:function(){return e.result},valid:function(){return e.valid},params:r},(0,s.h)(f.default,a({schema:l.bond,init:r},e),(0,s.h)(c.Field,{name:"type"}),(0,s.h)(c.Field,{name:"topology"}),(0,s.h)(c.Field,{name:"center"})))}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},s=t("preact"),u=t("preact-redux"),l=t("../../data/schema/struct-schema"),c=t("../../component/form/form"),f=n(c),d=t("../../component/dialog"),p=n(d);r.default=(0,u.connect)(function(t){return{formState:t.modal.form}})(i)},{"../../component/dialog":616,"../../component/form/form":619,"../../data/schema/struct-schema":642,preact:485,"preact-redux":484}],662:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function s(t){var e=Math.abs(t.charge),r=["",":",".","^^"][t.radical]||"",n="";return e&&(n=t.charge<0?"-":"+"),(t.isotope||"")+t.label+r+(e>1?e:"")+n}function u(t){var e=t.match(/^(\d+)?([a-z*]{1,3})(\.|:|\^\^)?(\d+[-+]|[-+])?$/i);if(e){var r="*"===e[2]?"A":(0,l.default)(e[2]),n=0,o=0,i=0;if(e[1]&&(o=parseInt(e[1])),e[3]&&(i={":":1,".":2,"^^":3}[e[3]]),e[4]&&(n=parseInt(e[4]),isNaN(n)&&(n=1),e[4].endsWith("-")&&(n=-n)),"A"===r||"Q"===r||"X"===r||"M"===r||h.default.map[r])return{label:r,charge:n,isotope:o,radical:i}}return null}function o(t){var e={label:t.letter||s(t)},r=t.formState,n=a(t,["formState"]),o=r.result,i=r.valid;return(0,f.h)(v.default,{title:"Label Edit",className:"labeledit",valid:function(){return i},result:function(){return u(o.label)},params:n},(0,f.h)(b.default,c({schema:m.labelEdit,customValid:{label:function(t){return u(t)}},init:e},r),(0,f.h)(y.Field,{name:"label",maxlength:"20",size:"10"})))}Object.defineProperty(r,"__esModule",{value:!0});var i=t("lodash/fp/capitalize"),l=n(i),c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},f=t("preact"),d=t("preact-redux"),p=t("../../../chem/element"),h=n(p),m=t("../../data/schema/struct-schema"),g=t("../../component/dialog"),v=n(g),y=t("../../component/form/form"),b=n(y);r.default=(0,d.connect)(function(t){return{formState:t.modal.form}})(o)},{"../../../chem/element":520,"../../component/dialog":616,"../../component/form/form":619,"../../data/schema/struct-schema":642,"lodash/fp/capitalize":418,preact:485,"preact-redux":484}],663:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function a(e,t){var r=t.schema,n=e.name,o=e.rgids,i={title:r.properties[n].title,enum:[0],enumNames:["Always"]};return o.forEach(function(t){e.label!==t&&(i.enum.push(t),i.enumNames.push("IF R"+e.label+" THEN R"+t))}),(0,l.h)(d.Field,u({name:n,schema:i},e))}function o(t){var e=t.formState,r=t.label,n=t.rgroupLabels,o=i(t,["formState","label","rgroupLabels"]);return(0,l.h)(m.default,{title:"R-Group Logic",className:"rgroup-logic",result:function(){return e.result},valid:function(){return e.valid},params:o},(0,l.h)(p.default,u({schema:f.rgroupLogic,customValid:{range:function(t){return s(t)}},init:o},e),(0,l.h)(d.Field,{name:"range"}),(0,l.h)(d.Field,{name:"resth"}),(0,l.h)(a,{name:"ifthen",className:"cond",label:r,rgids:n})))}function s(t){return t.replace(/\s*/g,"").replace(/,+/g,",").replace(/^,/,"").replace(/,$/,"").split(",").every(function(t){return t.match(/^[>,<=]?[0-9]+$/g)||t.match(/^[0-9]+-[0-9]+$/g)})}Object.defineProperty(r,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},l=t("preact"),c=t("preact-redux"),f=t("../../data/schema/struct-schema"),d=t("../../component/form/form"),p=n(d),h=t("../../component/dialog"),m=n(h);r.default=(0,c.connect)(function(t){return{formState:t.modal.form}})(o)},{"../../component/dialog":616,"../../component/form/form":619,"../../data/schema/struct-schema":642,preact:485,"preact-redux":484}],664:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t){var e=t.disabledIds,r=t.values,n=t.formState,o=t.type,i=a(t,["disabledIds","values","formState","type"]);return(0,u.h)(f.default,{title:"R-Group",className:"rgroup",params:i,result:function(){return n.result}},(0,u.h)(p.default,s({schema:l.rgroupSchema,init:{values:r}},n),(0,u.h)(d.Field,{name:"values",multiple:"atom"===o,labelPos:!1,component:m.default,disabledIds:e})))}Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},u=t("preact"),i=t("preact-redux"),l=t("../../data/schema/struct-schema"),c=t("../../component/dialog"),f=n(c),d=t("../../component/form/form"),p=n(d),h=t("../../component/form/buttonlist"),m=n(h);r.default=(0,i.connect)(function(t){return{formState:t.modal.form}})(o)},{"../../component/dialog":616,"../../component/form/buttonlist":617,"../../component/form/form":619,"../../data/schema/struct-schema":642,preact:485,"preact-redux":484}],665:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function p(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function h(t){var e=t.title,r=t.name,n=t.schema,o=p(t,["title","name","schema"]),i=Object.keys(n).reduce(function(t,e){return t.enum.push(e),t.enumNames.push(n[e].title||e),t},{title:e,type:"string",default:"",minLength:1,enum:[],enumNames:[]});return(0,g.h)(v.Field,m({name:r,schema:i,component:u.default},o))}function o(t){var e=t.context,r=t.fieldName,n=t.fieldValue,o=t.type,i=t.radiobuttons,a=t.formState,s=p(t,["context","fieldName","fieldValue","type","radiobuttons","formState"]),u=a.result,l=a.valid,c={context:e,fieldName:r||(0,_.getSdataDefault)(e),type:o,radiobuttons:i};c.fieldValue=n||(0,_.getSdataDefault)(e,c.fieldName);var f=_.sdataSchema[u.context][u.fieldName]||_.sdataCustomSchema,d={context:u.context.trim(),fieldName:u.fieldName.trim(),fieldValue:"string"==typeof u.fieldValue?u.fieldValue.trim():u.fieldValue};return(0,g.h)(b.default,{title:"S-Group Properties",className:"sgroup",result:function(){return u},valid:function(){return l},params:s},(0,g.h)(y.default,m({serialize:d,schema:f,init:c},a),(0,g.h)(v.SelectOneOf,{title:"Context",name:"context",schema:_.sdataSchema}),(0,g.h)("fieldset",{className:"data"},(0,g.h)(h,{title:"Field name",name:"fieldName",schema:_.sdataSchema[u.context]}),x(f,u.context,u.fieldName))))}Object.defineProperty(r,"__esModule",{value:!0});var m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},g=t("preact"),i=t("preact-redux"),v=t("../../component/form/form"),y=n(v),a=t("../../component/dialog"),b=n(a),s=t("../../component/form/combobox"),u=n(s),_=t("../../data/schema/sdata-schema"),x=function(t,e,r){return Object.keys(t.properties).filter(function(t){return"type"!==t&&"context"!==t&&"fieldName"!==t}).map(function(t){return"radiobuttons"===t?(0,g.h)(v.Field,{name:t,type:"radio",key:e+"-"+r+"-"+t+"-radio"}):(0,g.h)(v.Field,{name:t,type:"textarea",multiple:!0,size:"10",key:e+"-"+r+"-"+t+"-select"})})};r.default=(0,i.connect)(function(t){return{formState:t.modal.form}})(o)},{"../../component/dialog":616,"../../component/form/combobox":618,"../../component/form/form":619,"../../data/schema/sdata-schema":641,preact:485,"preact-redux":484}],666:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function o(t){var e=t.formState,r=a(t,["formState"]),n=e.result,o=e.valid,i=n.type;return(0,u.h)(p.default,{title:"S-Group Properties",className:"sgroup",result:function(){return n},valid:function(){return o},params:r},(0,u.h)(f.default,s({schema:l.sgroupMap[i],init:r},e),(0,u.h)(c.SelectOneOf,{title:"Type",name:"type",schema:l.sgroupMap}),(0,u.h)("fieldset",{className:"DAT"===i?"data":"base"},h(i))))}Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},u=t("preact"),i=t("preact-redux"),l=t("../../data/schema/struct-schema"),c=t("../../component/form/form"),f=n(c),d=t("../../component/dialog"),p=n(d),h=function(r){return Object.keys(l.sgroupMap[r].properties).filter(function(t){return"type"!==t}).map(function(t){var e={};return"name"===t&&(e.maxlength=15),"fieldName"===t&&(e.maxlength=30),"fieldValue"===t&&(e.type="textarea"),"radiobuttons"===t&&(e.type="radio"),(0,u.h)(c.Field,s({name:t,key:r+"-"+t},e))})};r.default=(0,i.connect)(function(t){return{formState:t.modal.form}})(o)},{"../../component/dialog":616,"../../component/form/form":619,"../../data/schema/struct-schema":642,preact:485,"preact-redux":484}],667:[function(t,e,r){"use strict";function n(t,e){var r=document.querySelector("[role=application]")||document.body;return(0,i.default)(r,t,e)}Object.defineProperty(r,"__esModule",{value:!0});var o=t("./app"),i=function(t){return t&&t.__esModule?t:{default:t}}(o);r.default=n},{"./app":611}],668:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function s(t,e){var r=e.action,n=e.editor,o=e.server,i=e.options;if(r.tool){if(n.tool(r.tool,r.opts))return r}else"function"==typeof r?r(n,o,i):console.info("no action");return t}function o(t,e,r){var n=r.editor,o=r.server;return"function"==typeof t.selected?t.selected(n,o):!(!t.action||!t.action.tool)&&(0,h.default)(e,t.action)}function i(t,e){var r=e.editor,n=e.server,o=e.options;return"function"==typeof t.disabled&&t.disabled(r,n,o)}function u(t,e,r){var n=v.default[t];return(0,c.default)(function(t){return t},{selected:o(n,e,r),disabled:i(n,r)})}Object.defineProperty(r,"__esModule",{value:!0});var l=t("lodash/fp/pickBy"),c=n(l),f=t("lodash/fp/isEmpty"),d=n(f),p=t("lodash/fp/isEqual"),h=n(p),m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};r.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments[1],r=e.type,n=e.action,o=a(e,["type","action"]);switch(r){case"INIT":n=v.default["select-lasso"].action;case"ACTION":var i=s(t&&t.activeTool,m({},o,{action:n}));case"UPDATE":return Object.keys(v.default).reduce(function(t,e){var r=u(e,t.activeTool,o);return(0,d.default)(r)||(t[e]=r),t},{activeTool:i||t.activeTool});default:return t}};var g=t("../../action"),v=n(g)},{"../../action":604,"lodash/fp/isEmpty":427,"lodash/fp/isEqual":428,"lodash/fp/pickBy":431}],669:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(i,a){function e(t,e){var r=e(),n=r.actionState.activeTool.tool;if("select"!==n){var o=r.toolbar.visibleTools.select,i=r.options.settings.resetToSelect;!0===i||i===n?t({type:"ACTION",action:d.default[o].action}):s()}}var s=(0,u.default)(100,function(){return i({type:"UPDATE"})}),r=function(e){return new Promise(function(t){return setTimeout(t,e)})};return{onInit:function(t){i({type:"INIT",editor:t})},onChange:function(t){void 0===t?r(0).then(function(){return i(e)}):i(e)},onSelectionChange:function(){s()},onElementEdit:function(t){var o=(0,f.fromElement)(t),e=null;if(c.default.map[o.label])e=(0,p.openDialog)(i,"atomProps",o);else if(1===Object.keys(o).length&&"ap"in o)e=(0,p.openDialog)(i,"attachmentPoints",o.ap).then(function(t){return{ap:t}});else if("list"===o.type||"not-list"===o.type)e=(0,p.openDialog)(i,"period-table",o);else if("rlabel"===o.type){var r=a().editor.struct().rgroups,n={type:"atom",values:o.values,disabledIds:Array.from(r.entries()).reduce(function(t,e){var r=l(e,2),n=r[0];return r[1].frags.has(o.fragId)&&t.push(n),t},[])};e=(0,p.openDialog)(i,"rgroup",n).then(function(t){return{values:t.values,type:"rlabel"}})}else e=(0,p.openDialog)(i,"period-table",o);return e.then(f.toElement)},onQuickEdit:function(t){return(0,p.openDialog)(i,"labelEdit",t)},onBondEdit:function(t){return(0,p.openDialog)(i,"bondProps",(0,f.fromBond)(t)).then(f.toBond)},onRgroupEdit:function(r){var t=a().editor.struct();if(Object.keys(r).length>2){var e=Array.from(t.rgroups.keys());return r.range||(r.range=">0"),(0,p.openDialog)(i,"rgroupLogic",Object.assign({rgroupLabels:e},r))}var n=Array.from(t.atoms.values()).reduce(function(t,e){return e.fragment===r.fragId&&null!==e.rglabel?t.concat((0,f.fromElement)(e).values):t},[]),o={type:"fragment",values:[r.label],disabledIds:n};return(0,p.openDialog)(i,"rgroup",o).then(function(t){return{label:t.values[0]}})},onSgroupEdit:function(t){return r(0).then(function(){return(0,p.openDialog)(i,"sgroup",(0,f.fromSgroup)(t))}).then(f.toSgroup)},onSdataEdit:function(t){return r(0).then(function(){return(0,p.openDialog)(i,"DAT"===t.type?"sdata":"sgroup",(0,f.fromSgroup)(t))}).then(f.toSgroup)},onMessage:function(t){t.error&&alert(t.error)},onAromatizeStruct:function(t){var e=a(),r=e.options.getServerSettings();return(0,h.serverCall)(e.editor,e.server,"aromatize",r,t)},onDearomatizeStruct:function(t){var e=a(),r=e.options.getServerSettings();return(0,h.serverCall)(e.editor,e.server,"dearomatize",r,t)},onMouseDown:function(){s()}}}Object.defineProperty(r,"__esModule",{value:!0});var i=t("lodash/fp/debounce"),u=n(i),l=function(){function r(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.default=o;var a=t("../../../chem/element"),c=n(a),f=t("../../data/convert/structconv"),s=t("../../action"),d=n(s),p=t("../modal"),h=t("../server")},{"../../../chem/element":520,"../../action":604,"../../data/convert/structconv":637,"../modal":673,"../server":676,"lodash/fp/debounce":421}],670:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function i(t){return function(e,r){var n=u();t.addEventListener("keydown",function(t){return a(e,r,n,t)})}}function a(e,t,r,n){var o=t();if(!o.modal){var i=o.editor,a=o.actionState,s=a.activeTool,u=(0,b.default)(n),l=i.selection()&&i.selection().atoms,c=null;if(u&&1===u.length&&l&&u.match(/\w/))console.assert(l.length>0),(0,E.openDialog)(e,"labelEdit",{letter:u}).then(function(t){e((0,j.onAction)({tool:"atom",opts:t}))}).catch(function(){return null}),n.preventDefault();else if(void 0!==(c=b.default.lookup(r,n))){var f=h(c,s);f=(f+1)%c.length;var d=c[f];if(a[d]&&!0===a[d].disabled)return void n.preventDefault();if(-1===S.actions.indexOf(d)){var p=x.default[d].action;e((0,j.onAction)(p)),n.preventDefault()}else window.clipboardData&&S.exec(n)}}}function s(t,e,r){Array.isArray(r[t])?r[t].push(e):r[t]=[e]}function u(){var r={},t=void 0;return Object.keys(x.default).forEach(function(e){t=x.default[e],t.shortcut&&(Array.isArray(t.shortcut)?t.shortcut.forEach(function(t){s(t,e,r)}):s(t.shortcut,e,r))}),(0,b.default)(r)}function h(t,r){var n=t.indexOf(r.tool);return t.forEach(function(t,e){(0,m.default)(x.default[t].action,r)&&(n=e)}),n}function l(r,n){var t=Object.keys(A.map).map(function(t){return A.map[t].mime}),o=(0,d.default)(0,function(t){return r((0,j.onAction)(t))}),i=(0,d.default)(0,function(t,e){return r((0,j.load)(t,e))});return{formats:t,focused:function(){return!n().modal},onCut:function(){var t=n().editor,e=c(t);return e?o({tool:"eraser",opts:1}):t.selection(null),e},onCopy:function(){var t=n().editor,e=c(t);return t.selection(null),e},onPaste:function(t){var e=t["chemical/x-mdl-molfile"]||t["chemical/x-mdl-rxnfile"]||t["text/plain"],r=n().editor.render.ctab.molecule;!e||r.hasRxnArrow()&&P.test(t["text/plain"])||i(e,{fragment:!0})}}}function c(t){var e={},r=t.structSelected();if(r.isBlank())return null;var n=r.isReaction?"chemical/x-mdl-molfile":"chemical/x-mdl-rxnfile";try{var o=v.default.stringify(r);return e["text/plain"]=o,e[n]=o,e}catch(t){alert(t.message)}return null}Object.defineProperty(r,"__esModule",{value:!0});var f=t("lodash/fp/debounce"),d=o(f),p=t("lodash/fp/isEqual"),m=o(p);r.initKeydownListener=i,r.initClipboard=l;var g=t("../../chem/molfile"),v=o(g),y=t("../data/convert/keynorm"),b=o(y),_=t("../action"),x=o(_),w=t("../component/cliparea"),S=n(w),O=t("../data/convert/structformat"),A=n(O),E=t("./modal"),j=t("./shared"),P=/\$RXN\n+\s+0\s+0\s+0\n*/},{"../../chem/molfile":523,"../action":604,"../component/cliparea":615,"../data/convert/keynorm":636,"../data/convert/structformat":638,"./modal":673,"./shared":677,"lodash/fp/debounce":421,"lodash/fp/isEqual":428}],671:[function(w,t,S){(function(o){"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function a(t,e){switch(e.type){case"INIT":o._ui_editor=e.editor;case"UPDATE":var r=(e.type,i(e,["type"]));r&&(t=u({},t,r))}var n=x(t,u({},e,(0,s.default)(["editor","server","options"],t)));return n===t.shared?t:u({},t,n)}Object.defineProperty(S,"__esModule",{value:!0}),S.load=S.onAction=void 0;var e=w("lodash/fp/pick"),s=t(e),u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};S.default=function(t,e){var r={actionState:null,editor:null,modal:null,options:Object.assign(h.initOptionsState,{app:t}),server:e||Promise.reject(new Error("Standalone mode!")),templates:g.initTmplsState},n=[c.default];return(0,l.createStore)(a,r,l.applyMiddleware.apply(void 0,n))};var l=w("redux"),r=w("redux-thunk"),c=t(r),n=(w("redux-logger"),w("./action")),f=t(n),d=w("./modal"),p=t(d),h=w("./options"),m=t(h),g=w("./templates"),v=t(g),y=w("./toolbar"),b=t(y),_=w("./shared");S.onAction=_.onAction,S.load=_.load;var x=(0,l.combineReducers)({actionState:f.default,toolbar:b.default,modal:p.default,server:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:null},editor:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:null},options:m.default,templates:v.default})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./action":668,"./modal":673,"./options":675,"./shared":677,"./templates":678,"./toolbar":680,"lodash/fp/pick":430,redux:505,"redux-logger":498,"redux-thunk":499}],672:[function(t,e,r){"use strict";function n(t){return{type:"UPDATE_FORM",data:t}}function o(t){return{type:"UPDATE_FORM",data:{moleculeErrors:t}}}function i(){return{type:"UPDATE_FORM",data:{result:(0,s.getDefaultOptions)(),valid:!0,errors:{}}}}function a(t,e,r){return"sdata"===r?(0,u.sdataReducer)(t,e):Object.assign({},t,e.data)}Object.defineProperty(r,"__esModule",{value:!0}),r.formsState=void 0,r.updateFormState=n,r.checkErrors=o,r.setDefaultSettings=i,r.formReducer=a;var s=t("../../data/schema/options-schema"),u=t("./sdata");r.formsState={atomProps:{errors:{},valid:!0,result:{label:"",charge:0,explicitValence:-1,hCount:0,invRet:0,isotope:0,radical:0,ringBondCount:0,substitutionCount:0}},attachmentPoints:{errors:{},valid:!0,result:{primary:!1,secondary:!1}},automap:{errors:{},valid:!0,result:{mode:"discard"}},bondProps:{errors:{},valid:!0,result:{type:"single",topology:0,center:0}},check:{errors:{},moleculeErrors:{}},labelEdit:{errors:{},valid:!0,result:{label:""}},rgroup:{errors:{},valid:!0,result:{values:[]}},rgroupLogic:{errors:{},valid:!0,result:{ifthen:0,range:">0",resth:!1}},save:{errors:{},valid:!0,result:{filename:"ketcher",format:"mol"}},settings:{errors:{},valid:!0,result:(0,s.getDefaultOptions)()},sgroup:{errors:{},valid:!0,result:{type:"GEN"}},sdata:(0,u.initSdata)()}},{"../../data/schema/options-schema":639,"./sdata":674}],673:[function(t,e,r){"use strict";function n(r,n,o){return new Promise(function(t,e){r({type:"MODAL_OPEN",data:{name:n,prop:i({},o,{onResult:t,onCancel:e})}})})}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments[1],r=e.type,n=e.data;if("UPDATE_FORM"===r){var o=(0,a.formReducer)(t.form,e,t.name);return i({},t,{form:o})}switch(r){case"MODAL_CLOSE":return null;case"MODAL_OPEN":return{name:n.name,form:a.formsState[n.name]||null,prop:n.prop||null};default:return t}}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};r.openDialog=n;var a=t("./form");r.default=o},{"./form":672}],674:[function(t,e,r){"use strict";function n(t,e){if(e.data.result.init)return i(a({},t,{result:Object.assign({},t.result,e.data.result)}),e.data);var r=e.data.result.context,n=e.data.result.fieldName,o=null;return r!==t.result.context?o=u(t,e.data.result):n!==t.result.fieldName&&(o=l(t,e.data.result)),o=o||a({},t,{result:Object.assign({},t.result,e.data.result)}),i(o,e.data)}Object.defineProperty(r,"__esModule",{value:!0}),r.initSdata=void 0;var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};r.sdataReducer=n;var s=t("../../data/schema/sdata-schema"),i=(r.initSdata=function(){var t=(0,s.getSdataDefault)(),e=(0,s.getSdataDefault)(t);return{errors:{},valid:!0,result:{context:t,fieldName:e,fieldValue:(0,s.getSdataDefault)(t,e),radiobuttons:"Absolute",type:"DAT"}}},function(t,e){var r=e.valid,n=e.errors,o=t.result,i=o.fieldName,a=o.fieldValue;return{result:t.result,valid:r&&!!i&&!!a,errors:n}}),u=function(t,e){var r=e.context,n=e.fieldValue,o=(0,s.getSdataDefault)(r),i=n;return i===t.result.fieldValue&&(i=(0,s.getSdataDefault)(r,o)),{result:a({},e,{context:r,fieldName:o,fieldValue:i})}},l=function(t,e){var r=e.fieldName,n=t.result.context,o=e.fieldValue;return s.sdataSchema[n][r]&&(o=(0,s.getSdataDefault)(n,r)),o===t.result.fieldValue&&s.sdataSchema[n][t.result.fieldName]&&(o=""),{result:a({},e,{fieldName:r,fieldValue:o})}}},{"../../data/schema/sdata-schema":641}],675:[function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(e){return function(t){t({type:"APP_OPTIONS",data:e}),t({type:"UPDATE"})}}function i(t){return v.storage.setItem("ketcher-opts",t),{type:"SAVE_SETTINGS",data:t}}function a(t,e){return{type:"CHANGE_ANALYSE",data:n({},t,e)}}function s(t){return{type:"SET_RECOGNIZE_STRUCT",data:{structStr:t}}}function u(t){return{type:"CHANGE_IMAGO_VERSION",data:{version:t}}}function l(t){return{type:"CHANGE_RECOGNIZE_FILE",data:{file:t,structStr:null}}}function c(t){return{type:"IS_FRAGMENT_RECOGNIZE",data:{fragment:t}}}function f(t){return{type:"SAVE_CHECK_OPTS",data:t}}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],r=e.type,n=e.data;return"APP_OPTIONS"===r?m({},t,{app:m({},t.app,n)}):"SAVE_SETTINGS"===r?m({},t,{settings:n}):"SAVE_CHECK_OPTS"===r?m({},t,{check:n}):"CHANGE_ANALYSE"===r?m({},t,{analyse:m({},t.analyse,n)}):y.includes(r)?m({},t,{recognize:m({},t.recognize,n)}):t}Object.defineProperty(r,"__esModule",{value:!0}),r.initOptionsState=void 0;var p=t("lodash/fp/pick"),h=function(t){return t&&t.__esModule?t:{default:t}}(p),m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};r.appUpdate=o,r.saveSettings=i,r.changeRound=a,r.setStruct=s,r.changeVersion=u,r.changeImage=l,r.shouldFragment=c,r.checkOpts=f;var g=t("../../data/schema/options-schema"),v=t("../../storage-ext"),y=(r.initOptionsState={app:{server:!1,templates:!1},analyse:{values:null,roundWeight:3,roundMass:3},check:{checkOptions:["valence","radicals","pseudoatoms","stereo","query","overlapping_atoms","overlapping_bonds","rgroups","chiral","3d","chiral_flag"]},recognize:{file:null,structStr:null,fragment:!1,version:null},settings:Object.assign((0,g.getDefaultOptions)(),(0,g.validation)(v.storage.getItem("ketcher-opts"))),getServerSettings:function(){return(0,h.default)(g.SERVER_OPTIONS,this.settings)}},["SET_RECOGNIZE_STRUCT","CHANGE_RECOGNIZE_FILE","CHANGE_IMAGO_VERSION","IS_FRAGMENT_RECOGNIZE"]);r.default=d},{"../../data/schema/options-schema":639,"../../storage-ext":681,"lodash/fp/pick":430}],676:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(){return function(e,t){t().server.then(function(t){return e((0,x.appUpdate)({indigoVersion:t.indigoVersion,imagoVersions:t.imagoVersions,server:!0}))},function(t){return console.info(t)})}}function i(o,i){return function(e,t){var r=t().server.recognize,n=r(o,i).then(function(t){e((0,x.setStruct)(t.struct))},function(){e((0,x.setStruct)(null)),setTimeout(function(){return alert("Error! The picture isn't recognized.")},200)});e((0,x.setStruct)(n))}}function u(t,e){var r={};if(e.includes("chiral_flag")&&t.isChiral&&(r.chiral_flag="Chiral flag is present on the canvas"),e.includes("valence")){var n=0;t.atoms.forEach(function(t){return t.badConn&&n++}),n>0&&(r.valence="Structure contains "+n+" atom"+(1!==n?"s":"")+" with bad valence")}return r}function a(s){return function(e,t){var r=t(),n=r.editor,o=r.server,i=u(n.struct(),s),a=t().options.getServerSettings();return a.data={types:(0,h.default)(["valence","chiral_flag"],s)},f(n,o,"check",a).then(function(t){t=Object.assign(t,i),e((0,w.checkErrors)(t))}).catch(function(t){throw alert("Failed check!\n"+t.message),t})}}function s(t){return c("automap",t)}function l(){return function(e,t){var r=t(),n=r.editor,o=r.server,i=t().options.getServerSettings();return i.data={properties:["molecular-weight","most-abundant-mass","monoisotopic-mass","gross","mass-composition"]},f(n,o,"calculate",i).then(function(t){return e({type:"CHANGE_ANALYSE",data:{values:t}})}).catch(function(t){throw alert(t.message),t})}}function c(o,i,a){return function(e,t){var r=t(),n=r.options.getServerSettings();n.data=i,f(r.editor,r.server,o,n,a).then(function(t){return e((0,S.load)(t.struct,{rescale:"layout"===o,reactionRelayout:"clean"===o}))}).catch(function(t){return alert(t.message)})}}function f(t,e,r,n,o){var i=t.selection(),a=[];if(i&&(a=i.atoms?i.atoms:t.explicitSelected().atoms),!o){var s=new Map;o=t.struct().clone(null,null,!1,s);var u=d(o.getComponents());a=a.map(function(t){return u.get(s.get(t))})}return e.then(function(){return e[r](Object.assign({struct:_.default.stringify(o,{ignoreErrors:!0})},a&&a.length>0?{selected:a}:null,n.data),(0,g.default)("data",n))})}function d(t){return t.reactants.concat(t.products).reduce(function(e,t){return Array.from(t).forEach(function(t){e.add(t)}),e},new y.default)}Object.defineProperty(r,"__esModule",{value:!0});var p=t("lodash/fp/without"),h=n(p),m=t("lodash/fp/omit"),g=n(m);r.checkServer=o,r.recognize=i,r.check=a,r.automap=s,r.analyse=l,r.serverTransform=c,r.serverCall=f;var v=t("../../../util/pool"),y=n(v),b=t("../../../chem/molfile"),_=n(b),x=t("../options"),w=t("../modal/form"),S=t("../shared")},{"../../../chem/molfile":523,"../../../util/pool":684,"../modal/form":672,"../options":675,"../shared":677,"lodash/fp/omit":429,"lodash/fp/without":437}],677:[function(t,e,r){"use strict";function s(t){return t&&t.dialog?{type:"MODAL_OPEN",data:{name:t.dialog}}:t&&t.thunk?t.thunk:{type:"ACTION",action:t}}function n(i,a){return function(e,t){var r=t(),n=r.editor,o=r.server;return a=a||{},u.fromString(i,a,o).then(function(t){console.assert(t,"No molecule to update"),a.rescale&&t.rescale(),t.isBlank()||(a.fragment?e(s({tool:"paste",opts:t})):n.struct(t))},function(t){alert(t.message||"Can't parse molecule!")})}}Object.defineProperty(r,"__esModule",{value:!0}),r.onAction=s,r.load=n;var o=t("../data/convert/structformat"),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(o)},{"../data/convert/structformat":638}],678:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){return{type:"TMPL_SELECT",data:{selected:t}}}function i(t){return{type:"TMPL_CHANGE_GROUP",data:{group:t,selected:null}}}function a(t){return{type:"TMPL_CHANGE_FILTER",data:{filter:t.trim(),selected:null}}}function s(t,e){return{type:"INIT_ATTACH",data:{name:t,atomid:e.atomid,bondid:e.bondid}}}function u(t){return{type:"SET_ATTACH_POINTS",data:{atomid:t.atomid,bondid:t.bondid}}}function l(t){return{type:"SET_TMPL_NAME",data:{name:t}}}function c(o){return function(t,n){(0,_.openDialog)(t,"attach",{tmpl:o}).then(function(t){var e=t.name,r=t.attach;o.struct.name=e,o.props=Object.assign({},o.props,r),"User Templates"===o.props.group&&d(n().templates.lib)},function(){return null}).then(function(){return(0,_.openDialog)(t,"templates").catch(function(){return null})})}}function f(t){var a={struct:t.clone(),props:{}};return function(o,i){(0,_.openDialog)(o,"attach",{tmpl:a}).then(function(t){var e=t.name,r=t.attach;a.struct.name=e,a.props=g({},r,{group:"User Templates"});var n=i().templates.lib.concat(a);o((0,x.initLib)(n)),d(n)}).catch(function(){return null})}}function d(t){var e=t.filter(function(t){return"User Templates"===t.props.group}).map(function(t){return{struct:y.default.stringify(t.struct),props:Object.assign({},(0,m.default)(["group"],t.props))}});b.storage.setItem("ketcher-tmpls",e)}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,e=arguments[1];if(O.includes(e.type))return Object.assign({},t,e.data);if(A.includes(e.type)){var r=Object.assign({},t.attach,e.data);return g({},t,{attach:r})}return t}Object.defineProperty(r,"__esModule",{value:!0}),r.initTmplsState=r.initTmplLib=void 0;var h=t("lodash/fp/omit"),m=n(h),g=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};r.selectTmpl=o,r.changeGroup=i,r.changeFilter=a,r.initAttach=s,r.setAttachPoints=u,r.setTmplName=l,r.editTmpl=c,r.saveUserTmpl=f;var v=t("../../../chem/molfile"),y=n(v),b=t("../../storage-ext"),_=t("../modal"),x=t("./init-lib"),w=n(x);r.initTmplLib=w.default;var S=r.initTmplsState={lib:[],selected:null,filter:"",group:null,attach:{}},O=["TMPL_INIT","TMPL_SELECT","TMPL_CHANGE_GROUP","TMPL_CHANGE_FILTER"],A=["INIT_ATTACH","SET_ATTACH_POINTS","SET_TMPL_NAME"];r.default=p},{"../../../chem/molfile":523,"../../storage-ext":681,"../modal":673,"./init-lib":679,"lodash/fp/omit":429}],679:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){return{type:"TMPL_INIT",data:{lib:t}}}function o(r,n,o){s(n+"library.sdf").then(function(t){var e=d.default.parse(t);return l(e,n,o).then(function(r){return e.map(function(t){var e=u(t);return e.file&&(t.props.prerender=-1!==r.indexOf(e.file)?"#"+e.id:""),t})})}).then(function(t){var e=t.concat(a());r(i(e)),r((0,m.appUpdate)({templates:!0}))})}function a(){var t=c.storage.getItem("ketcher-tmpls");return Array.isArray(t)&&0!==t.length?t.map(function(t){try{return""===t.props&&(t.props={}),t.props.group="User Templates",{struct:h.default.parse(t.struct),props:t.props}}catch(t){return null}}).filter(function(t){return null!==t}):[]}function s(e){return fetch(e,{credentials:"same-origin"}).then(function(t){if(t.ok)return t.text();throw Error("Could not fetch "+e)})}function u(t){var e=t.props.prerender,r=e&&e.split("#",2);return{file:e&&r[0],id:e&&r[1]}}function l(t,e,n){var o=t.reduce(function(t,e){var r=u(e).file;return r&&-1===t.indexOf(r)&&t.push(r),t},[]);return Promise.all(o.map(function(t){return s(e+t).catch(function(){return null})})).then(function(r){return r.forEach(function(t){t&&(n.innerHTML+=t)}),o.filter(function(t,e){return!!r[e]})})}Object.defineProperty(r,"__esModule",{value:!0}),r.initLib=i,r.default=o;var c=t("../../storage-ext"),f=t("../../../chem/sdf"),d=n(f),p=t("../../../chem/molfile"),h=n(p),m=t("../options")},{"../../../chem/molfile":523,"../../../chem/sdf":529,"../../storage-ext":681,"../options":675}],680:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u(r,t){var n=/(bond)(-)(common|stereo|query)/,o=window.innerHeight;return Object.keys(r).reduce(function(t,e){return"bond"===e&&o>700?t:"transform"===e&&o>800?t:"rgroup"===e&&o>850?t:((!e.match(n)||o>700)&&(t[e]=r[e]),t)},y({},t))}function i(){return function(e,r){var t=(0,m.default)(250,function(){var t=r();t.editor.render.update(),e({type:"CLEAR_VISIBLE",data:t.actionState.activeTool})});addEventListener("resize",t)}}function a(e){fetch("ketcher.svg",{credentials:"same-origin"}).then(function(t){if(!t.ok)throw Error("Could not fetch ketcher.svg");t.text().then(function(t){e.innerHTML+=t})})}function l(t,e,r){return t=(0,v.default)(t),b.basic.indexOf(t)>-1||-1!==e.indexOf(t)?{freqAtoms:e}:(e[r]=t,r=(r+1)%S,{freqAtoms:e,currentAtom:r})}function s(t){return{type:"ADD_ATOMS",data:t}}function c(e){var t=Object.keys(x.default).find(function(t){return(0,p.default)(e,x.default[t].action)}),r=document.getElementById(t),n=r&&f(r);return n&&""!==n.id?o({},n.id,r.id):null}function f(t,e){e=e||document.body;for(var r=t;"hidden"!==window.getComputedStyle(r).overflow&&!r.classList.contains("opened");){if(r===e)return null;r=r.parentNode}return r}Object.defineProperty(r,"__esModule",{value:!0});var d=t("lodash/fp/isEqual"),p=n(d),h=t("lodash/fp/throttle"),m=n(h),g=t("lodash/fp/capitalize"),v=n(g),y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};r.initResize=i,r.initIcons=a,r.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,e=arguments[1],r=e.type,n=e.data;switch(r){case"ACTION":var o=c(e.action);return o?y({},t,{opened:null,visibleTools:y({},t.visibleTools,o)}):y({},t,{opened:null});case"ADD_ATOMS":var i=l(n,t.freqAtoms,t.currentAtom);return y({},t,i);case"CLEAR_VISIBLE":var a=c(e.data),s=u(t.visibleTools,a);return y({},t,{opened:null,visibleTools:y({},s)});case"OPENED":return n.isSelected&&t.opened?y({},t,{opened:null}):y({},t,{opened:n.menuName});case"UPDATE":case"MODAL_OPEN":return y({},t,{opened:null});default:return t}},r.addAtoms=s,r.hiddenAncestor=f;var b=t("../../action/atoms"),_=t("../../action/tools"),x=n(_),w={freqAtoms:[],currentAtom:0,opened:null,visibleTools:{select:"select-lasso"}},S=7},{"../../action/atoms":602,"../../action/tools":607,"lodash/fp/capitalize":418,"lodash/fp/isEqual":428,"lodash/fp/throttle":435}],681:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.storage={warningMessage:"Your changes will be lost after the tab closing. See Help (Note 2).",isAvailable:function(){try{return localStorage}catch(t){return!1}},getItem:function(t){var e=null;try{e=JSON.parse(localStorage.getItem(t))}catch(t){console.info("LocalStorage:",t.name)}return e},setItem:function(t,e){var r=null;try{localStorage.setItem(t,JSON.stringify(e)),r=!0}catch(t){console.info("LocalStorage:",t.name),r=!1}return r}}},{}],682:[function(t,e,r){"use strict";function n(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];if(1===e.length&&"min"in e[0]&&"max"in e[0]&&(this.p0=e[0].min,this.p1=e[0].max),2===e.length)this.p0=e[0],this.p1=e[1];else if(4===e.length)this.p0=new i.default(e[0],e[1]),this.p1=new i.default(e[2],e[3]);else{if(0!==e.length)return new Error("Box2Abs constructor only accepts 4 numbers or 2 vectors or no args!");this.p0=new i.default,this.p1=new i.default}}Object.defineProperty(r,"__esModule",{value:!0});var o=t("./vec2"),i=function(t){return t&&t.__esModule?t:{default:t}}(o);n.prototype.toString=function(){return this.p0.toString()+" "+this.p1.toString()},n.prototype.clone=function(){return new n(this.p0,this.p1)},n.prototype.extend=function(t,e){return console.assert(!!t),e=e||t,new n(this.p0.sub(t),this.p1.add(e))},n.prototype.include=function(t){return console.assert(!!t),new n(this.p0.min(t),this.p1.max(t))},n.prototype.contains=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return console.assert(!!t),t.x>=this.p0.x-e&&t.x<=this.p1.x+e&&t.y>=this.p0.y-e&&t.y<=this.p1.y+e},n.prototype.translate=function(t){return console.assert(!!t),new n(this.p0.add(t),this.p1.add(t))},n.prototype.transform=function(t,e){return console.assert(!!t),new n(t(this.p0,e),t(this.p1,e))},n.prototype.sz=function(){return this.p1.sub(this.p0)},n.prototype.centre=function(){return i.default.centre(this.p0,this.p1)},n.prototype.pos=function(){return this.p0},n.fromRelBox=function(t){return console.assert(!!t),new n(t.x,t.y,t.x+t.width,t.y+t.height)},n.union=function(t,e){return console.assert(!!t),console.assert(!!e),new n(i.default.min(t.p0,e.p0),i.default.max(t.p1,e.p1))},n.segmentIntersection=function(t,e,r,n){var o=(t.x-r.x)*(e.y-r.y)-(t.y-r.y)*(e.x-r.x),i=(t.x-n.x)*(e.y-n.y)-(t.y-n.y)*(e.x-n.x),a=(r.x-t.x)*(n.y-t.y)-(r.y-t.y)*(n.x-t.x),s=(r.x-e.x)*(n.y-e.y)-(r.y-e.y)*(n.x-e.x);return o*i<=0&&a*s<=0},r.default=n},{"./vec2":686}],683:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),s=function(t){function u(){return n(this,u),o(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return i(u,t),a(u,[{key:"find",value:function(t){var e=!0,r=!1,n=void 0;try{for(var o,i=this[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;if(t(a))return a}}catch(t){r=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(r)throw n}}return null}},{key:"intersection",value:function(t){var e=new u,r=!0,n=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;this.has(s)&&e.add(s)}}catch(t){n=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw o}}return e}},{key:"equals",value:function(t){return this.isSuperset(t)&&t.isSuperset(this)}},{key:"isSuperset",value:function(t){var e=!0,r=!1,n=void 0;try{for(var o,i=t[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;if(!this.has(a))return!1}}catch(t){r=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(r)throw n}}return!0}},{key:"filter",value:function(t){return new u(Array.from(this).filter(t))}},{key:"union",value:function(t){var e=new u(this),r=!0,n=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;e.add(s)}}catch(t){n=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw o}}return e}}]),u}(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Set));r.default=s},{}],684:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function r(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),s=function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)},u=function(t){function r(t){n(this,r);var e=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._nextId=0,e}return i(r,t),a(r,[{key:"add",value:function(t){var e=this._nextId++;return s(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"set",this).call(this,e,t),e}},{key:"newId",value:function(){return this._nextId++}},{key:"keyOf",value:function(t){var e=!0,r=!1,n=void 0;try{for(var o,i=this.entries()[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value,s=l(a,2),u=s[0];if(s[1]===t)return u}}catch(t){r=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(r)throw n}}return null}},{key:"find",value:function(t){var e=!0,r=!1,n=void 0;try{for(var o,i=this.entries()[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value,s=l(a,2),u=s[0];if(t(u,s[1]))return u}}catch(t){r=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(r)throw n}}return null}},{key:"filter",value:function(o){return new r(Array.from(this).filter(function(t){var e=l(t,2),r=e[0],n=e[1];return o(r,n)}))}}]),r}(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Map));r.default=u},{}],685:[function(t,e,r){"use strict";function n(t,e){return t.scaled(1/e.scale)}function o(t,e){return t.scaled(e.scale)}Object.defineProperty(r,"__esModule",{value:!0}),r.default={scaled2obj:n,obj2scaled:o}},{}],686:[function(t,e,r){"use strict";function i(t,e,r){if(0===arguments.length)this.x=0,this.y=0,this.z=0;else if(1===arguments.length)this.x=parseFloat(t.x||0),this.y=parseFloat(t.y||0),this.z=parseFloat(t.z||0);else if(2===arguments.length)this.x=parseFloat(t||0),this.y=parseFloat(e||0),this.z=0;else{if(3!==arguments.length)throw new Error("Vec2(): invalid arguments");this.x=parseFloat(t),this.y=parseFloat(e),this.z=parseFloat(r)}}Object.defineProperty(r,"__esModule",{value:!0}),i.ZERO=new i(0,0),i.UNIT=new i(1,1),i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.prototype.equals=function(t){return console.assert(!!t),this.x===t.x&&this.y===t.y},i.prototype.add=function(t){return console.assert(!!t),new i(this.x+t.x,this.y+t.y,this.z+t.z)},i.prototype.add_=function(t){console.assert(!!t),this.x+=t.x,this.y+=t.y,this.z+=t.z},i.prototype.get_xy0=function(){return new i(this.x,this.y)},i.prototype.sub=function(t){return console.assert(!!t),new i(this.x-t.x,this.y-t.y,this.z-t.z)},i.prototype.scaled=function(t){return console.assert(0===t||!!t),new i(this.x*t,this.y*t,this.z*t)},i.prototype.negated=function(){return new i(-this.x,-this.y,-this.z)},i.prototype.yComplement=function(t){return t=t||0,new i(this.x,t-this.y,this.z)},i.prototype.addScaled=function(t,e){return console.assert(!!t),console.assert(0===e||!!e),new i(this.x+t.x*e,this.y+t.y*e,this.z+t.z*e)},i.prototype.normalized=function(){return this.scaled(1/this.length())},i.prototype.normalize=function(){var t=this.length();return!(t<1e-6)&&(this.x/=t,this.y/=t,!0)},i.prototype.turnLeft=function(){return new i(-this.y,this.x,this.z)},i.prototype.coordStr=function(){return this.x.toString()+" , "+this.y.toString()},i.prototype.toString=function(){return"("+this.x.toFixed(2)+","+this.y.toFixed(2)+")"},i.prototype.max=function(t){return console.assert(!!t),new i.max(this,t)},i.prototype.min=function(t){return console.assert(!!t),new i.min(this,t)},i.prototype.ceil=function(){return new i(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))},i.prototype.floor=function(){return new i(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))},i.prototype.rotate=function(t){console.assert(0===t||!!t);var e=Math.sin(t),r=Math.cos(t);return this.rotateSC(e,r)},i.prototype.rotateSC=function(t,e){return console.assert(0===t||!!t),console.assert(0===e||!!e),new i(this.x*e-this.y*t,this.x*t+this.y*e,this.z)},i.prototype.oxAngle=function(){return Math.atan2(this.y,this.x)},i.dist=function(t,e){return console.assert(!!t),console.assert(!!e),i.diff(t,e).length()},i.max=function(t,e){return console.assert(!!t),console.assert(!!e),new i(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.max(t.z,e.z))},i.min=function(t,e){return console.assert(!!t),console.assert(!!e),new i(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.min(t.z,e.z))},i.sum=function(t,e){return console.assert(!!t),console.assert(!!e),new i(t.x+e.x,t.y+e.y,t.z+e.z)},i.dot=function(t,e){return console.assert(!!t),console.assert(!!e),t.x*e.x+t.y*e.y},i.cross=function(t,e){return console.assert(!!t),console.assert(!!e),t.x*e.y-t.y*e.x},i.angle=function(t,e){return console.assert(!!t),console.assert(!!e),Math.atan2(i.cross(t,e),i.dot(t,e))},i.diff=function(t,e){return console.assert(!!t),console.assert(!!e),new i(t.x-e.x,t.y-e.y,t.z-e.z)},i.lc=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=new i,o=0;o<arguments.length/2;++o)n=n.addScaled(e[2*o],e[2*o+1]);return n},i.lc2=function(t,e,r,n){return console.assert(!!t),console.assert(!!r),console.assert(0===e||!!e),console.assert(0===n||!!n),new i(t.x*e+r.x*n,t.y*e+r.y*n,t.z*e+r.z*n)},i.centre=function(t,e){return new i.lc2(t,.5,e,.5)},r.default=i},{}],687:[function(A,E,t){(function(e){"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function r(){return g.default.stringify(O.editor.struct(),{ignoreErrors:!0})}function n(){var t=O.editor.struct();return y.toString(t,"smiles-ext",O.server).catch(function(){return g.default.stringify(t)})}function o(){return h.default.stringify(O.editor.struct(),{ignoreErrors:!0})}function i(){var t=O.editor.struct();var e=false;t.atoms.forEach(function(t){if(t.badConn){e=true}});return e}function a(t){"string"==typeof t&&O.ui.load(t,{rescale:!0})}function s(t){"string"==typeof t&&O.ui.load(t,{rescale:!0,fragment:!0})}function u(t,e,r){var n=new w.default(t,Object.assign({scale:r.bondLength||75},r));if(e){var o=h.default.parse(e);n.setMolecule(o)}return n.update(),n}var l=A("query-string"),c=t(l),f=A("./api"),d=t(f),p=A("./chem/molfile"),h=t(p),m=A("./chem/smiles"),g=t(m),v=A("./ui/data/convert/structformat"),y=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(v),b=A("./ui"),_=t(b),x=A("./render"),w=t(x);window.onload=function(){var t=c.default.parse(document.location.search);t.api_path&&(O.apiPath=t.api_path),O.server=(0,d.default)(O.apiPath,{"smart-layout":!0,"ignore-stereochemistry-errors":!0,"mass-skip-error-on-pseudoatoms":!1,"gross-formula-add-rsites":!0}),O.ui=(0,_.default)(Object.assign({},t,S),O.server),O.editor=e._ui_editor,O.server.then(function(){t.mol&&O.ui.load(t.mol)},function(){document.title+=" (standalone)"})};var S={version:"2.0.0-RC",apiPath:"",buildDate:"2018-06-25T09:07:46",buildNumber:null},O=E.exports=Object.assign({getSmiles:r,saveSmiles:n,getMolfile:o,setMolecule:a,addFragment:s,showMolfile:u,getCheck:i},S)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./api":518,"./chem/molfile":523,"./chem/smiles":532,"./render":586,"./ui":667,"./ui/data/convert/structformat":638,"core-js/modules/es6.array.copy-within":108,"core-js/modules/es6.array.fill":109,"core-js/modules/es6.array.find":111,"core-js/modules/es6.array.find-index":110,"core-js/modules/es6.array.from":112,"core-js/modules/es6.array.iterator":113,"core-js/modules/es6.array.of":114,"core-js/modules/es6.function.name":115,"core-js/modules/es6.map":116,"core-js/modules/es6.math.acosh":117,"core-js/modules/es6.math.asinh":118,"core-js/modules/es6.math.atanh":119,"core-js/modules/es6.math.cbrt":120,"core-js/modules/es6.math.clz32":121,"core-js/modules/es6.math.cosh":122,"core-js/modules/es6.math.expm1":123,"core-js/modules/es6.math.fround":124,"core-js/modules/es6.math.hypot":125,"core-js/modules/es6.math.imul":126,"core-js/modules/es6.math.log10":127,"core-js/modules/es6.math.log1p":128,"core-js/modules/es6.math.log2":129,"core-js/modules/es6.math.sign":130,"core-js/modules/es6.math.sinh":131,"core-js/modules/es6.math.tanh":132,"core-js/modules/es6.math.trunc":133,"core-js/modules/es6.number.epsilon":134,"core-js/modules/es6.number.is-finite":135,"core-js/modules/es6.number.is-integer":136,"core-js/modules/es6.number.is-nan":137,"core-js/modules/es6.number.is-safe-integer":138,"core-js/modules/es6.number.max-safe-integer":139,"core-js/modules/es6.number.min-safe-integer":140,"core-js/modules/es6.object.assign":141,"core-js/modules/es6.object.is":142,"core-js/modules/es6.object.set-prototype-of":143,"core-js/modules/es6.promise":144,"core-js/modules/es6.reflect.apply":145,"core-js/modules/es6.reflect.construct":146,"core-js/modules/es6.reflect.define-property":147,"core-js/modules/es6.reflect.delete-property":148,"core-js/modules/es6.reflect.get":151,"core-js/modules/es6.reflect.get-own-property-descriptor":149,"core-js/modules/es6.reflect.get-prototype-of":150,"core-js/modules/es6.reflect.has":152,"core-js/modules/es6.reflect.is-extensible":153,"core-js/modules/es6.reflect.own-keys":154,"core-js/modules/es6.reflect.prevent-extensions":155,"core-js/modules/es6.reflect.set":157,"core-js/modules/es6.reflect.set-prototype-of":156,"core-js/modules/es6.regexp.flags":158,"core-js/modules/es6.regexp.match":159,"core-js/modules/es6.regexp.replace":160,"core-js/modules/es6.regexp.search":161,"core-js/modules/es6.regexp.split":162,"core-js/modules/es6.set":163,"core-js/modules/es6.string.code-point-at":164,"core-js/modules/es6.string.ends-with":165,"core-js/modules/es6.string.from-code-point":166,"core-js/modules/es6.string.includes":167,"core-js/modules/es6.string.raw":168,"core-js/modules/es6.string.repeat":169,"core-js/modules/es6.string.starts-with":170,"core-js/modules/es6.symbol":171,"core-js/modules/es6.typed.array-buffer":172,"core-js/modules/es6.typed.float32-array":173,"core-js/modules/es6.typed.float64-array":174,"core-js/modules/es6.typed.int16-array":175,"core-js/modules/es6.typed.int32-array":176,"core-js/modules/es6.typed.int8-array":177,"core-js/modules/es6.typed.uint16-array":178,"core-js/modules/es6.typed.uint32-array":179,"core-js/modules/es6.typed.uint8-array":180,"core-js/modules/es6.typed.uint8-clamped-array":181,"core-js/modules/es6.weak-map":182,"core-js/modules/es6.weak-set":183,"core-js/modules/es7.array.includes":184,"core-js/modules/es7.object.entries":185,"core-js/modules/es7.object.get-own-property-descriptors":186,"core-js/modules/es7.object.values":187,"core-js/modules/es7.string.pad-end":188,"core-js/modules/es7.string.pad-start":189,"core-js/modules/web.dom.iterable":190,"core-js/modules/web.immediate":191,"core-js/modules/web.timers":192,"query-string":493,"regenerator-runtime/runtime":507,"whatwg-fetch":517}]},{},[687])(687)});